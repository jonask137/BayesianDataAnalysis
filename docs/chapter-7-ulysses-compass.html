<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Chapter 7 - Ulysses’ Compass | Bayesian Data Analysis Notes</title>
  <meta name="description" content="7 Chapter 7 - Ulysses’ Compass | Bayesian Data Analysis Notes" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Chapter 7 - Ulysses’ Compass | Bayesian Data Analysis Notes" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Chapter 7 - Ulysses’ Compass | Bayesian Data Analysis Notes" />
  
  
  

<meta name="author" content="Jonas Ringive Korsholm" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-6-the-haunted-dag-the-causal-terror.html"/>
<link rel="next" href="chapter-8-conditional-manatees.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="chapter-1-golems-of-prague.html"><a href="chapter-1-golems-of-prague.html"><i class="fa fa-check"></i><b>1</b> Chapter 1 - Golems of Prague</a></li>
<li class="chapter" data-level="2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html"><i class="fa fa-check"></i><b>2</b> Chapter 2 - Small worlds and Large Worlds</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#models-and-estimation"><i class="fa fa-check"></i><b>2.1</b> Models and Estimation</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#making-a-model-go"><i class="fa fa-check"></i><b>2.1.1</b> Making a model go!</a></li>
<li class="chapter" data-level="2.1.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#engines-motors-to-estimate-the-models"><i class="fa fa-check"></i><b>2.1.2</b> Engines / Motors to estimate the models</a>
<ul>
<li class="chapter" data-level="2.1.2.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#grid-approximation"><i class="fa fa-check"></i><b>2.1.2.1</b> Grid approximation</a></li>
<li class="chapter" data-level="2.1.2.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#quadratic-approximation"><i class="fa fa-check"></i><b>2.1.2.2</b> Quadratic approximation</a></li>
<li class="chapter" data-level="2.1.2.3" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#markov-chain-monte-carlo"><i class="fa fa-check"></i><b>2.1.2.3</b> Markov Chain Monte Carlo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#exercises"><i class="fa fa-check"></i><b>2.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#m1"><i class="fa fa-check"></i><b>2.2.1</b> 2M1</a></li>
<li class="chapter" data-level="2.2.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#m2"><i class="fa fa-check"></i><b>2.2.2</b> 2M2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html"><i class="fa fa-check"></i><b>3</b> Chapter 3 - Sampling the Imaginary</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-from-a-grid-approximate-posterior"><i class="fa fa-check"></i><b>3.1</b> Sampling from a grid-approximate posterior</a></li>
<li class="chapter" data-level="3.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-to-summarize"><i class="fa fa-check"></i><b>3.2</b> Sampling to summarize</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#defined-boundaries"><i class="fa fa-check"></i><b>3.2.1</b> Defined Boundaries</a></li>
<li class="chapter" data-level="3.2.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#defined-probability-mass"><i class="fa fa-check"></i><b>3.2.2</b> Defined Probability Mass</a></li>
<li class="chapter" data-level="3.2.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#point-estimates"><i class="fa fa-check"></i><b>3.2.3</b> Point Estimates</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-to-simulate-prediction"><i class="fa fa-check"></i><b>3.3</b> Sampling to simulate prediction</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#dummy-data"><i class="fa fa-check"></i><b>3.3.1</b> Dummy Data</a></li>
<li class="chapter" data-level="3.3.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#model-checking"><i class="fa fa-check"></i><b>3.3.2</b> Model Checking</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#exercises-1"><i class="fa fa-check"></i><b>3.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m1-1"><i class="fa fa-check"></i><b>3.4.1</b> 3M1</a></li>
<li class="chapter" data-level="3.4.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m2-1"><i class="fa fa-check"></i><b>3.4.2</b> 3M2</a></li>
<li class="chapter" data-level="3.4.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m3"><i class="fa fa-check"></i><b>3.4.3</b> 3M3</a></li>
<li class="chapter" data-level="3.4.4" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m4"><i class="fa fa-check"></i><b>3.4.4</b> 3M4</a></li>
<li class="chapter" data-level="3.4.5" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m5"><i class="fa fa-check"></i><b>3.4.5</b> 3M5</a></li>
<li class="chapter" data-level="3.4.6" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h1"><i class="fa fa-check"></i><b>3.4.6</b> 3H1</a></li>
<li class="chapter" data-level="3.4.7" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h2"><i class="fa fa-check"></i><b>3.4.7</b> 3H2</a></li>
<li class="chapter" data-level="3.4.8" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h3"><i class="fa fa-check"></i><b>3.4.8</b> 3H3</a></li>
<li class="chapter" data-level="3.4.9" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h4"><i class="fa fa-check"></i><b>3.4.9</b> 3H4</a></li>
<li class="chapter" data-level="3.4.10" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h5"><i class="fa fa-check"></i><b>3.4.10</b> 3H5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html"><i class="fa fa-check"></i><b>4</b> Chapter 4 - Geocentric Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#why-normal-distributions-are-normal"><i class="fa fa-check"></i><b>4.1</b> Why Normal distributions are normal</a></li>
<li class="chapter" data-level="4.2" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#a-language-for-describing-models"><i class="fa fa-check"></i><b>4.2</b> A language for describing models</a></li>
<li class="chapter" data-level="4.3" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#gaussian-model-of-height"><i class="fa fa-check"></i><b>4.3</b> Gaussian model of height</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#the-model"><i class="fa fa-check"></i><b>4.3.1</b> The model</a></li>
<li class="chapter" data-level="4.3.2" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#grid-approximation-of-the-posterior-distribution"><i class="fa fa-check"></i><b>4.3.2</b> Grid approximation of the posterior distribution</a></li>
<li class="chapter" data-level="4.3.3" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#sampling-from-the-posterior"><i class="fa fa-check"></i><b>4.3.3</b> Sampling from the posterior</a></li>
<li class="chapter" data-level="4.3.4" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#finding-the-posterior-distribution-with-quap"><i class="fa fa-check"></i><b>4.3.4</b> Finding the posterior distribution with quap</a></li>
<li class="chapter" data-level="4.3.5" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#sampling-from-a-quap"><i class="fa fa-check"></i><b>4.3.5</b> Sampling from a quap</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#linear-prediction"><i class="fa fa-check"></i><b>4.4</b> Linear prediction</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#the-linear-model-strategy"><i class="fa fa-check"></i><b>4.4.1</b> The linear model strategy</a></li>
<li class="chapter" data-level="4.4.2" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#finding-the-posterior-distribution"><i class="fa fa-check"></i><b>4.4.2</b> Finding the posterior distribution</a></li>
<li class="chapter" data-level="4.4.3" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#interpreting-the-posterior-distribution"><i class="fa fa-check"></i><b>4.4.3</b> Interpreting the posterior distribution</a>
<ul>
<li class="chapter" data-level="4.4.3.1" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#tables-of-marginal-distributions"><i class="fa fa-check"></i><b>4.4.3.1</b> Tables of marginal distributions</a></li>
<li class="chapter" data-level="4.4.3.2" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#plotting-posterior-inference-against-the-data"><i class="fa fa-check"></i><b>4.4.3.2</b> Plotting posterior inference against the data</a></li>
<li class="chapter" data-level="4.4.3.3" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#adding-uncertainty-around-the-mean"><i class="fa fa-check"></i><b>4.4.3.3</b> Adding uncertainty around the mean</a></li>
<li class="chapter" data-level="4.4.3.4" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#plotting-regression-intervlas-and-contours"><i class="fa fa-check"></i><b>4.4.3.4</b> Plotting regression intervlas and contours</a></li>
<li class="chapter" data-level="4.4.3.5" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#prediction-intevals"><i class="fa fa-check"></i><b>4.4.3.5</b> Prediction intevals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#curves-form-lines"><i class="fa fa-check"></i><b>4.5</b> Curves form lines</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#polynomial-regression"><i class="fa fa-check"></i><b>4.5.1</b> Polynomial regression</a></li>
<li class="chapter" data-level="4.5.2" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#splines"><i class="fa fa-check"></i><b>4.5.2</b> Splines</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#exercises-2"><i class="fa fa-check"></i><b>4.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#m1-2"><i class="fa fa-check"></i><b>4.6.1</b> 4M1</a></li>
<li class="chapter" data-level="4.6.2" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#m8"><i class="fa fa-check"></i><b>4.6.2</b> 4M8</a></li>
<li class="chapter" data-level="4.6.3" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#h1-1"><i class="fa fa-check"></i><b>4.6.3</b> 4H1</a></li>
<li class="chapter" data-level="4.6.4" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#h2-1"><i class="fa fa-check"></i><b>4.6.4</b> 4H2</a></li>
<li class="chapter" data-level="4.6.5" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#h3-1"><i class="fa fa-check"></i><b>4.6.5</b> 4H3</a>
<ul>
<li class="chapter" data-level="4.6.5.1" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#the-same-but-using-log-of-weight"><i class="fa fa-check"></i><b>4.6.5.1</b> The same but using log of weight</a></li>
</ul></li>
<li class="chapter" data-level="4.6.6" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#h6"><i class="fa fa-check"></i><b>4.6.6</b> 4H6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html"><i class="fa fa-check"></i><b>5</b> Chapter 5 - The Many Variables &amp; The Spurious Waffles</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#spurious-associations"><i class="fa fa-check"></i><b>5.1</b> Spurious Associations</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#testable-implications"><i class="fa fa-check"></i><b>5.1.1</b> Testable implications</a></li>
<li class="chapter" data-level="5.1.2" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#defining-a-multiple-regression"><i class="fa fa-check"></i><b>5.1.2</b> Defining a multiple regression</a></li>
<li class="chapter" data-level="5.1.3" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#approximating-the-posterior"><i class="fa fa-check"></i><b>5.1.3</b> Approximating the posterior</a></li>
<li class="chapter" data-level="5.1.4" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#the-flow"><i class="fa fa-check"></i><b>5.1.4</b> The flow</a>
<ul>
<li class="chapter" data-level="5.1.4.1" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#posterior-prediction-plots"><i class="fa fa-check"></i><b>5.1.4.1</b> Posterior Prediction Plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#masked-relationship"><i class="fa fa-check"></i><b>5.2</b> Masked Relationship</a></li>
<li class="chapter" data-level="5.3" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#categorical-variables"><i class="fa fa-check"></i><b>5.3</b> Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html"><i class="fa fa-check"></i><b>6</b> Chapter 6 - The Haunted DAG &amp; The Causal Terror</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#multicollinearity"><i class="fa fa-check"></i><b>6.1</b> Multicollinearity</a></li>
<li class="chapter" data-level="6.2" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#post-treatment-bias"><i class="fa fa-check"></i><b>6.2</b> Post Treatment Bias</a></li>
<li class="chapter" data-level="6.3" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#collider-bias"><i class="fa fa-check"></i><b>6.3</b> Collider Bias</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#collider-of-false-sorrow"><i class="fa fa-check"></i><b>6.3.1</b> Collider of false sorrow</a></li>
<li class="chapter" data-level="6.3.2" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#the-haunted-dag"><i class="fa fa-check"></i><b>6.3.2</b> The haunted DAG</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#confronting-confounding"><i class="fa fa-check"></i><b>6.4</b> Confronting Confounding</a></li>
<li class="chapter" data-level="6.5" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#exercises-3"><i class="fa fa-check"></i><b>6.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#m1-3"><i class="fa fa-check"></i><b>6.5.1</b> 6M1</a></li>
<li class="chapter" data-level="6.5.2" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#m3-1"><i class="fa fa-check"></i><b>6.5.2</b> 6M3</a></li>
<li class="chapter" data-level="6.5.3" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h"><i class="fa fa-check"></i><b>6.5.3</b> 6H</a></li>
<li class="chapter" data-level="6.5.4" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h3-2"><i class="fa fa-check"></i><b>6.5.4</b> 6H3</a></li>
<li class="chapter" data-level="6.5.5" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h4-1"><i class="fa fa-check"></i><b>6.5.5</b> 6H4</a></li>
<li class="chapter" data-level="6.5.6" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h5-1"><i class="fa fa-check"></i><b>6.5.6</b> 6H5</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#lecture-notes---not-integrated-in-the-text"><i class="fa fa-check"></i><b>6.6</b> Lecture notes - not integrated in the text</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html"><i class="fa fa-check"></i><b>7</b> Chapter 7 - Ulysses’ Compass</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#the-problem-with-parameters"><i class="fa fa-check"></i><b>7.1</b> The problem with parameters</a></li>
<li class="chapter" data-level="7.2" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#entropy-and-accuracy"><i class="fa fa-check"></i><b>7.2</b> Entropy and Accuracy</a></li>
<li class="chapter" data-level="7.3" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#golem-taming-regularization"><i class="fa fa-check"></i><b>7.3</b> Golem Taming: Regularization</a></li>
<li class="chapter" data-level="7.4" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#predicting-predictive-accuracy"><i class="fa fa-check"></i><b>7.4</b> Predicting predictive accuracy</a></li>
<li class="chapter" data-level="7.5" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#model-comparison"><i class="fa fa-check"></i><b>7.5</b> Model Comparison</a></li>
<li class="chapter" data-level="7.6" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#exercies"><i class="fa fa-check"></i><b>7.6</b> Exercies</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#m3-2"><i class="fa fa-check"></i><b>7.6.1</b> 7M3</a></li>
<li class="chapter" data-level="7.6.2" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#m4-1"><i class="fa fa-check"></i><b>7.6.2</b> 7M4</a></li>
<li class="chapter" data-level="7.6.3" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#m5-1"><i class="fa fa-check"></i><b>7.6.3</b> 7M5</a></li>
<li class="chapter" data-level="7.6.4" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#m6"><i class="fa fa-check"></i><b>7.6.4</b> 7M6</a></li>
<li class="chapter" data-level="7.6.5" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#h1-2"><i class="fa fa-check"></i><b>7.6.5</b> 7H1</a></li>
<li class="chapter" data-level="7.6.6" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#h2-2"><i class="fa fa-check"></i><b>7.6.6</b> 7H2</a>
<ul>
<li class="chapter" data-level="7.6.6.1" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#identify-the-outlier"><i class="fa fa-check"></i><b>7.6.6.1</b> (1) Identify the outlier</a></li>
<li class="chapter" data-level="7.6.6.2" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#inspect-model-predictions"><i class="fa fa-check"></i><b>7.6.6.2</b> (2) Inspect model predictions</a></li>
<li class="chapter" data-level="7.6.6.3" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#using-students-t-distribution"><i class="fa fa-check"></i><b>7.6.6.3</b> (3) Using students t distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.6.7" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#h5-2"><i class="fa fa-check"></i><b>7.6.7</b> 7H5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html"><i class="fa fa-check"></i><b>8</b> Chapter 8 - Conditional Manatees</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#building-an-interaction"><i class="fa fa-check"></i><b>8.1</b> Building an interaction</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#adding-an-indicator-variable-isnt-enough."><i class="fa fa-check"></i><b>8.1.1</b> Adding an indicator variable isn’t enough.</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#symmetry-of-interactions"><i class="fa fa-check"></i><b>8.2</b> Symmetry of interactions</a></li>
<li class="chapter" data-level="8.3" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#continuous-interactions"><i class="fa fa-check"></i><b>8.3</b> Continuous interactions</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#a-winter-flower"><i class="fa fa-check"></i><b>8.3.1</b> A Winter Flower</a></li>
<li class="chapter" data-level="8.3.2" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#the-models"><i class="fa fa-check"></i><b>8.3.2</b> The models</a></li>
<li class="chapter" data-level="8.3.3" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#plotting-posterior-predictions"><i class="fa fa-check"></i><b>8.3.3</b> Plotting posterior predictions</a></li>
<li class="chapter" data-level="8.3.4" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#plotting-prior-predictions"><i class="fa fa-check"></i><b>8.3.4</b> Plotting prior predictions</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#exercises-4"><i class="fa fa-check"></i><b>8.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#m4-2"><i class="fa fa-check"></i><b>8.4.1</b> 8M4</a>
<ul>
<li class="chapter" data-level="8.4.1.1" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#interaction-model"><i class="fa fa-check"></i><b>8.4.1.1</b> Interaction model</a></li>
<li class="chapter" data-level="8.4.1.2" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#conclusion"><i class="fa fa-check"></i><b>8.4.1.2</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="8.4.2" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#h3-3"><i class="fa fa-check"></i><b>8.4.2</b> 8H3</a>
<ul>
<li class="chapter" data-level="8.4.2.1" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#h3a"><i class="fa fa-check"></i><b>8.4.2.1</b> 8H3A</a></li>
<li class="chapter" data-level="8.4.2.2" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#h3b"><i class="fa fa-check"></i><b>8.4.2.2</b> 8H3B</a></li>
</ul></li>
<li class="chapter" data-level="8.4.3" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#h5-3"><i class="fa fa-check"></i><b>8.4.3</b> 8H5</a></li>
<li class="chapter" data-level="8.4.4" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#h6-1"><i class="fa fa-check"></i><b>8.4.4</b> 8H6</a></li>
<li class="chapter" data-level="8.4.5" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#h7"><i class="fa fa-check"></i><b>8.4.5</b> 8H7</a>
<ul>
<li class="chapter" data-level="8.4.5.1" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#predictions"><i class="fa fa-check"></i><b>8.4.5.1</b> Predictions</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>9</b> Chapter 9 - Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#good-king-markov-and-his-island-kingdom"><i class="fa fa-check"></i><b>9.1</b> Good King Markov and his island kingdom</a></li>
<li class="chapter" data-level="9.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#metropolis-algorithms"><i class="fa fa-check"></i><b>9.2</b> Metropolis algorithms</a></li>
<li class="chapter" data-level="9.3" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#hamiltonian-monte-carlo"><i class="fa fa-check"></i><b>9.3</b> Hamiltonian Monte Carlo</a></li>
<li class="chapter" data-level="9.4" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#easy-hmc-ulam"><i class="fa fa-check"></i><b>9.4</b> Easy HMC: ulam</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#fitting-using-quap"><i class="fa fa-check"></i><b>9.4.1</b> Fitting using quap</a></li>
<li class="chapter" data-level="9.4.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#fitting-using-hmc"><i class="fa fa-check"></i><b>9.4.2</b> Fitting using HMC</a>
<ul>
<li class="chapter" data-level="9.4.2.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#preparing-data"><i class="fa fa-check"></i><b>9.4.2.1</b> Preparing data</a></li>
<li class="chapter" data-level="9.4.2.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#sampling-from-the-posterior-1"><i class="fa fa-check"></i><b>9.4.2.2</b> Sampling from the posterior</a></li>
<li class="chapter" data-level="9.4.2.3" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#sampling-again-in-parallel"><i class="fa fa-check"></i><b>9.4.2.3</b> Sampling again, in parallel</a></li>
<li class="chapter" data-level="9.4.2.4" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#visualization"><i class="fa fa-check"></i><b>9.4.2.4</b> Visualization</a></li>
<li class="chapter" data-level="9.4.2.5" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#checking-the-chain"><i class="fa fa-check"></i><b>9.4.2.5</b> Checking the chain</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#care-and-feeding-of-your-markov-chain"><i class="fa fa-check"></i><b>9.5</b> Care and feeding of your Markov chain</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#how-many-samples-do-you-need"><i class="fa fa-check"></i><b>9.5.1</b> How many samples do you need?</a></li>
<li class="chapter" data-level="9.5.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#how-many-chains-do-you-need"><i class="fa fa-check"></i><b>9.5.2</b> How many chains do you need?</a></li>
<li class="chapter" data-level="9.5.3" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#taming-a-wild-chain"><i class="fa fa-check"></i><b>9.5.3</b> Taming a wild chain</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#exercises-5"><i class="fa fa-check"></i><b>9.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#e4"><i class="fa fa-check"></i><b>9.6.1</b> E4</a></li>
<li class="chapter" data-level="9.6.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#e5"><i class="fa fa-check"></i><b>9.6.2</b> E5</a></li>
<li class="chapter" data-level="9.6.3" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#e6"><i class="fa fa-check"></i><b>9.6.3</b> E6</a></li>
<li class="chapter" data-level="9.6.4" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#e7"><i class="fa fa-check"></i><b>9.6.4</b> E7</a></li>
<li class="chapter" data-level="9.6.5" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#m1-4"><i class="fa fa-check"></i><b>9.6.5</b> M1</a>
<ul>
<li class="chapter" data-level="9.6.5.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#comparing-to-posterior-distributions"><i class="fa fa-check"></i><b>9.6.5.1</b> Comparing to posterior distributions</a></li>
</ul></li>
<li class="chapter" data-level="9.6.6" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#h2-3"><i class="fa fa-check"></i><b>9.6.6</b> H2</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#lecture-notes"><i class="fa fa-check"></i><b>9.7</b> Lecture notes</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapter-10-big-entropy-and-the-generalized-linear-model.html"><a href="chapter-10-big-entropy-and-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>10</b> Chapter 10 - Big Entropy and the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chapter-10-big-entropy-and-the-generalized-linear-model.html"><a href="chapter-10-big-entropy-and-the-generalized-linear-model.html#maximum-entropy"><i class="fa fa-check"></i><b>10.1</b> Maximum Entropy</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="chapter-10-big-entropy-and-the-generalized-linear-model.html"><a href="chapter-10-big-entropy-and-the-generalized-linear-model.html#binomial"><i class="fa fa-check"></i><b>10.1.1</b> Binomial</a>
<ul>
<li class="chapter" data-level="10.1.1.1" data-path="chapter-10-big-entropy-and-the-generalized-linear-model.html"><a href="chapter-10-big-entropy-and-the-generalized-linear-model.html#example-from-the-lecture"><i class="fa fa-check"></i><b>10.1.1.1</b> Example from the lecture</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="chapter-10-big-entropy-and-the-generalized-linear-model.html"><a href="chapter-10-big-entropy-and-the-generalized-linear-model.html#generalized-linear-models"><i class="fa fa-check"></i><b>10.2</b> Generalized linear models</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="chapter-10-big-entropy-and-the-generalized-linear-model.html"><a href="chapter-10-big-entropy-and-the-generalized-linear-model.html#meet-the-family"><i class="fa fa-check"></i><b>10.2.1</b> Meet the family</a></li>
<li class="chapter" data-level="10.2.2" data-path="chapter-10-big-entropy-and-the-generalized-linear-model.html"><a href="chapter-10-big-entropy-and-the-generalized-linear-model.html#linking-linear-models-to-distributions"><i class="fa fa-check"></i><b>10.2.2</b> Linking linear models to distributions</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="chapter-10-big-entropy-and-the-generalized-linear-model.html"><a href="chapter-10-big-entropy-and-the-generalized-linear-model.html#maximum-entropy-priors"><i class="fa fa-check"></i><b>10.3</b> Maximum entropy priors</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html"><i class="fa fa-check"></i><b>11</b> Chapter 11 - God Spiked the Integers</a>
<ul>
<li class="chapter" data-level="11.1" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#binomial-regression"><i class="fa fa-check"></i><b>11.1</b> Binomial Regression</a>
<ul>
<li class="chapter" data-level="11.1.0.1" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#logistic-regression-prosocial-chimpanzees"><i class="fa fa-check"></i><b>11.1.0.1</b> Logistic regression: Prosocial chimpanzees:</a></li>
<li class="chapter" data-level="11.1.0.2" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#relative-shark-and-absolute-deer"><i class="fa fa-check"></i><b>11.1.0.2</b> Relative shark and absolute deer</a></li>
<li class="chapter" data-level="11.1.0.3" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#aggregated-binomial-chimpanzees-again-condensed."><i class="fa fa-check"></i><b>11.1.0.3</b> Aggregated binomial: Chimpanzees again, condensed.</a></li>
<li class="chapter" data-level="11.1.0.4" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#aggregated-binomial-graduate-school-admissions"><i class="fa fa-check"></i><b>11.1.0.4</b> Aggregated binomial: Graduate school admissions</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#poisson-regression"><i class="fa fa-check"></i><b>11.2</b> Poisson Regression</a>
<ul>
<li class="chapter" data-level="11.2.0.1" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#negative-binomial-gamma-poisson-models."><i class="fa fa-check"></i><b>11.2.0.1</b> Negative binomial (gamma-poisson) models.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#multinomial-regression"><i class="fa fa-check"></i><b>11.3</b> Multinomial Regression</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#example-from-the-lecture-1"><i class="fa fa-check"></i><b>11.3.1</b> Example from the lecture</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#exercies-1"><i class="fa fa-check"></i><b>11.4</b> Exercies</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#e1"><i class="fa fa-check"></i><b>11.4.1</b> E1</a></li>
<li class="chapter" data-level="11.4.2" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#e2"><i class="fa fa-check"></i><b>11.4.2</b> E2</a></li>
<li class="chapter" data-level="11.4.3" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#e3"><i class="fa fa-check"></i><b>11.4.3</b> E3</a></li>
<li class="chapter" data-level="11.4.4" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#m7"><i class="fa fa-check"></i><b>11.4.4</b> M7</a></li>
<li class="chapter" data-level="11.4.5" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#h1-3"><i class="fa fa-check"></i><b>11.4.5</b> H1</a></li>
<li class="chapter" data-level="11.4.6" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#h2-4"><i class="fa fa-check"></i><b>11.4.6</b> H2</a>
<ul>
<li class="chapter" data-level="11.4.6.1" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#a"><i class="fa fa-check"></i><b>11.4.6.1</b> A:</a></li>
<li class="chapter" data-level="11.4.6.2" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#b"><i class="fa fa-check"></i><b>11.4.6.2</b> B:</a></li>
<li class="chapter" data-level="11.4.6.3" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#c"><i class="fa fa-check"></i><b>11.4.6.3</b> C:</a></li>
</ul></li>
<li class="chapter" data-level="11.4.7" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#h3-4"><i class="fa fa-check"></i><b>11.4.7</b> H3</a>
<ul>
<li class="chapter" data-level="11.4.7.1" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#prior-predictive-simulation"><i class="fa fa-check"></i><b>11.4.7.1</b> Prior predictive simulation</a></li>
<li class="chapter" data-level="11.4.7.2" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#fitting-the-model"><i class="fa fa-check"></i><b>11.4.7.2</b> Fitting the model</a>
<ul>
<li class="chapter" data-level="11.4.7.2.1" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#using-poisson"><i class="fa fa-check"></i><b>11.4.7.2.1</b> Using poisson</a></li>
<li class="chapter" data-level="11.4.7.2.2" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#using-gamma-poisson"><i class="fa fa-check"></i><b>11.4.7.2.2</b> Using gamma poisson</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html"><i class="fa fa-check"></i><b>12</b> Ch 13 - Models with Memory</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#example-multilevel-tadpoles"><i class="fa fa-check"></i><b>12.1</b> Example: Multilevel tadpoles</a></li>
<li class="chapter" data-level="12.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#varying-effects-and-the-underfitting-overfitting-trade-off"><i class="fa fa-check"></i><b>12.2</b> Varying effects and the underfitting / overfitting trade-off</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#the-model-1"><i class="fa fa-check"></i><b>12.2.1</b> The model</a></li>
<li class="chapter" data-level="12.2.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#assign-values-to-the-parameters"><i class="fa fa-check"></i><b>12.2.2</b> Assign values to the parameters</a></li>
<li class="chapter" data-level="12.2.3" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#simulate-survivors"><i class="fa fa-check"></i><b>12.2.3</b> Simulate survivors</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#more-than-one-type-of-cluster"><i class="fa fa-check"></i><b>12.3</b> More than one type of cluster</a></li>
<li class="chapter" data-level="12.4" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#divergent-transitions-and-non-centered-priors"><i class="fa fa-check"></i><b>12.4</b> Divergent transitions and non-centered priors</a>
<ul>
<li class="chapter" data-level="12.4.0.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#the-devils-funnel-example"><i class="fa fa-check"></i><b>12.4.0.1</b> The Devil’s Funnel: (example)</a></li>
<li class="chapter" data-level="12.4.0.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#non-centered-chimpanzees-example"><i class="fa fa-check"></i><b>12.4.0.2</b> Non-centered chimpanzees (example)</a>
<ul>
<li class="chapter" data-level="12.4.0.2.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#solution-1-centered-parameterization-increasing-acceptance-rate"><i class="fa fa-check"></i><b>12.4.0.2.1</b> Solution 1: Centered parameterization (Increasing acceptance rate)</a></li>
<li class="chapter" data-level="12.4.0.2.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#solution-2-non-centered-version-reparameterize"><i class="fa fa-check"></i><b>12.4.0.2.2</b> Solution 2: Non-centered version (reparameterize)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#multilevel-posterior-predictions"><i class="fa fa-check"></i><b>12.5</b> Multilevel posterior predictions</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#posterior-prediction-for-same-clusters"><i class="fa fa-check"></i><b>12.5.1</b> Posterior prediction for same clusters</a></li>
<li class="chapter" data-level="12.5.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#posterior-prediction-for-new-clusters"><i class="fa fa-check"></i><b>12.5.2</b> Posterior prediction for new clusters</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#exercises-6"><i class="fa fa-check"></i><b>12.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#e1-1"><i class="fa fa-check"></i><b>12.6.1</b> E1</a></li>
<li class="chapter" data-level="12.6.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#e2-1"><i class="fa fa-check"></i><b>12.6.2</b> E2</a></li>
<li class="chapter" data-level="12.6.3" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#e3-1"><i class="fa fa-check"></i><b>12.6.3</b> E3</a></li>
<li class="chapter" data-level="12.6.4" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#e4-1"><i class="fa fa-check"></i><b>12.6.4</b> E4</a></li>
<li class="chapter" data-level="12.6.5" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#m1-5"><i class="fa fa-check"></i><b>12.6.5</b> M1</a></li>
<li class="chapter" data-level="12.6.6" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#h1-4"><i class="fa fa-check"></i><b>12.6.6</b> H1</a>
<ul>
<li class="chapter" data-level="12.6.6.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#fixed-effects-model"><i class="fa fa-check"></i><b>12.6.6.1</b> Fixed effects model:</a></li>
<li class="chapter" data-level="12.6.6.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#varying-intercepts-model"><i class="fa fa-check"></i><b>12.6.6.2</b> Varying intercepts model:</a></li>
<li class="chapter" data-level="12.6.6.3" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#extract-samples"><i class="fa fa-check"></i><b>12.6.6.3</b> Extract samples</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html"><i class="fa fa-check"></i><b>13</b> Ch 14 - Advuntetures in Coviaraince</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#varying-slopes-by-construction"><i class="fa fa-check"></i><b>13.1</b> Varying slopes by construction</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#simulate-the-population"><i class="fa fa-check"></i><b>13.1.1</b> Simulate the population</a></li>
<li class="chapter" data-level="13.1.2" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#simulate-observations"><i class="fa fa-check"></i><b>13.1.2</b> Simulate observations</a></li>
<li class="chapter" data-level="13.1.3" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#the-varying-slopes-model"><i class="fa fa-check"></i><b>13.1.3</b> The varying slopes model</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#advanced-varying-slopes"><i class="fa fa-check"></i><b>13.2</b> Advanced varying slopes</a>
<ul>
<li class="chapter" data-level="13.2.0.1" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#inference"><i class="fa fa-check"></i><b>13.2.0.1</b> Inference!</a></li>
<li class="chapter" data-level="13.2.0.2" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#conclusions---multilevel-horoscopes"><i class="fa fa-check"></i><b>13.2.0.2</b> Conclusions - multilevel horoscopes</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#exercises-7"><i class="fa fa-check"></i><b>13.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#e1-2"><i class="fa fa-check"></i><b>13.3.1</b> E1</a></li>
<li class="chapter" data-level="13.3.2" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#e3-2"><i class="fa fa-check"></i><b>13.3.2</b> E3</a></li>
<li class="chapter" data-level="13.3.3" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#h1-5"><i class="fa fa-check"></i><b>13.3.3</b> H1</a></li>
<li class="chapter" data-level="13.3.4" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#h2-5"><i class="fa fa-check"></i><b>13.3.4</b> H2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html"><i class="fa fa-check"></i><b>14</b> Ch 14 - Adventures in Covariance</a>
<ul>
<li class="chapter" data-level="14.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#ch-14.3---instruments-and-causal-designs"><i class="fa fa-check"></i><b>14.1</b> Ch 14.3 - Instruments and causal designs</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#instrumental-variables"><i class="fa fa-check"></i><b>14.1.1</b> Instrumental variables</a>
<ul>
<li class="chapter" data-level="14.1.1.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#only-including-e-we-add-confounding-effect-sideeffect-of-e"><i class="fa fa-check"></i><b>14.1.1.1</b> 1. Only including E (we add confounding effect sideeffect of E)</a></li>
<li class="chapter" data-level="14.1.1.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#adding-instrument-q-the-wrong-way"><i class="fa fa-check"></i><b>14.1.1.2</b> 2. Adding instrument Q (the wrong way)</a></li>
<li class="chapter" data-level="14.1.1.3" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#correct-use-of-the-instrument-variable"><i class="fa fa-check"></i><b>14.1.1.3</b> 3. Correct use of the instrument variable</a></li>
</ul></li>
<li class="chapter" data-level="14.1.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#other-designs"><i class="fa fa-check"></i><b>14.1.2</b> Other designs</a>
<ul>
<li class="chapter" data-level="14.1.2.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#front-door-criterion"><i class="fa fa-check"></i><b>14.1.2.1</b> Front-Door Criterion</a></li>
<li class="chapter" data-level="14.1.2.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#regression-discontinuity-rdd"><i class="fa fa-check"></i><b>14.1.2.2</b> Regression discontinuity (RDD)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#gaussian-processes-continuous-categories-and-the-gaussian-process"><i class="fa fa-check"></i><b>14.2</b> (Gaussian Processes) Continuous categories and the Gaussian process</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#example-spatial-autocorrelation-in-oceanic-tools"><i class="fa fa-check"></i><b>14.2.1</b> Example: Spatial autocorrelation in Oceanic tools</a>
<ul>
<li class="chapter" data-level="14.2.1.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#loading-data-defining-model"><i class="fa fa-check"></i><b>14.2.1.1</b> Loading data + defining model</a></li>
<li class="chapter" data-level="14.2.1.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#the-full-model"><i class="fa fa-check"></i><b>14.2.1.2</b> The full model</a></li>
<li class="chapter" data-level="14.2.1.3" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#gaussian-process-posterior"><i class="fa fa-check"></i><b>14.2.1.3</b> Gaussian Process Posterior</a></li>
</ul></li>
<li class="chapter" data-level="14.2.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#example-phylogenetic-distance-not-in-the-curriculum"><i class="fa fa-check"></i><b>14.2.2</b> Example: Phylogenetic distance (not in the curriculum)</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#exercises-8"><i class="fa fa-check"></i><b>14.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#m3-3"><i class="fa fa-check"></i><b>14.3.1</b> M3</a></li>
<li class="chapter" data-level="14.3.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#m4-3"><i class="fa fa-check"></i><b>14.3.2</b> M4</a></li>
<li class="chapter" data-level="14.3.3" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#h2-6"><i class="fa fa-check"></i><b>14.3.3</b> H2</a></li>
<li class="chapter" data-level="14.3.4" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#h4-varying-intercepts-varying-slopes"><i class="fa fa-check"></i><b>14.3.4</b> H4 Varying intercepts Varying slopes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Data Analysis Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter-7---ulysses-compass" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Chapter 7 - Ulysses’ Compass</h1>
<div id="the-problem-with-parameters" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> The problem with parameters</h2>
<p>The section elaborates on overfitting and underfitting.</p>
<p>It introduce <span class="math inline">\(R^2\)</span> and some reasoning for AIC and WAIC. It starts elaborating on why <span class="math inline">\(R^2\)</span> is useless.</p>
<p><strong>p-values will never be an indicator for predictive accuracy!!</strong>, what p-value does is only care about type 1 error. In general, do not pay too much attention to these.</p>
</div>
<div id="entropy-and-accuracy" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Entropy and Accuracy</h2>
<p>We see that entropy is able to reflect how wrong we are, instead of just measuring hit rate as accuracy does.</p>
<p>When we calculate the entropy of a model, we will try to minize the entropy, that is because the large the entropy, the more surprised we are of the actual outcomes. The larger the entropy the larger is q (our model) to p (the actual outcome), the distance from our model to the true model is also called the <em>Divergence</em>. The equation:</p>
<p><span class="math display">\[Divergence= \sum_i p_i(log(p_i) - log(q_i))\]</span></p>
<blockquote>
<p>Divergence example: Go to the eath / mars example in the book. In its essence, we see that earth is a HIGH entropy place, as there are a lot of land and a lot of water (hence there is lots of both). When you then go to mars, you will be surprised. But the surprise going from mars to earth will be greater, as there is low entropy on mars (as almost 100% of the planet is covered in land), hence you will be very surprised going to a place with higher entropy.</p>
</blockquote>
<p><strong><em>The simpler model is better than complicated models, that is because simpler model has higher entropy, as they generelize more than complicated models. Where we see complicated models can be compared with mars, where it is very certain about different outcomes (typical characteristics of overfitting)</em></strong></p>
<p>To estimate divergence for a model, we will use the <strong>log-score</strong>, this will be a distribution, this can be foind with <code>lppd()</code> from the <code>rethinking</code> package <em>(log-pointwise-predictive-density)</em>.</p>
<p><span class="math display">\[Deviance = logscore * -2.\]</span></p>
<p>We will look at following information criteria:</p>
<ul>
<li>AIC</li>
<li>WAIC</li>
<li>PSIS</li>
</ul>
<p>We see that deviance has the same properties as R2, thus it will not penalize for introducing more variables and also overfitting.</p>
<p>Then we also see that CV can make out of sample performance estimations based on testing the model on unseen data.</p>
<p><em>Notice that nonsens models can have good predictions, but their inference and causal relationships may be totally off, hence prediction and inference is two totally different ways of approaching a problem.</em></p>
<p><strong>Definition of PSIS:</strong> Recall that with leave one out CV, we estimate the model always leaving out one observation. With this technique we get a very good out of sample estimate. Although it it cumbersome. PSIS does something similar, with this we are also able to see the score for each observation <code>PSISk()</code>, thus if the score is high, we see that the model predictions are very different from what the observation may look like. This also implies that high PSIS values for observations indicates that the observation may have a large influence on the bayesian updating. <em>We see an example in section H2, where students t distribution is used instead.</em></p>
</div>
<div id="golem-taming-regularization" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Golem Taming: Regularization</h2>
<p>As we have seen in ML classes, we can regularize the model to make it harder to capture variance in the training / calibration process.</p>
<p>We regularize the priors, we see that we have a prior (striped) that can take on many values, while two versions of regularizations is more conservative, hence it needs more extreme data to overwhelm the priors.</p>
<p><img src="Images/paste-AA3B70A5.png" /></p>
</div>
<div id="predicting-predictive-accuracy" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Predicting predictive accuracy</h2>
<p>We see that:</p>
<ul>
<li><p>the <code>loo</code> function is a very accurate out of sample performance estimate</p></li>
<li><p>AIC: Information criteria to approximate out of sample performance, we see that WAIC always (almost) outperforms the AIC is</p></li>
<li><p>WAIC: we see that lppd is the loglik that we have in the AIC.</p>
<p><img src="Images/paste-225B764E.png" /></p></li>
</ul>
<p>One can use the <code>compare()</code> function to compare different modes, that will be done on the WAIC, and it will show the weight, hence if you have several models, it will say what weights different models should have in a prediction scenario.</p>
<p>pWAIC is the effective number of parameters in the model.</p>
<p>One must remember that the information criteria is an indication of the overfit, i.e., the model overconfidence. It should in fact never be used for model selection, as these criteria does not care about causality.</p>
</div>
<div id="model-comparison" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Model Comparison</h2>
</div>
<div id="exercies" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Exercies</h2>
<div id="m3-2" class="section level3" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> 7M3</h3>
<p>When comparing models with an information criterion, why must all models be fit to exactly the same observations? What would happen to the information criterion values, if the models were fit to different numbers of observations? Perform some experiments, if you are not sure.</p>
<p>Because the information is reflecting how surprised a model is when it sees some data.</p>
</div>
<div id="m4-1" class="section level3" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> 7M4</h3>
<p>What happens to the effective number of parameters, as measured by PSIS or WAIC, as a prior becomes more concentrated? Why? Perform some experiments, if you are not sure.</p>
<p>We see that the effective number of parameters are decreasing, that is because you constrain the possibilities of the model, hence less flexible, i.e., less complex and therefore less effective number of parameters.</p>
<p>If we use <code>WAIC()</code> we will see a penalty term, this is representitive of the effective numbers parameters.</p>
</div>
<div id="m5-1" class="section level3" number="7.6.3">
<h3><span class="header-section-number">7.6.3</span> 7M5</h3>
<p>Provide an informal explanation of why informative priors reduce overfitting.</p>
<p>If we have flat priors (some without information) we will see that the model can fit to any scenario. If we impose information in the priors we can manipulate the model to not model for scenarios that are impossible or extremely unlikely.</p>
</div>
<div id="m6" class="section level3" number="7.6.4">
<h3><span class="header-section-number">7.6.4</span> 7M6</h3>
<p>Provide an informal explanation of why overly informative priors result in underfitting.</p>
<p>This is basically because we constrain the model too much. Hence when the model is fitted it needs very extreme cases to adjust the priors.</p>
</div>
<div id="h1-2" class="section level3" number="7.6.5">
<h3><span class="header-section-number">7.6.5</span> 7H1</h3>
<p>In 2007, The Wall Street Journal published an editorial (“We’re Number One, Alas”) with a graph of corporate tax rates in 29 countries plotted against tax revenue. A badly fit curve was drawn in (reconstructed at right), seemingly by hand, to make the argument that the relationship between tax rate and tax revenue increases and then declines, such that higher tax rates can actually produce less tax revenue. I want you to actually fit a curve to these data, found in <code>data(Laffer)</code>.Do:</p>
<ol style="list-style-type: decimal">
<li>Consider models that use <em>tax rate</em> to predict tax revenue.</li>
<li>Compare, using WAIC or PSIS, a straight-line model to any curved models you like.</li>
<li>What do you conclude about the relationship between tax rate and tax revenue?</li>
</ol>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="chapter-7-ulysses-compass.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb186-2"><a href="chapter-7-ulysses-compass.html#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Laffer)</span>
<span id="cb186-3"><a href="chapter-7-ulysses-compass.html#cb186-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> Laffer</span>
<span id="cb186-4"><a href="chapter-7-ulysses-compass.html#cb186-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-5"><a href="chapter-7-ulysses-compass.html#cb186-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Add vector of squared values, for the polynomial variable</span></span>
<span id="cb186-6"><a href="chapter-7-ulysses-compass.html#cb186-6" aria-hidden="true" tabindex="-1"></a><span class="co">#d$tax_rate2 &lt;- d$tax_rate^2 #NOTICE: I moved the quadratic transformation to the model</span></span>
<span id="cb186-7"><a href="chapter-7-ulysses-compass.html#cb186-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-8"><a href="chapter-7-ulysses-compass.html#cb186-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Starndardizing ##</span></span>
<span id="cb186-9"><a href="chapter-7-ulysses-compass.html#cb186-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-10"><a href="chapter-7-ulysses-compass.html#cb186-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; I could have standardized the tax rate</span></span>
<span id="cb186-11"><a href="chapter-7-ulysses-compass.html#cb186-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-12"><a href="chapter-7-ulysses-compass.html#cb186-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-13"><a href="chapter-7-ulysses-compass.html#cb186-13" aria-hidden="true" tabindex="-1"></a><span class="co">#linear model</span></span>
<span id="cb186-14"><a href="chapter-7-ulysses-compass.html#cb186-14" aria-hidden="true" tabindex="-1"></a>ml <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb186-15"><a href="chapter-7-ulysses-compass.html#cb186-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb186-16"><a href="chapter-7-ulysses-compass.html#cb186-16" aria-hidden="true" tabindex="-1"></a>      tax_revenue <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) ,</span>
<span id="cb186-17"><a href="chapter-7-ulysses-compass.html#cb186-17" aria-hidden="true" tabindex="-1"></a>      mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b1<span class="sc">*</span>tax_rate <span class="sc">+</span> sigma,</span>
<span id="cb186-18"><a href="chapter-7-ulysses-compass.html#cb186-18" aria-hidden="true" tabindex="-1"></a>      a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">10</span> , <span class="dv">2</span> ) , <span class="co">#mean</span></span>
<span id="cb186-19"><a href="chapter-7-ulysses-compass.html#cb186-19" aria-hidden="true" tabindex="-1"></a>      b1 <span class="sc">~</span> <span class="fu">dlnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) , <span class="co">#We say that the beta can be higher and lower than 0, negative or positive effect</span></span>
<span id="cb186-20"><a href="chapter-7-ulysses-compass.html#cb186-20" aria-hidden="true" tabindex="-1"></a>      sigma <span class="sc">~</span> <span class="fu">dunif</span>( <span class="dv">0</span> , <span class="dv">50</span> )</span>
<span id="cb186-21"><a href="chapter-7-ulysses-compass.html#cb186-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb186-22"><a href="chapter-7-ulysses-compass.html#cb186-22" aria-hidden="true" tabindex="-1"></a>    ,<span class="at">data =</span> d</span>
<span id="cb186-23"><a href="chapter-7-ulysses-compass.html#cb186-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb186-24"><a href="chapter-7-ulysses-compass.html#cb186-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-25"><a href="chapter-7-ulysses-compass.html#cb186-25" aria-hidden="true" tabindex="-1"></a><span class="co">#quadratic model</span></span>
<span id="cb186-26"><a href="chapter-7-ulysses-compass.html#cb186-26" aria-hidden="true" tabindex="-1"></a>mq <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb186-27"><a href="chapter-7-ulysses-compass.html#cb186-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb186-28"><a href="chapter-7-ulysses-compass.html#cb186-28" aria-hidden="true" tabindex="-1"></a>      tax_revenue <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) ,</span>
<span id="cb186-29"><a href="chapter-7-ulysses-compass.html#cb186-29" aria-hidden="true" tabindex="-1"></a>      mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b1<span class="sc">*</span>tax_rate <span class="sc">+</span> b2<span class="sc">*</span>tax_rate<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sigma,</span>
<span id="cb186-30"><a href="chapter-7-ulysses-compass.html#cb186-30" aria-hidden="true" tabindex="-1"></a>      a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">10</span> , <span class="dv">2</span> ) , <span class="co">#mean</span></span>
<span id="cb186-31"><a href="chapter-7-ulysses-compass.html#cb186-31" aria-hidden="true" tabindex="-1"></a>      b1 <span class="sc">~</span> <span class="fu">dlnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) , <span class="co">#We say that the beta can be higher and lower than 0, negative or positive effect</span></span>
<span id="cb186-32"><a href="chapter-7-ulysses-compass.html#cb186-32" aria-hidden="true" tabindex="-1"></a>      b2 <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) , <span class="co">#We say that the beta can be higher and lower than 0, negative or positive effect</span></span>
<span id="cb186-33"><a href="chapter-7-ulysses-compass.html#cb186-33" aria-hidden="true" tabindex="-1"></a>      sigma <span class="sc">~</span> <span class="fu">dunif</span>( <span class="dv">0</span> , <span class="dv">50</span> )</span>
<span id="cb186-34"><a href="chapter-7-ulysses-compass.html#cb186-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb186-35"><a href="chapter-7-ulysses-compass.html#cb186-35" aria-hidden="true" tabindex="-1"></a>    ,<span class="at">data =</span> d</span>
<span id="cb186-36"><a href="chapter-7-ulysses-compass.html#cb186-36" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="chapter-7-ulysses-compass.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">WAIC</span>(ml)</span>
<span id="cb187-2"><a href="chapter-7-ulysses-compass.html#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">WAIC</span>(mq)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">WAIC</th>
<th align="right">lppd</th>
<th align="right">penalty</th>
<th align="right">std_err</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">126.4331</td>
<td align="right">-55.82019</td>
<td align="right">7.396335</td>
<td align="right">24.86687</td>
</tr>
</tbody>
</table>
</div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">WAIC</th>
<th align="right">lppd</th>
<th align="right">penalty</th>
<th align="right">std_err</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">128.139</td>
<td align="right">-56.26048</td>
<td align="right">7.809026</td>
<td align="right">23.21052</td>
</tr>
</tbody>
</table>
</div>
<p>We see that the WAIC is increasing in the more complex model, we also see the penalty is increasing, meaning that the effective number of parameters is increasing.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="chapter-7-ulysses-compass.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PSIS</span>(ml)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">PSIS</th>
<th align="right">lppd</th>
<th align="right">penalty</th>
<th align="right">std_err</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">130.7289</td>
<td align="right">-65.36447</td>
<td align="right">9.537887</td>
<td align="right">29.43002</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="chapter-7-ulysses-compass.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PSIS</span>(mq)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">PSIS</th>
<th align="right">lppd</th>
<th align="right">penalty</th>
<th align="right">std_err</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">133.1163</td>
<td align="right">-66.55817</td>
<td align="right">10.39137</td>
<td align="right">28.86921</td>
</tr>
</tbody>
</table>
</div>
<p>Another approach can be:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="chapter-7-ulysses-compass.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(ml,mq,<span class="at">func =</span> PSIS)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">134.3800</td>
</tr>
<tr class="even">
<td align="right">135.6509</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">32.87344</td>
</tr>
<tr class="even">
<td align="right">31.30131</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.000000</td>
</tr>
<tr class="even">
<td align="right">1.270912</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2.858863</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">11.25874</td>
</tr>
<tr class="even">
<td align="right">11.59884</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.6537255</td>
</tr>
<tr class="even">
<td align="right">0.3462745</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>We can look at the plot to see if they can be said to be different. We see that dPSIS is the difference to the best model, and the dSE is the standard error, if the dSE is smaller than dPSIS, then we can certainly say that the given model is worse than the linear model.</p>
<p>The weights are the AIC weights, so if we were to predict, this is the weight that each model should have in a prediction setting.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="chapter-7-ulysses-compass.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">compare</span>(ml,mq,<span class="at">func =</span> PSIS))</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-104-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see the there is no statistical evidence that the more complicated model is any better than the linear model. (<em>We look at the small gray range in the middle</em>)</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="chapter-7-ulysses-compass.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PSISk</span>(ml)</span></code></pre></div>
<pre><code>##  [1]  0.38 -0.04  0.28 -0.06 -0.07 -0.04  0.13  0.43  0.01 -0.13  0.36  2.06
## [13]  0.27  0.10 -0.03 -0.16 -0.05 -0.11  0.21 -0.08  0.00 -0.05  0.01  0.12
## [25]  0.26  0.38  0.45  0.49  0.30</code></pre>
<p>We see in that one value spikes (theres is one value for each observation).</p>
<p><strong><em>What can we conclude?</em></strong></p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="chapter-7-ulysses-compass.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(ml)</span>
<span id="cb194-2"><a href="chapter-7-ulysses-compass.html#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(mq)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.6829483</td>
</tr>
<tr class="even">
<td align="right">0.0462522</td>
</tr>
<tr class="odd">
<td align="right">1.6116390</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.6075766</td>
</tr>
<tr class="even">
<td align="right">0.0203702</td>
</tr>
<tr class="odd">
<td align="right">0.1969248</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.2880766</td>
</tr>
<tr class="even">
<td align="right">0.0136968</td>
</tr>
<tr class="odd">
<td align="right">1.2969151</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1.6539731</td>
</tr>
<tr class="even">
<td align="right">0.0788077</td>
</tr>
<tr class="odd">
<td align="right">1.9263629</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.9022411</td>
</tr>
<tr class="even">
<td align="right">0.1097593</td>
</tr>
<tr class="odd">
<td align="right">-0.0024818</td>
</tr>
<tr class="even">
<td align="right">1.6268564</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.8451227</td>
</tr>
<tr class="even">
<td align="right">0.0635355</td>
</tr>
<tr class="odd">
<td align="right">0.0016652</td>
</tr>
<tr class="even">
<td align="right">0.2138892</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.4484283</td>
</tr>
<tr class="even">
<td align="right">0.0082173</td>
</tr>
<tr class="odd">
<td align="right">-0.0051431</td>
</tr>
<tr class="even">
<td align="right">1.2850202</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2.2529104</td>
</tr>
<tr class="even">
<td align="right">0.2113014</td>
</tr>
<tr class="odd">
<td align="right">0.0001794</td>
</tr>
<tr class="even">
<td align="right">1.9686926</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>We see that in the linear model the intercept says that the tax return will be 2.18 if tax rate is 0. We see that the there is a positive effect from tax rate to tax return. And there is typically always a positive effect.</p>
<p>We see in the quadratic model that the squared values are really just 0, while a greater effect is put on the first order.</p>
</div>
<div id="h2-2" class="section level3" number="7.6.6">
<h3><span class="header-section-number">7.6.6</span> 7H2</h3>
<p>In the Laffer data, there is one country with high tax revenue that is an outlier. Use PSIS and WAIC to measure the importance of this outlier in the models you fit in the previous problem. Then use robust regression with a Students t distribution to revisit the curve fitting problem. How much does does a curved relationship depend upon the outlier point?</p>
<p>The exercise is separated into three parts:</p>
<ol style="list-style-type: decimal">
<li>Identify the outlier</li>
<li>Show the predictions for the two models</li>
<li>Construct a more robust model, with students t distribution, as it has fatter tails.</li>
</ol>
<div id="identify-the-outlier" class="section level4" number="7.6.6.1">
<h4><span class="header-section-number">7.6.6.1</span> (1) Identify the outlier</h4>
<p>We can inspect PSIS values.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="chapter-7-ulysses-compass.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb195-2"><a href="chapter-7-ulysses-compass.html#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">PSISk</span>(ml),<span class="at">pch =</span> <span class="dv">16</span>,<span class="at">cex =</span> <span class="fl">0.8</span>,<span class="at">main =</span> <span class="st">&quot;Linear vs. Quadratic model&quot;</span>,<span class="at">col =</span> <span class="st">&quot;#5ab4ac&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;PSISk&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;Observation&quot;</span>)</span>
<span id="cb195-3"><a href="chapter-7-ulysses-compass.html#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">PSISk</span>(mq),<span class="at">pch =</span> <span class="dv">16</span>,<span class="at">cex =</span> <span class="fl">0.8</span>,<span class="at">col =</span> <span class="st">&quot;#d8b365&quot;</span>)</span>
<span id="cb195-4"><a href="chapter-7-ulysses-compass.html#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">which.max</span>(<span class="fu">PSISk</span>(ml)),<span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>)</span>
<span id="cb195-5"><a href="chapter-7-ulysses-compass.html#cb195-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>,<span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>)</span>
<span id="cb195-6"><a href="chapter-7-ulysses-compass.html#cb195-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Linear&quot;</span>,<span class="st">&quot;Quadratic model&quot;</span>),<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;#5ab4ac&quot;</span>,<span class="st">&quot;#d8b365&quot;</span>),<span class="at">pch =</span> <span class="dv">16</span>,<span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb195-7"><a href="chapter-7-ulysses-compass.html#cb195-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d<span class="sc">$</span>tax_revenue,<span class="at">pch =</span> <span class="dv">20</span>,<span class="at">ylab =</span> <span class="st">&quot;Tax revenue&quot;</span>)</span>
<span id="cb195-8"><a href="chapter-7-ulysses-compass.html#cb195-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">which.max</span>(<span class="fu">PSISk</span>(ml)),<span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-107-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>From this we see that both models concludes that observation no. 12 is an outlier as it locates above 1. This is a nation with a very high tax revenue.</p>
</div>
<div id="inspect-model-predictions" class="section level4" number="7.6.6.2">
<h4><span class="header-section-number">7.6.6.2</span> (2) Inspect model predictions</h4>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="chapter-7-ulysses-compass.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Grid of values for predictions</span></span>
<span id="cb196-2"><a href="chapter-7-ulysses-compass.html#cb196-2" aria-hidden="true" tabindex="-1"></a>T_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">35</span>)</span>
<span id="cb196-3"><a href="chapter-7-ulysses-compass.html#cb196-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-4"><a href="chapter-7-ulysses-compass.html#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Making predictions</span></span>
<span id="cb196-5"><a href="chapter-7-ulysses-compass.html#cb196-5" aria-hidden="true" tabindex="-1"></a>ml_pred <span class="ot">&lt;-</span> <span class="fu">link</span>(ml,<span class="at">data =</span> <span class="fu">list</span>(<span class="at">tax_rate =</span> T_seq)) <span class="co">#use list() to enable the model to map the vector to the variable</span></span>
<span id="cb196-6"><a href="chapter-7-ulysses-compass.html#cb196-6" aria-hidden="true" tabindex="-1"></a>mq_pred <span class="ot">&lt;-</span> <span class="fu">link</span>(mq,<span class="at">data =</span> <span class="fu">list</span>(<span class="at">tax_rate =</span> T_seq))</span>
<span id="cb196-7"><a href="chapter-7-ulysses-compass.html#cb196-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-8"><a href="chapter-7-ulysses-compass.html#cb196-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-9"><a href="chapter-7-ulysses-compass.html#cb196-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting!</span></span>
<span id="cb196-10"><a href="chapter-7-ulysses-compass.html#cb196-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, .<span class="dv">8</span>))</span>
<span id="cb196-11"><a href="chapter-7-ulysses-compass.html#cb196-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-12"><a href="chapter-7-ulysses-compass.html#cb196-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Linear model</span></span>
<span id="cb196-13"><a href="chapter-7-ulysses-compass.html#cb196-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d<span class="sc">$</span>tax_rate,<span class="at">y =</span> d<span class="sc">$</span>tax_revenue,<span class="at">pch =</span> <span class="dv">20</span>,<span class="at">xlab =</span> <span class="st">&quot;Tax rate&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;Tax revenue&quot;</span>,<span class="at">main =</span> <span class="st">&quot;Linear model&quot;</span>)</span>
<span id="cb196-14"><a href="chapter-7-ulysses-compass.html#cb196-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(T_seq,<span class="fu">colMeans</span>(ml_pred))</span>
<span id="cb196-15"><a href="chapter-7-ulysses-compass.html#cb196-15" aria-hidden="true" tabindex="-1"></a><span class="fu">shade</span>(<span class="at">object =</span> <span class="fu">apply</span>(<span class="at">X =</span> ml_pred,<span class="at">MARGIN =</span> <span class="dv">2</span>,<span class="at">FUN =</span> PI,<span class="at">prob =</span> <span class="fl">0.89</span>),<span class="at">lim =</span> T_seq)</span>
<span id="cb196-16"><a href="chapter-7-ulysses-compass.html#cb196-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-17"><a href="chapter-7-ulysses-compass.html#cb196-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Quadratic model</span></span>
<span id="cb196-18"><a href="chapter-7-ulysses-compass.html#cb196-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d<span class="sc">$</span>tax_rate,<span class="at">y =</span> d<span class="sc">$</span>tax_revenue,<span class="at">pch =</span> <span class="dv">20</span>,<span class="at">xlab =</span> <span class="st">&quot;Tax rate&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;Tax revenue&quot;</span>,<span class="at">main =</span> <span class="st">&quot;Quadratic model&quot;</span>)</span>
<span id="cb196-19"><a href="chapter-7-ulysses-compass.html#cb196-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(T_seq,<span class="fu">colMeans</span>(mq_pred))</span>
<span id="cb196-20"><a href="chapter-7-ulysses-compass.html#cb196-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shade</span>(<span class="at">object =</span> <span class="fu">apply</span>(<span class="at">X =</span> mq_pred,<span class="at">MARGIN =</span> <span class="dv">2</span>,<span class="at">FUN =</span> PI,<span class="at">prob =</span> <span class="fl">0.89</span>),<span class="at">lim =</span> T_seq)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-108-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that the quadratic linear model captures some curvature, while the linear model naturally does not. Although the effect is not strong enough to account for the outlier, if it even should.</p>
<p>Now we can try to construct a model that has fatter tails, thus is less critical of outliers.</p>
</div>
<div id="using-students-t-distribution" class="section level4" number="7.6.6.3">
<h4><span class="header-section-number">7.6.6.3</span> (3) Using students t distribution</h4>
<p><em>Notice that i use the same code, thus it is just more compressed</em></p>
<p>Notice that the following alterations are done:</p>
<ol style="list-style-type: decimal">
<li>I had to standardize the tax rate for the students t distribution to work.</li>
<li>Set the mean of the distributions to 0 and decreased the standard deviation</li>
<li>Exchanged distribution for sigma to be exponentional</li>
</ol>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="chapter-7-ulysses-compass.html#cb197-1" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>tax_rate_s <span class="ot">&lt;-</span> <span class="fu">standardize</span>(d<span class="sc">$</span>tax_rate)</span>
<span id="cb197-2"><a href="chapter-7-ulysses-compass.html#cb197-2" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>tax_revenue_s <span class="ot">&lt;-</span> <span class="fu">standardize</span>(d<span class="sc">$</span>tax_revenue)</span>
<span id="cb197-3"><a href="chapter-7-ulysses-compass.html#cb197-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-4"><a href="chapter-7-ulysses-compass.html#cb197-4" aria-hidden="true" tabindex="-1"></a><span class="co">#quadratic model - normal distribution</span></span>
<span id="cb197-5"><a href="chapter-7-ulysses-compass.html#cb197-5" aria-hidden="true" tabindex="-1"></a>mq <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb197-6"><a href="chapter-7-ulysses-compass.html#cb197-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb197-7"><a href="chapter-7-ulysses-compass.html#cb197-7" aria-hidden="true" tabindex="-1"></a>      tax_revenue_s <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) ,</span>
<span id="cb197-8"><a href="chapter-7-ulysses-compass.html#cb197-8" aria-hidden="true" tabindex="-1"></a>      mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b1<span class="sc">*</span>tax_rate_s <span class="sc">+</span> b2<span class="sc">*</span>tax_rate_s<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sigma,</span>
<span id="cb197-9"><a href="chapter-7-ulysses-compass.html#cb197-9" aria-hidden="true" tabindex="-1"></a>      a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.2</span>) , <span class="co">#mean</span></span>
<span id="cb197-10"><a href="chapter-7-ulysses-compass.html#cb197-10" aria-hidden="true" tabindex="-1"></a>      b1 <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.1</span>) , <span class="co">#We say that the beta can be higher and lower than 0, negative or positive effect</span></span>
<span id="cb197-11"><a href="chapter-7-ulysses-compass.html#cb197-11" aria-hidden="true" tabindex="-1"></a>      b2 <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.1</span>) , <span class="co">#We say that the beta can be higher and lower than 0, negative or positive effect</span></span>
<span id="cb197-12"><a href="chapter-7-ulysses-compass.html#cb197-12" aria-hidden="true" tabindex="-1"></a>      sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="fl">0.01</span>)</span>
<span id="cb197-13"><a href="chapter-7-ulysses-compass.html#cb197-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb197-14"><a href="chapter-7-ulysses-compass.html#cb197-14" aria-hidden="true" tabindex="-1"></a>    ,<span class="at">data =</span> d</span>
<span id="cb197-15"><a href="chapter-7-ulysses-compass.html#cb197-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb197-16"><a href="chapter-7-ulysses-compass.html#cb197-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-17"><a href="chapter-7-ulysses-compass.html#cb197-17" aria-hidden="true" tabindex="-1"></a><span class="co">#quadratic model students t</span></span>
<span id="cb197-18"><a href="chapter-7-ulysses-compass.html#cb197-18" aria-hidden="true" tabindex="-1"></a>mq_t <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb197-19"><a href="chapter-7-ulysses-compass.html#cb197-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb197-20"><a href="chapter-7-ulysses-compass.html#cb197-20" aria-hidden="true" tabindex="-1"></a>      tax_revenue_s <span class="sc">~</span> <span class="fu">dstudent</span>( mu , sigma ) ,</span>
<span id="cb197-21"><a href="chapter-7-ulysses-compass.html#cb197-21" aria-hidden="true" tabindex="-1"></a>      mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b1<span class="sc">*</span>tax_rate_s <span class="sc">+</span> b2<span class="sc">*</span>tax_rate_s<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sigma,</span>
<span id="cb197-22"><a href="chapter-7-ulysses-compass.html#cb197-22" aria-hidden="true" tabindex="-1"></a>      a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.2</span> ) , <span class="co">#mean</span></span>
<span id="cb197-23"><a href="chapter-7-ulysses-compass.html#cb197-23" aria-hidden="true" tabindex="-1"></a>      b1 <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.1</span> ) , <span class="co">#We say that the beta can be higher and lower than 0, negative or positive effect</span></span>
<span id="cb197-24"><a href="chapter-7-ulysses-compass.html#cb197-24" aria-hidden="true" tabindex="-1"></a>      b2 <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.1</span> ) , <span class="co">#We say that the beta can be higher and lower than 0, negative or positive effect</span></span>
<span id="cb197-25"><a href="chapter-7-ulysses-compass.html#cb197-25" aria-hidden="true" tabindex="-1"></a>      sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="fl">0.01</span>)</span>
<span id="cb197-26"><a href="chapter-7-ulysses-compass.html#cb197-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb197-27"><a href="chapter-7-ulysses-compass.html#cb197-27" aria-hidden="true" tabindex="-1"></a>    ,<span class="at">data =</span> d</span>
<span id="cb197-28"><a href="chapter-7-ulysses-compass.html#cb197-28" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>Notice that I got an error <em>including Start values for parameters may be too far from MAP. Try better priors or use explicit start values.</em> I simply had to restrict the priors.</strong></p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="chapter-7-ulysses-compass.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Grid of values for predictions</span></span>
<span id="cb198-2"><a href="chapter-7-ulysses-compass.html#cb198-2" aria-hidden="true" tabindex="-1"></a>T_seq_s <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">1</span>,<span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb198-3"><a href="chapter-7-ulysses-compass.html#cb198-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-4"><a href="chapter-7-ulysses-compass.html#cb198-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Making predictions</span></span>
<span id="cb198-5"><a href="chapter-7-ulysses-compass.html#cb198-5" aria-hidden="true" tabindex="-1"></a>mq_pred <span class="ot">&lt;-</span> <span class="fu">link</span>(mq,<span class="at">data =</span> <span class="fu">list</span>(<span class="at">tax_rate_s =</span> T_seq_s)) <span class="co">#use list() to enable the model to map the vector to the variable</span></span>
<span id="cb198-6"><a href="chapter-7-ulysses-compass.html#cb198-6" aria-hidden="true" tabindex="-1"></a>mq_t_pred <span class="ot">&lt;-</span> <span class="fu">link</span>(mq_t,<span class="at">data =</span> <span class="fu">list</span>(<span class="at">tax_rate_s =</span> T_seq_s))</span>
<span id="cb198-7"><a href="chapter-7-ulysses-compass.html#cb198-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-8"><a href="chapter-7-ulysses-compass.html#cb198-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-9"><a href="chapter-7-ulysses-compass.html#cb198-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting!</span></span>
<span id="cb198-10"><a href="chapter-7-ulysses-compass.html#cb198-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> d<span class="sc">$</span>tax_rate_s,<span class="at">y =</span> d<span class="sc">$</span>tax_revenue_s,<span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb198-11"><a href="chapter-7-ulysses-compass.html#cb198-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( T_seq_s , <span class="fu">colMeans</span>(mq_pred) )</span>
<span id="cb198-12"><a href="chapter-7-ulysses-compass.html#cb198-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( T_seq_s , <span class="fu">colMeans</span>(mq_t_pred), <span class="at">col =</span> <span class="st">&quot;red&quot;</span> )</span>
<span id="cb198-13"><a href="chapter-7-ulysses-compass.html#cb198-13" aria-hidden="true" tabindex="-1"></a><span class="fu">shade</span>( <span class="fu">apply</span>( mq_pred , <span class="dv">2</span> , PI ) , T_seq_s )</span>
<span id="cb198-14"><a href="chapter-7-ulysses-compass.html#cb198-14" aria-hidden="true" tabindex="-1"></a><span class="fu">shade</span>( <span class="fu">apply</span>( mq_t_pred , <span class="dv">2</span> , PI ) , T_seq_s, <span class="at">col =</span> <span class="fu">col.alpha</span>(<span class="st">&quot;red&quot;</span>,<span class="fl">0.15</span>) )</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-110-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>I get a bit different results than the solution suggestions. In general what we experience with the students t distribution is that the it assigns more probability to the tails, hence it is less surprised than a regular normal distribution.</p>
<p>Thus one could say that students t distribution has a higher entropy, and it is less prone to being surprised, for more explanations I refer to section <a href="chapter-10-big-entropy-and-the-generalized-linear-model.html#maximum-entropy">10.1</a>.</p>
</div>
</div>
<div id="h5-2" class="section level3" number="7.6.7">
<h3><span class="header-section-number">7.6.7</span> 7H5</h3>
<p>Revisit the urban fox data from the previous chapters practice problems. Use WAIC or PSIS based model comparison on five different models each using weight as the outcome and containing these sets of predictor variables:</p>
<ol style="list-style-type: decimal">
<li>avgfood + groupsize + area</li>
<li>avgfood + groupsize</li>
<li>groupsize + area</li>
<li>avgfood</li>
<li>area</li>
</ol>
<p>Can you explain the relative difference in WAIC scores using the fox DAG from the previous chapter? Be sure to pay attention to the standard error of the score differences (dSE).</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="chapter-7-ulysses-compass.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co">#loading the data</span></span>
<span id="cb199-2"><a href="chapter-7-ulysses-compass.html#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb199-3"><a href="chapter-7-ulysses-compass.html#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(foxes)</span>
<span id="cb199-4"><a href="chapter-7-ulysses-compass.html#cb199-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> foxes</span>
<span id="cb199-5"><a href="chapter-7-ulysses-compass.html#cb199-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">scale</span>(d) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span>
<span id="cb199-6"><a href="chapter-7-ulysses-compass.html#cb199-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">group</th>
<th align="right">avgfood</th>
<th align="right">groupsize</th>
<th align="right">area</th>
<th align="right">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-2.025170</td>
<td align="right">-1.924829</td>
<td align="right">-1.524089</td>
<td align="right">-2.239596</td>
<td align="right">0.4141347</td>
</tr>
<tr class="even">
<td align="right">-2.025170</td>
<td align="right">-1.924829</td>
<td align="right">-1.524089</td>
<td align="right">-2.239596</td>
<td align="right">-1.4270464</td>
</tr>
<tr class="odd">
<td align="right">-1.900212</td>
<td align="right">-1.118035</td>
<td align="right">-1.524089</td>
<td align="right">-1.205508</td>
<td align="right">0.6759540</td>
</tr>
<tr class="even">
<td align="right">-1.900212</td>
<td align="right">-1.118035</td>
<td align="right">-1.524089</td>
<td align="right">-1.205508</td>
<td align="right">1.3009421</td>
</tr>
<tr class="odd">
<td align="right">-1.775255</td>
<td align="right">-1.319734</td>
<td align="right">-1.524089</td>
<td align="right">-1.130106</td>
<td align="right">1.1151348</td>
</tr>
<tr class="even">
<td align="right">-1.775255</td>
<td align="right">-1.319734</td>
<td align="right">-1.524089</td>
<td align="right">-1.130106</td>
<td align="right">-1.0807692</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="chapter-7-ulysses-compass.html#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. avgfood + groupsize + area</span></span>
<span id="cb200-2"><a href="chapter-7-ulysses-compass.html#cb200-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb200-3"><a href="chapter-7-ulysses-compass.html#cb200-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb200-4"><a href="chapter-7-ulysses-compass.html#cb200-4" aria-hidden="true" tabindex="-1"></a>    weight <span class="sc">~</span> <span class="fu">dnorm</span>(mu,sigma),</span>
<span id="cb200-5"><a href="chapter-7-ulysses-compass.html#cb200-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bGS<span class="sc">*</span>groupsize <span class="sc">+</span> bAF<span class="sc">*</span>avgfood <span class="sc">+</span> bA<span class="sc">*</span>area <span class="sc">+</span> sigma,</span>
<span id="cb200-6"><a href="chapter-7-ulysses-compass.html#cb200-6" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb200-7"><a href="chapter-7-ulysses-compass.html#cb200-7" aria-hidden="true" tabindex="-1"></a>    bGS <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb200-8"><a href="chapter-7-ulysses-compass.html#cb200-8" aria-hidden="true" tabindex="-1"></a>    bAF <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb200-9"><a href="chapter-7-ulysses-compass.html#cb200-9" aria-hidden="true" tabindex="-1"></a>    bA <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb200-10"><a href="chapter-7-ulysses-compass.html#cb200-10" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb200-11"><a href="chapter-7-ulysses-compass.html#cb200-11" aria-hidden="true" tabindex="-1"></a>  ),<span class="at">data =</span> d)</span>
<span id="cb200-12"><a href="chapter-7-ulysses-compass.html#cb200-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-13"><a href="chapter-7-ulysses-compass.html#cb200-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. avgfood + groupsize</span></span>
<span id="cb200-14"><a href="chapter-7-ulysses-compass.html#cb200-14" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb200-15"><a href="chapter-7-ulysses-compass.html#cb200-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb200-16"><a href="chapter-7-ulysses-compass.html#cb200-16" aria-hidden="true" tabindex="-1"></a>    weight <span class="sc">~</span> <span class="fu">dnorm</span>(mu,sigma),</span>
<span id="cb200-17"><a href="chapter-7-ulysses-compass.html#cb200-17" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bGS<span class="sc">*</span>groupsize <span class="sc">+</span> bAF<span class="sc">*</span>avgfood <span class="sc">+</span> sigma,</span>
<span id="cb200-18"><a href="chapter-7-ulysses-compass.html#cb200-18" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb200-19"><a href="chapter-7-ulysses-compass.html#cb200-19" aria-hidden="true" tabindex="-1"></a>    bGS <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb200-20"><a href="chapter-7-ulysses-compass.html#cb200-20" aria-hidden="true" tabindex="-1"></a>    bAF <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb200-21"><a href="chapter-7-ulysses-compass.html#cb200-21" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb200-22"><a href="chapter-7-ulysses-compass.html#cb200-22" aria-hidden="true" tabindex="-1"></a>  ),<span class="at">data =</span> d)</span>
<span id="cb200-23"><a href="chapter-7-ulysses-compass.html#cb200-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-24"><a href="chapter-7-ulysses-compass.html#cb200-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. groupsize + area</span></span>
<span id="cb200-25"><a href="chapter-7-ulysses-compass.html#cb200-25" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb200-26"><a href="chapter-7-ulysses-compass.html#cb200-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb200-27"><a href="chapter-7-ulysses-compass.html#cb200-27" aria-hidden="true" tabindex="-1"></a>    weight <span class="sc">~</span> <span class="fu">dnorm</span>(mu,sigma),</span>
<span id="cb200-28"><a href="chapter-7-ulysses-compass.html#cb200-28" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bGS<span class="sc">*</span>groupsize <span class="sc">+</span> bA<span class="sc">*</span>area <span class="sc">+</span> sigma,</span>
<span id="cb200-29"><a href="chapter-7-ulysses-compass.html#cb200-29" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb200-30"><a href="chapter-7-ulysses-compass.html#cb200-30" aria-hidden="true" tabindex="-1"></a>    bGS <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb200-31"><a href="chapter-7-ulysses-compass.html#cb200-31" aria-hidden="true" tabindex="-1"></a>    bA <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb200-32"><a href="chapter-7-ulysses-compass.html#cb200-32" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb200-33"><a href="chapter-7-ulysses-compass.html#cb200-33" aria-hidden="true" tabindex="-1"></a>  ),<span class="at">data =</span> d)</span>
<span id="cb200-34"><a href="chapter-7-ulysses-compass.html#cb200-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-35"><a href="chapter-7-ulysses-compass.html#cb200-35" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. avgfood</span></span>
<span id="cb200-36"><a href="chapter-7-ulysses-compass.html#cb200-36" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb200-37"><a href="chapter-7-ulysses-compass.html#cb200-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb200-38"><a href="chapter-7-ulysses-compass.html#cb200-38" aria-hidden="true" tabindex="-1"></a>    weight <span class="sc">~</span> <span class="fu">dnorm</span>(mu,sigma),</span>
<span id="cb200-39"><a href="chapter-7-ulysses-compass.html#cb200-39" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bAF<span class="sc">*</span>avgfood <span class="sc">+</span> sigma,</span>
<span id="cb200-40"><a href="chapter-7-ulysses-compass.html#cb200-40" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb200-41"><a href="chapter-7-ulysses-compass.html#cb200-41" aria-hidden="true" tabindex="-1"></a>    bAF <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb200-42"><a href="chapter-7-ulysses-compass.html#cb200-42" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb200-43"><a href="chapter-7-ulysses-compass.html#cb200-43" aria-hidden="true" tabindex="-1"></a>  ),<span class="at">data =</span> d)</span>
<span id="cb200-44"><a href="chapter-7-ulysses-compass.html#cb200-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-45"><a href="chapter-7-ulysses-compass.html#cb200-45" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. area</span></span>
<span id="cb200-46"><a href="chapter-7-ulysses-compass.html#cb200-46" aria-hidden="true" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb200-47"><a href="chapter-7-ulysses-compass.html#cb200-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb200-48"><a href="chapter-7-ulysses-compass.html#cb200-48" aria-hidden="true" tabindex="-1"></a>    weight <span class="sc">~</span> <span class="fu">dnorm</span>(mu,sigma),</span>
<span id="cb200-49"><a href="chapter-7-ulysses-compass.html#cb200-49" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bA<span class="sc">*</span>area <span class="sc">+</span> sigma,</span>
<span id="cb200-50"><a href="chapter-7-ulysses-compass.html#cb200-50" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb200-51"><a href="chapter-7-ulysses-compass.html#cb200-51" aria-hidden="true" tabindex="-1"></a>    bA <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb200-52"><a href="chapter-7-ulysses-compass.html#cb200-52" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb200-53"><a href="chapter-7-ulysses-compass.html#cb200-53" aria-hidden="true" tabindex="-1"></a>  ),<span class="at">data =</span> d)</span>
<span id="cb200-54"><a href="chapter-7-ulysses-compass.html#cb200-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-55"><a href="chapter-7-ulysses-compass.html#cb200-55" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(m1,m2,m3,m4,m5)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">329.1435</td>
</tr>
<tr class="even">
<td align="right">330.0579</td>
</tr>
<tr class="odd">
<td align="right">331.1008</td>
</tr>
<tr class="even">
<td align="right">337.3852</td>
</tr>
<tr class="odd">
<td align="right">337.5071</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">16.71357</td>
</tr>
<tr class="even">
<td align="right">16.78985</td>
</tr>
<tr class="odd">
<td align="right">16.91487</td>
</tr>
<tr class="even">
<td align="right">15.48986</td>
</tr>
<tr class="odd">
<td align="right">15.44320</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="right">0.9144073</td>
</tr>
<tr class="odd">
<td align="right">1.9573129</td>
</tr>
<tr class="even">
<td align="right">8.2416927</td>
</tr>
<tr class="odd">
<td align="right">8.3636141</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">1.216568</td>
</tr>
<tr class="odd">
<td align="right">2.504086</td>
</tr>
<tr class="even">
<td align="right">4.388906</td>
</tr>
<tr class="odd">
<td align="right">4.501271</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4.013940</td>
</tr>
<tr class="even">
<td align="right">3.800891</td>
</tr>
<tr class="odd">
<td align="right">3.469019</td>
</tr>
<tr class="even">
<td align="right">2.570548</td>
</tr>
<tr class="odd">
<td align="right">2.839409</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.4901075</td>
</tr>
<tr class="even">
<td align="right">0.3102632</td>
</tr>
<tr class="odd">
<td align="right">0.1841901</td>
</tr>
<tr class="even">
<td align="right">0.0079548</td>
</tr>
<tr class="odd">
<td align="right">0.0074844</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="chapter-7-ulysses-compass.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Identify lower and upper boundaries</span></span>
<span id="cb201-2"><a href="chapter-7-ulysses-compass.html#cb201-2" aria-hidden="true" tabindex="-1"></a>lb <span class="ot">&lt;-</span> <span class="fu">compare</span>(m1,m2,m3,m4,m5,<span class="at">sort =</span> F)<span class="sc">$</span>WAIC <span class="sc">-</span> <span class="fu">compare</span>(m1,m2,m3,m4,m5,<span class="at">sort =</span> F)<span class="sc">$</span>SE <span class="co">#Lower bound</span></span>
<span id="cb201-3"><a href="chapter-7-ulysses-compass.html#cb201-3" aria-hidden="true" tabindex="-1"></a>ub <span class="ot">&lt;-</span> <span class="fu">compare</span>(m1,m2,m3,m4,m5,<span class="at">sort =</span> F)<span class="sc">$</span>WAIC <span class="sc">+</span> <span class="fu">compare</span>(m1,m2,m3,m4,m5,<span class="at">sort =</span> F)<span class="sc">$</span>SE <span class="co">#Upper bound</span></span>
<span id="cb201-4"><a href="chapter-7-ulysses-compass.html#cb201-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-5"><a href="chapter-7-ulysses-compass.html#cb201-5" aria-hidden="true" tabindex="-1"></a>WAICComp <span class="ot">&lt;-</span> <span class="fu">compare</span>(m1,m2,m3,m4,m5,<span class="at">sort =</span> F)<span class="sc">$</span>WAIC</span></code></pre></div>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="chapter-7-ulysses-compass.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<pre><code>## null device 
##           1</code></pre>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="chapter-7-ulysses-compass.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">x =</span> WAICComp</span>
<span id="cb204-2"><a href="chapter-7-ulysses-compass.html#cb204-2" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">ylab =</span> <span class="st">&quot;Model m:&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;WAIC&quot;</span></span>
<span id="cb204-3"><a href="chapter-7-ulysses-compass.html#cb204-3" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">pch =</span> <span class="dv">20</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">300</span>,<span class="dv">375</span>)</span>
<span id="cb204-4"><a href="chapter-7-ulysses-compass.html#cb204-4" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">main =</span> <span class="st">&quot;Model comparison&quot;</span></span>
<span id="cb204-5"><a href="chapter-7-ulysses-compass.html#cb204-5" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">frame.plot =</span> T</span>
<span id="cb204-6"><a href="chapter-7-ulysses-compass.html#cb204-6" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb204-7"><a href="chapter-7-ulysses-compass.html#cb204-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="fu">abline</span>(<span class="at">h =</span> i,<span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col =</span> <span class="st">&quot;darkgrey&quot;</span>)</span>
<span id="cb204-8"><a href="chapter-7-ulysses-compass.html#cb204-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-9"><a href="chapter-7-ulysses-compass.html#cb204-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the standard errors</span></span>
<span id="cb204-10"><a href="chapter-7-ulysses-compass.html#cb204-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb204-11"><a href="chapter-7-ulysses-compass.html#cb204-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(lb[i],ub[i]),<span class="at">y =</span> <span class="fu">c</span>(i,i))</span>
<span id="cb204-12"><a href="chapter-7-ulysses-compass.html#cb204-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We see that:</p>
<ul>
<li>None of the models are superior</li>
<li>Three similar models, that being 1, 2 and three all being multivariate.</li>
<li>The two bivariate models respectively with avgfood or area are basically the same, the being the reason that area and avgfood is a pipe from avgfood to weight.</li>
<li>It is expected that they do not differ two much, as we have causality from area, to avgfood which has both directly on weight and indirectly flowing through groupsize.</li>
</ul>
<p><img src="Images/paste-1414ED60.png" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-6-the-haunted-dag-the-causal-terror.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter-8-conditional-manatees.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
