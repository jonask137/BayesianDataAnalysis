<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Chapter 8 - Model comparison | Bayesian Data Analysis Notes</title>
  <meta name="description" content="9 Chapter 8 - Model comparison | Bayesian Data Analysis Notes" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Chapter 8 - Model comparison | Bayesian Data Analysis Notes" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Chapter 8 - Model comparison | Bayesian Data Analysis Notes" />
  
  
  

<meta name="author" content="Jonas Ringive Korsholm" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-7-model-comparison.html"/>
<link rel="next" href="chapter-9-markov-chain-monte-carlo.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="chapter-1-golems-of-prague.html"><a href="chapter-1-golems-of-prague.html"><i class="fa fa-check"></i><b>1</b> Chapter 1 - Golems of Prague</a></li>
<li class="chapter" data-level="2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html"><i class="fa fa-check"></i><b>2</b> Chapter 2 - Small worlds and Large Worlds</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#models-and-estimation"><i class="fa fa-check"></i><b>2.1</b> Models and Estimation</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#engines-motors-to-estimate-the-models"><i class="fa fa-check"></i><b>2.1.1</b> Engines / Motors to estimate the models</a>
<ul>
<li class="chapter" data-level="2.1.1.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#grid-approximation"><i class="fa fa-check"></i><b>2.1.1.1</b> Grid approximation</a></li>
<li class="chapter" data-level="2.1.1.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#quadratic-approximation"><i class="fa fa-check"></i><b>2.1.1.2</b> Quadratic approximation</a></li>
<li class="chapter" data-level="2.1.1.3" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#markov-chain-monte-carlo"><i class="fa fa-check"></i><b>2.1.1.3</b> Markov Chain Monte Carlo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#exercises"><i class="fa fa-check"></i><b>2.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#m1"><i class="fa fa-check"></i><b>2.2.1</b> 2M1</a></li>
<li class="chapter" data-level="2.2.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#m2"><i class="fa fa-check"></i><b>2.2.2</b> 2M2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html"><i class="fa fa-check"></i><b>3</b> Chapter 3 - Sampling the Imaginary</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-from-a-grid-approximate-posterior"><i class="fa fa-check"></i><b>3.1</b> Sampling from a grid-approximate posterior</a></li>
<li class="chapter" data-level="3.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-to-summarize"><i class="fa fa-check"></i><b>3.2</b> Sampling to summarize</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#defined-boundaries"><i class="fa fa-check"></i><b>3.2.1</b> Defined Boundaries</a></li>
<li class="chapter" data-level="3.2.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#defined-probability-mass"><i class="fa fa-check"></i><b>3.2.2</b> Defined Probability Mass</a></li>
<li class="chapter" data-level="3.2.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#point-estimates"><i class="fa fa-check"></i><b>3.2.3</b> Point Estimates</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-to-simulate-prediction"><i class="fa fa-check"></i><b>3.3</b> Sampling to simulate prediction</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#dummy-data"><i class="fa fa-check"></i><b>3.3.1</b> Dummy Data</a></li>
<li class="chapter" data-level="3.3.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#model-checking"><i class="fa fa-check"></i><b>3.3.2</b> Model Checking</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#exercises-1"><i class="fa fa-check"></i><b>3.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m1-1"><i class="fa fa-check"></i><b>3.4.1</b> 3M1</a></li>
<li class="chapter" data-level="3.4.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m2-1"><i class="fa fa-check"></i><b>3.4.2</b> 3M2</a></li>
<li class="chapter" data-level="3.4.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m3"><i class="fa fa-check"></i><b>3.4.3</b> 3M3</a></li>
<li class="chapter" data-level="3.4.4" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m4"><i class="fa fa-check"></i><b>3.4.4</b> 3M4</a></li>
<li class="chapter" data-level="3.4.5" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m5"><i class="fa fa-check"></i><b>3.4.5</b> 3M5</a></li>
<li class="chapter" data-level="3.4.6" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h1"><i class="fa fa-check"></i><b>3.4.6</b> 3H1</a></li>
<li class="chapter" data-level="3.4.7" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h2"><i class="fa fa-check"></i><b>3.4.7</b> 3H2</a></li>
<li class="chapter" data-level="3.4.8" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h3"><i class="fa fa-check"></i><b>3.4.8</b> 3H3</a></li>
<li class="chapter" data-level="3.4.9" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h4"><i class="fa fa-check"></i><b>3.4.9</b> 3H4</a></li>
<li class="chapter" data-level="3.4.10" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h5"><i class="fa fa-check"></i><b>3.4.10</b> 3H5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geocentric-models.html"><a href="geocentric-models.html"><i class="fa fa-check"></i><b>4</b> Geocentric Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="geocentric-models.html"><a href="geocentric-models.html#why-normal-distributions-are-normal"><i class="fa fa-check"></i><b>4.1</b> Why Normal distributions are normal</a></li>
<li class="chapter" data-level="4.2" data-path="geocentric-models.html"><a href="geocentric-models.html#a-language-for-describing-models"><i class="fa fa-check"></i><b>4.2</b> A language for describing models</a></li>
<li class="chapter" data-level="4.3" data-path="geocentric-models.html"><a href="geocentric-models.html#gaussian-model-of-height"><i class="fa fa-check"></i><b>4.3</b> Gaussian model of height</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="geocentric-models.html"><a href="geocentric-models.html#the-model"><i class="fa fa-check"></i><b>4.3.1</b> The model</a></li>
<li class="chapter" data-level="4.3.2" data-path="geocentric-models.html"><a href="geocentric-models.html#grid-approximation-of-the-posterior-distribution"><i class="fa fa-check"></i><b>4.3.2</b> Grid approximation of the posterior distribution</a></li>
<li class="chapter" data-level="4.3.3" data-path="geocentric-models.html"><a href="geocentric-models.html#sampling-from-the-posterior"><i class="fa fa-check"></i><b>4.3.3</b> Sampling from the posterior</a></li>
<li class="chapter" data-level="4.3.4" data-path="geocentric-models.html"><a href="geocentric-models.html#finding-the-posterior-distribution-with-quap"><i class="fa fa-check"></i><b>4.3.4</b> Finding the posterior distribution with quap</a></li>
<li class="chapter" data-level="4.3.5" data-path="geocentric-models.html"><a href="geocentric-models.html#sampling-from-a-quap"><i class="fa fa-check"></i><b>4.3.5</b> Sampling from a quap</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="geocentric-models.html"><a href="geocentric-models.html#linear-prediction"><i class="fa fa-check"></i><b>4.4</b> Linear prediction</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="geocentric-models.html"><a href="geocentric-models.html#the-lienar-mdoel-strategy"><i class="fa fa-check"></i><b>4.4.1</b> The lienar mdoel strategy</a></li>
<li class="chapter" data-level="4.4.2" data-path="geocentric-models.html"><a href="geocentric-models.html#finding-the-posterior-distribution"><i class="fa fa-check"></i><b>4.4.2</b> Finding the posterior distribution</a></li>
<li class="chapter" data-level="4.4.3" data-path="geocentric-models.html"><a href="geocentric-models.html#interpreting-the-posterior-distribution"><i class="fa fa-check"></i><b>4.4.3</b> Interpreting the posterior distribution</a>
<ul>
<li class="chapter" data-level="4.4.3.1" data-path="geocentric-models.html"><a href="geocentric-models.html#tables-fo-marginal-distributions"><i class="fa fa-check"></i><b>4.4.3.1</b> Tables fo marginal distributions</a></li>
<li class="chapter" data-level="4.4.3.2" data-path="geocentric-models.html"><a href="geocentric-models.html#plotting-posterior-inference-against-the-data"><i class="fa fa-check"></i><b>4.4.3.2</b> Plotting posterior inference against the data</a></li>
<li class="chapter" data-level="4.4.3.3" data-path="geocentric-models.html"><a href="geocentric-models.html#adding-uncertainty-around-the-mean"><i class="fa fa-check"></i><b>4.4.3.3</b> Adding uncertainty around the mean</a></li>
<li class="chapter" data-level="4.4.3.4" data-path="geocentric-models.html"><a href="geocentric-models.html#plotting-regression-intervlas-and-contours"><i class="fa fa-check"></i><b>4.4.3.4</b> Plotting regression intervlas and contours</a></li>
<li class="chapter" data-level="4.4.3.5" data-path="geocentric-models.html"><a href="geocentric-models.html#prediction-intevals"><i class="fa fa-check"></i><b>4.4.3.5</b> Prediction intevals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="geocentric-models.html"><a href="geocentric-models.html#curves-form-lines"><i class="fa fa-check"></i><b>4.5</b> Curves form lines</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="geocentric-models.html"><a href="geocentric-models.html#polynomial-regression"><i class="fa fa-check"></i><b>4.5.1</b> Polynomial regression</a></li>
<li class="chapter" data-level="4.5.2" data-path="geocentric-models.html"><a href="geocentric-models.html#splines"><i class="fa fa-check"></i><b>4.5.2</b> Splines</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="geocentric-models.html"><a href="geocentric-models.html#exercises-2"><i class="fa fa-check"></i><b>4.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="geocentric-models.html"><a href="geocentric-models.html#m1-2"><i class="fa fa-check"></i><b>4.6.1</b> 4M1</a></li>
<li class="chapter" data-level="4.6.2" data-path="geocentric-models.html"><a href="geocentric-models.html#m8"><i class="fa fa-check"></i><b>4.6.2</b> 4M8</a></li>
<li class="chapter" data-level="4.6.3" data-path="geocentric-models.html"><a href="geocentric-models.html#h1-1"><i class="fa fa-check"></i><b>4.6.3</b> 4H1</a></li>
<li class="chapter" data-level="4.6.4" data-path="geocentric-models.html"><a href="geocentric-models.html#h2-1"><i class="fa fa-check"></i><b>4.6.4</b> 4H2</a></li>
<li class="chapter" data-level="4.6.5" data-path="geocentric-models.html"><a href="geocentric-models.html#h3-1"><i class="fa fa-check"></i><b>4.6.5</b> 4H3</a></li>
<li class="chapter" data-level="4.6.6" data-path="geocentric-models.html"><a href="geocentric-models.html#h6"><i class="fa fa-check"></i><b>4.6.6</b> 4H6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lecture-notes-wrap-up-chapters-geocentric-models.html"><a href="lecture-notes-wrap-up-chapters-geocentric-models.html"><i class="fa fa-check"></i><b>5</b> Lecture notes - wrap up chapters geocentric models</a></li>
<li class="chapter" data-level="6" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html"><i class="fa fa-check"></i><b>6</b> Chapter 5 - The Many Variables &amp; The Spurious Waffles</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#spurious-associations"><i class="fa fa-check"></i><b>6.1</b> Spurious Associations</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#defining-a-multiple-regression"><i class="fa fa-check"></i><b>6.1.1</b> Defining a multiple regression</a></li>
<li class="chapter" data-level="6.1.2" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#approximating-the-posterior"><i class="fa fa-check"></i><b>6.1.2</b> Approximating the posterior</a></li>
<li class="chapter" data-level="6.1.3" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#the-flow"><i class="fa fa-check"></i><b>6.1.3</b> The flow</a>
<ul>
<li class="chapter" data-level="6.1.3.1" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#posterior-prediction-plots"><i class="fa fa-check"></i><b>6.1.3.1</b> Posterior Prediction Plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#masked-relationship"><i class="fa fa-check"></i><b>6.2</b> Masked Relationship</a></li>
<li class="chapter" data-level="6.3" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#categorical-variables"><i class="fa fa-check"></i><b>6.3</b> Categorical Variables</a></li>
<li class="chapter" data-level="6.4" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#lecture-notes---not-integrated-in-the-notes"><i class="fa fa-check"></i><b>6.4</b> Lecture notes - not integrated in the notes</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html"><i class="fa fa-check"></i><b>7</b> Chapter 6 - The Haunted DAG &amp; The Causal Terror</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#multicollinearity"><i class="fa fa-check"></i><b>7.1</b> Multicollinearity</a></li>
<li class="chapter" data-level="7.2" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#post-treatment-bias"><i class="fa fa-check"></i><b>7.2</b> Post Treatment Bias</a></li>
<li class="chapter" data-level="7.3" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#collider-bias"><i class="fa fa-check"></i><b>7.3</b> Collider Bias</a></li>
<li class="chapter" data-level="7.4" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#confronting-confounding"><i class="fa fa-check"></i><b>7.4</b> Confronting Confounding</a></li>
<li class="chapter" data-level="7.5" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#exercises-3"><i class="fa fa-check"></i><b>7.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#m1-3"><i class="fa fa-check"></i><b>7.5.1</b> 6M1</a></li>
<li class="chapter" data-level="7.5.2" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#m3-1"><i class="fa fa-check"></i><b>7.5.2</b> 6M3</a></li>
<li class="chapter" data-level="7.5.3" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h"><i class="fa fa-check"></i><b>7.5.3</b> 6H</a></li>
<li class="chapter" data-level="7.5.4" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h3-2"><i class="fa fa-check"></i><b>7.5.4</b> 6H3</a></li>
<li class="chapter" data-level="7.5.5" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h4-1"><i class="fa fa-check"></i><b>7.5.5</b> 6H4</a></li>
<li class="chapter" data-level="7.5.6" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h5-1"><i class="fa fa-check"></i><b>7.5.6</b> 6H5</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#lecture-notes---not-integrated-in-the-text"><i class="fa fa-check"></i><b>7.6</b> Lecture notes - not integrated in the text</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html"><i class="fa fa-check"></i><b>8</b> Chapter 7 - Model comparison</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#the-problem-with-parameters"><i class="fa fa-check"></i><b>8.1</b> The problem with parameters</a></li>
<li class="chapter" data-level="8.2" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#entropy-and-accuracy"><i class="fa fa-check"></i><b>8.2</b> Entropy and Accuracy</a></li>
<li class="chapter" data-level="8.3" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#golem-taming-regularization"><i class="fa fa-check"></i><b>8.3</b> Golem Taming: Regularization</a></li>
<li class="chapter" data-level="8.4" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#predicting-predictive-accuracy"><i class="fa fa-check"></i><b>8.4</b> Predicting predictive accuracy</a></li>
<li class="chapter" data-level="8.5" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#model-comparison"><i class="fa fa-check"></i><b>8.5</b> Model Comparison</a></li>
<li class="chapter" data-level="8.6" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#exercies"><i class="fa fa-check"></i><b>8.6</b> Exercies</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#medium-exercises"><i class="fa fa-check"></i><b>8.6.1</b> Medium exercises</a></li>
<li class="chapter" data-level="8.6.2" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#hard-exercises"><i class="fa fa-check"></i><b>8.6.2</b> Hard exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html"><i class="fa fa-check"></i><b>9</b> Chapter 8 - Model comparison</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#building-an-interaction"><i class="fa fa-check"></i><b>9.1</b> Building an interaction</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#adding-an-indicator-variable-isnt-enough."><i class="fa fa-check"></i><b>9.1.1</b> Adding an indicator variable isn’t enough.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#symmetry-of-interactions"><i class="fa fa-check"></i><b>9.2</b> Symmetry of interactions</a></li>
<li class="chapter" data-level="9.3" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#continuous-interactions"><i class="fa fa-check"></i><b>9.3</b> Continuous interactions</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#a-winter-flower"><i class="fa fa-check"></i><b>9.3.1</b> A Winter Flower</a></li>
<li class="chapter" data-level="9.3.2" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#the-models"><i class="fa fa-check"></i><b>9.3.2</b> The models</a></li>
<li class="chapter" data-level="9.3.3" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#plotting-posterior-predictions"><i class="fa fa-check"></i><b>9.3.3</b> Plotting posterior predictions</a></li>
<li class="chapter" data-level="9.3.4" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#plotting-prior-predictions"><i class="fa fa-check"></i><b>9.3.4</b> Plotting prior predictions</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#exercises-4"><i class="fa fa-check"></i><b>9.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#m4-1"><i class="fa fa-check"></i><b>9.4.1</b> 8M4</a>
<ul>
<li class="chapter" data-level="9.4.1.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#interaction-model"><i class="fa fa-check"></i><b>9.4.1.1</b> Interaction model</a></li>
<li class="chapter" data-level="9.4.1.2" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#conclusion"><i class="fa fa-check"></i><b>9.4.1.2</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9.4.2" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#h3-3"><i class="fa fa-check"></i><b>9.4.2</b> 8H3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>10</b> Chapter 9 - Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#good-king-markov-and-his-island-kingdom"><i class="fa fa-check"></i><b>10.1</b> Good King Markov and his island kingdom</a></li>
<li class="chapter" data-level="10.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#metropolis-algorithms"><i class="fa fa-check"></i><b>10.2</b> Metropolis algorithms</a></li>
<li class="chapter" data-level="10.3" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#hamiltonian-monte-carlo"><i class="fa fa-check"></i><b>10.3</b> Hamiltonian Monte Carlo</a></li>
<li class="chapter" data-level="10.4" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#easy-hmc-ulam"><i class="fa fa-check"></i><b>10.4</b> Easy HMC: ulam</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#fitting-using-quap"><i class="fa fa-check"></i><b>10.4.1</b> Fitting using quap</a></li>
<li class="chapter" data-level="10.4.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#fitting-using-hmc"><i class="fa fa-check"></i><b>10.4.2</b> Fitting using HMC</a>
<ul>
<li class="chapter" data-level="10.4.2.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#preparing-data"><i class="fa fa-check"></i><b>10.4.2.1</b> Preparing data</a></li>
<li class="chapter" data-level="10.4.2.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#sampling-from-the-posterior-1"><i class="fa fa-check"></i><b>10.4.2.2</b> Sampling from the posterior</a></li>
<li class="chapter" data-level="10.4.2.3" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#sampling-again-in-parallel"><i class="fa fa-check"></i><b>10.4.2.3</b> Sampling again, in parallel</a></li>
<li class="chapter" data-level="10.4.2.4" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#visualization"><i class="fa fa-check"></i><b>10.4.2.4</b> Visualization</a></li>
<li class="chapter" data-level="10.4.2.5" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#checking-the-chain"><i class="fa fa-check"></i><b>10.4.2.5</b> Checking the chain</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#care-and-feeding-of-your-markov-chain"><i class="fa fa-check"></i><b>10.5</b> Care and feeding of your Markov chain</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#how-many-samples-do-you-need"><i class="fa fa-check"></i><b>10.5.1</b> How many samples do you need?</a></li>
<li class="chapter" data-level="10.5.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#how-many-chains-do-you-need"><i class="fa fa-check"></i><b>10.5.2</b> How many chains do you need?</a></li>
<li class="chapter" data-level="10.5.3" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#taming-a-wild-chain"><i class="fa fa-check"></i><b>10.5.3</b> Taming a wild chain</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#lecture-notes"><i class="fa fa-check"></i><b>10.6</b> Lecture notes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Data Analysis Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter-8---model-comparison" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Chapter 8 - Model comparison</h1>
<p>Introduction, using the case of the planes coming back with holes in the wings, does that mean that one should make the wings stronger? A model will suggest that, because it only sees scenarios of where the holes are in planes that came back, hence it is conditional on planes returning, we rarely see holes in the center part. Since we only see planes coming back, we dont get to see the other condition.</p>
<p>The following sections elaborate on how we can model interactions, meaning how one outcome may result another.</p>
<div id="building-an-interaction" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Building an interaction</h2>
<p>This section elaborates on what an interaction can be used at what for.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="chapter-8-model-comparison.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb182-2"><a href="chapter-8-model-comparison.html#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(rugged)</span>
<span id="cb182-3"><a href="chapter-8-model-comparison.html#cb182-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> rugged</span>
<span id="cb182-4"><a href="chapter-8-model-comparison.html#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="co"># make log version of outcome</span></span>
<span id="cb182-5"><a href="chapter-8-model-comparison.html#cb182-5" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>log_gdp <span class="ot">&lt;-</span> <span class="fu">log</span>( d<span class="sc">$</span>rgdppc_2000 )</span>
<span id="cb182-6"><a href="chapter-8-model-comparison.html#cb182-6" aria-hidden="true" tabindex="-1"></a><span class="co"># extract countries with GDP data</span></span>
<span id="cb182-7"><a href="chapter-8-model-comparison.html#cb182-7" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> d[ <span class="fu">complete.cases</span>(d<span class="sc">$</span>rgdppc_2000) , ]</span>
<span id="cb182-8"><a href="chapter-8-model-comparison.html#cb182-8" aria-hidden="true" tabindex="-1"></a><span class="co"># rescale variables</span></span>
<span id="cb182-9"><a href="chapter-8-model-comparison.html#cb182-9" aria-hidden="true" tabindex="-1"></a>dd<span class="sc">$</span>log_gdp_std <span class="ot">&lt;-</span> dd<span class="sc">$</span>log_gdp <span class="sc">/</span> <span class="fu">mean</span>(dd<span class="sc">$</span>log_gdp)</span>
<span id="cb182-10"><a href="chapter-8-model-comparison.html#cb182-10" aria-hidden="true" tabindex="-1"></a>dd<span class="sc">$</span>rugged_std <span class="ot">&lt;-</span> dd<span class="sc">$</span>rugged <span class="sc">/</span> <span class="fu">max</span>(dd<span class="sc">$</span>rugged)</span></code></pre></div>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="chapter-8-model-comparison.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co">#8.2</span></span>
<span id="cb183-2"><a href="chapter-8-model-comparison.html#cb183-2" aria-hidden="true" tabindex="-1"></a>m8<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb183-3"><a href="chapter-8-model-comparison.html#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb183-4"><a href="chapter-8-model-comparison.html#cb183-4" aria-hidden="true" tabindex="-1"></a>    log_gdp_std <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) ,</span>
<span id="cb183-5"><a href="chapter-8-model-comparison.html#cb183-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b<span class="sc">*</span>( rugged_std <span class="sc">-</span> <span class="fl">0.215</span> ) ,</span>
<span id="cb183-6"><a href="chapter-8-model-comparison.html#cb183-6" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">1</span> , <span class="dv">1</span> ) ,</span>
<span id="cb183-7"><a href="chapter-8-model-comparison.html#cb183-7" aria-hidden="true" tabindex="-1"></a>    b <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) ,</span>
<span id="cb183-8"><a href="chapter-8-model-comparison.html#cb183-8" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb183-9"><a href="chapter-8-model-comparison.html#cb183-9" aria-hidden="true" tabindex="-1"></a>  ) , <span class="at">data=</span>dd )</span>
<span id="cb183-10"><a href="chapter-8-model-comparison.html#cb183-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-11"><a href="chapter-8-model-comparison.html#cb183-11" aria-hidden="true" tabindex="-1"></a><span class="co">#8.3</span></span>
<span id="cb183-12"><a href="chapter-8-model-comparison.html#cb183-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb183-13"><a href="chapter-8-model-comparison.html#cb183-13" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">extract.prior</span>( m8<span class="fl">.1</span> )</span>
<span id="cb183-14"><a href="chapter-8-model-comparison.html#cb183-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-15"><a href="chapter-8-model-comparison.html#cb183-15" aria-hidden="true" tabindex="-1"></a><span class="co"># set up the plot dimensions</span></span>
<span id="cb183-16"><a href="chapter-8-model-comparison.html#cb183-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( <span class="cn">NULL</span> , <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>) , <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">1.5</span>) ,</span>
<span id="cb183-17"><a href="chapter-8-model-comparison.html#cb183-17" aria-hidden="true" tabindex="-1"></a><span class="at">xlab=</span><span class="st">&quot;ruggedness&quot;</span> , <span class="at">ylab=</span><span class="st">&quot;log GDP&quot;</span> )</span>
<span id="cb183-18"><a href="chapter-8-model-comparison.html#cb183-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>( <span class="at">h=</span><span class="fu">min</span>(dd<span class="sc">$</span>log_gdp_std) , <span class="at">lty=</span><span class="dv">2</span> )</span>
<span id="cb183-19"><a href="chapter-8-model-comparison.html#cb183-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>( <span class="at">h=</span><span class="fu">max</span>(dd<span class="sc">$</span>log_gdp_std) , <span class="at">lty=</span><span class="dv">2</span> )</span>
<span id="cb183-20"><a href="chapter-8-model-comparison.html#cb183-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-21"><a href="chapter-8-model-comparison.html#cb183-21" aria-hidden="true" tabindex="-1"></a><span class="co"># draw 50 lines from the prior</span></span>
<span id="cb183-22"><a href="chapter-8-model-comparison.html#cb183-22" aria-hidden="true" tabindex="-1"></a>rugged_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from=</span><span class="sc">-</span><span class="fl">0.1</span> , <span class="at">to=</span><span class="fl">1.1</span> , <span class="at">length.out=</span><span class="dv">30</span> )</span>
<span id="cb183-23"><a href="chapter-8-model-comparison.html#cb183-23" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">link</span>( m8<span class="fl">.1</span> , <span class="at">post=</span>prior , <span class="at">data=</span><span class="fu">data.frame</span>(<span class="at">rugged_std=</span>rugged_seq) )</span>
<span id="cb183-24"><a href="chapter-8-model-comparison.html#cb183-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span> ) <span class="fu">lines</span>( rugged_seq , mu[i,] , <span class="at">col=</span><span class="fu">col.alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.3</span>) )</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-100-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="chapter-8-model-comparison.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>( <span class="fu">abs</span>(prior<span class="sc">$</span>b) <span class="sc">&gt;</span> <span class="fl">0.6</span> ) <span class="sc">/</span> <span class="fu">length</span>(prior<span class="sc">$</span>b)</span></code></pre></div>
<pre><code>## [1] 0.545</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="chapter-8-model-comparison.html#cb186-1" aria-hidden="true" tabindex="-1"></a>m8<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb186-2"><a href="chapter-8-model-comparison.html#cb186-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb186-3"><a href="chapter-8-model-comparison.html#cb186-3" aria-hidden="true" tabindex="-1"></a>    log_gdp_std <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) ,</span>
<span id="cb186-4"><a href="chapter-8-model-comparison.html#cb186-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b<span class="sc">*</span>( rugged_std <span class="sc">-</span> <span class="fl">0.215</span> ) ,</span>
<span id="cb186-5"><a href="chapter-8-model-comparison.html#cb186-5" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">1</span> , <span class="fl">0.1</span> ) ,</span>
<span id="cb186-6"><a href="chapter-8-model-comparison.html#cb186-6" aria-hidden="true" tabindex="-1"></a>    b <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.3</span> ) ,</span>
<span id="cb186-7"><a href="chapter-8-model-comparison.html#cb186-7" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb186-8"><a href="chapter-8-model-comparison.html#cb186-8" aria-hidden="true" tabindex="-1"></a>  ) , <span class="at">data=</span>dd )</span></code></pre></div>
<div id="adding-an-indicator-variable-isnt-enough." class="section level3" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Adding an indicator variable isn’t enough.</h3>
<p>One may argue that indicator variables may be sufficient to reflect certain situations, e.g., if something is on Africa or not, hence an indicator (i.e., dummy variable) may be included in the model. Although that will just reflect the mean value of that given outcome as it is either in or out.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="chapter-8-model-comparison.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co">#8.7</span></span>
<span id="cb187-2"><a href="chapter-8-model-comparison.html#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="co"># make variable to index Africa (1) or not (2)</span></span>
<span id="cb187-3"><a href="chapter-8-model-comparison.html#cb187-3" aria-hidden="true" tabindex="-1"></a>dd<span class="sc">$</span>cid <span class="ot">&lt;-</span> <span class="fu">ifelse</span>( dd<span class="sc">$</span>cont_africa<span class="sc">==</span><span class="dv">1</span> , <span class="dv">1</span> , <span class="dv">2</span> )</span>
<span id="cb187-4"><a href="chapter-8-model-comparison.html#cb187-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-5"><a href="chapter-8-model-comparison.html#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="co">#8.8</span></span>
<span id="cb187-6"><a href="chapter-8-model-comparison.html#cb187-6" aria-hidden="true" tabindex="-1"></a>m8<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb187-7"><a href="chapter-8-model-comparison.html#cb187-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb187-8"><a href="chapter-8-model-comparison.html#cb187-8" aria-hidden="true" tabindex="-1"></a>    log_gdp_std <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) ,</span>
<span id="cb187-9"><a href="chapter-8-model-comparison.html#cb187-9" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a[cid] <span class="sc">+</span> b<span class="sc">*</span>( rugged_std <span class="sc">-</span> <span class="fl">0.215</span> ) ,</span>
<span id="cb187-10"><a href="chapter-8-model-comparison.html#cb187-10" aria-hidden="true" tabindex="-1"></a>    a[cid] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">1</span> , <span class="fl">0.1</span> ) ,</span>
<span id="cb187-11"><a href="chapter-8-model-comparison.html#cb187-11" aria-hidden="true" tabindex="-1"></a>    b <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.3</span> ) ,</span>
<span id="cb187-12"><a href="chapter-8-model-comparison.html#cb187-12" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb187-13"><a href="chapter-8-model-comparison.html#cb187-13" aria-hidden="true" tabindex="-1"></a>  ) , <span class="at">data=</span>dd )</span>
<span id="cb187-14"><a href="chapter-8-model-comparison.html#cb187-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-15"><a href="chapter-8-model-comparison.html#cb187-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-16"><a href="chapter-8-model-comparison.html#cb187-16" aria-hidden="true" tabindex="-1"></a><span class="co">#8.9</span></span>
<span id="cb187-17"><a href="chapter-8-model-comparison.html#cb187-17" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>( m8<span class="fl">.1</span> , m8<span class="fl">.2</span> )</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-252.2694</td>
</tr>
<tr class="even">
<td align="right">-188.7489</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">15.30363</td>
</tr>
<tr class="even">
<td align="right">13.29716</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.00000</td>
</tr>
<tr class="even">
<td align="right">63.52044</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">15.14767</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4.258180</td>
</tr>
<tr class="even">
<td align="right">2.693351</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">0</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="chapter-8-model-comparison.html#cb188-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-2"><a href="chapter-8-model-comparison.html#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="co">#8.10</span></span>
<span id="cb188-3"><a href="chapter-8-model-comparison.html#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>( m8<span class="fl">.2</span> , <span class="at">depth=</span><span class="dv">2</span> )</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.8804170</td>
</tr>
<tr class="even">
<td align="right">1.0491586</td>
</tr>
<tr class="odd">
<td align="right">-0.0465124</td>
</tr>
<tr class="even">
<td align="right">0.1123923</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0159377</td>
</tr>
<tr class="even">
<td align="right">0.0101860</td>
</tr>
<tr class="odd">
<td align="right">0.0456887</td>
</tr>
<tr class="even">
<td align="right">0.0060917</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.8549455</td>
</tr>
<tr class="even">
<td align="right">1.0328794</td>
</tr>
<tr class="odd">
<td align="right">-0.1195318</td>
</tr>
<tr class="even">
<td align="right">0.1026565</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.9058885</td>
</tr>
<tr class="even">
<td align="right">1.0654378</td>
</tr>
<tr class="odd">
<td align="right">0.0265069</td>
</tr>
<tr class="even">
<td align="right">0.1221281</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="chapter-8-model-comparison.html#cb189-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-2"><a href="chapter-8-model-comparison.html#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="co">#8.11</span></span>
<span id="cb189-3"><a href="chapter-8-model-comparison.html#cb189-3" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m8<span class="fl">.2</span>) </span>
<span id="cb189-4"><a href="chapter-8-model-comparison.html#cb189-4" aria-hidden="true" tabindex="-1"></a>diff_a1_a2 <span class="ot">&lt;-</span> post<span class="sc">$</span>a[,<span class="dv">1</span>] <span class="sc">-</span> post<span class="sc">$</span>a[,<span class="dv">2</span>]</span>
<span id="cb189-5"><a href="chapter-8-model-comparison.html#cb189-5" aria-hidden="true" tabindex="-1"></a><span class="fu">PI</span>( diff_a1_a2 )</span></code></pre></div>
<pre><code>##         5%        94% 
## -0.1990056 -0.1378378</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="chapter-8-model-comparison.html#cb191-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-2"><a href="chapter-8-model-comparison.html#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="co">#8.12</span></span>
<span id="cb191-3"><a href="chapter-8-model-comparison.html#cb191-3" aria-hidden="true" tabindex="-1"></a>rugged.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from=</span><span class="sc">-</span><span class="fl">0.1</span> , <span class="at">to=</span><span class="fl">1.1</span> , <span class="at">length.out=</span><span class="dv">30</span> )</span>
<span id="cb191-4"><a href="chapter-8-model-comparison.html#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compute mu over samples, fixing cid=2</span></span>
<span id="cb191-5"><a href="chapter-8-model-comparison.html#cb191-5" aria-hidden="true" tabindex="-1"></a>mu.NotAfrica <span class="ot">&lt;-</span> <span class="fu">link</span>( m8<span class="fl">.2</span> ,</span>
<span id="cb191-6"><a href="chapter-8-model-comparison.html#cb191-6" aria-hidden="true" tabindex="-1"></a><span class="at">data=</span><span class="fu">data.frame</span>( <span class="at">cid=</span><span class="dv">2</span> , <span class="at">rugged_std=</span>rugged.seq ) )</span>
<span id="cb191-7"><a href="chapter-8-model-comparison.html#cb191-7" aria-hidden="true" tabindex="-1"></a><span class="co"># compute mu over samples, fixing cid=1</span></span>
<span id="cb191-8"><a href="chapter-8-model-comparison.html#cb191-8" aria-hidden="true" tabindex="-1"></a>mu.Africa <span class="ot">&lt;-</span> <span class="fu">link</span>( m8<span class="fl">.2</span> ,</span>
<span id="cb191-9"><a href="chapter-8-model-comparison.html#cb191-9" aria-hidden="true" tabindex="-1"></a><span class="at">data=</span><span class="fu">data.frame</span>( <span class="at">cid=</span><span class="dv">1</span> , <span class="at">rugged_std=</span>rugged.seq ) )</span>
<span id="cb191-10"><a href="chapter-8-model-comparison.html#cb191-10" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize to means and intervals</span></span>
<span id="cb191-11"><a href="chapter-8-model-comparison.html#cb191-11" aria-hidden="true" tabindex="-1"></a>mu.NotAfrica_mu <span class="ot">&lt;-</span> <span class="fu">apply</span>( mu.NotAfrica , <span class="dv">2</span> , mean )</span>
<span id="cb191-12"><a href="chapter-8-model-comparison.html#cb191-12" aria-hidden="true" tabindex="-1"></a>mu.NotAfrica_ci <span class="ot">&lt;-</span> <span class="fu">apply</span>( mu.NotAfrica , <span class="dv">2</span> , PI , <span class="at">prob=</span><span class="fl">0.97</span> )</span>
<span id="cb191-13"><a href="chapter-8-model-comparison.html#cb191-13" aria-hidden="true" tabindex="-1"></a>mu.Africa_mu <span class="ot">&lt;-</span> <span class="fu">apply</span>( mu.Africa , <span class="dv">2</span> , mean )</span>
<span id="cb191-14"><a href="chapter-8-model-comparison.html#cb191-14" aria-hidden="true" tabindex="-1"></a>mu.Africa_ci <span class="ot">&lt;-</span> <span class="fu">apply</span>( mu.Africa , <span class="dv">2</span> , PI , <span class="at">prob=</span><span class="fl">0.97</span> )</span></code></pre></div>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="chapter-8-model-comparison.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dd<span class="sc">$</span>log_gdp,dd<span class="sc">$</span>rugged,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.7</span>,<span class="fl">1.4</span>))</span>
<span id="cb192-2"><a href="chapter-8-model-comparison.html#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb192-3"><a href="chapter-8-model-comparison.html#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(mu.NotAfrica_mu,<span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb192-4"><a href="chapter-8-model-comparison.html#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(mu.Africa_mu,<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-102-1.png" width="720" style="display: block; margin: auto;" /></p>
<p><strong><em>Thus we see that it is far better including an index instead of a dummy variable!!!</em></strong></p>
</div>
</div>
<div id="symmetry-of-interactions" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Symmetry of interactions</h2>
<p>About the index approach.</p>
</div>
<div id="continuous-interactions" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Continuous interactions</h2>
<div id="a-winter-flower" class="section level3" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> A Winter Flower</h3>
<p>This is an example with a flower that depends on sun and water to make photosynthesis, although having only one of the two is not useful at all, hence we need to deal with this using an interaction.</p>
<p>This is the data:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="chapter-8-model-comparison.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb193-2"><a href="chapter-8-model-comparison.html#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(tulips)</span>
<span id="cb193-3"><a href="chapter-8-model-comparison.html#cb193-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> tulips</span>
<span id="cb193-4"><a href="chapter-8-model-comparison.html#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(d)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    27 obs. of  4 variables:
##  $ bed   : Factor w/ 3 levels &quot;a&quot;,&quot;b&quot;,&quot;c&quot;: 1 1 1 1 1 1 1 1 1 2 ...
##  $ water : int  1 1 1 2 2 2 3 3 3 1 ...
##  $ shade : int  1 2 3 1 2 3 1 2 3 1 ...
##  $ blooms: num  0 0 111 183.5 59.2 ...</code></pre>
</div>
<div id="the-models" class="section level3" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> The models</h3>
<p>We are going to center W (water) and S (shade).</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="chapter-8-model-comparison.html#cb195-1" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>blooms_std <span class="ot">&lt;-</span> d<span class="sc">$</span>blooms <span class="sc">/</span> <span class="fu">max</span>(d<span class="sc">$</span>blooms)</span>
<span id="cb195-2"><a href="chapter-8-model-comparison.html#cb195-2" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>water_cent <span class="ot">&lt;-</span> d<span class="sc">$</span>water <span class="sc">-</span> <span class="fu">mean</span>(d<span class="sc">$</span>water)</span>
<span id="cb195-3"><a href="chapter-8-model-comparison.html#cb195-3" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>shade_cent <span class="ot">&lt;-</span> d<span class="sc">$</span>shade <span class="sc">-</span> <span class="fu">mean</span>(d<span class="sc">$</span>shade)</span></code></pre></div>
<p>We have the non centered model:</p>
<p><img src="Images/paste-6F1AC3F9.png" width="215" /></p>
<p>We set the priors to <em>(we correct the sd in the following)</em>:</p>
<p><img src="Images/paste-CEB9D029.png" width="114" /></p>
<p>Alpha = 0.5 means that when shade and sun is at its mean, the model expects blooms to be halfway to the observed maximum.</p>
<p>We see that the slopes (betas) for W and S is 0, meaning that we have no idea if there is going to be relatively more shade or water, hence it will just be centered at 0.</p>
<p><em>But what does the standard deviation of 1 imply?</em></p>
<p>We see that the blooming should not go below 0 and above 1. Lets us inspect the alpha parameter and what the prior expects to see.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="chapter-8-model-comparison.html#cb196-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fl">1e4</span> ,<span class="at">mean =</span> <span class="fl">0.5</span> ,<span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb196-2"><a href="chapter-8-model-comparison.html#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Intercept alpha less than 0 and higher than 1</span></span>
<span id="cb196-3"><a href="chapter-8-model-comparison.html#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>( a <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> a <span class="sc">&gt;</span> <span class="dv">1</span> ) <span class="sc">/</span> <span class="fu">length</span>( a )</span></code></pre></div>
<pre><code>## [1] 0.6189</code></pre>
<p>It implies that the priors assign most of the probability outside of the range of 0 to 1. Hence we try to constrain the priors a bit:</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="chapter-8-model-comparison.html#cb198-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fl">1e4</span>,<span class="at">mean =</span> <span class="fl">0.5</span>,<span class="at">sd =</span> <span class="fl">0.25</span>)</span>
<span id="cb198-2"><a href="chapter-8-model-comparison.html#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>( a <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> a <span class="sc">&gt;</span> <span class="dv">1</span> ) <span class="sc">/</span> <span class="fu">length</span>( a )</span></code></pre></div>
<pre><code>## [1] 0.0443</code></pre>
<p>Now we see that only 5% is less than 0 and higher than 1. That is much better. Notice that we want to allow the model to reach the edges and probably go a bit above / below so we can fit data within this region.</p>
<p>Regarding the beta values we see that the</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="chapter-8-model-comparison.html#cb200-1" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fl">1e4</span>,<span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb200-2"><a href="chapter-8-model-comparison.html#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(bw,<span class="at">main =</span> <span class="st">&quot;bw prior&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-103-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We also see that</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="chapter-8-model-comparison.html#cb201-1" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fl">1e4</span>,<span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="fl">0.25</span>)</span>
<span id="cb201-2"><a href="chapter-8-model-comparison.html#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(bw,<span class="at">main =</span> <span class="st">&quot;bw prior&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-104-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Now we see that the PI for 95% is between -0.5 and 0.5.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="chapter-8-model-comparison.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PI</span>(<span class="at">samples =</span> bw,<span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##         3%        98% 
## -0.4858059  0.4828205</code></pre>
<p>In general <strong>the goal</strong> of the priors in this example is to set priors with weak information but also constrain the model from overfitting.</p>
<p>The is how the model looks when finalized:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="chapter-8-model-comparison.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Non interaction model!</span></span>
<span id="cb204-2"><a href="chapter-8-model-comparison.html#cb204-2" aria-hidden="true" tabindex="-1"></a>m8<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb204-3"><a href="chapter-8-model-comparison.html#cb204-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb204-4"><a href="chapter-8-model-comparison.html#cb204-4" aria-hidden="true" tabindex="-1"></a>    blooms_std <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) ,</span>
<span id="cb204-5"><a href="chapter-8-model-comparison.html#cb204-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bw<span class="sc">*</span>water_cent <span class="sc">+</span> bs<span class="sc">*</span>shade_cent ,</span>
<span id="cb204-6"><a href="chapter-8-model-comparison.html#cb204-6" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="fl">0.5</span> , <span class="fl">0.25</span> ) ,</span>
<span id="cb204-7"><a href="chapter-8-model-comparison.html#cb204-7" aria-hidden="true" tabindex="-1"></a>    bw <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.25</span> ) ,</span>
<span id="cb204-8"><a href="chapter-8-model-comparison.html#cb204-8" aria-hidden="true" tabindex="-1"></a>    bs <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.25</span> ) ,</span>
<span id="cb204-9"><a href="chapter-8-model-comparison.html#cb204-9" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb204-10"><a href="chapter-8-model-comparison.html#cb204-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb204-11"><a href="chapter-8-model-comparison.html#cb204-11" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data=</span>d )</span>
<span id="cb204-12"><a href="chapter-8-model-comparison.html#cb204-12" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m8<span class="fl">.4</span>)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3587658</td>
</tr>
<tr class="even">
<td align="right">0.2050338</td>
</tr>
<tr class="odd">
<td align="right">-0.1125315</td>
</tr>
<tr class="even">
<td align="right">0.1581543</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0302189</td>
</tr>
<tr class="even">
<td align="right">0.0368895</td>
</tr>
<tr class="odd">
<td align="right">0.0368757</td>
</tr>
<tr class="even">
<td align="right">0.0214437</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3104702</td>
</tr>
<tr class="even">
<td align="right">0.1460771</td>
</tr>
<tr class="odd">
<td align="right">-0.1714660</td>
</tr>
<tr class="even">
<td align="right">0.1238831</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.4070615</td>
</tr>
<tr class="even">
<td align="right">0.2639904</td>
</tr>
<tr class="odd">
<td align="right">-0.0535971</td>
</tr>
<tr class="even">
<td align="right">0.1924255</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Building the interaction model</strong></p>
<p>The model now look like this:</p>
<p><img src="Images/paste-0ABEB8AB.png" width="242" /></p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="chapter-8-model-comparison.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co">#With interaction</span></span>
<span id="cb205-2"><a href="chapter-8-model-comparison.html#cb205-2" aria-hidden="true" tabindex="-1"></a>m8<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb205-3"><a href="chapter-8-model-comparison.html#cb205-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb205-4"><a href="chapter-8-model-comparison.html#cb205-4" aria-hidden="true" tabindex="-1"></a>    blooms_std <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) ,</span>
<span id="cb205-5"><a href="chapter-8-model-comparison.html#cb205-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bw<span class="sc">*</span>water_cent <span class="sc">+</span> bs<span class="sc">*</span>shade_cent <span class="sc">+</span> bws<span class="sc">*</span>water_cent<span class="sc">*</span>shade_cent ,</span>
<span id="cb205-6"><a href="chapter-8-model-comparison.html#cb205-6" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="fl">0.5</span> , <span class="fl">0.25</span> ) ,</span>
<span id="cb205-7"><a href="chapter-8-model-comparison.html#cb205-7" aria-hidden="true" tabindex="-1"></a>    bw <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.25</span> ) ,</span>
<span id="cb205-8"><a href="chapter-8-model-comparison.html#cb205-8" aria-hidden="true" tabindex="-1"></a>    bs <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.25</span> ) ,</span>
<span id="cb205-9"><a href="chapter-8-model-comparison.html#cb205-9" aria-hidden="true" tabindex="-1"></a>    bws <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.25</span> ) ,</span>
<span id="cb205-10"><a href="chapter-8-model-comparison.html#cb205-10" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb205-11"><a href="chapter-8-model-comparison.html#cb205-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb205-12"><a href="chapter-8-model-comparison.html#cb205-12" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data =</span> d)</span></code></pre></div>
</div>
<div id="plotting-posterior-predictions" class="section level3" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> Plotting posterior predictions</h3>
<p>To do this, we must:</p>
<ol style="list-style-type: decimal">
<li>Draw samples from</li>
</ol>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="chapter-8-model-comparison.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting the non interaction model</span></span>
<span id="cb206-2"><a href="chapter-8-model-comparison.html#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)) <span class="co"># 3 plots in 1 row</span></span>
<span id="cb206-3"><a href="chapter-8-model-comparison.html#cb206-3" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(m8<span class="fl">.4</span>,m8<span class="fl">.5</span>)</span>
<span id="cb206-4"><a href="chapter-8-model-comparison.html#cb206-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(m <span class="cf">in</span> models){</span>
<span id="cb206-5"><a href="chapter-8-model-comparison.html#cb206-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(s <span class="cf">in</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) {</span>
<span id="cb206-6"><a href="chapter-8-model-comparison.html#cb206-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb206-7"><a href="chapter-8-model-comparison.html#cb206-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Create index of observations given the shade level</span></span>
<span id="cb206-8"><a href="chapter-8-model-comparison.html#cb206-8" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> <span class="fu">which</span>(d<span class="sc">$</span>shade_cent<span class="sc">==</span>s) <span class="co">#We have three levels -1, 0 and 1.</span></span>
<span id="cb206-9"><a href="chapter-8-model-comparison.html#cb206-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb206-10"><a href="chapter-8-model-comparison.html#cb206-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Plot each water levels given the shade level</span></span>
<span id="cb206-11"><a href="chapter-8-model-comparison.html#cb206-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(d<span class="sc">$</span>water_cent[idx] </span>
<span id="cb206-12"><a href="chapter-8-model-comparison.html#cb206-12" aria-hidden="true" tabindex="-1"></a>         ,d<span class="sc">$</span>blooms_std[idx] </span>
<span id="cb206-13"><a href="chapter-8-model-comparison.html#cb206-13" aria-hidden="true" tabindex="-1"></a>         ,<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb206-14"><a href="chapter-8-model-comparison.html#cb206-14" aria-hidden="true" tabindex="-1"></a>         ,<span class="at">xlab=</span><span class="st">&quot;water&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;blooms&quot;</span></span>
<span id="cb206-15"><a href="chapter-8-model-comparison.html#cb206-15" aria-hidden="true" tabindex="-1"></a>         ,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span>rangi2</span>
<span id="cb206-16"><a href="chapter-8-model-comparison.html#cb206-16" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb206-17"><a href="chapter-8-model-comparison.html#cb206-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb206-18"><a href="chapter-8-model-comparison.html#cb206-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Draw samples</span></span>
<span id="cb206-19"><a href="chapter-8-model-comparison.html#cb206-19" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> <span class="fu">link</span>(m <span class="co">#Non interaction model</span></span>
<span id="cb206-20"><a href="chapter-8-model-comparison.html#cb206-20" aria-hidden="true" tabindex="-1"></a>               ,<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">shade_cent=</span>s,<span class="at">water_cent=</span><span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>))</span>
<span id="cb206-21"><a href="chapter-8-model-comparison.html#cb206-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb206-22"><a href="chapter-8-model-comparison.html#cb206-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Plotting 20 posterior lines</span></span>
<span id="cb206-23"><a href="chapter-8-model-comparison.html#cb206-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) </span>
<span id="cb206-24"><a href="chapter-8-model-comparison.html#cb206-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lines</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>,<span class="at">y =</span> mu[i,]</span>
<span id="cb206-25"><a href="chapter-8-model-comparison.html#cb206-25" aria-hidden="true" tabindex="-1"></a>            ,<span class="at">col=</span><span class="fu">col.alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.3</span>))</span>
<span id="cb206-26"><a href="chapter-8-model-comparison.html#cb206-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb206-27"><a href="chapter-8-model-comparison.html#cb206-27" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-106"></span>
<img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-106-1.png" alt="Top row = no interaction model, bottum row = innteraction model." width="720" />
<p class="caption">
Figure 9.1: Top row = no interaction model, bottum row = innteraction model.
</p>
</div>
</div>
<div id="plotting-prior-predictions" class="section level3" number="9.3.4">
<h3><span class="header-section-number">9.3.4</span> Plotting prior predictions</h3>
<p>Now we are going to extract priors to plot these.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="chapter-8-model-comparison.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb207-2"><a href="chapter-8-model-comparison.html#cb207-2" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">extract.prior</span>(m8<span class="fl">.5</span>)</span></code></pre></div>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="chapter-8-model-comparison.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting the non interaction model</span></span>
<span id="cb208-2"><a href="chapter-8-model-comparison.html#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)) <span class="co"># 3 plots in 1 row</span></span>
<span id="cb208-3"><a href="chapter-8-model-comparison.html#cb208-3" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(m8<span class="fl">.4</span>,m8<span class="fl">.5</span>)</span>
<span id="cb208-4"><a href="chapter-8-model-comparison.html#cb208-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(m <span class="cf">in</span> models){</span>
<span id="cb208-5"><a href="chapter-8-model-comparison.html#cb208-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(s <span class="cf">in</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) {</span>
<span id="cb208-6"><a href="chapter-8-model-comparison.html#cb208-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-7"><a href="chapter-8-model-comparison.html#cb208-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Create index of observations given the shade level</span></span>
<span id="cb208-8"><a href="chapter-8-model-comparison.html#cb208-8" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> <span class="fu">which</span>(d<span class="sc">$</span>shade_cent<span class="sc">==</span>s) <span class="co">#We have three levels -1, 0 and 1.</span></span>
<span id="cb208-9"><a href="chapter-8-model-comparison.html#cb208-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-10"><a href="chapter-8-model-comparison.html#cb208-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Plot each water levels given the shade level</span></span>
<span id="cb208-11"><a href="chapter-8-model-comparison.html#cb208-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(d<span class="sc">$</span>water_cent[idx] </span>
<span id="cb208-12"><a href="chapter-8-model-comparison.html#cb208-12" aria-hidden="true" tabindex="-1"></a>         ,d<span class="sc">$</span>blooms_std[idx] </span>
<span id="cb208-13"><a href="chapter-8-model-comparison.html#cb208-13" aria-hidden="true" tabindex="-1"></a>         ,<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">1.5</span>)</span>
<span id="cb208-14"><a href="chapter-8-model-comparison.html#cb208-14" aria-hidden="true" tabindex="-1"></a>         ,<span class="at">xlab=</span><span class="st">&quot;water&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;blooms&quot;</span></span>
<span id="cb208-15"><a href="chapter-8-model-comparison.html#cb208-15" aria-hidden="true" tabindex="-1"></a>         ,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span>rangi2</span>
<span id="cb208-16"><a href="chapter-8-model-comparison.html#cb208-16" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb208-17"><a href="chapter-8-model-comparison.html#cb208-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb208-18"><a href="chapter-8-model-comparison.html#cb208-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-19"><a href="chapter-8-model-comparison.html#cb208-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Draw samples</span></span>
<span id="cb208-20"><a href="chapter-8-model-comparison.html#cb208-20" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> <span class="fu">link</span>(m <span class="co">#Non interaction model</span></span>
<span id="cb208-21"><a href="chapter-8-model-comparison.html#cb208-21" aria-hidden="true" tabindex="-1"></a>               ,<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">shade_cent=</span>s,<span class="at">water_cent=</span><span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb208-22"><a href="chapter-8-model-comparison.html#cb208-22" aria-hidden="true" tabindex="-1"></a>               ,<span class="at">post =</span> prior)</span>
<span id="cb208-23"><a href="chapter-8-model-comparison.html#cb208-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-24"><a href="chapter-8-model-comparison.html#cb208-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Plotting 20 prior lines</span></span>
<span id="cb208-25"><a href="chapter-8-model-comparison.html#cb208-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) </span>
<span id="cb208-26"><a href="chapter-8-model-comparison.html#cb208-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lines</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>,<span class="at">y =</span> mu[i,]</span>
<span id="cb208-27"><a href="chapter-8-model-comparison.html#cb208-27" aria-hidden="true" tabindex="-1"></a>            ,<span class="at">col=</span><span class="fu">col.alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.3</span>))</span>
<span id="cb208-28"><a href="chapter-8-model-comparison.html#cb208-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb208-29"><a href="chapter-8-model-comparison.html#cb208-29" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-107"></span>
<img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-107-1.png" alt="Top row = no interaction model, bottum row = innteraction model." width="720" />
<p class="caption">
Figure 9.2: Top row = no interaction model, bottum row = innteraction model.
</p>
</div>
<p>We see that the priors both for the interaction and no interaction model is typically within the limits, so that is good.</p>
<p>We can say that the priors are:</p>
<ul>
<li><p>Harmless</p></li>
<li><p>Weakly realistic</p></li>
<li><p>The priors include non or very low bias to positive or negative effects as most things can happen, although the priors tend to be in a reasonable range, hence we are doing better then a flat prior, but we do not include much information either.</p></li>
</ul>
</div>
</div>
<div id="exercises-4" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Exercises</h2>
<div id="m4-1" class="section level3" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> 8M4</h3>
<p>Repeat the tulips analysis, but this time use priors that constrain the effect of water to be positive and the effect of shade to be negative. Use prior predictive simulation. What do these prior assumptions mean for the interaction prior, if anything?</p>
<p>Notes:</p>
<p>Need to be changed, so the prior distribution is higher than 0 and less than 0, thus the distribution of the two distributions must be on each side of 0.</p>
<p>We can do this by manipulating the mean or the standard deviation of the dsitruibutions.</p>
<p>There are two difficulties with this:</p>
<ul>
<li>You can end up having an unrealistic mean. To avoid that, you can manipulate the standard deviation, although that may make too much certainty</li>
<li>Also a normal distribution will never be strictly within some region, as it never touches 0.</li>
</ul>
<p>Thus we can use an exponential distribution, although that only has one tail. Thus we can make a log normal distribution instead.</p>
<p>The model is from code chunk 8.24 - m8.5.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="chapter-8-model-comparison.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Loading data</span></span>
<span id="cb209-2"><a href="chapter-8-model-comparison.html#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb209-3"><a href="chapter-8-model-comparison.html#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;tulips&quot;</span>)</span>
<span id="cb209-4"><a href="chapter-8-model-comparison.html#cb209-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> tulips</span>
<span id="cb209-5"><a href="chapter-8-model-comparison.html#cb209-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-6"><a href="chapter-8-model-comparison.html#cb209-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; water and shade variables are three levels, ordered after amount of water/shade.</span></span>
<span id="cb209-7"><a href="chapter-8-model-comparison.html#cb209-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; Cluster of plants in the same section of the greenhouse.</span></span>
<span id="cb209-8"><a href="chapter-8-model-comparison.html#cb209-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; Blooms = the outcome variable which we have to predict.</span></span>
<span id="cb209-9"><a href="chapter-8-model-comparison.html#cb209-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb209-10"><a href="chapter-8-model-comparison.html#cb209-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Transforming the data</span></span>
<span id="cb209-11"><a href="chapter-8-model-comparison.html#cb209-11" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>blooms_std <span class="ot">&lt;-</span> d<span class="sc">$</span>blooms <span class="sc">/</span> <span class="fu">max</span>(d<span class="sc">$</span>blooms)</span>
<span id="cb209-12"><a href="chapter-8-model-comparison.html#cb209-12" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>water_cent <span class="ot">&lt;-</span> d<span class="sc">$</span>water <span class="sc">-</span> <span class="fu">mean</span>(d<span class="sc">$</span>water)</span>
<span id="cb209-13"><a href="chapter-8-model-comparison.html#cb209-13" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>shade_cent <span class="ot">&lt;-</span> d<span class="sc">$</span>shade <span class="sc">-</span> <span class="fu">mean</span>(d<span class="sc">$</span>shade)</span></code></pre></div>
<div id="interaction-model" class="section level4" number="9.4.1.1">
<h4><span class="header-section-number">9.4.1.1</span> Interaction model</h4>
<p><strong>Model specification</strong></p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="chapter-8-model-comparison.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The model</span></span>
<span id="cb210-2"><a href="chapter-8-model-comparison.html#cb210-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb210-3"><a href="chapter-8-model-comparison.html#cb210-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb210-4"><a href="chapter-8-model-comparison.html#cb210-4" aria-hidden="true" tabindex="-1"></a>    blooms_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu,sigma),</span>
<span id="cb210-5"><a href="chapter-8-model-comparison.html#cb210-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bw <span class="sc">*</span> water_cent <span class="sc">-</span> bs <span class="sc">*</span> shade_cent <span class="sc">+</span> bws <span class="sc">*</span> water_cent <span class="sc">*</span> shade_cent, <span class="co">#Notice there is minus bs</span></span>
<span id="cb210-6"><a href="chapter-8-model-comparison.html#cb210-6" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="fl">0.5</span>,<span class="fl">0.25</span>),</span>
<span id="cb210-7"><a href="chapter-8-model-comparison.html#cb210-7" aria-hidden="true" tabindex="-1"></a>    bw <span class="sc">~</span> <span class="fu">dlnorm</span>(<span class="dv">0</span>,<span class="fl">0.25</span>),</span>
<span id="cb210-8"><a href="chapter-8-model-comparison.html#cb210-8" aria-hidden="true" tabindex="-1"></a>    bs <span class="sc">~</span> <span class="fu">dlnorm</span>(<span class="dv">0</span>,<span class="fl">0.25</span>),</span>
<span id="cb210-9"><a href="chapter-8-model-comparison.html#cb210-9" aria-hidden="true" tabindex="-1"></a>    bws <span class="sc">~</span> <span class="fu">dlnorm</span>(<span class="dv">0</span>,<span class="fl">0.25</span>),</span>
<span id="cb210-10"><a href="chapter-8-model-comparison.html#cb210-10" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb210-11"><a href="chapter-8-model-comparison.html#cb210-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb210-12"><a href="chapter-8-model-comparison.html#cb210-12" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data =</span> d</span>
<span id="cb210-13"><a href="chapter-8-model-comparison.html#cb210-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb210-14"><a href="chapter-8-model-comparison.html#cb210-14" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3822041</td>
</tr>
<tr class="even">
<td align="right">0.5410913</td>
</tr>
<tr class="odd">
<td align="right">0.5081694</td>
</tr>
<tr class="even">
<td align="right">0.4926979</td>
</tr>
<tr class="odd">
<td align="right">0.6048014</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1058485</td>
</tr>
<tr class="even">
<td align="right">0.0990471</td>
</tr>
<tr class="odd">
<td align="right">0.0967641</td>
</tr>
<tr class="even">
<td align="right">0.1027979</td>
</tr>
<tr class="odd">
<td align="right">0.1203730</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.2130377</td>
</tr>
<tr class="even">
<td align="right">0.3827949</td>
</tr>
<tr class="odd">
<td align="right">0.3535217</td>
</tr>
<tr class="even">
<td align="right">0.3284070</td>
</tr>
<tr class="odd">
<td align="right">0.4124220</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.5513704</td>
</tr>
<tr class="even">
<td align="right">0.6993877</td>
</tr>
<tr class="odd">
<td align="right">0.6628172</td>
</tr>
<tr class="even">
<td align="right">0.6569888</td>
</tr>
<tr class="odd">
<td align="right">0.7971807</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>We see that the more shade, the less blooms and the more water the more blooms. Although the combination of water and shade will lead to less blooms, I guess because the plant will be drowning in water.</p>
<p><strong>Prior predictive simulation</strong></p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="chapter-8-model-comparison.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb211-2"><a href="chapter-8-model-comparison.html#cb211-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-3"><a href="chapter-8-model-comparison.html#cb211-3" aria-hidden="true" tabindex="-1"></a>simulations <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb211-4"><a href="chapter-8-model-comparison.html#cb211-4" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">extract.prior</span>(m)</span>
<span id="cb211-5"><a href="chapter-8-model-comparison.html#cb211-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-6"><a href="chapter-8-model-comparison.html#cb211-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) {</span>
<span id="cb211-7"><a href="chapter-8-model-comparison.html#cb211-7" aria-hidden="true" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> <span class="fu">which</span>(d<span class="sc">$</span>shade_cent <span class="sc">==</span> s)</span>
<span id="cb211-8"><a href="chapter-8-model-comparison.html#cb211-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> d<span class="sc">$</span>water_cent[idx]</span>
<span id="cb211-9"><a href="chapter-8-model-comparison.html#cb211-9" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">y =</span> d<span class="sc">$</span>blooms[idx]</span>
<span id="cb211-10"><a href="chapter-8-model-comparison.html#cb211-10" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">1.5</span>)</span>
<span id="cb211-11"><a href="chapter-8-model-comparison.html#cb211-11" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">xlab =</span> <span class="st">&quot;water&quot;</span></span>
<span id="cb211-12"><a href="chapter-8-model-comparison.html#cb211-12" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">ylab =</span> <span class="st">&quot;blooms&quot;</span></span>
<span id="cb211-13"><a href="chapter-8-model-comparison.html#cb211-13" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">pch =</span> <span class="dv">16</span></span>
<span id="cb211-14"><a href="chapter-8-model-comparison.html#cb211-14" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">col =</span> rangi2</span>
<span id="cb211-15"><a href="chapter-8-model-comparison.html#cb211-15" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Priors predictive simulation, S = &quot;</span>,s)</span>
<span id="cb211-16"><a href="chapter-8-model-comparison.html#cb211-16" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb211-17"><a href="chapter-8-model-comparison.html#cb211-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb211-18"><a href="chapter-8-model-comparison.html#cb211-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb211-19"><a href="chapter-8-model-comparison.html#cb211-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Call link function to make predictions</span></span>
<span id="cb211-20"><a href="chapter-8-model-comparison.html#cb211-20" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="fu">link</span>(<span class="at">fit =</span> m</span>
<span id="cb211-21"><a href="chapter-8-model-comparison.html#cb211-21" aria-hidden="true" tabindex="-1"></a>             ,<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">shade_cent =</span> s, <span class="at">water_cent =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb211-22"><a href="chapter-8-model-comparison.html#cb211-22" aria-hidden="true" tabindex="-1"></a>             ,<span class="at">post =</span> prior <span class="co">#posterior is just the prior, hence we introduce no data</span></span>
<span id="cb211-23"><a href="chapter-8-model-comparison.html#cb211-23" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb211-24"><a href="chapter-8-model-comparison.html#cb211-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>simulations) {</span>
<span id="cb211-25"><a href="chapter-8-model-comparison.html#cb211-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span></span>
<span id="cb211-26"><a href="chapter-8-model-comparison.html#cb211-26" aria-hidden="true" tabindex="-1"></a>          ,mu[i,]</span>
<span id="cb211-27"><a href="chapter-8-model-comparison.html#cb211-27" aria-hidden="true" tabindex="-1"></a>          ,<span class="at">col =</span> <span class="fu">col.alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.3</span>)</span>
<span id="cb211-28"><a href="chapter-8-model-comparison.html#cb211-28" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb211-29"><a href="chapter-8-model-comparison.html#cb211-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb211-30"><a href="chapter-8-model-comparison.html#cb211-30" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-110-1.png" width="720" style="display: block; margin: auto;" /><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-110-2.png" width="720" style="display: block; margin: auto;" /><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-110-3.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that we are going to regularize the priors even more, to make better priors.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="chapter-8-model-comparison.html#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The model </span></span>
<span id="cb212-2"><a href="chapter-8-model-comparison.html#cb212-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb212-3"><a href="chapter-8-model-comparison.html#cb212-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb212-4"><a href="chapter-8-model-comparison.html#cb212-4" aria-hidden="true" tabindex="-1"></a>    blooms_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu,sigma),</span>
<span id="cb212-5"><a href="chapter-8-model-comparison.html#cb212-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bw <span class="sc">*</span> water_cent <span class="sc">-</span> bs <span class="sc">*</span> shade_cent <span class="sc">+</span> bws <span class="sc">*</span> water_cent <span class="sc">*</span> shade_cent, <span class="co">#Notice there is minus bs</span></span>
<span id="cb212-6"><a href="chapter-8-model-comparison.html#cb212-6" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="fl">0.5</span>,<span class="fl">0.25</span>),</span>
<span id="cb212-7"><a href="chapter-8-model-comparison.html#cb212-7" aria-hidden="true" tabindex="-1"></a>    bw <span class="sc">~</span> <span class="fu">dlnorm</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fl">0.25</span>), <span class="co">#Set mean to -2</span></span>
<span id="cb212-8"><a href="chapter-8-model-comparison.html#cb212-8" aria-hidden="true" tabindex="-1"></a>    bs <span class="sc">~</span> <span class="fu">dlnorm</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fl">0.25</span>), <span class="co">#Set mean to -2</span></span>
<span id="cb212-9"><a href="chapter-8-model-comparison.html#cb212-9" aria-hidden="true" tabindex="-1"></a>    bws <span class="sc">~</span> <span class="fu">dlnorm</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fl">0.25</span>), <span class="co">#Set mean to -2</span></span>
<span id="cb212-10"><a href="chapter-8-model-comparison.html#cb212-10" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb212-11"><a href="chapter-8-model-comparison.html#cb212-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-12"><a href="chapter-8-model-comparison.html#cb212-12" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data =</span> d</span>
<span id="cb212-13"><a href="chapter-8-model-comparison.html#cb212-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-14"><a href="chapter-8-model-comparison.html#cb212-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-15"><a href="chapter-8-model-comparison.html#cb212-15" aria-hidden="true" tabindex="-1"></a>simulations <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb212-16"><a href="chapter-8-model-comparison.html#cb212-16" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">extract.prior</span>(m)</span>
<span id="cb212-17"><a href="chapter-8-model-comparison.html#cb212-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-18"><a href="chapter-8-model-comparison.html#cb212-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) {</span>
<span id="cb212-19"><a href="chapter-8-model-comparison.html#cb212-19" aria-hidden="true" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> <span class="fu">which</span>(d<span class="sc">$</span>shade_cent <span class="sc">==</span> s)</span>
<span id="cb212-20"><a href="chapter-8-model-comparison.html#cb212-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> d<span class="sc">$</span>water_cent[idx]</span>
<span id="cb212-21"><a href="chapter-8-model-comparison.html#cb212-21" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">y =</span> d<span class="sc">$</span>blooms[idx]</span>
<span id="cb212-22"><a href="chapter-8-model-comparison.html#cb212-22" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">1.5</span>)</span>
<span id="cb212-23"><a href="chapter-8-model-comparison.html#cb212-23" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">xlab =</span> <span class="st">&quot;water&quot;</span></span>
<span id="cb212-24"><a href="chapter-8-model-comparison.html#cb212-24" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">ylab =</span> <span class="st">&quot;blooms&quot;</span></span>
<span id="cb212-25"><a href="chapter-8-model-comparison.html#cb212-25" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">pch =</span> <span class="dv">16</span></span>
<span id="cb212-26"><a href="chapter-8-model-comparison.html#cb212-26" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">col =</span> rangi2</span>
<span id="cb212-27"><a href="chapter-8-model-comparison.html#cb212-27" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Priors predictive simulation, S = &quot;</span>,s)</span>
<span id="cb212-28"><a href="chapter-8-model-comparison.html#cb212-28" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb212-29"><a href="chapter-8-model-comparison.html#cb212-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb212-30"><a href="chapter-8-model-comparison.html#cb212-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb212-31"><a href="chapter-8-model-comparison.html#cb212-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Call link function to make predictions</span></span>
<span id="cb212-32"><a href="chapter-8-model-comparison.html#cb212-32" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="fu">link</span>(<span class="at">fit =</span> m</span>
<span id="cb212-33"><a href="chapter-8-model-comparison.html#cb212-33" aria-hidden="true" tabindex="-1"></a>             ,<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">shade_cent =</span> s, <span class="at">water_cent =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb212-34"><a href="chapter-8-model-comparison.html#cb212-34" aria-hidden="true" tabindex="-1"></a>             ,<span class="at">post =</span> prior <span class="co">#posterior is just the prior, hence we introduce no data</span></span>
<span id="cb212-35"><a href="chapter-8-model-comparison.html#cb212-35" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb212-36"><a href="chapter-8-model-comparison.html#cb212-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>simulations) {</span>
<span id="cb212-37"><a href="chapter-8-model-comparison.html#cb212-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span></span>
<span id="cb212-38"><a href="chapter-8-model-comparison.html#cb212-38" aria-hidden="true" tabindex="-1"></a>          ,mu[i,]</span>
<span id="cb212-39"><a href="chapter-8-model-comparison.html#cb212-39" aria-hidden="true" tabindex="-1"></a>          ,<span class="at">col =</span> <span class="fu">col.alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.3</span>)</span>
<span id="cb212-40"><a href="chapter-8-model-comparison.html#cb212-40" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb212-41"><a href="chapter-8-model-comparison.html#cb212-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb212-42"><a href="chapter-8-model-comparison.html#cb212-42" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-111-1.png" width="720" style="display: block; margin: auto;" /><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-111-2.png" width="720" style="display: block; margin: auto;" /><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-111-3.png" width="720" style="display: block; margin: auto;" /></p>
</div>
<div id="conclusion" class="section level4" number="9.4.1.2">
<h4><span class="header-section-number">9.4.1.2</span> Conclusion</h4>
<p>We see that the regularized priors are more realistic.</p>
<p><strong>Never plot the priors with the actual data points, that is just done for practical reasons.</strong></p>
</div>
</div>
<div id="h3-3" class="section level3" number="9.4.2">
<h3><span class="header-section-number">9.4.2</span> 8H3</h3>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-7-model-comparison.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter-9-markov-chain-monte-carlo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
