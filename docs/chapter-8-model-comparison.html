<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Chapter 8 - Model comparison | Bayesian Data Analysis Notes</title>
  <meta name="description" content="9 Chapter 8 - Model comparison | Bayesian Data Analysis Notes" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Chapter 8 - Model comparison | Bayesian Data Analysis Notes" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Chapter 8 - Model comparison | Bayesian Data Analysis Notes" />
  
  
  

<meta name="author" content="Jonas Ringive Korsholm" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-7-model-comparison.html"/>
<link rel="next" href="chapter-9-markov-chain-monte-carlo.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="chapter-1-golems-of-prague.html"><a href="chapter-1-golems-of-prague.html"><i class="fa fa-check"></i><b>1</b> Chapter 1 - Golems of Prague</a></li>
<li class="chapter" data-level="2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html"><i class="fa fa-check"></i><b>2</b> Chapter 2 - Small worlds and Large Worlds</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#models-and-estimation"><i class="fa fa-check"></i><b>2.1</b> Models and Estimation</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#engines-motors-to-estimate-the-models"><i class="fa fa-check"></i><b>2.1.1</b> Engines / Motors to estimate the models</a>
<ul>
<li class="chapter" data-level="2.1.1.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#grid-approximation"><i class="fa fa-check"></i><b>2.1.1.1</b> Grid approximation</a></li>
<li class="chapter" data-level="2.1.1.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#quadratic-approximation"><i class="fa fa-check"></i><b>2.1.1.2</b> Quadratic approximation</a></li>
<li class="chapter" data-level="2.1.1.3" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#markov-chain-monte-carlo"><i class="fa fa-check"></i><b>2.1.1.3</b> Markov Chain Monte Carlo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#exercises"><i class="fa fa-check"></i><b>2.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#m1"><i class="fa fa-check"></i><b>2.2.1</b> 2M1</a></li>
<li class="chapter" data-level="2.2.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#m2"><i class="fa fa-check"></i><b>2.2.2</b> 2M2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html"><i class="fa fa-check"></i><b>3</b> Chapter 3 - Sampling the Imaginary</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-from-a-grid-approximate-posterior"><i class="fa fa-check"></i><b>3.1</b> Sampling from a grid-approximate posterior</a></li>
<li class="chapter" data-level="3.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-to-summarize"><i class="fa fa-check"></i><b>3.2</b> Sampling to summarize</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#defined-boundaries"><i class="fa fa-check"></i><b>3.2.1</b> Defined Boundaries</a></li>
<li class="chapter" data-level="3.2.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#defined-probability-mass"><i class="fa fa-check"></i><b>3.2.2</b> Defined Probability Mass</a></li>
<li class="chapter" data-level="3.2.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#point-estimates"><i class="fa fa-check"></i><b>3.2.3</b> Point Estimates</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-to-simulate-prediction"><i class="fa fa-check"></i><b>3.3</b> Sampling to simulate prediction</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#dummy-data"><i class="fa fa-check"></i><b>3.3.1</b> Dummy Data</a></li>
<li class="chapter" data-level="3.3.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#model-checking"><i class="fa fa-check"></i><b>3.3.2</b> Model Checking</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#exercises-1"><i class="fa fa-check"></i><b>3.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m1-1"><i class="fa fa-check"></i><b>3.4.1</b> 3M1</a></li>
<li class="chapter" data-level="3.4.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m2-1"><i class="fa fa-check"></i><b>3.4.2</b> 3M2</a></li>
<li class="chapter" data-level="3.4.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m3"><i class="fa fa-check"></i><b>3.4.3</b> 3M3</a></li>
<li class="chapter" data-level="3.4.4" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m4"><i class="fa fa-check"></i><b>3.4.4</b> 3M4</a></li>
<li class="chapter" data-level="3.4.5" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m5"><i class="fa fa-check"></i><b>3.4.5</b> 3M5</a></li>
<li class="chapter" data-level="3.4.6" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h1"><i class="fa fa-check"></i><b>3.4.6</b> 3H1</a></li>
<li class="chapter" data-level="3.4.7" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h2"><i class="fa fa-check"></i><b>3.4.7</b> 3H2</a></li>
<li class="chapter" data-level="3.4.8" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h3"><i class="fa fa-check"></i><b>3.4.8</b> 3H3</a></li>
<li class="chapter" data-level="3.4.9" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h4"><i class="fa fa-check"></i><b>3.4.9</b> 3H4</a></li>
<li class="chapter" data-level="3.4.10" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h5"><i class="fa fa-check"></i><b>3.4.10</b> 3H5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geocentric-models.html"><a href="geocentric-models.html"><i class="fa fa-check"></i><b>4</b> Geocentric Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="geocentric-models.html"><a href="geocentric-models.html#why-normal-distributions-are-normal"><i class="fa fa-check"></i><b>4.1</b> Why Normal distributions are normal</a></li>
<li class="chapter" data-level="4.2" data-path="geocentric-models.html"><a href="geocentric-models.html#a-language-for-describing-models"><i class="fa fa-check"></i><b>4.2</b> A language for describing models</a></li>
<li class="chapter" data-level="4.3" data-path="geocentric-models.html"><a href="geocentric-models.html#gaussian-model-of-height"><i class="fa fa-check"></i><b>4.3</b> Gaussian model of height</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="geocentric-models.html"><a href="geocentric-models.html#the-model"><i class="fa fa-check"></i><b>4.3.1</b> The model</a></li>
<li class="chapter" data-level="4.3.2" data-path="geocentric-models.html"><a href="geocentric-models.html#grid-approximation-of-the-posterior-distribution"><i class="fa fa-check"></i><b>4.3.2</b> Grid approximation of the posterior distribution</a></li>
<li class="chapter" data-level="4.3.3" data-path="geocentric-models.html"><a href="geocentric-models.html#sampling-from-the-posterior"><i class="fa fa-check"></i><b>4.3.3</b> Sampling from the posterior</a></li>
<li class="chapter" data-level="4.3.4" data-path="geocentric-models.html"><a href="geocentric-models.html#finding-the-posterior-distribution-with-quap"><i class="fa fa-check"></i><b>4.3.4</b> Finding the posterior distribution with quap</a></li>
<li class="chapter" data-level="4.3.5" data-path="geocentric-models.html"><a href="geocentric-models.html#sampling-from-a-quap"><i class="fa fa-check"></i><b>4.3.5</b> Sampling from a quap</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="geocentric-models.html"><a href="geocentric-models.html#linear-prediction"><i class="fa fa-check"></i><b>4.4</b> Linear prediction</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="geocentric-models.html"><a href="geocentric-models.html#the-lienar-mdoel-strategy"><i class="fa fa-check"></i><b>4.4.1</b> The lienar mdoel strategy</a></li>
<li class="chapter" data-level="4.4.2" data-path="geocentric-models.html"><a href="geocentric-models.html#finding-the-posterior-distribution"><i class="fa fa-check"></i><b>4.4.2</b> Finding the posterior distribution</a></li>
<li class="chapter" data-level="4.4.3" data-path="geocentric-models.html"><a href="geocentric-models.html#interpreting-the-posterior-distribution"><i class="fa fa-check"></i><b>4.4.3</b> Interpreting the posterior distribution</a>
<ul>
<li class="chapter" data-level="4.4.3.1" data-path="geocentric-models.html"><a href="geocentric-models.html#tables-fo-marginal-distributions"><i class="fa fa-check"></i><b>4.4.3.1</b> Tables fo marginal distributions</a></li>
<li class="chapter" data-level="4.4.3.2" data-path="geocentric-models.html"><a href="geocentric-models.html#plotting-posterior-inference-against-the-data"><i class="fa fa-check"></i><b>4.4.3.2</b> Plotting posterior inference against the data</a></li>
<li class="chapter" data-level="4.4.3.3" data-path="geocentric-models.html"><a href="geocentric-models.html#adding-uncertainty-around-the-mean"><i class="fa fa-check"></i><b>4.4.3.3</b> Adding uncertainty around the mean</a></li>
<li class="chapter" data-level="4.4.3.4" data-path="geocentric-models.html"><a href="geocentric-models.html#plotting-regression-intervlas-and-contours"><i class="fa fa-check"></i><b>4.4.3.4</b> Plotting regression intervlas and contours</a></li>
<li class="chapter" data-level="4.4.3.5" data-path="geocentric-models.html"><a href="geocentric-models.html#prediction-intevals"><i class="fa fa-check"></i><b>4.4.3.5</b> Prediction intevals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="geocentric-models.html"><a href="geocentric-models.html#curves-form-lines"><i class="fa fa-check"></i><b>4.5</b> Curves form lines</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="geocentric-models.html"><a href="geocentric-models.html#polynomial-regression"><i class="fa fa-check"></i><b>4.5.1</b> Polynomial regression</a></li>
<li class="chapter" data-level="4.5.2" data-path="geocentric-models.html"><a href="geocentric-models.html#splines"><i class="fa fa-check"></i><b>4.5.2</b> Splines</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="geocentric-models.html"><a href="geocentric-models.html#exercises-2"><i class="fa fa-check"></i><b>4.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="geocentric-models.html"><a href="geocentric-models.html#m1-2"><i class="fa fa-check"></i><b>4.6.1</b> 4M1</a></li>
<li class="chapter" data-level="4.6.2" data-path="geocentric-models.html"><a href="geocentric-models.html#m8"><i class="fa fa-check"></i><b>4.6.2</b> 4M8</a></li>
<li class="chapter" data-level="4.6.3" data-path="geocentric-models.html"><a href="geocentric-models.html#h1-1"><i class="fa fa-check"></i><b>4.6.3</b> 4H1</a></li>
<li class="chapter" data-level="4.6.4" data-path="geocentric-models.html"><a href="geocentric-models.html#h2-1"><i class="fa fa-check"></i><b>4.6.4</b> 4H2</a></li>
<li class="chapter" data-level="4.6.5" data-path="geocentric-models.html"><a href="geocentric-models.html#h3-1"><i class="fa fa-check"></i><b>4.6.5</b> 4H3</a>
<ul>
<li class="chapter" data-level="4.6.5.1" data-path="geocentric-models.html"><a href="geocentric-models.html#the-same-but-using-log-of-weight"><i class="fa fa-check"></i><b>4.6.5.1</b> The same but using log of weight</a></li>
</ul></li>
<li class="chapter" data-level="4.6.6" data-path="geocentric-models.html"><a href="geocentric-models.html#h6"><i class="fa fa-check"></i><b>4.6.6</b> 4H6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lecture-notes-wrap-up-chapters-geocentric-models.html"><a href="lecture-notes-wrap-up-chapters-geocentric-models.html"><i class="fa fa-check"></i><b>5</b> Lecture notes - wrap up chapters geocentric models</a></li>
<li class="chapter" data-level="6" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html"><i class="fa fa-check"></i><b>6</b> Chapter 5 - The Many Variables &amp; The Spurious Waffles</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#spurious-associations"><i class="fa fa-check"></i><b>6.1</b> Spurious Associations</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#defining-a-multiple-regression"><i class="fa fa-check"></i><b>6.1.1</b> Defining a multiple regression</a></li>
<li class="chapter" data-level="6.1.2" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#approximating-the-posterior"><i class="fa fa-check"></i><b>6.1.2</b> Approximating the posterior</a></li>
<li class="chapter" data-level="6.1.3" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#the-flow"><i class="fa fa-check"></i><b>6.1.3</b> The flow</a>
<ul>
<li class="chapter" data-level="6.1.3.1" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#posterior-prediction-plots"><i class="fa fa-check"></i><b>6.1.3.1</b> Posterior Prediction Plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#masked-relationship"><i class="fa fa-check"></i><b>6.2</b> Masked Relationship</a></li>
<li class="chapter" data-level="6.3" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#categorical-variables"><i class="fa fa-check"></i><b>6.3</b> Categorical Variables</a></li>
<li class="chapter" data-level="6.4" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#lecture-notes---not-integrated-in-the-notes"><i class="fa fa-check"></i><b>6.4</b> Lecture notes - not integrated in the notes</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html"><i class="fa fa-check"></i><b>7</b> Chapter 6 - The Haunted DAG &amp; The Causal Terror</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#multicollinearity"><i class="fa fa-check"></i><b>7.1</b> Multicollinearity</a></li>
<li class="chapter" data-level="7.2" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#post-treatment-bias"><i class="fa fa-check"></i><b>7.2</b> Post Treatment Bias</a></li>
<li class="chapter" data-level="7.3" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#collider-bias"><i class="fa fa-check"></i><b>7.3</b> Collider Bias</a></li>
<li class="chapter" data-level="7.4" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#confronting-confounding"><i class="fa fa-check"></i><b>7.4</b> Confronting Confounding</a></li>
<li class="chapter" data-level="7.5" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#exercises-3"><i class="fa fa-check"></i><b>7.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#m1-3"><i class="fa fa-check"></i><b>7.5.1</b> 6M1</a></li>
<li class="chapter" data-level="7.5.2" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#m3-1"><i class="fa fa-check"></i><b>7.5.2</b> 6M3</a></li>
<li class="chapter" data-level="7.5.3" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h"><i class="fa fa-check"></i><b>7.5.3</b> 6H</a></li>
<li class="chapter" data-level="7.5.4" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h3-2"><i class="fa fa-check"></i><b>7.5.4</b> 6H3</a></li>
<li class="chapter" data-level="7.5.5" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h4-1"><i class="fa fa-check"></i><b>7.5.5</b> 6H4</a></li>
<li class="chapter" data-level="7.5.6" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h5-1"><i class="fa fa-check"></i><b>7.5.6</b> 6H5</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#lecture-notes---not-integrated-in-the-text"><i class="fa fa-check"></i><b>7.6</b> Lecture notes - not integrated in the text</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html"><i class="fa fa-check"></i><b>8</b> Chapter 7 - Model comparison</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#the-problem-with-parameters"><i class="fa fa-check"></i><b>8.1</b> The problem with parameters</a></li>
<li class="chapter" data-level="8.2" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#entropy-and-accuracy"><i class="fa fa-check"></i><b>8.2</b> Entropy and Accuracy</a></li>
<li class="chapter" data-level="8.3" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#golem-taming-regularization"><i class="fa fa-check"></i><b>8.3</b> Golem Taming: Regularization</a></li>
<li class="chapter" data-level="8.4" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#predicting-predictive-accuracy"><i class="fa fa-check"></i><b>8.4</b> Predicting predictive accuracy</a></li>
<li class="chapter" data-level="8.5" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#model-comparison"><i class="fa fa-check"></i><b>8.5</b> Model Comparison</a></li>
<li class="chapter" data-level="8.6" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#exercies"><i class="fa fa-check"></i><b>8.6</b> Exercies</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#m3-2"><i class="fa fa-check"></i><b>8.6.1</b> 7M3</a></li>
<li class="chapter" data-level="8.6.2" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#m4-1"><i class="fa fa-check"></i><b>8.6.2</b> 7M4</a></li>
<li class="chapter" data-level="8.6.3" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#m5-1"><i class="fa fa-check"></i><b>8.6.3</b> 7M5</a></li>
<li class="chapter" data-level="8.6.4" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#m6"><i class="fa fa-check"></i><b>8.6.4</b> 7M6</a></li>
<li class="chapter" data-level="8.6.5" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#h1-2"><i class="fa fa-check"></i><b>8.6.5</b> 7H1</a></li>
<li class="chapter" data-level="8.6.6" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#h2-2"><i class="fa fa-check"></i><b>8.6.6</b> 7H2</a>
<ul>
<li class="chapter" data-level="8.6.6.1" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#identify-the-outlier"><i class="fa fa-check"></i><b>8.6.6.1</b> (1) Identify the outlier</a></li>
<li class="chapter" data-level="8.6.6.2" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#inspect-model-predictions"><i class="fa fa-check"></i><b>8.6.6.2</b> (2) Inspect model predictions</a></li>
<li class="chapter" data-level="8.6.6.3" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#using-students-t-distribution"><i class="fa fa-check"></i><b>8.6.6.3</b> (3) Using students t distribution</a></li>
</ul></li>
<li class="chapter" data-level="8.6.7" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#h5-2"><i class="fa fa-check"></i><b>8.6.7</b> 7H5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html"><i class="fa fa-check"></i><b>9</b> Chapter 8 - Model comparison</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#building-an-interaction"><i class="fa fa-check"></i><b>9.1</b> Building an interaction</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#adding-an-indicator-variable-isnt-enough."><i class="fa fa-check"></i><b>9.1.1</b> Adding an indicator variable isn’t enough.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#symmetry-of-interactions"><i class="fa fa-check"></i><b>9.2</b> Symmetry of interactions</a></li>
<li class="chapter" data-level="9.3" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#continuous-interactions"><i class="fa fa-check"></i><b>9.3</b> Continuous interactions</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#a-winter-flower"><i class="fa fa-check"></i><b>9.3.1</b> A Winter Flower</a></li>
<li class="chapter" data-level="9.3.2" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#the-models"><i class="fa fa-check"></i><b>9.3.2</b> The models</a></li>
<li class="chapter" data-level="9.3.3" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#plotting-posterior-predictions"><i class="fa fa-check"></i><b>9.3.3</b> Plotting posterior predictions</a></li>
<li class="chapter" data-level="9.3.4" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#plotting-prior-predictions"><i class="fa fa-check"></i><b>9.3.4</b> Plotting prior predictions</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#exercises-4"><i class="fa fa-check"></i><b>9.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#m4-2"><i class="fa fa-check"></i><b>9.4.1</b> 8M4</a>
<ul>
<li class="chapter" data-level="9.4.1.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#interaction-model"><i class="fa fa-check"></i><b>9.4.1.1</b> Interaction model</a></li>
<li class="chapter" data-level="9.4.1.2" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#conclusion"><i class="fa fa-check"></i><b>9.4.1.2</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9.4.2" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#h3-3"><i class="fa fa-check"></i><b>9.4.2</b> 8H3</a>
<ul>
<li class="chapter" data-level="9.4.2.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#h3a"><i class="fa fa-check"></i><b>9.4.2.1</b> 8H3A</a></li>
<li class="chapter" data-level="9.4.2.2" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#h3b"><i class="fa fa-check"></i><b>9.4.2.2</b> 8H3B</a></li>
</ul></li>
<li class="chapter" data-level="9.4.3" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#h5-3"><i class="fa fa-check"></i><b>9.4.3</b> 8H5</a></li>
<li class="chapter" data-level="9.4.4" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#h6-1"><i class="fa fa-check"></i><b>9.4.4</b> 8H6</a></li>
<li class="chapter" data-level="9.4.5" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#h7"><i class="fa fa-check"></i><b>9.4.5</b> 8H7</a>
<ul>
<li class="chapter" data-level="9.4.5.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#predictions"><i class="fa fa-check"></i><b>9.4.5.1</b> Predictions</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>10</b> Chapter 9 - Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#good-king-markov-and-his-island-kingdom"><i class="fa fa-check"></i><b>10.1</b> Good King Markov and his island kingdom</a></li>
<li class="chapter" data-level="10.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#metropolis-algorithms"><i class="fa fa-check"></i><b>10.2</b> Metropolis algorithms</a></li>
<li class="chapter" data-level="10.3" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#hamiltonian-monte-carlo"><i class="fa fa-check"></i><b>10.3</b> Hamiltonian Monte Carlo</a></li>
<li class="chapter" data-level="10.4" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#easy-hmc-ulam"><i class="fa fa-check"></i><b>10.4</b> Easy HMC: ulam</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#fitting-using-quap"><i class="fa fa-check"></i><b>10.4.1</b> Fitting using quap</a></li>
<li class="chapter" data-level="10.4.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#fitting-using-hmc"><i class="fa fa-check"></i><b>10.4.2</b> Fitting using HMC</a>
<ul>
<li class="chapter" data-level="10.4.2.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#preparing-data"><i class="fa fa-check"></i><b>10.4.2.1</b> Preparing data</a></li>
<li class="chapter" data-level="10.4.2.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#sampling-from-the-posterior-1"><i class="fa fa-check"></i><b>10.4.2.2</b> Sampling from the posterior</a></li>
<li class="chapter" data-level="10.4.2.3" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#sampling-again-in-parallel"><i class="fa fa-check"></i><b>10.4.2.3</b> Sampling again, in parallel</a></li>
<li class="chapter" data-level="10.4.2.4" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#visualization"><i class="fa fa-check"></i><b>10.4.2.4</b> Visualization</a></li>
<li class="chapter" data-level="10.4.2.5" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#checking-the-chain"><i class="fa fa-check"></i><b>10.4.2.5</b> Checking the chain</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#care-and-feeding-of-your-markov-chain"><i class="fa fa-check"></i><b>10.5</b> Care and feeding of your Markov chain</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#how-many-samples-do-you-need"><i class="fa fa-check"></i><b>10.5.1</b> How many samples do you need?</a></li>
<li class="chapter" data-level="10.5.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#how-many-chains-do-you-need"><i class="fa fa-check"></i><b>10.5.2</b> How many chains do you need?</a></li>
<li class="chapter" data-level="10.5.3" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#taming-a-wild-chain"><i class="fa fa-check"></i><b>10.5.3</b> Taming a wild chain</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#exercises-5"><i class="fa fa-check"></i><b>10.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#e4"><i class="fa fa-check"></i><b>10.6.1</b> E4</a></li>
<li class="chapter" data-level="10.6.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#e5"><i class="fa fa-check"></i><b>10.6.2</b> E5</a></li>
<li class="chapter" data-level="10.6.3" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#e6"><i class="fa fa-check"></i><b>10.6.3</b> E6</a></li>
<li class="chapter" data-level="10.6.4" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#e7"><i class="fa fa-check"></i><b>10.6.4</b> E7</a></li>
<li class="chapter" data-level="10.6.5" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#m1-4"><i class="fa fa-check"></i><b>10.6.5</b> M1</a>
<ul>
<li class="chapter" data-level="10.6.5.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#comparing-to-posterior-distributions"><i class="fa fa-check"></i><b>10.6.5.1</b> Comparing to posterior distributions</a></li>
</ul></li>
<li class="chapter" data-level="10.6.6" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#h2-3"><i class="fa fa-check"></i><b>10.6.6</b> H2</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#lecture-notes"><i class="fa fa-check"></i><b>10.7</b> Lecture notes</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>11</b> Big Entropy and the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="11.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#maximum-entropy"><i class="fa fa-check"></i><b>11.1</b> Maximum Entropy</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#binomial"><i class="fa fa-check"></i><b>11.1.1</b> Binomial</a>
<ul>
<li class="chapter" data-level="11.1.1.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#example-from-the-lecture"><i class="fa fa-check"></i><b>11.1.1.1</b> Example from the lecture</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#generalized-linear-models"><i class="fa fa-check"></i><b>11.2</b> Generalized linear models</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#meet-the-family"><i class="fa fa-check"></i><b>11.2.1</b> Meet the family</a></li>
<li class="chapter" data-level="11.2.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#linking-linear-models-to-distributions"><i class="fa fa-check"></i><b>11.2.2</b> Linking linear models to distributions</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#maximum-entropy-priors"><i class="fa fa-check"></i><b>11.3</b> Maximum entropy priors</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html"><i class="fa fa-check"></i><b>12</b> God Spiked the Integers</a>
<ul>
<li class="chapter" data-level="12.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#binomial-regression"><i class="fa fa-check"></i><b>12.1</b> Binomial Regression</a>
<ul>
<li class="chapter" data-level="12.1.0.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#logistic-regression-prosocial-chimpanzees"><i class="fa fa-check"></i><b>12.1.0.1</b> Logistic regression: Prosocial chimpanzees:</a></li>
<li class="chapter" data-level="12.1.0.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#relative-shark-and-absolute-deer"><i class="fa fa-check"></i><b>12.1.0.2</b> Relative shark and absolute deer</a></li>
<li class="chapter" data-level="12.1.0.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#aggregated-binomial-chimpanzees-again-condensed."><i class="fa fa-check"></i><b>12.1.0.3</b> Aggregated binomial: Chimpanzees again, condensed.</a></li>
<li class="chapter" data-level="12.1.0.4" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#aggregated-binomial-graduate-school-admissions"><i class="fa fa-check"></i><b>12.1.0.4</b> Aggregated binomial: Graduate school admissions</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#poisson-regression"><i class="fa fa-check"></i><b>12.2</b> Poisson Regression</a>
<ul>
<li class="chapter" data-level="12.2.0.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#negative-binomial-gamma-poisson-models."><i class="fa fa-check"></i><b>12.2.0.1</b> Negative binomial (gamma-poisson) models.</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#multinomial-regression"><i class="fa fa-check"></i><b>12.3</b> Multinomial Regression</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#example-from-the-lecture-1"><i class="fa fa-check"></i><b>12.3.1</b> Example from the lecture</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#exercies-1"><i class="fa fa-check"></i><b>12.4</b> Exercies</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#e1"><i class="fa fa-check"></i><b>12.4.1</b> E1</a></li>
<li class="chapter" data-level="12.4.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#e2"><i class="fa fa-check"></i><b>12.4.2</b> E2</a></li>
<li class="chapter" data-level="12.4.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#e3"><i class="fa fa-check"></i><b>12.4.3</b> E3</a></li>
<li class="chapter" data-level="12.4.4" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#m7"><i class="fa fa-check"></i><b>12.4.4</b> M7</a></li>
<li class="chapter" data-level="12.4.5" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#h1-3"><i class="fa fa-check"></i><b>12.4.5</b> H1</a></li>
<li class="chapter" data-level="12.4.6" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#h2-4"><i class="fa fa-check"></i><b>12.4.6</b> H2</a></li>
<li class="chapter" data-level="12.4.7" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#h3-4"><i class="fa fa-check"></i><b>12.4.7</b> H3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html"><i class="fa fa-check"></i><b>13</b> Ch 13 - Models with Memory</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#example-multilevel-tadpoles"><i class="fa fa-check"></i><b>13.1</b> Example: Multilevel tadpoles</a></li>
<li class="chapter" data-level="13.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#varying-effects-and-the-underfitting-overfitting-trade-off"><i class="fa fa-check"></i><b>13.2</b> Varying effects and the underfitting / overfitting trade-off</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#the-model-1"><i class="fa fa-check"></i><b>13.2.1</b> The model</a></li>
<li class="chapter" data-level="13.2.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#assign-values-to-the-parameters"><i class="fa fa-check"></i><b>13.2.2</b> Assign values to the parameters</a></li>
<li class="chapter" data-level="13.2.3" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#simulate-survivors"><i class="fa fa-check"></i><b>13.2.3</b> Simulate survivors</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#more-than-one-type-of-cluster"><i class="fa fa-check"></i><b>13.3</b> More than one type of cluster</a></li>
<li class="chapter" data-level="13.4" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#divergent-transitions-and-non-centered-priors"><i class="fa fa-check"></i><b>13.4</b> Divergent transitions and non-centered priors</a>
<ul>
<li class="chapter" data-level="13.4.0.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#the-devils-funnel-example"><i class="fa fa-check"></i><b>13.4.0.1</b> The Devil’s Funnel: (example)</a></li>
<li class="chapter" data-level="13.4.0.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#non-centered-chimpanzees-example"><i class="fa fa-check"></i><b>13.4.0.2</b> Non-centered chimpanzees (example)</a>
<ul>
<li class="chapter" data-level="13.4.0.2.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#solution-1-centered-parameterization-increasing-acceptance-rate"><i class="fa fa-check"></i><b>13.4.0.2.1</b> Solution 1: Centered parameterization (Increasing acceptance rate)</a></li>
<li class="chapter" data-level="13.4.0.2.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#solution-2-non-centered-version-reparameterize"><i class="fa fa-check"></i><b>13.4.0.2.2</b> Solution 2: Non-centered version (reparameterize)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#multilevel-posterior-predictions"><i class="fa fa-check"></i><b>13.5</b> Multilevel posterior predictions</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#posterior-prediction-for-same-clusters"><i class="fa fa-check"></i><b>13.5.1</b> Posterior prediction for same clusters</a></li>
<li class="chapter" data-level="13.5.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#posterior-prediction-for-new-clusters"><i class="fa fa-check"></i><b>13.5.2</b> Posterior prediction for new clusters</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#exercises-6"><i class="fa fa-check"></i><b>13.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#e1-1"><i class="fa fa-check"></i><b>13.6.1</b> E1</a></li>
<li class="chapter" data-level="13.6.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#e2-1"><i class="fa fa-check"></i><b>13.6.2</b> E2</a></li>
<li class="chapter" data-level="13.6.3" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#e3-1"><i class="fa fa-check"></i><b>13.6.3</b> E3</a></li>
<li class="chapter" data-level="13.6.4" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#e4-1"><i class="fa fa-check"></i><b>13.6.4</b> E4</a></li>
<li class="chapter" data-level="13.6.5" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#m1-5"><i class="fa fa-check"></i><b>13.6.5</b> M1</a></li>
<li class="chapter" data-level="13.6.6" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#h1-4"><i class="fa fa-check"></i><b>13.6.6</b> H1</a>
<ul>
<li class="chapter" data-level="13.6.6.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#fixed-effects-model"><i class="fa fa-check"></i><b>13.6.6.1</b> Fixed effects model:</a></li>
<li class="chapter" data-level="13.6.6.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#varying-intercepts-model"><i class="fa fa-check"></i><b>13.6.6.2</b> Varying intercepts model:</a></li>
<li class="chapter" data-level="13.6.6.3" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#extract-samples"><i class="fa fa-check"></i><b>13.6.6.3</b> Extract samples</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html"><i class="fa fa-check"></i><b>14</b> Ch 14 - Advuntetures in Coviaraince</a>
<ul>
<li class="chapter" data-level="14.1" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#varying-slopes-by-construction"><i class="fa fa-check"></i><b>14.1</b> Varying slopes by construction</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#simulate-the-population"><i class="fa fa-check"></i><b>14.1.1</b> Simulate the population</a></li>
<li class="chapter" data-level="14.1.2" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#simulate-observations"><i class="fa fa-check"></i><b>14.1.2</b> Simulate observations</a></li>
<li class="chapter" data-level="14.1.3" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#the-varying-slopes-model"><i class="fa fa-check"></i><b>14.1.3</b> The varying slopes model</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#advanced-varying-slopes"><i class="fa fa-check"></i><b>14.2</b> Advanced varying slopes</a>
<ul>
<li class="chapter" data-level="14.2.0.1" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#inference"><i class="fa fa-check"></i><b>14.2.0.1</b> Inference!</a></li>
<li class="chapter" data-level="14.2.0.2" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#conclusions---multilevel-horoscopes"><i class="fa fa-check"></i><b>14.2.0.2</b> Conclusions - multilevel horoscopes</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#exercises-7"><i class="fa fa-check"></i><b>14.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#e1-2"><i class="fa fa-check"></i><b>14.3.1</b> E1</a></li>
<li class="chapter" data-level="14.3.2" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#e3-2"><i class="fa fa-check"></i><b>14.3.2</b> E3</a></li>
<li class="chapter" data-level="14.3.3" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#h1-5"><i class="fa fa-check"></i><b>14.3.3</b> H1</a></li>
<li class="chapter" data-level="14.3.4" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#h2-5"><i class="fa fa-check"></i><b>14.3.4</b> H2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html"><i class="fa fa-check"></i><b>15</b> Ch 14 - Adventures in Covariance</a>
<ul>
<li class="chapter" data-level="15.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#ch-14.3---instruments-and-causal-designs"><i class="fa fa-check"></i><b>15.1</b> Ch 14.3 - Instruments and causal designs</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#instrumental-variables"><i class="fa fa-check"></i><b>15.1.1</b> Instrumental variables</a>
<ul>
<li class="chapter" data-level="15.1.1.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#only-including-e-we-add-confounding-effect-sideeffect-of-e"><i class="fa fa-check"></i><b>15.1.1.1</b> 1. Only including E (we add confounding effect sideeffect of E)</a></li>
<li class="chapter" data-level="15.1.1.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#adding-instrument-q-the-wrong-way"><i class="fa fa-check"></i><b>15.1.1.2</b> 2. Adding instrument Q (the wrong way)</a></li>
<li class="chapter" data-level="15.1.1.3" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#correct-use-of-the-instrument-variable"><i class="fa fa-check"></i><b>15.1.1.3</b> 3. Correct use of the instrument variable</a></li>
</ul></li>
<li class="chapter" data-level="15.1.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#other-designs"><i class="fa fa-check"></i><b>15.1.2</b> Other designs</a>
<ul>
<li class="chapter" data-level="15.1.2.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#front-door-criterion"><i class="fa fa-check"></i><b>15.1.2.1</b> Front-Door Criterion</a></li>
<li class="chapter" data-level="15.1.2.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#regression-discontinuity-rdd"><i class="fa fa-check"></i><b>15.1.2.2</b> Regression discontinuity (RDD)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#gaussian-processes-continuous-categories-and-the-gaussian-process"><i class="fa fa-check"></i><b>15.2</b> (Gaussian Processes) Continuous categories and the Gaussian process</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#example-spatial-autocorrelation-in-oceanic-tools"><i class="fa fa-check"></i><b>15.2.1</b> Example: Spatial autocorrelation in Oceanic tools</a>
<ul>
<li class="chapter" data-level="15.2.1.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#loading-data-defining-model"><i class="fa fa-check"></i><b>15.2.1.1</b> Loading data + defining model</a></li>
<li class="chapter" data-level="15.2.1.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#the-full-model"><i class="fa fa-check"></i><b>15.2.1.2</b> The full model</a></li>
<li class="chapter" data-level="15.2.1.3" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#gaussian-process-posterior"><i class="fa fa-check"></i><b>15.2.1.3</b> Gaussian Process Posterior</a></li>
</ul></li>
<li class="chapter" data-level="15.2.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#example-phylogenetic-distance-not-in-the-curriculum"><i class="fa fa-check"></i><b>15.2.2</b> Example: Phylogenetic distance (not in the curriculum)</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#exercises-8"><i class="fa fa-check"></i><b>15.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#m3-3"><i class="fa fa-check"></i><b>15.3.1</b> M3</a></li>
<li class="chapter" data-level="15.3.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#m4-3"><i class="fa fa-check"></i><b>15.3.2</b> M4</a></li>
<li class="chapter" data-level="15.3.3" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#h2-6"><i class="fa fa-check"></i><b>15.3.3</b> H2</a></li>
<li class="chapter" data-level="15.3.4" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#h4-varying-intercepts-varying-slopes"><i class="fa fa-check"></i><b>15.3.4</b> H4 Varying intercepts Varying slopes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Data Analysis Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter-8---model-comparison" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Chapter 8 - Model comparison</h1>
<p>Introduction, using the case of the planes coming back with holes in the wings, does that mean that one should make the wings stronger? A model will suggest that, because it only sees scenarios of where the holes are in planes that came back, hence it is conditional on planes returning, we rarely see holes in the center part. Since we only see planes coming back, we dont get to see the other condition.</p>
<p>The following sections elaborate on how we can model interactions, meaning how one outcome may result another.</p>
<div id="building-an-interaction" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Building an interaction</h2>
<p>This section elaborates on what an interaction can be used at what for.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="chapter-8-model-comparison.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb202-2"><a href="chapter-8-model-comparison.html#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(rugged)</span>
<span id="cb202-3"><a href="chapter-8-model-comparison.html#cb202-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> rugged</span>
<span id="cb202-4"><a href="chapter-8-model-comparison.html#cb202-4" aria-hidden="true" tabindex="-1"></a><span class="co"># make log version of outcome</span></span>
<span id="cb202-5"><a href="chapter-8-model-comparison.html#cb202-5" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>log_gdp <span class="ot">&lt;-</span> <span class="fu">log</span>( d<span class="sc">$</span>rgdppc_2000 )</span>
<span id="cb202-6"><a href="chapter-8-model-comparison.html#cb202-6" aria-hidden="true" tabindex="-1"></a><span class="co"># extract countries with GDP data</span></span>
<span id="cb202-7"><a href="chapter-8-model-comparison.html#cb202-7" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> d[ <span class="fu">complete.cases</span>(d<span class="sc">$</span>rgdppc_2000) , ]</span>
<span id="cb202-8"><a href="chapter-8-model-comparison.html#cb202-8" aria-hidden="true" tabindex="-1"></a><span class="co"># rescale variables</span></span>
<span id="cb202-9"><a href="chapter-8-model-comparison.html#cb202-9" aria-hidden="true" tabindex="-1"></a>dd<span class="sc">$</span>log_gdp_std <span class="ot">&lt;-</span> dd<span class="sc">$</span>log_gdp <span class="sc">/</span> <span class="fu">mean</span>(dd<span class="sc">$</span>log_gdp)</span>
<span id="cb202-10"><a href="chapter-8-model-comparison.html#cb202-10" aria-hidden="true" tabindex="-1"></a>dd<span class="sc">$</span>rugged_std <span class="ot">&lt;-</span> dd<span class="sc">$</span>rugged <span class="sc">/</span> <span class="fu">max</span>(dd<span class="sc">$</span>rugged)</span></code></pre></div>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="chapter-8-model-comparison.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co">#8.2</span></span>
<span id="cb203-2"><a href="chapter-8-model-comparison.html#cb203-2" aria-hidden="true" tabindex="-1"></a>m8<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb203-3"><a href="chapter-8-model-comparison.html#cb203-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb203-4"><a href="chapter-8-model-comparison.html#cb203-4" aria-hidden="true" tabindex="-1"></a>    log_gdp_std <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) ,</span>
<span id="cb203-5"><a href="chapter-8-model-comparison.html#cb203-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b<span class="sc">*</span>( rugged_std <span class="sc">-</span> <span class="fl">0.215</span> ) ,</span>
<span id="cb203-6"><a href="chapter-8-model-comparison.html#cb203-6" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">1</span> , <span class="dv">1</span> ) ,</span>
<span id="cb203-7"><a href="chapter-8-model-comparison.html#cb203-7" aria-hidden="true" tabindex="-1"></a>    b <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) ,</span>
<span id="cb203-8"><a href="chapter-8-model-comparison.html#cb203-8" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb203-9"><a href="chapter-8-model-comparison.html#cb203-9" aria-hidden="true" tabindex="-1"></a>  ) , <span class="at">data=</span>dd )</span>
<span id="cb203-10"><a href="chapter-8-model-comparison.html#cb203-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-11"><a href="chapter-8-model-comparison.html#cb203-11" aria-hidden="true" tabindex="-1"></a><span class="co">#8.3</span></span>
<span id="cb203-12"><a href="chapter-8-model-comparison.html#cb203-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb203-13"><a href="chapter-8-model-comparison.html#cb203-13" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">extract.prior</span>( m8<span class="fl">.1</span> )</span>
<span id="cb203-14"><a href="chapter-8-model-comparison.html#cb203-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-15"><a href="chapter-8-model-comparison.html#cb203-15" aria-hidden="true" tabindex="-1"></a><span class="co"># set up the plot dimensions</span></span>
<span id="cb203-16"><a href="chapter-8-model-comparison.html#cb203-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( <span class="cn">NULL</span> , <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>) , <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">1.5</span>) ,</span>
<span id="cb203-17"><a href="chapter-8-model-comparison.html#cb203-17" aria-hidden="true" tabindex="-1"></a><span class="at">xlab=</span><span class="st">&quot;ruggedness&quot;</span> , <span class="at">ylab=</span><span class="st">&quot;log GDP&quot;</span> )</span>
<span id="cb203-18"><a href="chapter-8-model-comparison.html#cb203-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>( <span class="at">h=</span><span class="fu">min</span>(dd<span class="sc">$</span>log_gdp_std) , <span class="at">lty=</span><span class="dv">2</span> )</span>
<span id="cb203-19"><a href="chapter-8-model-comparison.html#cb203-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>( <span class="at">h=</span><span class="fu">max</span>(dd<span class="sc">$</span>log_gdp_std) , <span class="at">lty=</span><span class="dv">2</span> )</span>
<span id="cb203-20"><a href="chapter-8-model-comparison.html#cb203-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-21"><a href="chapter-8-model-comparison.html#cb203-21" aria-hidden="true" tabindex="-1"></a><span class="co"># draw 50 lines from the prior</span></span>
<span id="cb203-22"><a href="chapter-8-model-comparison.html#cb203-22" aria-hidden="true" tabindex="-1"></a>rugged_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from=</span><span class="sc">-</span><span class="fl">0.1</span> , <span class="at">to=</span><span class="fl">1.1</span> , <span class="at">length.out=</span><span class="dv">30</span> )</span>
<span id="cb203-23"><a href="chapter-8-model-comparison.html#cb203-23" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">link</span>( m8<span class="fl">.1</span> , <span class="at">post=</span>prior , <span class="at">data=</span><span class="fu">data.frame</span>(<span class="at">rugged_std=</span>rugged_seq) )</span>
<span id="cb203-24"><a href="chapter-8-model-comparison.html#cb203-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span> ) <span class="fu">lines</span>( rugged_seq , mu[i,] , <span class="at">col=</span><span class="fu">col.alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.3</span>) )</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-116-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="chapter-8-model-comparison.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>( <span class="fu">abs</span>(prior<span class="sc">$</span>b) <span class="sc">&gt;</span> <span class="fl">0.6</span> ) <span class="sc">/</span> <span class="fu">length</span>(prior<span class="sc">$</span>b)</span></code></pre></div>
<pre><code>## [1] 0.545</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="chapter-8-model-comparison.html#cb206-1" aria-hidden="true" tabindex="-1"></a>m8<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb206-2"><a href="chapter-8-model-comparison.html#cb206-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb206-3"><a href="chapter-8-model-comparison.html#cb206-3" aria-hidden="true" tabindex="-1"></a>    log_gdp_std <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) ,</span>
<span id="cb206-4"><a href="chapter-8-model-comparison.html#cb206-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b<span class="sc">*</span>( rugged_std <span class="sc">-</span> <span class="fl">0.215</span> ) ,</span>
<span id="cb206-5"><a href="chapter-8-model-comparison.html#cb206-5" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">1</span> , <span class="fl">0.1</span> ) ,</span>
<span id="cb206-6"><a href="chapter-8-model-comparison.html#cb206-6" aria-hidden="true" tabindex="-1"></a>    b <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.3</span> ) ,</span>
<span id="cb206-7"><a href="chapter-8-model-comparison.html#cb206-7" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb206-8"><a href="chapter-8-model-comparison.html#cb206-8" aria-hidden="true" tabindex="-1"></a>  ) , <span class="at">data=</span>dd )</span></code></pre></div>
<div id="adding-an-indicator-variable-isnt-enough." class="section level3" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Adding an indicator variable isn’t enough.</h3>
<p>One may argue that indicator variables may be sufficient to reflect certain situations, e.g., if something is on Africa or not, hence an indicator (i.e., dummy variable) may be included in the model. Although that will just reflect the mean value of that given outcome as it is either in or out.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="chapter-8-model-comparison.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co">#8.7</span></span>
<span id="cb207-2"><a href="chapter-8-model-comparison.html#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="co"># make variable to index Africa (1) or not (2)</span></span>
<span id="cb207-3"><a href="chapter-8-model-comparison.html#cb207-3" aria-hidden="true" tabindex="-1"></a>dd<span class="sc">$</span>cid <span class="ot">&lt;-</span> <span class="fu">ifelse</span>( dd<span class="sc">$</span>cont_africa<span class="sc">==</span><span class="dv">1</span> , <span class="dv">1</span> , <span class="dv">2</span> )</span>
<span id="cb207-4"><a href="chapter-8-model-comparison.html#cb207-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-5"><a href="chapter-8-model-comparison.html#cb207-5" aria-hidden="true" tabindex="-1"></a><span class="co">#8.8</span></span>
<span id="cb207-6"><a href="chapter-8-model-comparison.html#cb207-6" aria-hidden="true" tabindex="-1"></a>m8<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb207-7"><a href="chapter-8-model-comparison.html#cb207-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb207-8"><a href="chapter-8-model-comparison.html#cb207-8" aria-hidden="true" tabindex="-1"></a>    log_gdp_std <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) ,</span>
<span id="cb207-9"><a href="chapter-8-model-comparison.html#cb207-9" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a[cid] <span class="sc">+</span> b<span class="sc">*</span>( rugged_std <span class="sc">-</span> <span class="fl">0.215</span> ) ,</span>
<span id="cb207-10"><a href="chapter-8-model-comparison.html#cb207-10" aria-hidden="true" tabindex="-1"></a>    a[cid] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">1</span> , <span class="fl">0.1</span> ) ,</span>
<span id="cb207-11"><a href="chapter-8-model-comparison.html#cb207-11" aria-hidden="true" tabindex="-1"></a>    b <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.3</span> ) ,</span>
<span id="cb207-12"><a href="chapter-8-model-comparison.html#cb207-12" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb207-13"><a href="chapter-8-model-comparison.html#cb207-13" aria-hidden="true" tabindex="-1"></a>  ) , <span class="at">data=</span>dd )</span>
<span id="cb207-14"><a href="chapter-8-model-comparison.html#cb207-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-15"><a href="chapter-8-model-comparison.html#cb207-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-16"><a href="chapter-8-model-comparison.html#cb207-16" aria-hidden="true" tabindex="-1"></a><span class="co">#8.9</span></span>
<span id="cb207-17"><a href="chapter-8-model-comparison.html#cb207-17" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>( m8<span class="fl">.1</span> , m8<span class="fl">.2</span> )</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-252.2694</td>
</tr>
<tr class="even">
<td align="right">-188.7489</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">15.30363</td>
</tr>
<tr class="even">
<td align="right">13.29716</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.00000</td>
</tr>
<tr class="even">
<td align="right">63.52044</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">15.14767</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4.258180</td>
</tr>
<tr class="even">
<td align="right">2.693351</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">0</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="chapter-8-model-comparison.html#cb208-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2"><a href="chapter-8-model-comparison.html#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="co">#8.10</span></span>
<span id="cb208-3"><a href="chapter-8-model-comparison.html#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>( m8<span class="fl">.2</span> , <span class="at">depth=</span><span class="dv">2</span> )</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.8804170</td>
</tr>
<tr class="even">
<td align="right">1.0491586</td>
</tr>
<tr class="odd">
<td align="right">-0.0465124</td>
</tr>
<tr class="even">
<td align="right">0.1123923</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0159377</td>
</tr>
<tr class="even">
<td align="right">0.0101860</td>
</tr>
<tr class="odd">
<td align="right">0.0456887</td>
</tr>
<tr class="even">
<td align="right">0.0060917</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.8549455</td>
</tr>
<tr class="even">
<td align="right">1.0328794</td>
</tr>
<tr class="odd">
<td align="right">-0.1195318</td>
</tr>
<tr class="even">
<td align="right">0.1026565</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.9058885</td>
</tr>
<tr class="even">
<td align="right">1.0654378</td>
</tr>
<tr class="odd">
<td align="right">0.0265069</td>
</tr>
<tr class="even">
<td align="right">0.1221281</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="chapter-8-model-comparison.html#cb209-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2"><a href="chapter-8-model-comparison.html#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="co">#8.11</span></span>
<span id="cb209-3"><a href="chapter-8-model-comparison.html#cb209-3" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m8<span class="fl">.2</span>) </span>
<span id="cb209-4"><a href="chapter-8-model-comparison.html#cb209-4" aria-hidden="true" tabindex="-1"></a>diff_a1_a2 <span class="ot">&lt;-</span> post<span class="sc">$</span>a[,<span class="dv">1</span>] <span class="sc">-</span> post<span class="sc">$</span>a[,<span class="dv">2</span>]</span>
<span id="cb209-5"><a href="chapter-8-model-comparison.html#cb209-5" aria-hidden="true" tabindex="-1"></a><span class="fu">PI</span>( diff_a1_a2 )</span></code></pre></div>
<pre><code>##         5%        94% 
## -0.1990056 -0.1378378</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="chapter-8-model-comparison.html#cb211-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-2"><a href="chapter-8-model-comparison.html#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="co">#8.12</span></span>
<span id="cb211-3"><a href="chapter-8-model-comparison.html#cb211-3" aria-hidden="true" tabindex="-1"></a>rugged.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from=</span><span class="sc">-</span><span class="fl">0.1</span> , <span class="at">to=</span><span class="fl">1.1</span> , <span class="at">length.out=</span><span class="dv">30</span> )</span>
<span id="cb211-4"><a href="chapter-8-model-comparison.html#cb211-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compute mu over samples, fixing cid=2</span></span>
<span id="cb211-5"><a href="chapter-8-model-comparison.html#cb211-5" aria-hidden="true" tabindex="-1"></a>mu.NotAfrica <span class="ot">&lt;-</span> <span class="fu">link</span>( m8<span class="fl">.2</span> ,</span>
<span id="cb211-6"><a href="chapter-8-model-comparison.html#cb211-6" aria-hidden="true" tabindex="-1"></a><span class="at">data=</span><span class="fu">data.frame</span>( <span class="at">cid=</span><span class="dv">2</span> , <span class="at">rugged_std=</span>rugged.seq ) )</span>
<span id="cb211-7"><a href="chapter-8-model-comparison.html#cb211-7" aria-hidden="true" tabindex="-1"></a><span class="co"># compute mu over samples, fixing cid=1</span></span>
<span id="cb211-8"><a href="chapter-8-model-comparison.html#cb211-8" aria-hidden="true" tabindex="-1"></a>mu.Africa <span class="ot">&lt;-</span> <span class="fu">link</span>( m8<span class="fl">.2</span> ,</span>
<span id="cb211-9"><a href="chapter-8-model-comparison.html#cb211-9" aria-hidden="true" tabindex="-1"></a><span class="at">data=</span><span class="fu">data.frame</span>( <span class="at">cid=</span><span class="dv">1</span> , <span class="at">rugged_std=</span>rugged.seq ) )</span>
<span id="cb211-10"><a href="chapter-8-model-comparison.html#cb211-10" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize to means and intervals</span></span>
<span id="cb211-11"><a href="chapter-8-model-comparison.html#cb211-11" aria-hidden="true" tabindex="-1"></a>mu.NotAfrica_mu <span class="ot">&lt;-</span> <span class="fu">apply</span>( mu.NotAfrica , <span class="dv">2</span> , mean )</span>
<span id="cb211-12"><a href="chapter-8-model-comparison.html#cb211-12" aria-hidden="true" tabindex="-1"></a>mu.NotAfrica_ci <span class="ot">&lt;-</span> <span class="fu">apply</span>( mu.NotAfrica , <span class="dv">2</span> , PI , <span class="at">prob=</span><span class="fl">0.97</span> )</span>
<span id="cb211-13"><a href="chapter-8-model-comparison.html#cb211-13" aria-hidden="true" tabindex="-1"></a>mu.Africa_mu <span class="ot">&lt;-</span> <span class="fu">apply</span>( mu.Africa , <span class="dv">2</span> , mean )</span>
<span id="cb211-14"><a href="chapter-8-model-comparison.html#cb211-14" aria-hidden="true" tabindex="-1"></a>mu.Africa_ci <span class="ot">&lt;-</span> <span class="fu">apply</span>( mu.Africa , <span class="dv">2</span> , PI , <span class="at">prob=</span><span class="fl">0.97</span> )</span></code></pre></div>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="chapter-8-model-comparison.html#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dd<span class="sc">$</span>log_gdp,dd<span class="sc">$</span>rugged,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.7</span>,<span class="fl">1.4</span>))</span>
<span id="cb212-2"><a href="chapter-8-model-comparison.html#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb212-3"><a href="chapter-8-model-comparison.html#cb212-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(mu.NotAfrica_mu,<span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb212-4"><a href="chapter-8-model-comparison.html#cb212-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(mu.Africa_mu,<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-118-1.png" width="720" style="display: block; margin: auto;" /></p>
<p><strong><em>Thus we see that it is far better including an index instead of a dummy variable!!!</em></strong></p>
</div>
</div>
<div id="symmetry-of-interactions" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Symmetry of interactions</h2>
<p>About the index approach.</p>
</div>
<div id="continuous-interactions" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Continuous interactions</h2>
<div id="a-winter-flower" class="section level3" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> A Winter Flower</h3>
<p>This is an example with a flower that depends on sun and water to make photosynthesis, although having only one of the two is not useful at all, hence we need to deal with this using an interaction.</p>
<p>This is the data:</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="chapter-8-model-comparison.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb213-2"><a href="chapter-8-model-comparison.html#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(tulips)</span>
<span id="cb213-3"><a href="chapter-8-model-comparison.html#cb213-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> tulips</span>
<span id="cb213-4"><a href="chapter-8-model-comparison.html#cb213-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(d)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    27 obs. of  4 variables:
##  $ bed   : Factor w/ 3 levels &quot;a&quot;,&quot;b&quot;,&quot;c&quot;: 1 1 1 1 1 1 1 1 1 2 ...
##  $ water : int  1 1 1 2 2 2 3 3 3 1 ...
##  $ shade : int  1 2 3 1 2 3 1 2 3 1 ...
##  $ blooms: num  0 0 111 183.5 59.2 ...</code></pre>
</div>
<div id="the-models" class="section level3" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> The models</h3>
<p>We are going to center W (water) and S (shade).</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="chapter-8-model-comparison.html#cb215-1" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>blooms_std <span class="ot">&lt;-</span> d<span class="sc">$</span>blooms <span class="sc">/</span> <span class="fu">max</span>(d<span class="sc">$</span>blooms)</span>
<span id="cb215-2"><a href="chapter-8-model-comparison.html#cb215-2" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>water_cent <span class="ot">&lt;-</span> d<span class="sc">$</span>water <span class="sc">-</span> <span class="fu">mean</span>(d<span class="sc">$</span>water)</span>
<span id="cb215-3"><a href="chapter-8-model-comparison.html#cb215-3" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>shade_cent <span class="ot">&lt;-</span> d<span class="sc">$</span>shade <span class="sc">-</span> <span class="fu">mean</span>(d<span class="sc">$</span>shade)</span></code></pre></div>
<p>We have the non centered model:</p>
<p><img src="Images/paste-6F1AC3F9.png" width="215" /></p>
<p>We set the priors to <em>(we correct the sd in the following)</em>:</p>
<p><img src="Images/paste-CEB9D029.png" width="114" /></p>
<p>Alpha = 0.5 means that when shade and sun is at its mean, the model expects blooms to be halfway to the observed maximum.</p>
<p>We see that the slopes (betas) for W and S is 0, meaning that we have no idea if there is going to be relatively more shade or water, hence it will just be centered at 0.</p>
<p><em>But what does the standard deviation of 1 imply?</em></p>
<p>We see that the blooming should not go below 0 and above 1. Lets us inspect the alpha parameter and what the prior expects to see.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="chapter-8-model-comparison.html#cb216-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fl">1e4</span> ,<span class="at">mean =</span> <span class="fl">0.5</span> ,<span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb216-2"><a href="chapter-8-model-comparison.html#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Intercept alpha less than 0 and higher than 1</span></span>
<span id="cb216-3"><a href="chapter-8-model-comparison.html#cb216-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>( a <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> a <span class="sc">&gt;</span> <span class="dv">1</span> ) <span class="sc">/</span> <span class="fu">length</span>( a )</span></code></pre></div>
<pre><code>## [1] 0.6189</code></pre>
<p>It implies that the priors assign most of the probability outside of the range of 0 to 1. Hence we try to constrain the priors a bit:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="chapter-8-model-comparison.html#cb218-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fl">1e4</span>,<span class="at">mean =</span> <span class="fl">0.5</span>,<span class="at">sd =</span> <span class="fl">0.25</span>)</span>
<span id="cb218-2"><a href="chapter-8-model-comparison.html#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>( a <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> a <span class="sc">&gt;</span> <span class="dv">1</span> ) <span class="sc">/</span> <span class="fu">length</span>( a )</span></code></pre></div>
<pre><code>## [1] 0.0443</code></pre>
<p>Now we see that only 5% is less than 0 and higher than 1. That is much better. Notice that we want to allow the model to reach the edges and probably go a bit above / below so we can fit data within this region.</p>
<p>Regarding the beta values we see that the</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="chapter-8-model-comparison.html#cb220-1" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fl">1e4</span>,<span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb220-2"><a href="chapter-8-model-comparison.html#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(bw,<span class="at">main =</span> <span class="st">&quot;bw prior&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-119-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We also see that</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="chapter-8-model-comparison.html#cb221-1" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fl">1e4</span>,<span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="fl">0.25</span>)</span>
<span id="cb221-2"><a href="chapter-8-model-comparison.html#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(bw,<span class="at">main =</span> <span class="st">&quot;bw prior&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-120-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Now we see that the PI for 95% is between -0.5 and 0.5.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="chapter-8-model-comparison.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PI</span>(<span class="at">samples =</span> bw,<span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##         3%        98% 
## -0.4858059  0.4828205</code></pre>
<p>In general <strong>the goal</strong> of the priors in this example is to set priors with weak information but also constrain the model from overfitting.</p>
<p>The is how the model looks when finalized:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="chapter-8-model-comparison.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Non interaction model!</span></span>
<span id="cb224-2"><a href="chapter-8-model-comparison.html#cb224-2" aria-hidden="true" tabindex="-1"></a>m8<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb224-3"><a href="chapter-8-model-comparison.html#cb224-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb224-4"><a href="chapter-8-model-comparison.html#cb224-4" aria-hidden="true" tabindex="-1"></a>    blooms_std <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) ,</span>
<span id="cb224-5"><a href="chapter-8-model-comparison.html#cb224-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bw<span class="sc">*</span>water_cent <span class="sc">+</span> bs<span class="sc">*</span>shade_cent ,</span>
<span id="cb224-6"><a href="chapter-8-model-comparison.html#cb224-6" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="fl">0.5</span> , <span class="fl">0.25</span> ) ,</span>
<span id="cb224-7"><a href="chapter-8-model-comparison.html#cb224-7" aria-hidden="true" tabindex="-1"></a>    bw <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.25</span> ) ,</span>
<span id="cb224-8"><a href="chapter-8-model-comparison.html#cb224-8" aria-hidden="true" tabindex="-1"></a>    bs <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.25</span> ) ,</span>
<span id="cb224-9"><a href="chapter-8-model-comparison.html#cb224-9" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb224-10"><a href="chapter-8-model-comparison.html#cb224-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb224-11"><a href="chapter-8-model-comparison.html#cb224-11" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data=</span>d )</span>
<span id="cb224-12"><a href="chapter-8-model-comparison.html#cb224-12" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m8<span class="fl">.4</span>)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3587658</td>
</tr>
<tr class="even">
<td align="right">0.2050338</td>
</tr>
<tr class="odd">
<td align="right">-0.1125315</td>
</tr>
<tr class="even">
<td align="right">0.1581543</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0302189</td>
</tr>
<tr class="even">
<td align="right">0.0368895</td>
</tr>
<tr class="odd">
<td align="right">0.0368757</td>
</tr>
<tr class="even">
<td align="right">0.0214437</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3104702</td>
</tr>
<tr class="even">
<td align="right">0.1460771</td>
</tr>
<tr class="odd">
<td align="right">-0.1714660</td>
</tr>
<tr class="even">
<td align="right">0.1238831</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.4070615</td>
</tr>
<tr class="even">
<td align="right">0.2639904</td>
</tr>
<tr class="odd">
<td align="right">-0.0535971</td>
</tr>
<tr class="even">
<td align="right">0.1924255</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Building the interaction model</strong></p>
<p>The model now look like this:</p>
<p><img src="Images/paste-0ABEB8AB.png" width="242" /></p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="chapter-8-model-comparison.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co">#With interaction</span></span>
<span id="cb225-2"><a href="chapter-8-model-comparison.html#cb225-2" aria-hidden="true" tabindex="-1"></a>m8<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb225-3"><a href="chapter-8-model-comparison.html#cb225-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb225-4"><a href="chapter-8-model-comparison.html#cb225-4" aria-hidden="true" tabindex="-1"></a>    blooms_std <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) ,</span>
<span id="cb225-5"><a href="chapter-8-model-comparison.html#cb225-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bw<span class="sc">*</span>water_cent <span class="sc">+</span> bs<span class="sc">*</span>shade_cent <span class="sc">+</span> bws<span class="sc">*</span>water_cent<span class="sc">*</span>shade_cent ,</span>
<span id="cb225-6"><a href="chapter-8-model-comparison.html#cb225-6" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="fl">0.5</span> , <span class="fl">0.25</span> ) ,</span>
<span id="cb225-7"><a href="chapter-8-model-comparison.html#cb225-7" aria-hidden="true" tabindex="-1"></a>    bw <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.25</span> ) ,</span>
<span id="cb225-8"><a href="chapter-8-model-comparison.html#cb225-8" aria-hidden="true" tabindex="-1"></a>    bs <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.25</span> ) ,</span>
<span id="cb225-9"><a href="chapter-8-model-comparison.html#cb225-9" aria-hidden="true" tabindex="-1"></a>    bws <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.25</span> ) ,</span>
<span id="cb225-10"><a href="chapter-8-model-comparison.html#cb225-10" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb225-11"><a href="chapter-8-model-comparison.html#cb225-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb225-12"><a href="chapter-8-model-comparison.html#cb225-12" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data =</span> d)</span></code></pre></div>
</div>
<div id="plotting-posterior-predictions" class="section level3" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> Plotting posterior predictions</h3>
<p>To do this, we must:</p>
<ol style="list-style-type: decimal">
<li>Draw samples from</li>
</ol>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="chapter-8-model-comparison.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting the non interaction model</span></span>
<span id="cb226-2"><a href="chapter-8-model-comparison.html#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)) <span class="co"># 3 plots in 1 row</span></span>
<span id="cb226-3"><a href="chapter-8-model-comparison.html#cb226-3" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(m8<span class="fl">.4</span>,m8<span class="fl">.5</span>)</span>
<span id="cb226-4"><a href="chapter-8-model-comparison.html#cb226-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(m <span class="cf">in</span> models){</span>
<span id="cb226-5"><a href="chapter-8-model-comparison.html#cb226-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(s <span class="cf">in</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) {</span>
<span id="cb226-6"><a href="chapter-8-model-comparison.html#cb226-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb226-7"><a href="chapter-8-model-comparison.html#cb226-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Create index of observations given the shade level</span></span>
<span id="cb226-8"><a href="chapter-8-model-comparison.html#cb226-8" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> <span class="fu">which</span>(d<span class="sc">$</span>shade_cent<span class="sc">==</span>s) <span class="co">#We have three levels -1, 0 and 1.</span></span>
<span id="cb226-9"><a href="chapter-8-model-comparison.html#cb226-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb226-10"><a href="chapter-8-model-comparison.html#cb226-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Plot each water levels given the shade level</span></span>
<span id="cb226-11"><a href="chapter-8-model-comparison.html#cb226-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(d<span class="sc">$</span>water_cent[idx] </span>
<span id="cb226-12"><a href="chapter-8-model-comparison.html#cb226-12" aria-hidden="true" tabindex="-1"></a>         ,d<span class="sc">$</span>blooms_std[idx] </span>
<span id="cb226-13"><a href="chapter-8-model-comparison.html#cb226-13" aria-hidden="true" tabindex="-1"></a>         ,<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb226-14"><a href="chapter-8-model-comparison.html#cb226-14" aria-hidden="true" tabindex="-1"></a>         ,<span class="at">xlab=</span><span class="st">&quot;water&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;blooms&quot;</span></span>
<span id="cb226-15"><a href="chapter-8-model-comparison.html#cb226-15" aria-hidden="true" tabindex="-1"></a>         ,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span>rangi2</span>
<span id="cb226-16"><a href="chapter-8-model-comparison.html#cb226-16" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb226-17"><a href="chapter-8-model-comparison.html#cb226-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb226-18"><a href="chapter-8-model-comparison.html#cb226-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Draw samples</span></span>
<span id="cb226-19"><a href="chapter-8-model-comparison.html#cb226-19" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> <span class="fu">link</span>(m <span class="co">#Non interaction model</span></span>
<span id="cb226-20"><a href="chapter-8-model-comparison.html#cb226-20" aria-hidden="true" tabindex="-1"></a>               ,<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">shade_cent=</span>s,<span class="at">water_cent=</span><span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>))</span>
<span id="cb226-21"><a href="chapter-8-model-comparison.html#cb226-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb226-22"><a href="chapter-8-model-comparison.html#cb226-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Plotting 20 posterior lines</span></span>
<span id="cb226-23"><a href="chapter-8-model-comparison.html#cb226-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) </span>
<span id="cb226-24"><a href="chapter-8-model-comparison.html#cb226-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lines</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>,<span class="at">y =</span> mu[i,]</span>
<span id="cb226-25"><a href="chapter-8-model-comparison.html#cb226-25" aria-hidden="true" tabindex="-1"></a>            ,<span class="at">col=</span><span class="fu">col.alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.3</span>))</span>
<span id="cb226-26"><a href="chapter-8-model-comparison.html#cb226-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb226-27"><a href="chapter-8-model-comparison.html#cb226-27" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-122"></span>
<img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-122-1.png" alt="Top row = no interaction model, bottum row = innteraction model." width="720" />
<p class="caption">
Figure 9.1: Top row = no interaction model, bottum row = innteraction model.
</p>
</div>
</div>
<div id="plotting-prior-predictions" class="section level3" number="9.3.4">
<h3><span class="header-section-number">9.3.4</span> Plotting prior predictions</h3>
<p>Now we are going to extract priors to plot these.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="chapter-8-model-comparison.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb227-2"><a href="chapter-8-model-comparison.html#cb227-2" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">extract.prior</span>(m8<span class="fl">.5</span>)</span></code></pre></div>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="chapter-8-model-comparison.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting the non interaction model</span></span>
<span id="cb228-2"><a href="chapter-8-model-comparison.html#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)) <span class="co"># 3 plots in 1 row</span></span>
<span id="cb228-3"><a href="chapter-8-model-comparison.html#cb228-3" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(m8<span class="fl">.4</span>,m8<span class="fl">.5</span>)</span>
<span id="cb228-4"><a href="chapter-8-model-comparison.html#cb228-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(m <span class="cf">in</span> models){</span>
<span id="cb228-5"><a href="chapter-8-model-comparison.html#cb228-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(s <span class="cf">in</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) {</span>
<span id="cb228-6"><a href="chapter-8-model-comparison.html#cb228-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb228-7"><a href="chapter-8-model-comparison.html#cb228-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Create index of observations given the shade level</span></span>
<span id="cb228-8"><a href="chapter-8-model-comparison.html#cb228-8" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> <span class="fu">which</span>(d<span class="sc">$</span>shade_cent<span class="sc">==</span>s) <span class="co">#We have three levels -1, 0 and 1.</span></span>
<span id="cb228-9"><a href="chapter-8-model-comparison.html#cb228-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb228-10"><a href="chapter-8-model-comparison.html#cb228-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Plot each water levels given the shade level</span></span>
<span id="cb228-11"><a href="chapter-8-model-comparison.html#cb228-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(d<span class="sc">$</span>water_cent[idx] </span>
<span id="cb228-12"><a href="chapter-8-model-comparison.html#cb228-12" aria-hidden="true" tabindex="-1"></a>         ,d<span class="sc">$</span>blooms_std[idx] </span>
<span id="cb228-13"><a href="chapter-8-model-comparison.html#cb228-13" aria-hidden="true" tabindex="-1"></a>         ,<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">1.5</span>)</span>
<span id="cb228-14"><a href="chapter-8-model-comparison.html#cb228-14" aria-hidden="true" tabindex="-1"></a>         ,<span class="at">xlab=</span><span class="st">&quot;water&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;blooms&quot;</span></span>
<span id="cb228-15"><a href="chapter-8-model-comparison.html#cb228-15" aria-hidden="true" tabindex="-1"></a>         ,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span>rangi2</span>
<span id="cb228-16"><a href="chapter-8-model-comparison.html#cb228-16" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb228-17"><a href="chapter-8-model-comparison.html#cb228-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb228-18"><a href="chapter-8-model-comparison.html#cb228-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb228-19"><a href="chapter-8-model-comparison.html#cb228-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Draw samples</span></span>
<span id="cb228-20"><a href="chapter-8-model-comparison.html#cb228-20" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> <span class="fu">link</span>(m <span class="co">#Non interaction model</span></span>
<span id="cb228-21"><a href="chapter-8-model-comparison.html#cb228-21" aria-hidden="true" tabindex="-1"></a>               ,<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">shade_cent=</span>s,<span class="at">water_cent=</span><span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb228-22"><a href="chapter-8-model-comparison.html#cb228-22" aria-hidden="true" tabindex="-1"></a>               ,<span class="at">post =</span> prior)</span>
<span id="cb228-23"><a href="chapter-8-model-comparison.html#cb228-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb228-24"><a href="chapter-8-model-comparison.html#cb228-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Plotting 20 prior lines</span></span>
<span id="cb228-25"><a href="chapter-8-model-comparison.html#cb228-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) </span>
<span id="cb228-26"><a href="chapter-8-model-comparison.html#cb228-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lines</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>,<span class="at">y =</span> mu[i,]</span>
<span id="cb228-27"><a href="chapter-8-model-comparison.html#cb228-27" aria-hidden="true" tabindex="-1"></a>            ,<span class="at">col=</span><span class="fu">col.alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.3</span>))</span>
<span id="cb228-28"><a href="chapter-8-model-comparison.html#cb228-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb228-29"><a href="chapter-8-model-comparison.html#cb228-29" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-123"></span>
<img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-123-1.png" alt="Top row = no interaction model, bottum row = innteraction model." width="720" />
<p class="caption">
Figure 9.2: Top row = no interaction model, bottum row = innteraction model.
</p>
</div>
<p>We see that the priors both for the interaction and no interaction model is typically within the limits, so that is good.</p>
<p>We can say that the priors are:</p>
<ul>
<li><p>Harmless</p></li>
<li><p>Weakly realistic</p></li>
<li><p>The priors include non or very low bias to positive or negative effects as most things can happen, although the priors tend to be in a reasonable range, hence we are doing better then a flat prior, but we do not include much information either.</p></li>
</ul>
</div>
</div>
<div id="exercises-4" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Exercises</h2>
<div id="m4-2" class="section level3" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> 8M4</h3>
<p>Repeat the tulips analysis, but this time use priors that constrain the effect of water to be positive and the effect of shade to be negative. Use prior predictive simulation. What do these prior assumptions mean for the interaction prior, if anything?</p>
<p>Notes:</p>
<p>Need to be changed, so the prior distribution is higher than 0 and less than 0, thus the distribution of the two distributions must be on each side of 0.</p>
<p>We can do this by manipulating the mean or the standard deviation of the dsitruibutions.</p>
<p>There are two difficulties with this:</p>
<ul>
<li>You can end up having an unrealistic mean. To avoid that, you can manipulate the standard deviation, although that may make too much certainty</li>
<li>Also a normal distribution will never be strictly within some region, as it never touches 0.</li>
</ul>
<p>Thus we can use an exponential distribution, although that only has one tail. Thus we can make a log normal distribution instead.</p>
<p>The model is from code chunk 8.24 - m8.5.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="chapter-8-model-comparison.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Loading data</span></span>
<span id="cb229-2"><a href="chapter-8-model-comparison.html#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb229-3"><a href="chapter-8-model-comparison.html#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;tulips&quot;</span>)</span>
<span id="cb229-4"><a href="chapter-8-model-comparison.html#cb229-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> tulips</span>
<span id="cb229-5"><a href="chapter-8-model-comparison.html#cb229-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-6"><a href="chapter-8-model-comparison.html#cb229-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; water and shade variables are three levels, ordered after amount of water/shade.</span></span>
<span id="cb229-7"><a href="chapter-8-model-comparison.html#cb229-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; Cluster of plants in the same section of the greenhouse.</span></span>
<span id="cb229-8"><a href="chapter-8-model-comparison.html#cb229-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; Blooms = the outcome variable which we have to predict.</span></span>
<span id="cb229-9"><a href="chapter-8-model-comparison.html#cb229-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb229-10"><a href="chapter-8-model-comparison.html#cb229-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Transforming the data</span></span>
<span id="cb229-11"><a href="chapter-8-model-comparison.html#cb229-11" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>blooms_std <span class="ot">&lt;-</span> d<span class="sc">$</span>blooms <span class="sc">/</span> <span class="fu">max</span>(d<span class="sc">$</span>blooms)</span>
<span id="cb229-12"><a href="chapter-8-model-comparison.html#cb229-12" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>water_cent <span class="ot">&lt;-</span> d<span class="sc">$</span>water <span class="sc">-</span> <span class="fu">mean</span>(d<span class="sc">$</span>water)</span>
<span id="cb229-13"><a href="chapter-8-model-comparison.html#cb229-13" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>shade_cent <span class="ot">&lt;-</span> d<span class="sc">$</span>shade <span class="sc">-</span> <span class="fu">mean</span>(d<span class="sc">$</span>shade)</span></code></pre></div>
<div id="interaction-model" class="section level4" number="9.4.1.1">
<h4><span class="header-section-number">9.4.1.1</span> Interaction model</h4>
<p><strong>Model specification</strong></p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="chapter-8-model-comparison.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The model</span></span>
<span id="cb230-2"><a href="chapter-8-model-comparison.html#cb230-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb230-3"><a href="chapter-8-model-comparison.html#cb230-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb230-4"><a href="chapter-8-model-comparison.html#cb230-4" aria-hidden="true" tabindex="-1"></a>    blooms_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu,sigma),</span>
<span id="cb230-5"><a href="chapter-8-model-comparison.html#cb230-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bw <span class="sc">*</span> water_cent <span class="sc">-</span> bs <span class="sc">*</span> shade_cent <span class="sc">+</span> bws <span class="sc">*</span> water_cent <span class="sc">*</span> shade_cent, <span class="co">#Notice there is minus bs</span></span>
<span id="cb230-6"><a href="chapter-8-model-comparison.html#cb230-6" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="fl">0.5</span>,<span class="fl">0.25</span>),</span>
<span id="cb230-7"><a href="chapter-8-model-comparison.html#cb230-7" aria-hidden="true" tabindex="-1"></a>    bw <span class="sc">~</span> <span class="fu">dlnorm</span>(<span class="dv">0</span>,<span class="fl">0.25</span>),</span>
<span id="cb230-8"><a href="chapter-8-model-comparison.html#cb230-8" aria-hidden="true" tabindex="-1"></a>    bs <span class="sc">~</span> <span class="fu">dlnorm</span>(<span class="dv">0</span>,<span class="fl">0.25</span>),</span>
<span id="cb230-9"><a href="chapter-8-model-comparison.html#cb230-9" aria-hidden="true" tabindex="-1"></a>    bws <span class="sc">~</span> <span class="fu">dlnorm</span>(<span class="dv">0</span>,<span class="fl">0.25</span>),</span>
<span id="cb230-10"><a href="chapter-8-model-comparison.html#cb230-10" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb230-11"><a href="chapter-8-model-comparison.html#cb230-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb230-12"><a href="chapter-8-model-comparison.html#cb230-12" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data =</span> d</span>
<span id="cb230-13"><a href="chapter-8-model-comparison.html#cb230-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb230-14"><a href="chapter-8-model-comparison.html#cb230-14" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3822041</td>
</tr>
<tr class="even">
<td align="right">0.5410913</td>
</tr>
<tr class="odd">
<td align="right">0.5081694</td>
</tr>
<tr class="even">
<td align="right">0.4926979</td>
</tr>
<tr class="odd">
<td align="right">0.6048014</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1058485</td>
</tr>
<tr class="even">
<td align="right">0.0990471</td>
</tr>
<tr class="odd">
<td align="right">0.0967641</td>
</tr>
<tr class="even">
<td align="right">0.1027979</td>
</tr>
<tr class="odd">
<td align="right">0.1203730</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.2130377</td>
</tr>
<tr class="even">
<td align="right">0.3827949</td>
</tr>
<tr class="odd">
<td align="right">0.3535217</td>
</tr>
<tr class="even">
<td align="right">0.3284070</td>
</tr>
<tr class="odd">
<td align="right">0.4124220</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.5513704</td>
</tr>
<tr class="even">
<td align="right">0.6993877</td>
</tr>
<tr class="odd">
<td align="right">0.6628172</td>
</tr>
<tr class="even">
<td align="right">0.6569888</td>
</tr>
<tr class="odd">
<td align="right">0.7971807</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>We see that the more shade, the less blooms and the more water the more blooms. Although the combination of water and shade will lead to less blooms, I guess because the plant will be drowning in water.</p>
<p><strong>Prior predictive simulation</strong></p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="chapter-8-model-comparison.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb231-2"><a href="chapter-8-model-comparison.html#cb231-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-3"><a href="chapter-8-model-comparison.html#cb231-3" aria-hidden="true" tabindex="-1"></a>simulations <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb231-4"><a href="chapter-8-model-comparison.html#cb231-4" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">extract.prior</span>(m)</span>
<span id="cb231-5"><a href="chapter-8-model-comparison.html#cb231-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-6"><a href="chapter-8-model-comparison.html#cb231-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) {</span>
<span id="cb231-7"><a href="chapter-8-model-comparison.html#cb231-7" aria-hidden="true" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> <span class="fu">which</span>(d<span class="sc">$</span>shade_cent <span class="sc">==</span> s)</span>
<span id="cb231-8"><a href="chapter-8-model-comparison.html#cb231-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> d<span class="sc">$</span>water_cent[idx]</span>
<span id="cb231-9"><a href="chapter-8-model-comparison.html#cb231-9" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">y =</span> d<span class="sc">$</span>blooms[idx]</span>
<span id="cb231-10"><a href="chapter-8-model-comparison.html#cb231-10" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">1.5</span>)</span>
<span id="cb231-11"><a href="chapter-8-model-comparison.html#cb231-11" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">xlab =</span> <span class="st">&quot;water&quot;</span></span>
<span id="cb231-12"><a href="chapter-8-model-comparison.html#cb231-12" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">ylab =</span> <span class="st">&quot;blooms&quot;</span></span>
<span id="cb231-13"><a href="chapter-8-model-comparison.html#cb231-13" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">pch =</span> <span class="dv">16</span></span>
<span id="cb231-14"><a href="chapter-8-model-comparison.html#cb231-14" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">col =</span> rangi2</span>
<span id="cb231-15"><a href="chapter-8-model-comparison.html#cb231-15" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Priors predictive simulation, S = &quot;</span>,s)</span>
<span id="cb231-16"><a href="chapter-8-model-comparison.html#cb231-16" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb231-17"><a href="chapter-8-model-comparison.html#cb231-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb231-18"><a href="chapter-8-model-comparison.html#cb231-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb231-19"><a href="chapter-8-model-comparison.html#cb231-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Call link function to make predictions</span></span>
<span id="cb231-20"><a href="chapter-8-model-comparison.html#cb231-20" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="fu">link</span>(<span class="at">fit =</span> m</span>
<span id="cb231-21"><a href="chapter-8-model-comparison.html#cb231-21" aria-hidden="true" tabindex="-1"></a>             ,<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">shade_cent =</span> s, <span class="at">water_cent =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb231-22"><a href="chapter-8-model-comparison.html#cb231-22" aria-hidden="true" tabindex="-1"></a>             ,<span class="at">post =</span> prior <span class="co">#posterior is just the prior, hence we introduce no data</span></span>
<span id="cb231-23"><a href="chapter-8-model-comparison.html#cb231-23" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb231-24"><a href="chapter-8-model-comparison.html#cb231-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>simulations) {</span>
<span id="cb231-25"><a href="chapter-8-model-comparison.html#cb231-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span></span>
<span id="cb231-26"><a href="chapter-8-model-comparison.html#cb231-26" aria-hidden="true" tabindex="-1"></a>          ,mu[i,]</span>
<span id="cb231-27"><a href="chapter-8-model-comparison.html#cb231-27" aria-hidden="true" tabindex="-1"></a>          ,<span class="at">col =</span> <span class="fu">col.alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.3</span>)</span>
<span id="cb231-28"><a href="chapter-8-model-comparison.html#cb231-28" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb231-29"><a href="chapter-8-model-comparison.html#cb231-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb231-30"><a href="chapter-8-model-comparison.html#cb231-30" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-126-1.png" width="720" style="display: block; margin: auto;" /><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-126-2.png" width="720" style="display: block; margin: auto;" /><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-126-3.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that we are going to regularize the priors even more, to make better priors.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="chapter-8-model-comparison.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The model </span></span>
<span id="cb232-2"><a href="chapter-8-model-comparison.html#cb232-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb232-3"><a href="chapter-8-model-comparison.html#cb232-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb232-4"><a href="chapter-8-model-comparison.html#cb232-4" aria-hidden="true" tabindex="-1"></a>    blooms_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu,sigma),</span>
<span id="cb232-5"><a href="chapter-8-model-comparison.html#cb232-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bw <span class="sc">*</span> water_cent <span class="sc">-</span> bs <span class="sc">*</span> shade_cent <span class="sc">+</span> bws <span class="sc">*</span> water_cent <span class="sc">*</span> shade_cent, <span class="co">#Notice there is minus bs</span></span>
<span id="cb232-6"><a href="chapter-8-model-comparison.html#cb232-6" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="fl">0.5</span>,<span class="fl">0.25</span>),</span>
<span id="cb232-7"><a href="chapter-8-model-comparison.html#cb232-7" aria-hidden="true" tabindex="-1"></a>    bw <span class="sc">~</span> <span class="fu">dlnorm</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fl">0.25</span>), <span class="co">#Set mean to -2</span></span>
<span id="cb232-8"><a href="chapter-8-model-comparison.html#cb232-8" aria-hidden="true" tabindex="-1"></a>    bs <span class="sc">~</span> <span class="fu">dlnorm</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fl">0.25</span>), <span class="co">#Set mean to -2</span></span>
<span id="cb232-9"><a href="chapter-8-model-comparison.html#cb232-9" aria-hidden="true" tabindex="-1"></a>    bws <span class="sc">~</span> <span class="fu">dlnorm</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fl">0.25</span>), <span class="co">#Set mean to -2</span></span>
<span id="cb232-10"><a href="chapter-8-model-comparison.html#cb232-10" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb232-11"><a href="chapter-8-model-comparison.html#cb232-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb232-12"><a href="chapter-8-model-comparison.html#cb232-12" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data =</span> d</span>
<span id="cb232-13"><a href="chapter-8-model-comparison.html#cb232-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb232-14"><a href="chapter-8-model-comparison.html#cb232-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-15"><a href="chapter-8-model-comparison.html#cb232-15" aria-hidden="true" tabindex="-1"></a>simulations <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb232-16"><a href="chapter-8-model-comparison.html#cb232-16" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">extract.prior</span>(m)</span>
<span id="cb232-17"><a href="chapter-8-model-comparison.html#cb232-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-18"><a href="chapter-8-model-comparison.html#cb232-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) {</span>
<span id="cb232-19"><a href="chapter-8-model-comparison.html#cb232-19" aria-hidden="true" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> <span class="fu">which</span>(d<span class="sc">$</span>shade_cent <span class="sc">==</span> s)</span>
<span id="cb232-20"><a href="chapter-8-model-comparison.html#cb232-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> d<span class="sc">$</span>water_cent[idx]</span>
<span id="cb232-21"><a href="chapter-8-model-comparison.html#cb232-21" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">y =</span> d<span class="sc">$</span>blooms[idx]</span>
<span id="cb232-22"><a href="chapter-8-model-comparison.html#cb232-22" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">1.5</span>)</span>
<span id="cb232-23"><a href="chapter-8-model-comparison.html#cb232-23" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">xlab =</span> <span class="st">&quot;water&quot;</span></span>
<span id="cb232-24"><a href="chapter-8-model-comparison.html#cb232-24" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">ylab =</span> <span class="st">&quot;blooms&quot;</span></span>
<span id="cb232-25"><a href="chapter-8-model-comparison.html#cb232-25" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">pch =</span> <span class="dv">16</span></span>
<span id="cb232-26"><a href="chapter-8-model-comparison.html#cb232-26" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">col =</span> rangi2</span>
<span id="cb232-27"><a href="chapter-8-model-comparison.html#cb232-27" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Priors predictive simulation, S = &quot;</span>,s)</span>
<span id="cb232-28"><a href="chapter-8-model-comparison.html#cb232-28" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb232-29"><a href="chapter-8-model-comparison.html#cb232-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb232-30"><a href="chapter-8-model-comparison.html#cb232-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb232-31"><a href="chapter-8-model-comparison.html#cb232-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Call link function to make predictions</span></span>
<span id="cb232-32"><a href="chapter-8-model-comparison.html#cb232-32" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="fu">link</span>(<span class="at">fit =</span> m</span>
<span id="cb232-33"><a href="chapter-8-model-comparison.html#cb232-33" aria-hidden="true" tabindex="-1"></a>             ,<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">shade_cent =</span> s, <span class="at">water_cent =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb232-34"><a href="chapter-8-model-comparison.html#cb232-34" aria-hidden="true" tabindex="-1"></a>             ,<span class="at">post =</span> prior <span class="co">#posterior is just the prior, hence we introduce no data</span></span>
<span id="cb232-35"><a href="chapter-8-model-comparison.html#cb232-35" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb232-36"><a href="chapter-8-model-comparison.html#cb232-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>simulations) {</span>
<span id="cb232-37"><a href="chapter-8-model-comparison.html#cb232-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span></span>
<span id="cb232-38"><a href="chapter-8-model-comparison.html#cb232-38" aria-hidden="true" tabindex="-1"></a>          ,mu[i,]</span>
<span id="cb232-39"><a href="chapter-8-model-comparison.html#cb232-39" aria-hidden="true" tabindex="-1"></a>          ,<span class="at">col =</span> <span class="fu">col.alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.3</span>)</span>
<span id="cb232-40"><a href="chapter-8-model-comparison.html#cb232-40" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb232-41"><a href="chapter-8-model-comparison.html#cb232-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb232-42"><a href="chapter-8-model-comparison.html#cb232-42" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-127-1.png" width="720" style="display: block; margin: auto;" /><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-127-2.png" width="720" style="display: block; margin: auto;" /><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-127-3.png" width="720" style="display: block; margin: auto;" /></p>
</div>
<div id="conclusion" class="section level4" number="9.4.1.2">
<h4><span class="header-section-number">9.4.1.2</span> Conclusion</h4>
<p>We see that the regularized priors are more realistic.</p>
<p><strong>Never plot the priors with the actual data points, that is just done for practical reasons.</strong></p>
</div>
</div>
<div id="h3-3" class="section level3" number="9.4.2">
<h3><span class="header-section-number">9.4.2</span> 8H3</h3>
<p>Consider again the data(rugged) data aon economic development and terrain ruggedness, examined in this chapter. One of the African countries in that example, Seychelles, if far outside the cloud of other nations, being a rare country with both relatively high GDP and high ruggedness. Seychelles is also unusual, in that it is a group of islands far from the coast of mainland Africa, and its main economic activity is tourism.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Focus on model <code>m8.5</code> (must be m8.3) form the chapter. Use WAIC pointwise penalties and PSIS pareto k values to measure relative influence of each country. By these criteria, us Seychelles influencing the results? Are there other nations that are relatively influential? If so, can you explain way?</p></li>
<li><p>Now use robust regression, as described in the previous chapter. Modfiy m8.5 to use a student-t distribution with v = 2. Does this chagne the results in a substantial way?</p></li>
</ol>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="chapter-8-model-comparison.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The data</span></span>
<span id="cb233-2"><a href="chapter-8-model-comparison.html#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb233-3"><a href="chapter-8-model-comparison.html#cb233-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(rugged)</span>
<span id="cb233-4"><a href="chapter-8-model-comparison.html#cb233-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> rugged</span>
<span id="cb233-5"><a href="chapter-8-model-comparison.html#cb233-5" aria-hidden="true" tabindex="-1"></a><span class="co"># make log version of outcome</span></span>
<span id="cb233-6"><a href="chapter-8-model-comparison.html#cb233-6" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>log_gdp <span class="ot">&lt;-</span> <span class="fu">log</span>( d<span class="sc">$</span>rgdppc_2000 )</span>
<span id="cb233-7"><a href="chapter-8-model-comparison.html#cb233-7" aria-hidden="true" tabindex="-1"></a><span class="co"># extract countries with GDP data</span></span>
<span id="cb233-8"><a href="chapter-8-model-comparison.html#cb233-8" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> d[ <span class="fu">complete.cases</span>(d<span class="sc">$</span>rgdppc_2000) , ]</span>
<span id="cb233-9"><a href="chapter-8-model-comparison.html#cb233-9" aria-hidden="true" tabindex="-1"></a><span class="co"># rescale variables</span></span>
<span id="cb233-10"><a href="chapter-8-model-comparison.html#cb233-10" aria-hidden="true" tabindex="-1"></a>dd<span class="sc">$</span>log_gdp_std <span class="ot">&lt;-</span> dd<span class="sc">$</span>log_gdp <span class="sc">/</span> <span class="fu">mean</span>(dd<span class="sc">$</span>log_gdp)</span>
<span id="cb233-11"><a href="chapter-8-model-comparison.html#cb233-11" aria-hidden="true" tabindex="-1"></a>dd<span class="sc">$</span>rugged_std <span class="ot">&lt;-</span> dd<span class="sc">$</span>rugged <span class="sc">/</span> <span class="fu">max</span>(dd<span class="sc">$</span>rugged)</span>
<span id="cb233-12"><a href="chapter-8-model-comparison.html#cb233-12" aria-hidden="true" tabindex="-1"></a>dd<span class="sc">$</span>cid <span class="ot">&lt;-</span> <span class="fu">ifelse</span>( dd<span class="sc">$</span>cont_africa<span class="sc">==</span><span class="dv">1</span> , <span class="dv">1</span> , <span class="dv">2</span> )</span>
<span id="cb233-13"><a href="chapter-8-model-comparison.html#cb233-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-14"><a href="chapter-8-model-comparison.html#cb233-14" aria-hidden="true" tabindex="-1"></a><span class="co">#The model</span></span>
<span id="cb233-15"><a href="chapter-8-model-comparison.html#cb233-15" aria-hidden="true" tabindex="-1"></a>m8<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb233-16"><a href="chapter-8-model-comparison.html#cb233-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb233-17"><a href="chapter-8-model-comparison.html#cb233-17" aria-hidden="true" tabindex="-1"></a>    log_gdp_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu,sigma),</span>
<span id="cb233-18"><a href="chapter-8-model-comparison.html#cb233-18" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a[cid] <span class="sc">+</span> b[cid] <span class="sc">*</span> (rugged_std <span class="sc">-</span> <span class="fl">0.215</span>), <span class="co">#0.215 is the mean</span></span>
<span id="cb233-19"><a href="chapter-8-model-comparison.html#cb233-19" aria-hidden="true" tabindex="-1"></a>    a[cid] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">1</span>,<span class="fl">0.1</span>),</span>
<span id="cb233-20"><a href="chapter-8-model-comparison.html#cb233-20" aria-hidden="true" tabindex="-1"></a>    b[cid] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.3</span>),</span>
<span id="cb233-21"><a href="chapter-8-model-comparison.html#cb233-21" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb233-22"><a href="chapter-8-model-comparison.html#cb233-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb233-23"><a href="chapter-8-model-comparison.html#cb233-23" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data =</span> dd</span>
<span id="cb233-24"><a href="chapter-8-model-comparison.html#cb233-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb233-25"><a href="chapter-8-model-comparison.html#cb233-25" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m8<span class="fl">.3</span>,<span class="at">depth =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.8865639</td>
</tr>
<tr class="even">
<td align="right">1.0505696</td>
</tr>
<tr class="odd">
<td align="right">0.1325055</td>
</tr>
<tr class="even">
<td align="right">-0.1425763</td>
</tr>
<tr class="odd">
<td align="right">0.1094900</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0156751</td>
</tr>
<tr class="even">
<td align="right">0.0099362</td>
</tr>
<tr class="odd">
<td align="right">0.0742018</td>
</tr>
<tr class="even">
<td align="right">0.0547474</td>
</tr>
<tr class="odd">
<td align="right">0.0059347</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.8615121</td>
</tr>
<tr class="even">
<td align="right">1.0346896</td>
</tr>
<tr class="odd">
<td align="right">0.0139167</td>
</tr>
<tr class="even">
<td align="right">-0.2300732</td>
</tr>
<tr class="odd">
<td align="right">0.1000051</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.9116158</td>
</tr>
<tr class="even">
<td align="right">1.0664496</td>
</tr>
<tr class="odd">
<td align="right">0.2510943</td>
</tr>
<tr class="even">
<td align="right">-0.0550794</td>
</tr>
<tr class="odd">
<td align="right">0.1189748</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>We see that there is one intercept, if it is Africa or not and the same of the betas. Where 1 = Africa and 2 = all other.</p>
<p>We see that in non african countries the log of gdp (standardized) is decreasing whenever ruggedness is increasing.</p>
<p>Also we see that the gdp is in general higher in non african countries compared to african countries as the intercept is higher.</p>
<div id="h3a" class="section level4" number="9.4.2.1">
<h4><span class="header-section-number">9.4.2.1</span> 8H3A</h4>
<p><strong>Now lets answer Q A to see if there are some outlier countries</strong></p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="chapter-8-model-comparison.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">137</span>)</span>
<span id="cb234-2"><a href="chapter-8-model-comparison.html#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">PSISk</span>(m8<span class="fl">.3</span>),<span class="at">pch =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-129-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Now we see that there are some countries that seem to be having higher values than the rest. That implies that these countries are harder to estimate. Lets inspectect which these were.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="chapter-8-model-comparison.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">137</span>)</span>
<span id="cb235-2"><a href="chapter-8-model-comparison.html#cb235-2" aria-hidden="true" tabindex="-1"></a>dd<span class="sc">$</span>PSISk <span class="ot">&lt;-</span> <span class="fu">PSISk</span>(m8<span class="fl">.3</span>)</span>
<span id="cb235-3"><a href="chapter-8-model-comparison.html#cb235-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dd[<span class="fu">order</span>(<span class="sc">-</span>dd<span class="sc">$</span>PSISk),<span class="fu">c</span>(<span class="st">&quot;country&quot;</span>,<span class="st">&quot;cid&quot;</span>,<span class="st">&quot;log_gdp_std&quot;</span>,<span class="st">&quot;rugged_std&quot;</span>,<span class="st">&quot;PSISk&quot;</span>)])</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">country</th>
<th align="right">cid</th>
<th align="right">log_gdp_std</th>
<th align="right">rugged_std</th>
<th align="right">PSISk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">122</td>
<td align="left">Lesotho</td>
<td align="right">1</td>
<td align="right">0.8994088</td>
<td align="right">1.0000000</td>
<td align="right">0.55</td>
</tr>
<tr class="even">
<td align="left">199</td>
<td align="left">Seychelles</td>
<td align="right">1</td>
<td align="right">1.1501264</td>
<td align="right">0.7876491</td>
<td align="right">0.47</td>
</tr>
<tr class="odd">
<td align="left">205</td>
<td align="left">Tajikistan</td>
<td align="right">2</td>
<td align="right">0.7826922</td>
<td align="right">0.8547243</td>
<td align="right">0.36</td>
</tr>
<tr class="even">
<td align="left">55</td>
<td align="left">Djibouti</td>
<td align="right">1</td>
<td align="right">0.8852846</td>
<td align="right">0.3921316</td>
<td align="right">0.33</td>
</tr>
<tr class="odd">
<td align="left">179</td>
<td align="left">Rwanda</td>
<td align="right">1</td>
<td align="right">0.8155552</td>
<td align="right">0.5335376</td>
<td align="right">0.33</td>
</tr>
<tr class="even">
<td align="left">46</td>
<td align="left">Comoros</td>
<td align="right">1</td>
<td align="right">0.8780973</td>
<td align="right">0.5366011</td>
<td align="right">0.32</td>
</tr>
</tbody>
</table>
</div>
<p>We see that these countries appear to primarily bee african countries that are hard to predict. We see that Lesotho and Sychelles both are much more rugged than the other countries (the mean is 0.215), where they lie around the observed mean log_gdp_std (which is 1).</p>
<p>We can manually calculate some point estimates.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="chapter-8-model-comparison.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Seychelles, estimate = 0.8994088</span></span>
<span id="cb236-2"><a href="chapter-8-model-comparison.html#cb236-2" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">=</span> <span class="fl">0.89</span></span>
<span id="cb236-3"><a href="chapter-8-model-comparison.html#cb236-3" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="fl">0.13</span></span>
<span id="cb236-4"><a href="chapter-8-model-comparison.html#cb236-4" aria-hidden="true" tabindex="-1"></a>rug_mean <span class="ot">=</span> <span class="fl">0.215</span></span>
<span id="cb236-5"><a href="chapter-8-model-comparison.html#cb236-5" aria-hidden="true" tabindex="-1"></a>rug_std <span class="ot">=</span> dd<span class="sc">$</span>rugged_std[dd<span class="sc">$</span>country <span class="sc">==</span> <span class="st">&#39;Seychelles&#39;</span>]</span>
<span id="cb236-6"><a href="chapter-8-model-comparison.html#cb236-6" aria-hidden="true" tabindex="-1"></a>a1 <span class="sc">+</span> b1 <span class="sc">*</span> (rug_std <span class="sc">-</span> rug_mean)</span>
<span id="cb236-7"><a href="chapter-8-model-comparison.html#cb236-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-8"><a href="chapter-8-model-comparison.html#cb236-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Lesotho, estimate = 1.1501264</span></span>
<span id="cb236-9"><a href="chapter-8-model-comparison.html#cb236-9" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">=</span> <span class="fl">0.89</span></span>
<span id="cb236-10"><a href="chapter-8-model-comparison.html#cb236-10" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="fl">0.13</span></span>
<span id="cb236-11"><a href="chapter-8-model-comparison.html#cb236-11" aria-hidden="true" tabindex="-1"></a>rug_mean <span class="ot">=</span> <span class="fl">0.215</span></span>
<span id="cb236-12"><a href="chapter-8-model-comparison.html#cb236-12" aria-hidden="true" tabindex="-1"></a>rug_std <span class="ot">=</span> dd<span class="sc">$</span>rugged_std[dd<span class="sc">$</span>country <span class="sc">==</span> <span class="st">&#39;Lesotho&#39;</span>]</span>
<span id="cb236-13"><a href="chapter-8-model-comparison.html#cb236-13" aria-hidden="true" tabindex="-1"></a>a1 <span class="sc">+</span> b1 <span class="sc">*</span> (rug_std <span class="sc">-</span> rug_mean)</span>
<span id="cb236-14"><a href="chapter-8-model-comparison.html#cb236-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-15"><a href="chapter-8-model-comparison.html#cb236-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Tajikistan, estimate = 0.7826922</span></span>
<span id="cb236-16"><a href="chapter-8-model-comparison.html#cb236-16" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">=</span> <span class="fl">1.05</span></span>
<span id="cb236-17"><a href="chapter-8-model-comparison.html#cb236-17" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">=</span> <span class="sc">-</span><span class="fl">0.14</span></span>
<span id="cb236-18"><a href="chapter-8-model-comparison.html#cb236-18" aria-hidden="true" tabindex="-1"></a>rug_mean <span class="ot">=</span> <span class="fl">0.215</span></span>
<span id="cb236-19"><a href="chapter-8-model-comparison.html#cb236-19" aria-hidden="true" tabindex="-1"></a>rug_std <span class="ot">=</span> dd<span class="sc">$</span>rugged_std[dd<span class="sc">$</span>country <span class="sc">==</span> <span class="st">&#39;Tajikistan&#39;</span>]</span>
<span id="cb236-20"><a href="chapter-8-model-comparison.html#cb236-20" aria-hidden="true" tabindex="-1"></a>a2 <span class="sc">+</span> b2 <span class="sc">*</span> (rug_std <span class="sc">-</span> rug_mean)</span></code></pre></div>
<pre><code>## [1] 0.9644444
## [1] 0.99205
## [1] 0.9604386</code></pre>
<p>We see that Seychelles have a higher gdp than expected, while lesotho is lower than expected and tajikistan is much lower than expected.</p>
</div>
<div id="h3b" class="section level4" number="9.4.2.2">
<h4><span class="header-section-number">9.4.2.2</span> 8H3B</h4>
<p><em>Now use robust regression, as described in the previous chapter. Modfiy m8.5 to use a student-t distribution with v = 2. Does this chagne the results in a substantial way?</em></p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="chapter-8-model-comparison.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The model</span></span>
<span id="cb238-2"><a href="chapter-8-model-comparison.html#cb238-2" aria-hidden="true" tabindex="-1"></a>m8<span class="fl">.3</span>b <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb238-3"><a href="chapter-8-model-comparison.html#cb238-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb238-4"><a href="chapter-8-model-comparison.html#cb238-4" aria-hidden="true" tabindex="-1"></a>    log_gdp_std <span class="sc">~</span> <span class="fu">dstudent</span>(<span class="at">nu =</span> <span class="dv">2</span>,mu,sigma),</span>
<span id="cb238-5"><a href="chapter-8-model-comparison.html#cb238-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a[cid] <span class="sc">+</span> b[cid] <span class="sc">*</span> (rugged_std <span class="sc">-</span> <span class="fl">0.215</span>), <span class="co">#0.215 is the mean</span></span>
<span id="cb238-6"><a href="chapter-8-model-comparison.html#cb238-6" aria-hidden="true" tabindex="-1"></a>    a[cid] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">1</span>,<span class="fl">0.1</span>),</span>
<span id="cb238-7"><a href="chapter-8-model-comparison.html#cb238-7" aria-hidden="true" tabindex="-1"></a>    b[cid] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.3</span>),</span>
<span id="cb238-8"><a href="chapter-8-model-comparison.html#cb238-8" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb238-9"><a href="chapter-8-model-comparison.html#cb238-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb238-10"><a href="chapter-8-model-comparison.html#cb238-10" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data =</span> dd</span>
<span id="cb238-11"><a href="chapter-8-model-comparison.html#cb238-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb238-12"><a href="chapter-8-model-comparison.html#cb238-12" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m8<span class="fl">.3</span>b,<span class="at">depth =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.8626690</td>
</tr>
<tr class="even">
<td align="right">1.0456856</td>
</tr>
<tr class="odd">
<td align="right">0.1130584</td>
</tr>
<tr class="even">
<td align="right">-0.2135288</td>
</tr>
<tr class="odd">
<td align="right">0.0845281</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0161602</td>
</tr>
<tr class="even">
<td align="right">0.0109710</td>
</tr>
<tr class="odd">
<td align="right">0.0752908</td>
</tr>
<tr class="even">
<td align="right">0.0635400</td>
</tr>
<tr class="odd">
<td align="right">0.0067326</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.8368419</td>
</tr>
<tr class="even">
<td align="right">1.0281518</td>
</tr>
<tr class="odd">
<td align="right">-0.0072708</td>
</tr>
<tr class="even">
<td align="right">-0.3150781</td>
</tr>
<tr class="odd">
<td align="right">0.0737680</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.8884961</td>
</tr>
<tr class="even">
<td align="right">1.0632194</td>
</tr>
<tr class="odd">
<td align="right">0.2333876</td>
</tr>
<tr class="even">
<td align="right">-0.1119796</td>
</tr>
<tr class="odd">
<td align="right">0.0952881</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="chapter-8-model-comparison.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">137</span>)</span>
<span id="cb239-2"><a href="chapter-8-model-comparison.html#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="fl">0.3</span>))</span>
<span id="cb239-3"><a href="chapter-8-model-comparison.html#cb239-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">PSISk</span>(m8<span class="fl">.3</span>b),<span class="at">pch =</span> <span class="dv">20</span>,<span class="at">col =</span> <span class="st">&quot;#d8b365&quot;</span>,<span class="at">sub =</span> <span class="st">&quot;Brown = robust, Blue = initial model&quot;</span>,<span class="at">main =</span> <span class="st">&quot;Robust vs. Initial model&quot;</span></span>
<span id="cb239-4"><a href="chapter-8-model-comparison.html#cb239-4" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(<span class="fu">PSISk</span>(m8<span class="fl">.3</span>b),<span class="fu">PSISk</span>(m8<span class="fl">.3</span>)),<span class="fu">max</span>(<span class="fu">PSISk</span>(m8<span class="fl">.3</span>b),<span class="fu">PSISk</span>(m8<span class="fl">.3</span>))),<span class="at">ylab =</span> <span class="st">&quot;PSISk&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;Country&quot;</span>)</span>
<span id="cb239-5"><a href="chapter-8-model-comparison.html#cb239-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">PSISk</span>(m8<span class="fl">.3</span>),<span class="at">pch =</span> <span class="dv">20</span>,<span class="at">col =</span> <span class="st">&quot;#5ab4ac&quot;</span>)</span>
<span id="cb239-6"><a href="chapter-8-model-comparison.html#cb239-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(<span class="fu">PSISk</span>(m8<span class="fl">.3</span>b)),<span class="at">col =</span> <span class="st">&quot;#d8b365&quot;</span>,<span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb239-7"><a href="chapter-8-model-comparison.html#cb239-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(<span class="fu">PSISk</span>(m8<span class="fl">.3</span>)),<span class="at">col =</span> <span class="st">&quot;#5ab4ac&quot;</span>,<span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb239-8"><a href="chapter-8-model-comparison.html#cb239-8" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-133-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that the robust model is having less high values, although the overall error appears to be slightly larger, but in we missing out on less observations.</p>
<p>The reason is that the students t distribution is having fatter tails, thus it is less surprised when it is seeing extreme values.</p>
<p>Now we are able to identify the different beta parameter values for the different models. Notice that the blue model is less certain.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="chapter-8-model-comparison.html#cb240-1" aria-hidden="true" tabindex="-1"></a>postN <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m8<span class="fl">.3</span>)</span>
<span id="cb240-2"><a href="chapter-8-model-comparison.html#cb240-2" aria-hidden="true" tabindex="-1"></a>postT <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m8<span class="fl">.3</span>b)</span>
<span id="cb240-3"><a href="chapter-8-model-comparison.html#cb240-3" aria-hidden="true" tabindex="-1"></a>diffN <span class="ot">&lt;-</span> postN<span class="sc">$</span>b[,<span class="dv">1</span>] <span class="sc">-</span> postN<span class="sc">$</span>b[,<span class="dv">2</span>]</span>
<span id="cb240-4"><a href="chapter-8-model-comparison.html#cb240-4" aria-hidden="true" tabindex="-1"></a>diffT <span class="ot">&lt;-</span> postT<span class="sc">$</span>b[,<span class="dv">1</span>] <span class="sc">-</span> postT<span class="sc">$</span>b[,<span class="dv">2</span>]</span>
<span id="cb240-5"><a href="chapter-8-model-comparison.html#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(diffN,<span class="at">main =</span> <span class="st">&quot;Blue = Students t, Black = initial model&quot;</span>)</span>
<span id="cb240-6"><a href="chapter-8-model-comparison.html#cb240-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(diffT , <span class="at">add=</span><span class="cn">TRUE</span> , <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-134-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="chapter-8-model-comparison.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="h5-3" class="section level3" number="9.4.3">
<h3><span class="header-section-number">9.4.3</span> 8H5</h3>
<p>Consider the data(wines2012) data table. These data are expert ratings of 20 different French an America wines by 9 different French and American judges. Your goal is to model <code>score</code>, the subjective rating assigned buy each judge and wines. Construct index variable of <code>judge</code> and <code>wine</code> and then use these index variables to construct a linear regression model. Justify your priors. You should end up with 9 judge parameters and 20 wine parameters. How do you interpret the variation among individual judges and individual wines? Do you notice any patterns, just by plotting the differences? Which judges gave the highest/lowest ratings? Which wines were rated wors/best on average?</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="chapter-8-model-comparison.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Wines2012&quot;</span>)</span>
<span id="cb242-2"><a href="chapter-8-model-comparison.html#cb242-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> Wines2012</span>
<span id="cb242-3"><a href="chapter-8-model-comparison.html#cb242-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">judge</th>
<th align="left">flight</th>
<th align="left">wine</th>
<th align="right">score</th>
<th align="right">wine.amer</th>
<th align="right">judge.amer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Jean-M Cardebat</td>
<td align="left">white</td>
<td align="left">A1</td>
<td align="right">10</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Jean-M Cardebat</td>
<td align="left">white</td>
<td align="left">B1</td>
<td align="right">13</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Jean-M Cardebat</td>
<td align="left">white</td>
<td align="left">C1</td>
<td align="right">14</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Jean-M Cardebat</td>
<td align="left">white</td>
<td align="left">D1</td>
<td align="right">15</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Jean-M Cardebat</td>
<td align="left">white</td>
<td align="left">E1</td>
<td align="right">8</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Jean-M Cardebat</td>
<td align="left">white</td>
<td align="left">F1</td>
<td align="right">13</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<p>Lets create the indexes:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="chapter-8-model-comparison.html#cb243-1" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>wid <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(d<span class="sc">$</span>wine)</span>
<span id="cb243-2"><a href="chapter-8-model-comparison.html#cb243-2" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>jid <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(d<span class="sc">$</span>judge)</span>
<span id="cb243-3"><a href="chapter-8-model-comparison.html#cb243-3" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>score_std <span class="ot">&lt;-</span> <span class="fu">standardize</span>(d<span class="sc">$</span>score)</span>
<span id="cb243-4"><a href="chapter-8-model-comparison.html#cb243-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d[,<span class="sc">!</span>(<span class="fu">colnames</span>(d) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;wine.amer&quot;</span>,<span class="st">&quot;judge.amer&quot;</span>))] <span class="co">#remove unnecessary columns</span></span>
<span id="cb243-5"><a href="chapter-8-model-comparison.html#cb243-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">unique</span>(d))</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">judge</th>
<th align="left">flight</th>
<th align="left">wine</th>
<th align="right">score</th>
<th align="right">wid</th>
<th align="right">jid</th>
<th align="right">score_std</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Jean-M Cardebat</td>
<td align="left">white</td>
<td align="left">A1</td>
<td align="right">10</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">-1.5766041</td>
</tr>
<tr class="even">
<td align="left">Jean-M Cardebat</td>
<td align="left">white</td>
<td align="left">B1</td>
<td align="right">13</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">-0.4504583</td>
</tr>
<tr class="odd">
<td align="left">Jean-M Cardebat</td>
<td align="left">white</td>
<td align="left">C1</td>
<td align="right">14</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">-0.0750764</td>
</tr>
<tr class="even">
<td align="left">Jean-M Cardebat</td>
<td align="left">white</td>
<td align="left">D1</td>
<td align="right">15</td>
<td align="right">7</td>
<td align="right">4</td>
<td align="right">0.3003055</td>
</tr>
<tr class="odd">
<td align="left">Jean-M Cardebat</td>
<td align="left">white</td>
<td align="left">E1</td>
<td align="right">8</td>
<td align="right">9</td>
<td align="right">4</td>
<td align="right">-2.3273680</td>
</tr>
<tr class="even">
<td align="left">Jean-M Cardebat</td>
<td align="left">white</td>
<td align="left">F1</td>
<td align="right">13</td>
<td align="right">11</td>
<td align="right">4</td>
<td align="right">-0.4504583</td>
</tr>
</tbody>
</table>
</div>
<p>Notice that the values are standardized, hence the prior should also have that in mind. See the following distribution of a prior suggestion.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="chapter-8-model-comparison.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>,<span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="fl">0.2</span>),<span class="at">main =</span> <span class="st">&quot;Prior - mean = 0, sd = 0.2&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-138-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="chapter-8-model-comparison.html#cb245-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb245-2"><a href="chapter-8-model-comparison.html#cb245-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb245-3"><a href="chapter-8-model-comparison.html#cb245-3" aria-hidden="true" tabindex="-1"></a>    score_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu,sigma),</span>
<span id="cb245-4"><a href="chapter-8-model-comparison.html#cb245-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a1[wid] <span class="sc">+</span> a2[jid] <span class="sc">+</span> sigma,</span>
<span id="cb245-5"><a href="chapter-8-model-comparison.html#cb245-5" aria-hidden="true" tabindex="-1"></a>    a1[wid] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="co">#We say it is around the center of all wines</span></span>
<span id="cb245-6"><a href="chapter-8-model-comparison.html#cb245-6" aria-hidden="true" tabindex="-1"></a>    a2[jid] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="co">#We say it is around the center of all wines</span></span>
<span id="cb245-7"><a href="chapter-8-model-comparison.html#cb245-7" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>) <span class="co">#tend towards 0, but decreases exponentially</span></span>
<span id="cb245-8"><a href="chapter-8-model-comparison.html#cb245-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb245-9"><a href="chapter-8-model-comparison.html#cb245-9" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data =</span> d</span>
<span id="cb245-10"><a href="chapter-8-model-comparison.html#cb245-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb245-11"><a href="chapter-8-model-comparison.html#cb245-11" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m,<span class="at">depth =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.0975300</td>
</tr>
<tr class="even">
<td align="right">-0.1136502</td>
</tr>
<tr class="odd">
<td align="right">-0.0411093</td>
</tr>
<tr class="even">
<td align="right">0.0797922</td>
</tr>
<tr class="odd">
<td align="right">-0.2103713</td>
</tr>
<tr class="even">
<td align="right">-0.3151526</td>
</tr>
<tr class="odd">
<td align="right">-0.0330491</td>
</tr>
<tr class="even">
<td align="right">-0.0411093</td>
</tr>
<tr class="odd">
<td align="right">-0.1217103</td>
</tr>
<tr class="even">
<td align="right">-0.1055901</td>
</tr>
<tr class="odd">
<td align="right">-0.1620107</td>
</tr>
<tr class="even">
<td align="right">-0.1700708</td>
</tr>
<tr class="odd">
<td align="right">-0.2023113</td>
</tr>
<tr class="even">
<td align="right">-0.1539507</td>
</tr>
<tr class="odd">
<td align="right">-0.2506718</td>
</tr>
<tr class="even">
<td align="right">-0.2426118</td>
</tr>
<tr class="odd">
<td align="right">-0.2184315</td>
</tr>
<tr class="even">
<td align="right">-0.5247153</td>
</tr>
<tr class="odd">
<td align="right">-0.2264916</td>
</tr>
<tr class="even">
<td align="right">0.0072514</td>
</tr>
<tr class="odd">
<td align="right">-0.5354002</td>
</tr>
<tr class="even">
<td align="right">-0.2069480</td>
</tr>
<tr class="odd">
<td align="right">-0.2124223</td>
</tr>
<tr class="even">
<td align="right">-0.7105747</td>
</tr>
<tr class="odd">
<td align="right">0.1817203</td>
</tr>
<tr class="even">
<td align="right">-0.0317736</td>
</tr>
<tr class="odd">
<td align="right">-0.2616900</td>
</tr>
<tr class="even">
<td align="right">-0.7872135</td>
</tr>
<tr class="odd">
<td align="right">-0.5791938</td>
</tr>
<tr class="even">
<td align="right">0.7559472</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1579120</td>
</tr>
<tr class="even">
<td align="right">0.1578767</td>
</tr>
<tr class="odd">
<td align="right">0.1580826</td>
</tr>
<tr class="even">
<td align="right">0.1586934</td>
</tr>
<tr class="odd">
<td align="right">0.1577904</td>
</tr>
<tr class="even">
<td align="right">0.1579402</td>
</tr>
<tr class="odd">
<td align="right">0.1581130</td>
</tr>
<tr class="even">
<td align="right">0.1580826</td>
</tr>
<tr class="odd">
<td align="right">0.1578613</td>
</tr>
<tr class="even">
<td align="right">0.1578936</td>
</tr>
<tr class="odd">
<td align="right">0.1578066</td>
</tr>
<tr class="even">
<td align="right">0.1578002</td>
</tr>
<tr class="odd">
<td align="right">0.1577894</td>
</tr>
<tr class="even">
<td align="right">0.1578146</td>
</tr>
<tr class="odd">
<td align="right">0.1578181</td>
</tr>
<tr class="even">
<td align="right">0.1578096</td>
</tr>
<tr class="odd">
<td align="right">0.1577930</td>
</tr>
<tr class="even">
<td align="right">0.1589943</td>
</tr>
<tr class="odd">
<td align="right">0.1577970</td>
</tr>
<tr class="even">
<td align="right">0.1582869</td>
</tr>
<tr class="odd">
<td align="right">0.1311845</td>
</tr>
<tr class="even">
<td align="right">0.1316898</td>
</tr>
<tr class="odd">
<td align="right">0.1316702</td>
</tr>
<tr class="even">
<td align="right">0.1314781</td>
</tr>
<tr class="odd">
<td align="right">0.1340408</td>
</tr>
<tr class="even">
<td align="right">0.1325181</td>
</tr>
<tr class="odd">
<td align="right">0.1315102</td>
</tr>
<tr class="even">
<td align="right">0.1317293</td>
</tr>
<tr class="odd">
<td align="right">0.1312212</td>
</tr>
<tr class="even">
<td align="right">0.0371506</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.3499039</td>
</tr>
<tr class="even">
<td align="right">-0.3659676</td>
</tr>
<tr class="odd">
<td align="right">-0.2937559</td>
</tr>
<tr class="even">
<td align="right">-0.1738305</td>
</tr>
<tr class="odd">
<td align="right">-0.4625509</td>
</tr>
<tr class="even">
<td align="right">-0.5675715</td>
</tr>
<tr class="odd">
<td align="right">-0.2857441</td>
</tr>
<tr class="even">
<td align="right">-0.2937559</td>
</tr>
<tr class="odd">
<td align="right">-0.3740031</td>
</tr>
<tr class="even">
<td align="right">-0.3579345</td>
</tr>
<tr class="odd">
<td align="right">-0.4142162</td>
</tr>
<tr class="even">
<td align="right">-0.4222659</td>
</tr>
<tr class="odd">
<td align="right">-0.4544892</td>
</tr>
<tr class="even">
<td align="right">-0.4061688</td>
</tr>
<tr class="odd">
<td align="right">-0.5028957</td>
</tr>
<tr class="even">
<td align="right">-0.4948220</td>
</tr>
<tr class="odd">
<td align="right">-0.4706152</td>
</tr>
<tr class="even">
<td align="right">-0.7788189</td>
</tr>
<tr class="odd">
<td align="right">-0.4786817</td>
</tr>
<tr class="even">
<td align="right">-0.2457217</td>
</tr>
<tr class="odd">
<td align="right">-0.7450583</td>
</tr>
<tr class="even">
<td align="right">-0.4174138</td>
</tr>
<tr class="odd">
<td align="right">-0.4228566</td>
</tr>
<tr class="even">
<td align="right">-0.9207021</td>
</tr>
<tr class="odd">
<td align="right">-0.0325027</td>
</tr>
<tr class="even">
<td align="right">-0.2435631</td>
</tr>
<tr class="odd">
<td align="right">-0.4718688</td>
</tr>
<tr class="even">
<td align="right">-0.9977423</td>
</tr>
<tr class="odd">
<td align="right">-0.7889105</td>
</tr>
<tr class="even">
<td align="right">0.6965733</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1548439</td>
</tr>
<tr class="even">
<td align="right">0.1386673</td>
</tr>
<tr class="odd">
<td align="right">0.2115373</td>
</tr>
<tr class="even">
<td align="right">0.3334149</td>
</tr>
<tr class="odd">
<td align="right">0.0418082</td>
</tr>
<tr class="even">
<td align="right">-0.0627337</td>
</tr>
<tr class="odd">
<td align="right">0.2196459</td>
</tr>
<tr class="even">
<td align="right">0.2115373</td>
</tr>
<tr class="odd">
<td align="right">0.1305825</td>
</tr>
<tr class="even">
<td align="right">0.1467544</td>
</tr>
<tr class="odd">
<td align="right">0.0901947</td>
</tr>
<tr class="even">
<td align="right">0.0821244</td>
</tr>
<tr class="odd">
<td align="right">0.0498666</td>
</tr>
<tr class="even">
<td align="right">0.0982675</td>
</tr>
<tr class="odd">
<td align="right">0.0015520</td>
</tr>
<tr class="even">
<td align="right">0.0095984</td>
</tr>
<tr class="odd">
<td align="right">0.0337522</td>
</tr>
<tr class="even">
<td align="right">-0.2706116</td>
</tr>
<tr class="odd">
<td align="right">0.0256985</td>
</tr>
<tr class="even">
<td align="right">0.2602245</td>
</tr>
<tr class="odd">
<td align="right">-0.3257420</td>
</tr>
<tr class="even">
<td align="right">0.0035178</td>
</tr>
<tr class="odd">
<td align="right">-0.0019879</td>
</tr>
<tr class="even">
<td align="right">-0.5004473</td>
</tr>
<tr class="odd">
<td align="right">0.3959434</td>
</tr>
<tr class="even">
<td align="right">0.1800159</td>
</tr>
<tr class="odd">
<td align="right">-0.0515113</td>
</tr>
<tr class="even">
<td align="right">-0.5766846</td>
</tr>
<tr class="odd">
<td align="right">-0.3694770</td>
</tr>
<tr class="even">
<td align="right">0.8153211</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>We can extract priors for the two intercepts. We see that they end up being very similar, as expected.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="chapter-8-model-comparison.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(<span class="fu">extract.prior</span>(<span class="at">fit =</span> m,<span class="at">n =</span> <span class="dv">1000</span>)<span class="sc">$</span>a1)</span>
<span id="cb246-2"><a href="chapter-8-model-comparison.html#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(<span class="fu">extract.prior</span>(<span class="at">fit =</span> m,<span class="at">n =</span> <span class="dv">1000</span>)<span class="sc">$</span>a2,<span class="at">add =</span> T,<span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-140-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Now it would be nice to inspect the point estimates for each wine and judge and see the span of these. Although <code>plot(precis())</code> does not appear to work in this example.</p>
</div>
<div id="h6-1" class="section level3" number="9.4.4">
<h3><span class="header-section-number">9.4.4</span> 8H6</h3>
<p>Now consider three features of the wines and judges:</p>
<ol style="list-style-type: decimal">
<li>fLight: Whether the wine is red or white.</li>
<li>wine.amer: indicator variable for american wines</li>
<li>judge.amer: indicator variable for american judges</li>
</ol>
<p>use indicator or index variales to model the influence o these features on the scores. Omit the individual judge and ine index variable from Problem 1. DO not include interaction effects yet.</p>
<p>Again justify your priors. What do you conclude about the differences among the wines and judge?</p>
<p>Try to relate the results to the inferences in the previous problem.</p>
<p><strong>Reasoning for the priors</strong></p>
<ul>
<li>Since the values are standardized everything is measured on a standard deviation scale, thus we also expect the values to be around the center. That is also the reason that we have a narrow distribution for the intercept (0.2).</li>
<li>We set the priors for the slopes a bit wider. As we expect that there may be greater deviances in this, an thus we allow the mode to pick up on ‘extreme’ observations.</li>
</ul>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="chapter-8-model-comparison.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb247-2"><a href="chapter-8-model-comparison.html#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Wines2012&quot;</span>)</span>
<span id="cb247-3"><a href="chapter-8-model-comparison.html#cb247-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> Wines2012</span>
<span id="cb247-4"><a href="chapter-8-model-comparison.html#cb247-4" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>fid <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">I</span>(d<span class="sc">$</span>flight <span class="sc">==</span> <span class="st">&#39;red&#39;</span>)) <span class="co">#1 = red, 0 = white</span></span>
<span id="cb247-5"><a href="chapter-8-model-comparison.html#cb247-5" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>score_std <span class="ot">&lt;-</span> <span class="fu">standardize</span>(d<span class="sc">$</span>score)</span>
<span id="cb247-6"><a href="chapter-8-model-comparison.html#cb247-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d[,(<span class="fu">colnames</span>(d) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;score_std&quot;</span>,<span class="st">&quot;fid&quot;</span>,<span class="st">&quot;wine.amer&quot;</span>,<span class="st">&quot;judge.amer&quot;</span>))] <span class="co">#keep relevant columns</span></span>
<span id="cb247-7"><a href="chapter-8-model-comparison.html#cb247-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-8"><a href="chapter-8-model-comparison.html#cb247-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Notice that wine.amer and judge.amer is both integer, 0 and 1, thus no transformation is needed.</span></span>
<span id="cb247-9"><a href="chapter-8-model-comparison.html#cb247-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-10"><a href="chapter-8-model-comparison.html#cb247-10" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb247-11"><a href="chapter-8-model-comparison.html#cb247-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb247-12"><a href="chapter-8-model-comparison.html#cb247-12" aria-hidden="true" tabindex="-1"></a>    score_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu,sigma),</span>
<span id="cb247-13"><a href="chapter-8-model-comparison.html#cb247-13" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bF<span class="sc">*</span>fid <span class="sc">+</span> bWA<span class="sc">*</span>wine.amer <span class="sc">+</span> bJA<span class="sc">*</span>judge.amer,</span>
<span id="cb247-14"><a href="chapter-8-model-comparison.html#cb247-14" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="co">#We say it is around the center of all wines</span></span>
<span id="cb247-15"><a href="chapter-8-model-comparison.html#cb247-15" aria-hidden="true" tabindex="-1"></a>    bF <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="co">#We say it is around the center of all wines</span></span>
<span id="cb247-16"><a href="chapter-8-model-comparison.html#cb247-16" aria-hidden="true" tabindex="-1"></a>    bWA <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="co">#We assume that the coefficient can both be positive and negative</span></span>
<span id="cb247-17"><a href="chapter-8-model-comparison.html#cb247-17" aria-hidden="true" tabindex="-1"></a>    bJA <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="co">#Same assumption as above</span></span>
<span id="cb247-18"><a href="chapter-8-model-comparison.html#cb247-18" aria-hidden="true" tabindex="-1"></a>      <span class="co">#Alternative way of writing out this: c(bW,bJ,bR) ~ dnorm( 0 , 0.5 ),</span></span>
<span id="cb247-19"><a href="chapter-8-model-comparison.html#cb247-19" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>) <span class="co">#tend towards 0, but decreases exponentially</span></span>
<span id="cb247-20"><a href="chapter-8-model-comparison.html#cb247-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb247-21"><a href="chapter-8-model-comparison.html#cb247-21" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data =</span> d</span>
<span id="cb247-22"><a href="chapter-8-model-comparison.html#cb247-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb247-23"><a href="chapter-8-model-comparison.html#cb247-23" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m,<span class="at">depth =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.0129460</td>
</tr>
<tr class="even">
<td align="right">-0.0052015</td>
</tr>
<tr class="odd">
<td align="right">-0.1802174</td>
</tr>
<tr class="even">
<td align="right">0.2257082</td>
</tr>
<tr class="odd">
<td align="right">0.9824057</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1198328</td>
</tr>
<tr class="even">
<td align="right">0.1148061</td>
</tr>
<tr class="odd">
<td align="right">0.1344745</td>
</tr>
<tr class="even">
<td align="right">0.1342008</td>
</tr>
<tr class="odd">
<td align="right">0.0515728</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.2044620</td>
</tr>
<tr class="even">
<td align="right">-0.1886839</td>
</tr>
<tr class="odd">
<td align="right">-0.3951337</td>
</tr>
<tr class="even">
<td align="right">0.0112294</td>
</tr>
<tr class="odd">
<td align="right">0.8999824</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1785700</td>
</tr>
<tr class="even">
<td align="right">0.1782809</td>
</tr>
<tr class="odd">
<td align="right">0.0346989</td>
</tr>
<tr class="even">
<td align="right">0.4401870</td>
</tr>
<tr class="odd">
<td align="right">1.0648290</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>Now I have created an indicator model, where there is simply one intercept, and on slope across all categories, one may have used an index model instead.</p>
<p>We see that:</p>
<ul>
<li>the slope for the flight goes on both sides of 0, hence one cannot do inference on this. Also indicating that red and white wine are rated more or less the same.</li>
<li>We see that if the wine is american, then the wine tend to be rated lower, on average by the wine being american, the standardized rating decrease by 0.18. Although notice that we have a little probability space on the positive side of 0 (that is dependent on the interval we want to do inference on)</li>
<li>The ratings appear to be higher when we have an american judge.</li>
</ul>
</div>
<div id="h7" class="section level3" number="9.4.5">
<h3><span class="header-section-number">9.4.5</span> 8H7</h3>
<p>Now consider two_way interactions among the fhree features. You should end up with three different interaction terms in your model. THese will be easier to buiild, if you use indicator variables. Again justify the priors. Explain what each interaction measn. Be sure to interpret the model’s predictions on the outcome scale (mu, expected score), not on the scale of individial parameters.</p>
<p>You can use link to help with this, or just use your knowledge of th elinear model insteat. What do you conclude about the features and the scores? Can you relate the results of your model(s) to the individual judge and wine inferences from 8H5?</p>
<p><strong>Notes on the priors</strong></p>
<ul>
<li>Notice that the prior for an interaction effect should not be flatter than the slope for the variable, that being because the variance should not be more extreme in these subgroups of the data!!!</li>
<li>Otherwise the arguments are the same.</li>
</ul>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="chapter-8-model-comparison.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb248-2"><a href="chapter-8-model-comparison.html#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Wines2012&quot;</span>)</span>
<span id="cb248-3"><a href="chapter-8-model-comparison.html#cb248-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> Wines2012</span>
<span id="cb248-4"><a href="chapter-8-model-comparison.html#cb248-4" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>fid <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">I</span>(d<span class="sc">$</span>flight <span class="sc">==</span> <span class="st">&#39;red&#39;</span>)) <span class="co">#1 = red, 0 = white</span></span>
<span id="cb248-5"><a href="chapter-8-model-comparison.html#cb248-5" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>score_std <span class="ot">&lt;-</span> <span class="fu">standardize</span>(d<span class="sc">$</span>score)</span>
<span id="cb248-6"><a href="chapter-8-model-comparison.html#cb248-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d[,(<span class="fu">colnames</span>(d) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;score_std&quot;</span>,<span class="st">&quot;fid&quot;</span>,<span class="st">&quot;wine.amer&quot;</span>,<span class="st">&quot;judge.amer&quot;</span>))] <span class="co">#keep relevant columns</span></span>
<span id="cb248-7"><a href="chapter-8-model-comparison.html#cb248-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-8"><a href="chapter-8-model-comparison.html#cb248-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Notice that wine.amer and judge.amer is both integer, 0 and 1, thus no transformation is needed.</span></span>
<span id="cb248-9"><a href="chapter-8-model-comparison.html#cb248-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-10"><a href="chapter-8-model-comparison.html#cb248-10" aria-hidden="true" tabindex="-1"></a>m_interaction <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb248-11"><a href="chapter-8-model-comparison.html#cb248-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb248-12"><a href="chapter-8-model-comparison.html#cb248-12" aria-hidden="true" tabindex="-1"></a>    score_std <span class="sc">~</span> <span class="fu">dnorm</span>(mu,sigma),</span>
<span id="cb248-13"><a href="chapter-8-model-comparison.html#cb248-13" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bF<span class="sc">*</span>fid <span class="sc">+</span> bWA<span class="sc">*</span>wine.amer <span class="sc">+</span> bJA<span class="sc">*</span>judge.amer <span class="sc">+</span> bi1<span class="sc">*</span>fid<span class="sc">*</span>wine.amer <span class="sc">+</span> bi2<span class="sc">*</span>fid<span class="sc">*</span>judge.amer <span class="sc">+</span> bi3<span class="sc">*</span>wine.amer<span class="sc">*</span>judge.amer,</span>
<span id="cb248-14"><a href="chapter-8-model-comparison.html#cb248-14" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="co">#We say it is around the center of all wines</span></span>
<span id="cb248-15"><a href="chapter-8-model-comparison.html#cb248-15" aria-hidden="true" tabindex="-1"></a>    bF <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="co">#We say it is around the center of all wines</span></span>
<span id="cb248-16"><a href="chapter-8-model-comparison.html#cb248-16" aria-hidden="true" tabindex="-1"></a>    bWA <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="co">#We assume that the coefficient can both be positive and negative</span></span>
<span id="cb248-17"><a href="chapter-8-model-comparison.html#cb248-17" aria-hidden="true" tabindex="-1"></a>    bJA <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="co">#Same assumption as above</span></span>
<span id="cb248-18"><a href="chapter-8-model-comparison.html#cb248-18" aria-hidden="true" tabindex="-1"></a>    bi1 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="co">#prior for the interaction between flight and wine amer</span></span>
<span id="cb248-19"><a href="chapter-8-model-comparison.html#cb248-19" aria-hidden="true" tabindex="-1"></a>    bi2 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="co">#prior for the interaction between flight and judge amer</span></span>
<span id="cb248-20"><a href="chapter-8-model-comparison.html#cb248-20" aria-hidden="true" tabindex="-1"></a>    bi3 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="co">#prior for the interaction between wine amer and judge amer</span></span>
<span id="cb248-21"><a href="chapter-8-model-comparison.html#cb248-21" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Notice one could say c(bi1,bi2,bi3) &lt;- dnorm(0,0.5)</span></span>
<span id="cb248-22"><a href="chapter-8-model-comparison.html#cb248-22" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>) <span class="co">#tend towards 0, but decreases exponentially</span></span>
<span id="cb248-23"><a href="chapter-8-model-comparison.html#cb248-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb248-24"><a href="chapter-8-model-comparison.html#cb248-24" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data =</span> d</span>
<span id="cb248-25"><a href="chapter-8-model-comparison.html#cb248-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb248-26"><a href="chapter-8-model-comparison.html#cb248-26" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m_interaction,<span class="at">depth =</span> <span class="dv">2</span>) <span class="co">#Notice if combatibility interval is lower then also a narrower intercal</span></span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.0441879</td>
</tr>
<tr class="even">
<td align="right">0.0753160</td>
</tr>
<tr class="odd">
<td align="right">-0.0127051</td>
</tr>
<tr class="even">
<td align="right">0.1768951</td>
</tr>
<tr class="odd">
<td align="right">-0.3425854</td>
</tr>
<tr class="even">
<td align="right">0.1345109</td>
</tr>
<tr class="odd">
<td align="right">-0.0386676</td>
</tr>
<tr class="even">
<td align="right">0.9741449</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1286030</td>
</tr>
<tr class="even">
<td align="right">0.1502348</td>
</tr>
<tr class="odd">
<td align="right">0.1918088</td>
</tr>
<tr class="even">
<td align="right">0.1983921</td>
</tr>
<tr class="odd">
<td align="right">0.2184200</td>
</tr>
<tr class="even">
<td align="right">0.2210731</td>
</tr>
<tr class="odd">
<td align="right">0.2310524</td>
</tr>
<tr class="even">
<td align="right">0.0512234</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.2497203</td>
</tr>
<tr class="even">
<td align="right">-0.1647882</td>
</tr>
<tr class="odd">
<td align="right">-0.3192526</td>
</tr>
<tr class="even">
<td align="right">-0.1401739</td>
</tr>
<tr class="odd">
<td align="right">-0.6916627</td>
</tr>
<tr class="even">
<td align="right">-0.2188066</td>
</tr>
<tr class="odd">
<td align="right">-0.4079339</td>
</tr>
<tr class="even">
<td align="right">0.8922800</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1613446</td>
</tr>
<tr class="even">
<td align="right">0.3154202</td>
</tr>
<tr class="odd">
<td align="right">0.2938424</td>
</tr>
<tr class="even">
<td align="right">0.4939641</td>
</tr>
<tr class="odd">
<td align="right">0.0064920</td>
</tr>
<tr class="even">
<td align="right">0.4878284</td>
</tr>
<tr class="odd">
<td align="right">0.3305987</td>
</tr>
<tr class="even">
<td align="right">1.0560098</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<div id="predictions" class="section level4" number="9.4.5.1">
<h4><span class="header-section-number">9.4.5.1</span> Predictions</h4>
<p>Now we can make some predictions. Notice that we need to first generate some data. Then <code>link</code> can be used to map the data to the model and produce outputs.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="chapter-8-model-comparison.html#cb249-1" aria-hidden="true" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb249-2"><a href="chapter-8-model-comparison.html#cb249-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">fid =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">times =</span> <span class="dv">4</span>),</span>
<span id="cb249-3"><a href="chapter-8-model-comparison.html#cb249-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">wine.amer =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">each=</span><span class="dv">4</span>),</span>
<span id="cb249-4"><a href="chapter-8-model-comparison.html#cb249-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">judge.amer =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">times =</span> <span class="dv">2</span>)</span>
<span id="cb249-5"><a href="chapter-8-model-comparison.html#cb249-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb249-6"><a href="chapter-8-model-comparison.html#cb249-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pred_data)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">fid</th>
<th align="right">wine.amer</th>
<th align="right">judge.amer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="chapter-8-model-comparison.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Predict averages</span></span>
<span id="cb250-2"><a href="chapter-8-model-comparison.html#cb250-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">link</span>(m_interaction,<span class="at">data =</span> pred_data)</span>
<span id="cb250-3"><a href="chapter-8-model-comparison.html#cb250-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-4"><a href="chapter-8-model-comparison.html#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Generate row names for the observations, used for the plot</span></span>
<span id="cb250-5"><a href="chapter-8-model-comparison.html#cb250-5" aria-hidden="true" tabindex="-1"></a>row_labels <span class="ot">&lt;-</span> <span class="fu">paste</span>( <span class="fu">ifelse</span>(pred_data<span class="sc">$</span>fid<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;R&quot;</span>,<span class="st">&quot;W&quot;</span>) ,</span>
<span id="cb250-6"><a href="chapter-8-model-comparison.html#cb250-6" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(pred_data<span class="sc">$</span>judge.amer<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;F&quot;</span>) ,</span>
<span id="cb250-7"><a href="chapter-8-model-comparison.html#cb250-7" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(pred_data<span class="sc">$</span>wine.amer<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;F&quot;</span>) , <span class="at">sep=</span><span class="st">&quot;&quot;</span> )</span>
<span id="cb250-8"><a href="chapter-8-model-comparison.html#cb250-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( <span class="fu">precis</span>( <span class="fu">list</span>(<span class="at">mu=</span>mu) , <span class="dv">2</span> ) , <span class="at">labels=</span>row_labels )</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-144-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>In general we expect red wines that have an american judge but the wine is not american.</p>
<p><strong>Why plot this?</strong></p>
<p>From the precis table it is hard to make these relations, although when we plot the combinations, it is far easier to make these correlations.</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-7-model-comparison.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter-9-markov-chain-monte-carlo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
