<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Chapter 3 - Sampling the Imaginary | Bayesian Data Analysis Notes</title>
  <meta name="description" content="3 Chapter 3 - Sampling the Imaginary | Bayesian Data Analysis Notes" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Chapter 3 - Sampling the Imaginary | Bayesian Data Analysis Notes" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Chapter 3 - Sampling the Imaginary | Bayesian Data Analysis Notes" />
  
  
  

<meta name="author" content="Jonas Ringive Korsholm" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-2-small-worlds-and-large-worlds.html"/>
<link rel="next" href="geocentric-models.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="chapter-1-golems-of-prague.html"><a href="chapter-1-golems-of-prague.html"><i class="fa fa-check"></i><b>1</b> Chapter 1 - Golems of Prague</a></li>
<li class="chapter" data-level="2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html"><i class="fa fa-check"></i><b>2</b> Chapter 2 - Small worlds and Large Worlds</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#models-and-estimation"><i class="fa fa-check"></i><b>2.1</b> Models and Estimation</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#engines-motors-to-estimate-the-models"><i class="fa fa-check"></i><b>2.1.1</b> Engines / Motors to estimate the models</a>
<ul>
<li class="chapter" data-level="2.1.1.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#grid-approximation"><i class="fa fa-check"></i><b>2.1.1.1</b> Grid approximation</a></li>
<li class="chapter" data-level="2.1.1.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#quadratic-approximation"><i class="fa fa-check"></i><b>2.1.1.2</b> Quadratic approximation</a></li>
<li class="chapter" data-level="2.1.1.3" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#markov-chain-monte-carlo"><i class="fa fa-check"></i><b>2.1.1.3</b> Markov Chain Monte Carlo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#exercises"><i class="fa fa-check"></i><b>2.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#m1"><i class="fa fa-check"></i><b>2.2.1</b> 2M1</a></li>
<li class="chapter" data-level="2.2.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#m2"><i class="fa fa-check"></i><b>2.2.2</b> 2M2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html"><i class="fa fa-check"></i><b>3</b> Chapter 3 - Sampling the Imaginary</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-from-a-grid-approximate-posterior"><i class="fa fa-check"></i><b>3.1</b> Sampling from a grid-approximate posterior</a></li>
<li class="chapter" data-level="3.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-to-summarize"><i class="fa fa-check"></i><b>3.2</b> Sampling to summarize</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#defined-boundaries"><i class="fa fa-check"></i><b>3.2.1</b> Defined Boundaries</a></li>
<li class="chapter" data-level="3.2.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#defined-probability-mass"><i class="fa fa-check"></i><b>3.2.2</b> Defined Probability Mass</a></li>
<li class="chapter" data-level="3.2.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#point-estimates"><i class="fa fa-check"></i><b>3.2.3</b> Point Estimates</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-to-simulate-prediction"><i class="fa fa-check"></i><b>3.3</b> Sampling to simulate prediction</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#dummy-data"><i class="fa fa-check"></i><b>3.3.1</b> Dummy Data</a></li>
<li class="chapter" data-level="3.3.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#model-checking"><i class="fa fa-check"></i><b>3.3.2</b> Model Checking</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#exercises-1"><i class="fa fa-check"></i><b>3.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m1-1"><i class="fa fa-check"></i><b>3.4.1</b> 3M1</a></li>
<li class="chapter" data-level="3.4.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m2-1"><i class="fa fa-check"></i><b>3.4.2</b> 3M2</a></li>
<li class="chapter" data-level="3.4.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m3"><i class="fa fa-check"></i><b>3.4.3</b> 3M3</a></li>
<li class="chapter" data-level="3.4.4" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m4"><i class="fa fa-check"></i><b>3.4.4</b> 3M4</a></li>
<li class="chapter" data-level="3.4.5" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m5"><i class="fa fa-check"></i><b>3.4.5</b> 3M5</a></li>
<li class="chapter" data-level="3.4.6" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h1"><i class="fa fa-check"></i><b>3.4.6</b> 3H1</a></li>
<li class="chapter" data-level="3.4.7" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h2"><i class="fa fa-check"></i><b>3.4.7</b> 3H2</a></li>
<li class="chapter" data-level="3.4.8" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h3"><i class="fa fa-check"></i><b>3.4.8</b> 3H3</a></li>
<li class="chapter" data-level="3.4.9" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h4"><i class="fa fa-check"></i><b>3.4.9</b> 3H4</a></li>
<li class="chapter" data-level="3.4.10" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h5"><i class="fa fa-check"></i><b>3.4.10</b> 3H5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geocentric-models.html"><a href="geocentric-models.html"><i class="fa fa-check"></i><b>4</b> Geocentric Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="geocentric-models.html"><a href="geocentric-models.html#why-normal-distributions-are-normal"><i class="fa fa-check"></i><b>4.1</b> Why Normal distributions are normal</a></li>
<li class="chapter" data-level="4.2" data-path="geocentric-models.html"><a href="geocentric-models.html#a-language-for-describing-models"><i class="fa fa-check"></i><b>4.2</b> A language for describing models</a></li>
<li class="chapter" data-level="4.3" data-path="geocentric-models.html"><a href="geocentric-models.html#gaussian-model-of-height"><i class="fa fa-check"></i><b>4.3</b> Gaussian model of height</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="geocentric-models.html"><a href="geocentric-models.html#the-model"><i class="fa fa-check"></i><b>4.3.1</b> The model</a></li>
<li class="chapter" data-level="4.3.2" data-path="geocentric-models.html"><a href="geocentric-models.html#grid-approximation-of-the-posterior-distribution"><i class="fa fa-check"></i><b>4.3.2</b> Grid approximation of the posterior distribution</a></li>
<li class="chapter" data-level="4.3.3" data-path="geocentric-models.html"><a href="geocentric-models.html#sampling-from-the-posterior"><i class="fa fa-check"></i><b>4.3.3</b> Sampling from the posterior</a></li>
<li class="chapter" data-level="4.3.4" data-path="geocentric-models.html"><a href="geocentric-models.html#finding-the-posterior-distribution-with-quap"><i class="fa fa-check"></i><b>4.3.4</b> Finding the posterior distribution with quap</a></li>
<li class="chapter" data-level="4.3.5" data-path="geocentric-models.html"><a href="geocentric-models.html#sampling-from-a-quap"><i class="fa fa-check"></i><b>4.3.5</b> Sampling from a quap</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="geocentric-models.html"><a href="geocentric-models.html#linear-prediction"><i class="fa fa-check"></i><b>4.4</b> Linear prediction</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="geocentric-models.html"><a href="geocentric-models.html#the-lienar-mdoel-strategy"><i class="fa fa-check"></i><b>4.4.1</b> The lienar mdoel strategy</a></li>
<li class="chapter" data-level="4.4.2" data-path="geocentric-models.html"><a href="geocentric-models.html#finding-the-posterior-distribution"><i class="fa fa-check"></i><b>4.4.2</b> Finding the posterior distribution</a></li>
<li class="chapter" data-level="4.4.3" data-path="geocentric-models.html"><a href="geocentric-models.html#interpreting-the-posterior-distribution"><i class="fa fa-check"></i><b>4.4.3</b> Interpreting the posterior distribution</a>
<ul>
<li class="chapter" data-level="4.4.3.1" data-path="geocentric-models.html"><a href="geocentric-models.html#tables-fo-marginal-distributions"><i class="fa fa-check"></i><b>4.4.3.1</b> Tables fo marginal distributions</a></li>
<li class="chapter" data-level="4.4.3.2" data-path="geocentric-models.html"><a href="geocentric-models.html#plotting-posterior-inference-against-the-data"><i class="fa fa-check"></i><b>4.4.3.2</b> Plotting posterior inference against the data</a></li>
<li class="chapter" data-level="4.4.3.3" data-path="geocentric-models.html"><a href="geocentric-models.html#adding-uncertainty-around-the-mean"><i class="fa fa-check"></i><b>4.4.3.3</b> Adding uncertainty around the mean</a></li>
<li class="chapter" data-level="4.4.3.4" data-path="geocentric-models.html"><a href="geocentric-models.html#plotting-regression-intervlas-and-contours"><i class="fa fa-check"></i><b>4.4.3.4</b> Plotting regression intervlas and contours</a></li>
<li class="chapter" data-level="4.4.3.5" data-path="geocentric-models.html"><a href="geocentric-models.html#prediction-intevals"><i class="fa fa-check"></i><b>4.4.3.5</b> Prediction intevals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="geocentric-models.html"><a href="geocentric-models.html#curves-form-lines"><i class="fa fa-check"></i><b>4.5</b> Curves form lines</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="geocentric-models.html"><a href="geocentric-models.html#polynomial-regression"><i class="fa fa-check"></i><b>4.5.1</b> Polynomial regression</a></li>
<li class="chapter" data-level="4.5.2" data-path="geocentric-models.html"><a href="geocentric-models.html#splines"><i class="fa fa-check"></i><b>4.5.2</b> Splines</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="geocentric-models.html"><a href="geocentric-models.html#exercises-2"><i class="fa fa-check"></i><b>4.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="geocentric-models.html"><a href="geocentric-models.html#m1-2"><i class="fa fa-check"></i><b>4.6.1</b> 4M1</a></li>
<li class="chapter" data-level="4.6.2" data-path="geocentric-models.html"><a href="geocentric-models.html#m8"><i class="fa fa-check"></i><b>4.6.2</b> 4M8</a></li>
<li class="chapter" data-level="4.6.3" data-path="geocentric-models.html"><a href="geocentric-models.html#h1-1"><i class="fa fa-check"></i><b>4.6.3</b> 4H1</a></li>
<li class="chapter" data-level="4.6.4" data-path="geocentric-models.html"><a href="geocentric-models.html#h2-1"><i class="fa fa-check"></i><b>4.6.4</b> 4H2</a></li>
<li class="chapter" data-level="4.6.5" data-path="geocentric-models.html"><a href="geocentric-models.html#h3-1"><i class="fa fa-check"></i><b>4.6.5</b> 4H3</a></li>
<li class="chapter" data-level="4.6.6" data-path="geocentric-models.html"><a href="geocentric-models.html#h6"><i class="fa fa-check"></i><b>4.6.6</b> 4H6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lecture-notes-wrap-up-chapters-geocentric-models.html"><a href="lecture-notes-wrap-up-chapters-geocentric-models.html"><i class="fa fa-check"></i><b>5</b> Lecture notes - wrap up chapters geocentric models</a></li>
<li class="chapter" data-level="6" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html"><i class="fa fa-check"></i><b>6</b> Chapter 5 - The Many Variables &amp; The Spurious Waffles</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#spurious-associations"><i class="fa fa-check"></i><b>6.1</b> Spurious Associations</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#defining-a-multiple-regression"><i class="fa fa-check"></i><b>6.1.1</b> Defining a multiple regression</a></li>
<li class="chapter" data-level="6.1.2" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#approximating-the-posterior"><i class="fa fa-check"></i><b>6.1.2</b> Approximating the posterior</a></li>
<li class="chapter" data-level="6.1.3" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#the-flow"><i class="fa fa-check"></i><b>6.1.3</b> The flow</a>
<ul>
<li class="chapter" data-level="6.1.3.1" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#posterior-prediction-plots"><i class="fa fa-check"></i><b>6.1.3.1</b> Posterior Prediction Plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#masked-relationship"><i class="fa fa-check"></i><b>6.2</b> Masked Relationship</a></li>
<li class="chapter" data-level="6.3" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#categorical-variables"><i class="fa fa-check"></i><b>6.3</b> Categorical Variables</a></li>
<li class="chapter" data-level="6.4" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#lecture-notes---not-integrated-in-the-notes"><i class="fa fa-check"></i><b>6.4</b> Lecture notes - not integrated in the notes</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html"><i class="fa fa-check"></i><b>7</b> Chapter 6 - The Haunted DAG &amp; The Causal Terror</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#multicollinearity"><i class="fa fa-check"></i><b>7.1</b> Multicollinearity</a></li>
<li class="chapter" data-level="7.2" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#post-treatment-bias"><i class="fa fa-check"></i><b>7.2</b> Post Treatment Bias</a></li>
<li class="chapter" data-level="7.3" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#collider-bias"><i class="fa fa-check"></i><b>7.3</b> Collider Bias</a></li>
<li class="chapter" data-level="7.4" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#confronting-confounding"><i class="fa fa-check"></i><b>7.4</b> Confronting Confounding</a></li>
<li class="chapter" data-level="7.5" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#exercises-3"><i class="fa fa-check"></i><b>7.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#m1-3"><i class="fa fa-check"></i><b>7.5.1</b> 6M1</a></li>
<li class="chapter" data-level="7.5.2" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#m3-1"><i class="fa fa-check"></i><b>7.5.2</b> 6M3</a></li>
<li class="chapter" data-level="7.5.3" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h"><i class="fa fa-check"></i><b>7.5.3</b> 6H</a></li>
<li class="chapter" data-level="7.5.4" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h3-2"><i class="fa fa-check"></i><b>7.5.4</b> 6H3</a></li>
<li class="chapter" data-level="7.5.5" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h4-1"><i class="fa fa-check"></i><b>7.5.5</b> 6H4</a></li>
<li class="chapter" data-level="7.5.6" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h5-1"><i class="fa fa-check"></i><b>7.5.6</b> 6H5</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#lecture-notes---not-integrated-in-the-text"><i class="fa fa-check"></i><b>7.6</b> Lecture notes - not integrated in the text</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html"><i class="fa fa-check"></i><b>8</b> Chapter 7 - Model comparison</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#the-problem-with-parameters"><i class="fa fa-check"></i><b>8.1</b> The problem with parameters</a></li>
<li class="chapter" data-level="8.2" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#entropy-and-accuracy"><i class="fa fa-check"></i><b>8.2</b> Entropy and Accuracy</a></li>
<li class="chapter" data-level="8.3" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#golem-taming-regularization"><i class="fa fa-check"></i><b>8.3</b> Golem Taming: Regularization</a></li>
<li class="chapter" data-level="8.4" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#predicting-predictive-accuracy"><i class="fa fa-check"></i><b>8.4</b> Predicting predictive accuracy</a></li>
<li class="chapter" data-level="8.5" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#model-comparison"><i class="fa fa-check"></i><b>8.5</b> Model Comparison</a></li>
<li class="chapter" data-level="8.6" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#exercies"><i class="fa fa-check"></i><b>8.6</b> Exercies</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#medium-exercises"><i class="fa fa-check"></i><b>8.6.1</b> Medium exercises</a></li>
<li class="chapter" data-level="8.6.2" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#hard-exercises"><i class="fa fa-check"></i><b>8.6.2</b> Hard exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html"><i class="fa fa-check"></i><b>9</b> Chapter 8 - Model comparison</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#building-an-interaction"><i class="fa fa-check"></i><b>9.1</b> Building an interaction</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#adding-an-indicator-variable-isnt-enough."><i class="fa fa-check"></i><b>9.1.1</b> Adding an indicator variable isn’t enough.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#symmetry-of-interactions"><i class="fa fa-check"></i><b>9.2</b> Symmetry of interactions</a></li>
<li class="chapter" data-level="9.3" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#continuous-interactions"><i class="fa fa-check"></i><b>9.3</b> Continuous interactions</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#a-winter-flower"><i class="fa fa-check"></i><b>9.3.1</b> A Winter Flower</a></li>
<li class="chapter" data-level="9.3.2" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#the-models"><i class="fa fa-check"></i><b>9.3.2</b> The models</a></li>
<li class="chapter" data-level="9.3.3" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#plotting-posterior-predictions"><i class="fa fa-check"></i><b>9.3.3</b> Plotting posterior predictions</a></li>
<li class="chapter" data-level="9.3.4" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#plotting-prior-predictions"><i class="fa fa-check"></i><b>9.3.4</b> Plotting prior predictions</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#section"><i class="fa fa-check"></i><b>9.4</b> </a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Data Analysis Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter-3---sampling-the-imaginary" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Chapter 3 - Sampling the Imaginary</h1>
<p>They take the following example:</p>
<div class="figure">
<img src="Images/paste-C4C8291D.png" alt="" />
<p class="caption"><img src="" alt="Notation for posterior probability" /></p>
</div>
<p>We see that this is the equation for a person being vampire given that the test i positive. This is calculated by using Bayes Theorem. This can be written in code in the following:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="chapter-3-sampling-the-imaginary.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#3.1</span></span>
<span id="cb12-2"><a href="chapter-3-sampling-the-imaginary.html#cb12-2" aria-hidden="true" tabindex="-1"></a>Pr_Positive_Vampire <span class="ot">&lt;-</span> <span class="fl">0.95</span> <span class="co">#Condiational prob for positive given vampire</span></span>
<span id="cb12-3"><a href="chapter-3-sampling-the-imaginary.html#cb12-3" aria-hidden="true" tabindex="-1"></a>Pr_Positive_Mortal <span class="ot">&lt;-</span> <span class="fl">0.01</span> <span class="co">#Essentially the false positive rate</span></span>
<span id="cb12-4"><a href="chapter-3-sampling-the-imaginary.html#cb12-4" aria-hidden="true" tabindex="-1"></a>Pr_Vampire <span class="ot">&lt;-</span> <span class="fl">0.001</span> <span class="co">#Prior for being vampire</span></span>
<span id="cb12-5"><a href="chapter-3-sampling-the-imaginary.html#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="chapter-3-sampling-the-imaginary.html#cb12-6" aria-hidden="true" tabindex="-1"></a>Pr_Positive <span class="ot">&lt;-</span> Pr_Positive_Vampire <span class="sc">*</span> Pr_Vampire <span class="sc">+</span> Pr_Positive_Mortal <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> Pr_Vampire)</span>
<span id="cb12-7"><a href="chapter-3-sampling-the-imaginary.html#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="chapter-3-sampling-the-imaginary.html#cb12-8" aria-hidden="true" tabindex="-1"></a>(Pr_Vampire_Positive <span class="ot">&lt;-</span> Pr_Positive_Vampire<span class="sc">*</span>Pr_Vampire <span class="sc">/</span> Pr_Positive)</span></code></pre></div>
<pre><code>## [1] 0.08683729</code></pre>
<p>We see that given the test being positive, there is an 8.6% chance of being vampire compared to the default 0.001. So we see that even though the test has 95% percent correctness there is in fact still only less than 10% chance that you are a vampire given the positive test.</p>
<p><em>We see that the actual true rate is dependent on how many in the population that are actual vampires.</em></p>
<p>A more intuitive way of writing out this can be shown as:</p>
<p><img src="Images/paste-8A38A037.png" /></p>
<p>Leading to:</p>
<p><img src="Images/paste-C7EC230A.png" /></p>
<p><strong>The Aim</strong> of the following section is to build an intuition around the approximation techniques. We see that in the example it is very simple hence one would not necessarily need the approximation techniques. Although it is suggested to start using the fitting techniques early as one will use them as soon as the problem gets just a bit more complex.</p>
<div id="sampling-from-a-grid-approximate-posterior" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Sampling from a grid-approximate posterior</h2>
<p>Lets take an example. We are going to take 10.000 samples</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="chapter-3-sampling-the-imaginary.html#cb14-1" aria-hidden="true" tabindex="-1"></a>p_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="dv">1</span>,<span class="at">length.out=</span><span class="dv">1000</span> )</span>
<span id="cb14-2"><a href="chapter-3-sampling-the-imaginary.html#cb14-2" aria-hidden="true" tabindex="-1"></a>prob_p <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">1000</span>) <span class="co">#This is the prior. It is flat = stupid prior</span></span>
<span id="cb14-3"><a href="chapter-3-sampling-the-imaginary.html#cb14-3" aria-hidden="true" tabindex="-1"></a>prob_data <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">6</span>,<span class="at">size=</span><span class="dv">9</span>,<span class="at">prob=</span>p_grid)</span>
<span id="cb14-4"><a href="chapter-3-sampling-the-imaginary.html#cb14-4" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> prob_data <span class="sc">*</span> prob_p</span>
<span id="cb14-5"><a href="chapter-3-sampling-the-imaginary.html#cb14-5" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> posterior <span class="sc">/</span> <span class="fu">sum</span>(posterior) <span class="co">#sum(posterior) = average likelihood</span></span>
<span id="cb14-6"><a href="chapter-3-sampling-the-imaginary.html#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;First 10 posteriors&quot;</span>)</span>
<span id="cb14-7"><a href="chapter-3-sampling-the-imaginary.html#cb14-7" aria-hidden="true" tabindex="-1"></a>posterior[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb14-8"><a href="chapter-3-sampling-the-imaginary.html#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="chapter-3-sampling-the-imaginary.html#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb14-10"><a href="chapter-3-sampling-the-imaginary.html#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p_grid,<span class="at">main =</span> <span class="st">&quot;p_grid&quot;</span>) <span class="co">#The grid</span></span>
<span id="cb14-11"><a href="chapter-3-sampling-the-imaginary.html#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prob_p,<span class="at">main =</span> <span class="st">&quot;prob_p (prior)&quot;</span>) <span class="co">#Prior</span></span>
<span id="cb14-12"><a href="chapter-3-sampling-the-imaginary.html#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prob_data,<span class="at">main =</span> <span class="st">&quot;prob_data (likelihood)&quot;</span>) <span class="co">#likelihood</span></span>
<span id="cb14-13"><a href="chapter-3-sampling-the-imaginary.html#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(posterior,<span class="at">main =</span> <span class="st">&quot;posterior&quot;</span>) <span class="co">#Posterior</span></span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/3.2-1.png" width="720" style="display: block; margin: auto;" /></p>
<pre><code>## [1] &quot;First 10 posteriors&quot;
##  [1] 0.000000e+00 8.433659e-19 5.381333e-17 6.111249e-16 3.423368e-15
##  [6] 1.301978e-14 3.875963e-14 9.744233e-14 2.164638e-13 4.375070e-13</code></pre>
<p>Notice that the p_grid is flat. Hence the</p>
<p>Now lets sample from the prior distribution.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="chapter-3-sampling-the-imaginary.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Code 3.3</span></span>
<span id="cb16-2"><a href="chapter-3-sampling-the-imaginary.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1337</span>)</span>
<span id="cb16-3"><a href="chapter-3-sampling-the-imaginary.html#cb16-3" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">sample</span>(p_grid </span>
<span id="cb16-4"><a href="chapter-3-sampling-the-imaginary.html#cb16-4" aria-hidden="true" tabindex="-1"></a>                  ,<span class="at">prob=</span>posterior </span>
<span id="cb16-5"><a href="chapter-3-sampling-the-imaginary.html#cb16-5" aria-hidden="true" tabindex="-1"></a>                  ,<span class="at">size=</span><span class="dv">10000</span> <span class="co">#The higher the number the smoother the curve</span></span>
<span id="cb16-6"><a href="chapter-3-sampling-the-imaginary.html#cb16-6" aria-hidden="true" tabindex="-1"></a>                  ,<span class="at">replace=</span><span class="cn">TRUE</span> )</span>
<span id="cb16-7"><a href="chapter-3-sampling-the-imaginary.html#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="chapter-3-sampling-the-imaginary.html#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Code 3.4</span></span>
<span id="cb16-9"><a href="chapter-3-sampling-the-imaginary.html#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb16-10"><a href="chapter-3-sampling-the-imaginary.html#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(samples)</span>
<span id="cb16-11"><a href="chapter-3-sampling-the-imaginary.html#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb16-12"><a href="chapter-3-sampling-the-imaginary.html#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(samples)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/3.3-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that the densitity plot shows the estimated probability of water on the globe.</p>
<blockquote>
<p><strong>What we have seen so far:</strong> we are replicating the posterior probability of water based on the data we have at hand. This is not of much value. <strong><em>We are next going to use the samples to understand the posterior.</em></strong></p>
</blockquote>
</div>
<div id="sampling-to-summarize" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Sampling to summarize</h2>
<p><em>Now we see that the models work is done. Although now it is up to the analyst to interprete the posterior distribution.</em></p>
<p>This includes:</p>
<ol style="list-style-type: decimal">
<li>How much posterior probability lies below some parameter value?</li>
<li>How much posterior probability lies between two parameter values?</li>
<li>Which parameter value marks the lower 5% of the posterior probability?</li>
<li>Which range of parameter values contains 90% of the posterior probability?</li>
<li>Which parameter value has highest posterior probability?</li>
</ol>
<p>This is essentially about <strong>three things:</strong> 1) defined boundaries, 2) defined probability mass, 3) point estimates. The following sections describe these.</p>
<div id="defined-boundaries" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Defined Boundaries</h3>
<p>This</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="chapter-3-sampling-the-imaginary.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">0</span>)</span>
<span id="cb17-2"><a href="chapter-3-sampling-the-imaginary.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># add up posterior probability where p &lt; 0.5</span></span>
<span id="cb17-3"><a href="chapter-3-sampling-the-imaginary.html#cb17-3" aria-hidden="true" tabindex="-1"></a>p_grid</span>
<span id="cb17-4"><a href="chapter-3-sampling-the-imaginary.html#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(posterior[p_grid <span class="sc">&lt;</span> <span class="fl">0.5</span>]) <span class="co">#Sum all posteriors where the p_grid is &lt; 50%</span></span></code></pre></div>
<pre><code>##    [1] 0.000000000 0.001001001 0.002002002 0.003003003 0.004004004 0.005005005
##    [7] 0.006006006 0.007007007 0.008008008 0.009009009 0.010010010 0.011011011
##   [13] 0.012012012 0.013013013 0.014014014 0.015015015 0.016016016 0.017017017
##   [19] 0.018018018 0.019019019 0.020020020 0.021021021 0.022022022 0.023023023
##   [25] 0.024024024 0.025025025 0.026026026 0.027027027 0.028028028 0.029029029
##   [31] 0.030030030 0.031031031 0.032032032 0.033033033 0.034034034 0.035035035
##   [37] 0.036036036 0.037037037 0.038038038 0.039039039 0.040040040 0.041041041
##   [43] 0.042042042 0.043043043 0.044044044 0.045045045 0.046046046 0.047047047
##   [49] 0.048048048 0.049049049 0.050050050 0.051051051 0.052052052 0.053053053
##   [55] 0.054054054 0.055055055 0.056056056 0.057057057 0.058058058 0.059059059
##   [61] 0.060060060 0.061061061 0.062062062 0.063063063 0.064064064 0.065065065
##   [67] 0.066066066 0.067067067 0.068068068 0.069069069 0.070070070 0.071071071
##   [73] 0.072072072 0.073073073 0.074074074 0.075075075 0.076076076 0.077077077
##   [79] 0.078078078 0.079079079 0.080080080 0.081081081 0.082082082 0.083083083
##   [85] 0.084084084 0.085085085 0.086086086 0.087087087 0.088088088 0.089089089
##   [91] 0.090090090 0.091091091 0.092092092 0.093093093 0.094094094 0.095095095
##   [97] 0.096096096 0.097097097 0.098098098 0.099099099 0.100100100 0.101101101
##  [103] 0.102102102 0.103103103 0.104104104 0.105105105 0.106106106 0.107107107
##  [109] 0.108108108 0.109109109 0.110110110 0.111111111 0.112112112 0.113113113
##  [115] 0.114114114 0.115115115 0.116116116 0.117117117 0.118118118 0.119119119
##  [121] 0.120120120 0.121121121 0.122122122 0.123123123 0.124124124 0.125125125
##  [127] 0.126126126 0.127127127 0.128128128 0.129129129 0.130130130 0.131131131
##  [133] 0.132132132 0.133133133 0.134134134 0.135135135 0.136136136 0.137137137
##  [139] 0.138138138 0.139139139 0.140140140 0.141141141 0.142142142 0.143143143
##  [145] 0.144144144 0.145145145 0.146146146 0.147147147 0.148148148 0.149149149
##  [151] 0.150150150 0.151151151 0.152152152 0.153153153 0.154154154 0.155155155
##  [157] 0.156156156 0.157157157 0.158158158 0.159159159 0.160160160 0.161161161
##  [163] 0.162162162 0.163163163 0.164164164 0.165165165 0.166166166 0.167167167
##  [169] 0.168168168 0.169169169 0.170170170 0.171171171 0.172172172 0.173173173
##  [175] 0.174174174 0.175175175 0.176176176 0.177177177 0.178178178 0.179179179
##  [181] 0.180180180 0.181181181 0.182182182 0.183183183 0.184184184 0.185185185
##  [187] 0.186186186 0.187187187 0.188188188 0.189189189 0.190190190 0.191191191
##  [193] 0.192192192 0.193193193 0.194194194 0.195195195 0.196196196 0.197197197
##  [199] 0.198198198 0.199199199 0.200200200 0.201201201 0.202202202 0.203203203
##  [205] 0.204204204 0.205205205 0.206206206 0.207207207 0.208208208 0.209209209
##  [211] 0.210210210 0.211211211 0.212212212 0.213213213 0.214214214 0.215215215
##  [217] 0.216216216 0.217217217 0.218218218 0.219219219 0.220220220 0.221221221
##  [223] 0.222222222 0.223223223 0.224224224 0.225225225 0.226226226 0.227227227
##  [229] 0.228228228 0.229229229 0.230230230 0.231231231 0.232232232 0.233233233
##  [235] 0.234234234 0.235235235 0.236236236 0.237237237 0.238238238 0.239239239
##  [241] 0.240240240 0.241241241 0.242242242 0.243243243 0.244244244 0.245245245
##  [247] 0.246246246 0.247247247 0.248248248 0.249249249 0.250250250 0.251251251
##  [253] 0.252252252 0.253253253 0.254254254 0.255255255 0.256256256 0.257257257
##  [259] 0.258258258 0.259259259 0.260260260 0.261261261 0.262262262 0.263263263
##  [265] 0.264264264 0.265265265 0.266266266 0.267267267 0.268268268 0.269269269
##  [271] 0.270270270 0.271271271 0.272272272 0.273273273 0.274274274 0.275275275
##  [277] 0.276276276 0.277277277 0.278278278 0.279279279 0.280280280 0.281281281
##  [283] 0.282282282 0.283283283 0.284284284 0.285285285 0.286286286 0.287287287
##  [289] 0.288288288 0.289289289 0.290290290 0.291291291 0.292292292 0.293293293
##  [295] 0.294294294 0.295295295 0.296296296 0.297297297 0.298298298 0.299299299
##  [301] 0.300300300 0.301301301 0.302302302 0.303303303 0.304304304 0.305305305
##  [307] 0.306306306 0.307307307 0.308308308 0.309309309 0.310310310 0.311311311
##  [313] 0.312312312 0.313313313 0.314314314 0.315315315 0.316316316 0.317317317
##  [319] 0.318318318 0.319319319 0.320320320 0.321321321 0.322322322 0.323323323
##  [325] 0.324324324 0.325325325 0.326326326 0.327327327 0.328328328 0.329329329
##  [331] 0.330330330 0.331331331 0.332332332 0.333333333 0.334334334 0.335335335
##  [337] 0.336336336 0.337337337 0.338338338 0.339339339 0.340340340 0.341341341
##  [343] 0.342342342 0.343343343 0.344344344 0.345345345 0.346346346 0.347347347
##  [349] 0.348348348 0.349349349 0.350350350 0.351351351 0.352352352 0.353353353
##  [355] 0.354354354 0.355355355 0.356356356 0.357357357 0.358358358 0.359359359
##  [361] 0.360360360 0.361361361 0.362362362 0.363363363 0.364364364 0.365365365
##  [367] 0.366366366 0.367367367 0.368368368 0.369369369 0.370370370 0.371371371
##  [373] 0.372372372 0.373373373 0.374374374 0.375375375 0.376376376 0.377377377
##  [379] 0.378378378 0.379379379 0.380380380 0.381381381 0.382382382 0.383383383
##  [385] 0.384384384 0.385385385 0.386386386 0.387387387 0.388388388 0.389389389
##  [391] 0.390390390 0.391391391 0.392392392 0.393393393 0.394394394 0.395395395
##  [397] 0.396396396 0.397397397 0.398398398 0.399399399 0.400400400 0.401401401
##  [403] 0.402402402 0.403403403 0.404404404 0.405405405 0.406406406 0.407407407
##  [409] 0.408408408 0.409409409 0.410410410 0.411411411 0.412412412 0.413413413
##  [415] 0.414414414 0.415415415 0.416416416 0.417417417 0.418418418 0.419419419
##  [421] 0.420420420 0.421421421 0.422422422 0.423423423 0.424424424 0.425425425
##  [427] 0.426426426 0.427427427 0.428428428 0.429429429 0.430430430 0.431431431
##  [433] 0.432432432 0.433433433 0.434434434 0.435435435 0.436436436 0.437437437
##  [439] 0.438438438 0.439439439 0.440440440 0.441441441 0.442442442 0.443443443
##  [445] 0.444444444 0.445445445 0.446446446 0.447447447 0.448448448 0.449449449
##  [451] 0.450450450 0.451451451 0.452452452 0.453453453 0.454454454 0.455455455
##  [457] 0.456456456 0.457457457 0.458458458 0.459459459 0.460460460 0.461461461
##  [463] 0.462462462 0.463463463 0.464464464 0.465465465 0.466466466 0.467467467
##  [469] 0.468468468 0.469469469 0.470470470 0.471471471 0.472472472 0.473473473
##  [475] 0.474474474 0.475475475 0.476476476 0.477477477 0.478478478 0.479479479
##  [481] 0.480480480 0.481481481 0.482482482 0.483483483 0.484484484 0.485485485
##  [487] 0.486486486 0.487487487 0.488488488 0.489489489 0.490490490 0.491491491
##  [493] 0.492492492 0.493493493 0.494494494 0.495495495 0.496496496 0.497497497
##  [499] 0.498498498 0.499499499 0.500500501 0.501501502 0.502502503 0.503503504
##  [505] 0.504504505 0.505505506 0.506506507 0.507507508 0.508508509 0.509509510
##  [511] 0.510510511 0.511511512 0.512512513 0.513513514 0.514514515 0.515515516
##  [517] 0.516516517 0.517517518 0.518518519 0.519519520 0.520520521 0.521521522
##  [523] 0.522522523 0.523523524 0.524524525 0.525525526 0.526526527 0.527527528
##  [529] 0.528528529 0.529529530 0.530530531 0.531531532 0.532532533 0.533533534
##  [535] 0.534534535 0.535535536 0.536536537 0.537537538 0.538538539 0.539539540
##  [541] 0.540540541 0.541541542 0.542542543 0.543543544 0.544544545 0.545545546
##  [547] 0.546546547 0.547547548 0.548548549 0.549549550 0.550550551 0.551551552
##  [553] 0.552552553 0.553553554 0.554554555 0.555555556 0.556556557 0.557557558
##  [559] 0.558558559 0.559559560 0.560560561 0.561561562 0.562562563 0.563563564
##  [565] 0.564564565 0.565565566 0.566566567 0.567567568 0.568568569 0.569569570
##  [571] 0.570570571 0.571571572 0.572572573 0.573573574 0.574574575 0.575575576
##  [577] 0.576576577 0.577577578 0.578578579 0.579579580 0.580580581 0.581581582
##  [583] 0.582582583 0.583583584 0.584584585 0.585585586 0.586586587 0.587587588
##  [589] 0.588588589 0.589589590 0.590590591 0.591591592 0.592592593 0.593593594
##  [595] 0.594594595 0.595595596 0.596596597 0.597597598 0.598598599 0.599599600
##  [601] 0.600600601 0.601601602 0.602602603 0.603603604 0.604604605 0.605605606
##  [607] 0.606606607 0.607607608 0.608608609 0.609609610 0.610610611 0.611611612
##  [613] 0.612612613 0.613613614 0.614614615 0.615615616 0.616616617 0.617617618
##  [619] 0.618618619 0.619619620 0.620620621 0.621621622 0.622622623 0.623623624
##  [625] 0.624624625 0.625625626 0.626626627 0.627627628 0.628628629 0.629629630
##  [631] 0.630630631 0.631631632 0.632632633 0.633633634 0.634634635 0.635635636
##  [637] 0.636636637 0.637637638 0.638638639 0.639639640 0.640640641 0.641641642
##  [643] 0.642642643 0.643643644 0.644644645 0.645645646 0.646646647 0.647647648
##  [649] 0.648648649 0.649649650 0.650650651 0.651651652 0.652652653 0.653653654
##  [655] 0.654654655 0.655655656 0.656656657 0.657657658 0.658658659 0.659659660
##  [661] 0.660660661 0.661661662 0.662662663 0.663663664 0.664664665 0.665665666
##  [667] 0.666666667 0.667667668 0.668668669 0.669669670 0.670670671 0.671671672
##  [673] 0.672672673 0.673673674 0.674674675 0.675675676 0.676676677 0.677677678
##  [679] 0.678678679 0.679679680 0.680680681 0.681681682 0.682682683 0.683683684
##  [685] 0.684684685 0.685685686 0.686686687 0.687687688 0.688688689 0.689689690
##  [691] 0.690690691 0.691691692 0.692692693 0.693693694 0.694694695 0.695695696
##  [697] 0.696696697 0.697697698 0.698698699 0.699699700 0.700700701 0.701701702
##  [703] 0.702702703 0.703703704 0.704704705 0.705705706 0.706706707 0.707707708
##  [709] 0.708708709 0.709709710 0.710710711 0.711711712 0.712712713 0.713713714
##  [715] 0.714714715 0.715715716 0.716716717 0.717717718 0.718718719 0.719719720
##  [721] 0.720720721 0.721721722 0.722722723 0.723723724 0.724724725 0.725725726
##  [727] 0.726726727 0.727727728 0.728728729 0.729729730 0.730730731 0.731731732
##  [733] 0.732732733 0.733733734 0.734734735 0.735735736 0.736736737 0.737737738
##  [739] 0.738738739 0.739739740 0.740740741 0.741741742 0.742742743 0.743743744
##  [745] 0.744744745 0.745745746 0.746746747 0.747747748 0.748748749 0.749749750
##  [751] 0.750750751 0.751751752 0.752752753 0.753753754 0.754754755 0.755755756
##  [757] 0.756756757 0.757757758 0.758758759 0.759759760 0.760760761 0.761761762
##  [763] 0.762762763 0.763763764 0.764764765 0.765765766 0.766766767 0.767767768
##  [769] 0.768768769 0.769769770 0.770770771 0.771771772 0.772772773 0.773773774
##  [775] 0.774774775 0.775775776 0.776776777 0.777777778 0.778778779 0.779779780
##  [781] 0.780780781 0.781781782 0.782782783 0.783783784 0.784784785 0.785785786
##  [787] 0.786786787 0.787787788 0.788788789 0.789789790 0.790790791 0.791791792
##  [793] 0.792792793 0.793793794 0.794794795 0.795795796 0.796796797 0.797797798
##  [799] 0.798798799 0.799799800 0.800800801 0.801801802 0.802802803 0.803803804
##  [805] 0.804804805 0.805805806 0.806806807 0.807807808 0.808808809 0.809809810
##  [811] 0.810810811 0.811811812 0.812812813 0.813813814 0.814814815 0.815815816
##  [817] 0.816816817 0.817817818 0.818818819 0.819819820 0.820820821 0.821821822
##  [823] 0.822822823 0.823823824 0.824824825 0.825825826 0.826826827 0.827827828
##  [829] 0.828828829 0.829829830 0.830830831 0.831831832 0.832832833 0.833833834
##  [835] 0.834834835 0.835835836 0.836836837 0.837837838 0.838838839 0.839839840
##  [841] 0.840840841 0.841841842 0.842842843 0.843843844 0.844844845 0.845845846
##  [847] 0.846846847 0.847847848 0.848848849 0.849849850 0.850850851 0.851851852
##  [853] 0.852852853 0.853853854 0.854854855 0.855855856 0.856856857 0.857857858
##  [859] 0.858858859 0.859859860 0.860860861 0.861861862 0.862862863 0.863863864
##  [865] 0.864864865 0.865865866 0.866866867 0.867867868 0.868868869 0.869869870
##  [871] 0.870870871 0.871871872 0.872872873 0.873873874 0.874874875 0.875875876
##  [877] 0.876876877 0.877877878 0.878878879 0.879879880 0.880880881 0.881881882
##  [883] 0.882882883 0.883883884 0.884884885 0.885885886 0.886886887 0.887887888
##  [889] 0.888888889 0.889889890 0.890890891 0.891891892 0.892892893 0.893893894
##  [895] 0.894894895 0.895895896 0.896896897 0.897897898 0.898898899 0.899899900
##  [901] 0.900900901 0.901901902 0.902902903 0.903903904 0.904904905 0.905905906
##  [907] 0.906906907 0.907907908 0.908908909 0.909909910 0.910910911 0.911911912
##  [913] 0.912912913 0.913913914 0.914914915 0.915915916 0.916916917 0.917917918
##  [919] 0.918918919 0.919919920 0.920920921 0.921921922 0.922922923 0.923923924
##  [925] 0.924924925 0.925925926 0.926926927 0.927927928 0.928928929 0.929929930
##  [931] 0.930930931 0.931931932 0.932932933 0.933933934 0.934934935 0.935935936
##  [937] 0.936936937 0.937937938 0.938938939 0.939939940 0.940940941 0.941941942
##  [943] 0.942942943 0.943943944 0.944944945 0.945945946 0.946946947 0.947947948
##  [949] 0.948948949 0.949949950 0.950950951 0.951951952 0.952952953 0.953953954
##  [955] 0.954954955 0.955955956 0.956956957 0.957957958 0.958958959 0.959959960
##  [961] 0.960960961 0.961961962 0.962962963 0.963963964 0.964964965 0.965965966
##  [967] 0.966966967 0.967967968 0.968968969 0.969969970 0.970970971 0.971971972
##  [973] 0.972972973 0.973973974 0.974974975 0.975975976 0.976976977 0.977977978
##  [979] 0.978978979 0.979979980 0.980980981 0.981981982 0.982982983 0.983983984
##  [985] 0.984984985 0.985985986 0.986986987 0.987987988 0.988988989 0.989989990
##  [991] 0.990990991 0.991991992 0.992992993 0.993993994 0.994994995 0.995995996
##  [997] 0.996996997 0.997997998 0.998998999 1.000000000
## [1] 0.1718746</code></pre>
<p>We see that the sum of the first 10 probabilities, as these are below.</p>
</div>
<div id="defined-probability-mass" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Defined Probability Mass</h3>
<p>This is about finding an interval and interpreting this. For example, we want to know the region between the 10% and 90% quantiles, or the first 80%.</p>
<p>This can be solved by doing:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="chapter-3-sampling-the-imaginary.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#R Code 3.9</span></span>
<span id="cb19-2"><a href="chapter-3-sampling-the-imaginary.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(samples,<span class="fl">0.8</span>) <span class="co">#Boundaries of lower 80% posterior probability, thus it starts at 0</span></span>
<span id="cb19-3"><a href="chapter-3-sampling-the-imaginary.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#R Code 3.10</span></span>
<span id="cb19-4"><a href="chapter-3-sampling-the-imaginary.html#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(samples,<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)) <span class="co">#Or between 10% and 90% posterior probability. hence midle 80% posterior probability</span></span></code></pre></div>
<pre><code>##       80% 
## 0.7607608 
##       10%       90% 
## 0.4484484 0.8119119</code></pre>
<p>These we call <strong><em>percentile intervals (PI)</em></strong>. For this there is functionality in the <code>rethinking</code>library.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="chapter-3-sampling-the-imaginary.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PI</span>(samples,<span class="at">prob =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>##       25%       75% 
## 0.5415415 0.7377377</code></pre>
<p>We see that this will autoamtically find the center probability of the posterior distribution. This may not be convenient if for instance the peak is outside of the region that <code>PI</code> return.</p>
<p>Therefore we have the functio <code>HPDI</code>, which stands for <em>highest posterior density interval</em>. This will find the densest probability mass.</p>
<p>This is justified, as you can end up with the same probability mass region with many combinations, hence <code>HPDI</code> is merely helping with this procedure.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="chapter-3-sampling-the-imaginary.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDI</span>(samples,<span class="at">prob =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>##      |0.5      0.5| 
## 0.5475475 0.7417417</code></pre>
<p>Now we see that it finds a more narrow region aggregating to the same probability. The following also exemplify this:</p>
<p><img src="Images/paste-0B5FCF4F.png" /></p>
<p>Many will confuse this with a <em>confidence interval</em>, while they will be named <em>compatibility or credible intervals</em> so they are not mixed up.</p>
<blockquote>
<p>Criticism of traditional confidence intervals. One sees that a common interpretation of confidence intervals is that with a CI of 95%, means that there is a 95% probability of the true value lying within the interval. <strong>THIS IS WRONG</strong>, that is a Bayesian interpretation and can only be used in a Bayesian setting. This is actually about what if you repeat an experiment, then 95% of the computed intervals will include the <em>‘true’</em> value. See page 58.</p>
</blockquote>
<blockquote>
<p>Criticims of <em>‘true’</em> values. Remember that you are working in a small world and thus true answers can never really be found, these belong in the large world.</p>
</blockquote>
</div>
<div id="point-estimates" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Point Estimates</h3>
<p>Point estimates are the third and final common summary task for the posterior distribution.</p>
<p>Often this is not wanted, as point estimates will remove valuable information. The following are examples of getting the point estimates:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="chapter-3-sampling-the-imaginary.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb25-2"><a href="chapter-3-sampling-the-imaginary.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> p_grid,<span class="at">y =</span> posterior,<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">main =</span> <span class="st">&quot;Posterior distribution&quot;</span>,<span class="at">sub =</span> <span class="st">&quot;Showing different point estimates&quot;</span>)</span>
<span id="cb25-3"><a href="chapter-3-sampling-the-imaginary.html#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb25-4"><a href="chapter-3-sampling-the-imaginary.html#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> p_grid[ <span class="fu">which.max</span>(posterior) ],<span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>)</span>
<span id="cb25-5"><a href="chapter-3-sampling-the-imaginary.html#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">chainmode</span>( samples , <span class="at">adj=</span><span class="fl">0.01</span> ),<span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</span>
<span id="cb25-6"><a href="chapter-3-sampling-the-imaginary.html#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>( samples ),<span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb25-7"><a href="chapter-3-sampling-the-imaginary.html#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">median</span>( samples ),<span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>)</span>
<span id="cb25-8"><a href="chapter-3-sampling-the-imaginary.html#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;max posteriod&quot;</span>,<span class="st">&quot;mode&quot;</span>,<span class="st">&quot;mean&quot;</span>,<span class="st">&quot;median&quot;</span>),<span class="at">lty =</span> <span class="dv">1</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkblue&quot;</span>,<span class="st">&quot;darkgreen&quot;</span>,<span class="st">&quot;darkred&quot;</span>,<span class="st">&quot;darkorange&quot;</span>))</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-18-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="chapter-3-sampling-the-imaginary.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#R Code 3.14 to 3.16</span></span>
<span id="cb26-2"><a href="chapter-3-sampling-the-imaginary.html#cb26-2" aria-hidden="true" tabindex="-1"></a>p_grid[ <span class="fu">which.max</span>(posterior) ]</span>
<span id="cb26-3"><a href="chapter-3-sampling-the-imaginary.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chainmode</span>( samples , <span class="at">adj=</span><span class="fl">0.01</span> ) <span class="co">#The mode: i.e., the most often appearing value</span></span>
<span id="cb26-4"><a href="chapter-3-sampling-the-imaginary.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>( samples )</span>
<span id="cb26-5"><a href="chapter-3-sampling-the-imaginary.html#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>( samples )</span></code></pre></div>
<pre><code>## [1] 0.6666667
## [1] 0.6830388
## [1] 0.6359439
## [1] 0.6446446</code></pre>
<p>The question is then: <strong>what point estimate to use?</strong></p>
<p>We can apply a loss function to support the decision. We can find a series of loss given the grid and the loss function.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="chapter-3-sampling-the-imaginary.html#cb28-1" aria-hidden="true" tabindex="-1"></a>loss <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="at">X =</span> p_grid</span>
<span id="cb28-2"><a href="chapter-3-sampling-the-imaginary.html#cb28-2" aria-hidden="true" tabindex="-1"></a>               ,<span class="at">FUN =</span> <span class="cf">function</span>(d) <span class="fu">sum</span>(posterior <span class="sc">*</span> <span class="fu">abs</span>(d<span class="sc">-</span>p_grid)))</span></code></pre></div>
<p>And for one specific point estimate:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="chapter-3-sampling-the-imaginary.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(posterior <span class="sc">*</span> <span class="fu">abs</span>(<span class="fl">0.5</span> <span class="sc">-</span> p_grid)) <span class="co">#0.1640626</span></span></code></pre></div>
<pre><code>## [1] 0.1640626</code></pre>
<p>To find the point estimate with the lowest loss one can say:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="chapter-3-sampling-the-imaginary.html#cb31-1" aria-hidden="true" tabindex="-1"></a>p_grid[<span class="fu">which.min</span>(loss)] <span class="co">#0.6446446, equal to the median</span></span></code></pre></div>
<pre><code>## [1] 0.6446446</code></pre>
<p>There are naturally also other loss functions, e.g., <span class="math inline">\((d-p)^2\)</span>, which would lead to the posterio mean.</p>
</div>
</div>
<div id="sampling-to-simulate-prediction" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Sampling to simulate prediction</h2>
<p>We can sample data to simulate the observations from the model. It has the following advantages:</p>
<ol style="list-style-type: decimal">
<li>Model Design: One can sample from the prior and see what one expects. This we will look more into in a later section.</li>
<li>Model Checking: To see if you end up with the same model.</li>
<li>Software Validation: One can use it to simulate the data that the models was built on. To check if the model can replicate the underlying data. I guess this is to check if something is broken.</li>
<li>Research Design:</li>
<li>Forecasting: One can simulate what will happen in the future.</li>
</ol>
<p>The following is an overview of how to simulate observations and make model checks:</p>
<div id="dummy-data" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Dummy Data</h3>
<p>This is basically drawing data given a certain probability of the different outcomes.</p>
<p>One must remember that the outputs of such are small world numbers.</p>
<p>The folo</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="chapter-3-sampling-the-imaginary.html#cb33-1" aria-hidden="true" tabindex="-1"></a>dummy_w <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">100000</span> <span class="co">#No of observations</span></span>
<span id="cb33-2"><a href="chapter-3-sampling-the-imaginary.html#cb33-2" aria-hidden="true" tabindex="-1"></a>                  ,<span class="at">size=</span><span class="dv">9</span>  <span class="co">#Size of each set</span></span>
<span id="cb33-3"><a href="chapter-3-sampling-the-imaginary.html#cb33-3" aria-hidden="true" tabindex="-1"></a>                  ,<span class="at">prob=</span><span class="fl">0.7</span>) <span class="co">#70% water</span></span>
<span id="cb33-4"><a href="chapter-3-sampling-the-imaginary.html#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">simplehist</span>( dummy_w , <span class="at">xlab=</span><span class="st">&quot;dummy water count&quot;</span> )</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/3.24-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that we get mostly combinations with 6 or 7 water.</p>
</div>
<div id="model-checking" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Model Checking</h3>
<p>This has two purposes:</p>
<ol style="list-style-type: decimal">
<li>Ensure that the model fit worked correctly</li>
<li>Evaluate the adequacy of a model for some purpose</li>
</ol>
<p><strong><em>Did the software work?</em></strong></p>
<p>This is basically just to check if you have set it up correctly.</p>
<p><strong><em>Is the model adequate?</em></strong></p>
<p><em>There are no true models,</em> hence you need to assess where the model fails to describe the data.</p>
<p>One also experience that models tend to be overconfident.</p>
<p>One wants to sample from the distribution to see if the model can be replicated. If we end up seeing very different results, then one should start considering is somthing is not taken into account.</p>
</div>
</div>
<div id="exercises-1" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Exercises</h2>
<div id="m1-1" class="section level3" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> 3M1</h3>
<p>Suppose the globe tossing data had turned out to be 8 water in 15 tosses. Construct the posterior distribution, using grid approximation. Use the same flat prior as before.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="chapter-3-sampling-the-imaginary.html#cb34-1" aria-hidden="true" tabindex="-1"></a>length <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb34-2"><a href="chapter-3-sampling-the-imaginary.html#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="chapter-3-sampling-the-imaginary.html#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># define grid</span></span>
<span id="cb34-4"><a href="chapter-3-sampling-the-imaginary.html#cb34-4" aria-hidden="true" tabindex="-1"></a>p_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span> , <span class="at">to=</span><span class="dv">1</span> , <span class="at">length.out =</span> length)</span>
<span id="cb34-5"><a href="chapter-3-sampling-the-imaginary.html#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># define prior</span></span>
<span id="cb34-6"><a href="chapter-3-sampling-the-imaginary.html#cb34-6" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, length) <span class="co">#The flat (stupid) prior</span></span>
<span id="cb34-7"><a href="chapter-3-sampling-the-imaginary.html#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># compute likelihood at each value in grid</span></span>
<span id="cb34-8"><a href="chapter-3-sampling-the-imaginary.html#cb34-8" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">8</span> <span class="co">#Successes, water in this example</span></span>
<span id="cb34-9"><a href="chapter-3-sampling-the-imaginary.html#cb34-9" aria-hidden="true" tabindex="-1"></a>                     ,<span class="at">size =</span> <span class="dv">15</span> <span class="co">#No. of tosses</span></span>
<span id="cb34-10"><a href="chapter-3-sampling-the-imaginary.html#cb34-10" aria-hidden="true" tabindex="-1"></a>                     ,<span class="at">prob =</span> p_grid )</span>
<span id="cb34-11"><a href="chapter-3-sampling-the-imaginary.html#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="chapter-3-sampling-the-imaginary.html#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co"># compute product of likelihood and prior</span></span>
<span id="cb34-13"><a href="chapter-3-sampling-the-imaginary.html#cb34-13" aria-hidden="true" tabindex="-1"></a>unstd.posterior <span class="ot">&lt;-</span> likelihood <span class="sc">*</span> prior</span>
<span id="cb34-14"><a href="chapter-3-sampling-the-imaginary.html#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co"># standardize the posterior, so it sums to 1</span></span>
<span id="cb34-15"><a href="chapter-3-sampling-the-imaginary.html#cb34-15" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> unstd.posterior <span class="sc">/</span> <span class="fu">sum</span>(unstd.posterior)</span>
<span id="cb34-16"><a href="chapter-3-sampling-the-imaginary.html#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-17"><a href="chapter-3-sampling-the-imaginary.html#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting</span></span>
<span id="cb34-18"><a href="chapter-3-sampling-the-imaginary.html#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb34-19"><a href="chapter-3-sampling-the-imaginary.html#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prior,<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">main =</span> <span class="st">&quot;Prior&quot;</span>)</span>
<span id="cb34-20"><a href="chapter-3-sampling-the-imaginary.html#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p_grid </span>
<span id="cb34-21"><a href="chapter-3-sampling-the-imaginary.html#cb34-21" aria-hidden="true" tabindex="-1"></a>     ,posterior </span>
<span id="cb34-22"><a href="chapter-3-sampling-the-imaginary.html#cb34-22" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">type=</span><span class="st">&quot;l&quot;</span></span>
<span id="cb34-23"><a href="chapter-3-sampling-the-imaginary.html#cb34-23" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">xlab=</span><span class="st">&quot;probability of water&quot;</span> </span>
<span id="cb34-24"><a href="chapter-3-sampling-the-imaginary.html#cb34-24" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">ylab=</span><span class="st">&quot;posterior probability&quot;</span> </span>
<span id="cb34-25"><a href="chapter-3-sampling-the-imaginary.html#cb34-25" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">main =</span> <span class="st">&quot;Posterior distribution&quot;</span></span>
<span id="cb34-26"><a href="chapter-3-sampling-the-imaginary.html#cb34-26" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">sub =</span> <span class="fu">paste</span>(length,<span class="st">&quot; points&quot;</span>)</span>
<span id="cb34-27"><a href="chapter-3-sampling-the-imaginary.html#cb34-27" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb34-28"><a href="chapter-3-sampling-the-imaginary.html#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> p_grid[<span class="fu">which.max</span>(posterior)],<span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>,<span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb34-29"><a href="chapter-3-sampling-the-imaginary.html#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">paste</span>(<span class="st">&quot;Max =&quot;</span>,<span class="fu">round</span>(p_grid[<span class="fu">which.max</span>(posterior)],<span class="dv">2</span>)))</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-21-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that the posterior distribution is now centered almost around 50%, as we almost in every second case see water.</p>
</div>
<div id="m2-1" class="section level3" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> 3M2</h3>
<p>Draw 10,000 samples from the grid approximation from above. Then use the samples to calculate the 90% HPDI for p.</p>
<p>First we draw 10.000 samples and then we can calculate the HDPI (higest posterior density interval)</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="chapter-3-sampling-the-imaginary.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb35-2"><a href="chapter-3-sampling-the-imaginary.html#cb35-2" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">sample</span>(p_grid,<span class="at">size=</span><span class="dv">10000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span>posterior)</span>
<span id="cb35-3"><a href="chapter-3-sampling-the-imaginary.html#cb35-3" aria-hidden="true" tabindex="-1"></a>hdpi <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples,<span class="at">prob =</span> <span class="fl">0.9</span>)</span>
<span id="cb35-4"><a href="chapter-3-sampling-the-imaginary.html#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="chapter-3-sampling-the-imaginary.html#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb35-6"><a href="chapter-3-sampling-the-imaginary.html#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p_grid </span>
<span id="cb35-7"><a href="chapter-3-sampling-the-imaginary.html#cb35-7" aria-hidden="true" tabindex="-1"></a>     ,posterior </span>
<span id="cb35-8"><a href="chapter-3-sampling-the-imaginary.html#cb35-8" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">type=</span><span class="st">&quot;l&quot;</span></span>
<span id="cb35-9"><a href="chapter-3-sampling-the-imaginary.html#cb35-9" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">xlab=</span><span class="st">&quot;probability of water&quot;</span> </span>
<span id="cb35-10"><a href="chapter-3-sampling-the-imaginary.html#cb35-10" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">ylab=</span><span class="st">&quot;posterior probability&quot;</span> </span>
<span id="cb35-11"><a href="chapter-3-sampling-the-imaginary.html#cb35-11" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">main =</span> <span class="st">&quot;Posterior distribution&quot;</span></span>
<span id="cb35-12"><a href="chapter-3-sampling-the-imaginary.html#cb35-12" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">sub =</span> <span class="fu">paste</span>(length,<span class="st">&quot; points&quot;</span>)</span>
<span id="cb35-13"><a href="chapter-3-sampling-the-imaginary.html#cb35-13" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb35-14"><a href="chapter-3-sampling-the-imaginary.html#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> hdpi[<span class="dv">1</span>],<span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb35-15"><a href="chapter-3-sampling-the-imaginary.html#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> hdpi[<span class="dv">2</span>],<span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb35-16"><a href="chapter-3-sampling-the-imaginary.html#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">paste</span>(<span class="st">&quot;Max =&quot;</span>,<span class="fu">round</span>(p_grid[<span class="fu">which.max</span>(posterior)],<span class="dv">2</span>)))</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-22-1.png" width="720" style="display: block; margin: auto;" /></p>
</div>
<div id="m3" class="section level3" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> 3M3</h3>
<p>Construct a posterior predictive check for this model and data. This means simulate the distribution of samples, averaging over the posterior uncertainty in p. What is the probability of observing 8 water in 15 tosses?</p>
<p>Posterior predictive check = to inspect the posterior and see if it actually makes sense.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="chapter-3-sampling-the-imaginary.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb36-2"><a href="chapter-3-sampling-the-imaginary.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(samples)</span>
<span id="cb36-3"><a href="chapter-3-sampling-the-imaginary.html#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(samples)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-23-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="chapter-3-sampling-the-imaginary.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(samples)</span></code></pre></div>
<pre><code>## [1] 0.5292899</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="chapter-3-sampling-the-imaginary.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">8</span>,<span class="at">size =</span> <span class="dv">15</span>,<span class="at">prob =</span> <span class="fu">mean</span>(samples))</span></code></pre></div>
<pre><code>## [1] 0.202942</code></pre>
<p>We see that there is a 0.2 probability that you select 8 water in a total of 15 tosses.</p>
</div>
<div id="m4" class="section level3" number="3.4.4">
<h3><span class="header-section-number">3.4.4</span> 3M4</h3>
<p>Using the posterior distribution constructed from the new (8/15) data, now calculate the probability of observing 6 water in 9 tosses.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="chapter-3-sampling-the-imaginary.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">6</span>,<span class="at">size =</span> <span class="dv">9</span>,<span class="at">prob =</span> <span class="fu">mean</span>(samples))</span></code></pre></div>
<pre><code>## [1] 0.19262</code></pre>
<p>We see a 0.19 probability of getting 6 water in a total of 9 tosses.</p>
</div>
<div id="m5" class="section level3" number="3.4.5">
<h3><span class="header-section-number">3.4.5</span> 3M5</h3>
<p>Start over at 3M1, but now use a prior that is zero below p = 0.5 and a constant above p = 0.5. This corresponds to prior information that a majority of the Earth’s surface is water. Repeat each problem above and compare the inferences. What difference does the better prior make? If it helps, compare inferences (using both priors) to the true value p = 0.7.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="chapter-3-sampling-the-imaginary.html#cb43-1" aria-hidden="true" tabindex="-1"></a>length <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb43-2"><a href="chapter-3-sampling-the-imaginary.html#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="chapter-3-sampling-the-imaginary.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># define grid</span></span>
<span id="cb43-4"><a href="chapter-3-sampling-the-imaginary.html#cb43-4" aria-hidden="true" tabindex="-1"></a>p_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span> , <span class="at">to=</span><span class="dv">1</span> , <span class="at">length.out =</span> length)</span>
<span id="cb43-5"><a href="chapter-3-sampling-the-imaginary.html#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># define prior</span></span>
<span id="cb43-6"><a href="chapter-3-sampling-the-imaginary.html#cb43-6" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,length<span class="sc">/</span><span class="dv">2</span>),<span class="fu">rep</span>(<span class="dv">1</span>,length<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb43-7"><a href="chapter-3-sampling-the-imaginary.html#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># compute likelihood at each value in grid</span></span>
<span id="cb43-8"><a href="chapter-3-sampling-the-imaginary.html#cb43-8" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">8</span> <span class="co">#Successes, water in this example</span></span>
<span id="cb43-9"><a href="chapter-3-sampling-the-imaginary.html#cb43-9" aria-hidden="true" tabindex="-1"></a>                     ,<span class="at">size =</span> <span class="dv">15</span> <span class="co">#No. of tosses</span></span>
<span id="cb43-10"><a href="chapter-3-sampling-the-imaginary.html#cb43-10" aria-hidden="true" tabindex="-1"></a>                     ,<span class="at">prob =</span> p_grid )</span>
<span id="cb43-11"><a href="chapter-3-sampling-the-imaginary.html#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="chapter-3-sampling-the-imaginary.html#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="co"># compute product of likelihood and prior</span></span>
<span id="cb43-13"><a href="chapter-3-sampling-the-imaginary.html#cb43-13" aria-hidden="true" tabindex="-1"></a>unstd.posterior <span class="ot">&lt;-</span> likelihood <span class="sc">*</span> prior</span>
<span id="cb43-14"><a href="chapter-3-sampling-the-imaginary.html#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="co"># standardize the posterior, so it sums to 1</span></span>
<span id="cb43-15"><a href="chapter-3-sampling-the-imaginary.html#cb43-15" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> unstd.posterior <span class="sc">/</span> <span class="fu">sum</span>(unstd.posterior)</span>
<span id="cb43-16"><a href="chapter-3-sampling-the-imaginary.html#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="chapter-3-sampling-the-imaginary.html#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting</span></span>
<span id="cb43-18"><a href="chapter-3-sampling-the-imaginary.html#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb43-19"><a href="chapter-3-sampling-the-imaginary.html#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prior,<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">main =</span> <span class="st">&quot;Prior&quot;</span>)</span>
<span id="cb43-20"><a href="chapter-3-sampling-the-imaginary.html#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p_grid </span>
<span id="cb43-21"><a href="chapter-3-sampling-the-imaginary.html#cb43-21" aria-hidden="true" tabindex="-1"></a>     ,posterior </span>
<span id="cb43-22"><a href="chapter-3-sampling-the-imaginary.html#cb43-22" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">type=</span><span class="st">&quot;l&quot;</span></span>
<span id="cb43-23"><a href="chapter-3-sampling-the-imaginary.html#cb43-23" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">xlab=</span><span class="st">&quot;probability of water&quot;</span> </span>
<span id="cb43-24"><a href="chapter-3-sampling-the-imaginary.html#cb43-24" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">ylab=</span><span class="st">&quot;posterior probability&quot;</span> </span>
<span id="cb43-25"><a href="chapter-3-sampling-the-imaginary.html#cb43-25" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">main =</span> <span class="st">&quot;Posterior distribution&quot;</span></span>
<span id="cb43-26"><a href="chapter-3-sampling-the-imaginary.html#cb43-26" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">sub =</span> <span class="fu">paste</span>(length,<span class="st">&quot; points&quot;</span>)</span>
<span id="cb43-27"><a href="chapter-3-sampling-the-imaginary.html#cb43-27" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb43-28"><a href="chapter-3-sampling-the-imaginary.html#cb43-28" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> p_grid[<span class="fu">which.max</span>(posterior)],<span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>,<span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb43-29"><a href="chapter-3-sampling-the-imaginary.html#cb43-29" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">paste</span>(<span class="st">&quot;Max =&quot;</span>,<span class="fu">round</span>(p_grid[<span class="fu">which.max</span>(posterior)],<span class="dv">2</span>)))</span>
<span id="cb43-30"><a href="chapter-3-sampling-the-imaginary.html#cb43-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-31"><a href="chapter-3-sampling-the-imaginary.html#cb43-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculating HDPI</span></span>
<span id="cb43-32"><a href="chapter-3-sampling-the-imaginary.html#cb43-32" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">sample</span>(p_grid,<span class="at">size=</span><span class="dv">10000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span>posterior)</span>
<span id="cb43-33"><a href="chapter-3-sampling-the-imaginary.html#cb43-33" aria-hidden="true" tabindex="-1"></a>hdpi <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples,<span class="at">prob =</span> <span class="fl">0.9</span>)</span>
<span id="cb43-34"><a href="chapter-3-sampling-the-imaginary.html#cb43-34" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> hdpi[<span class="dv">1</span>],<span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>)</span>
<span id="cb43-35"><a href="chapter-3-sampling-the-imaginary.html#cb43-35" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> hdpi[<span class="dv">2</span>],<span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-27-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Now we would see that the probability of drawing water is relatively higher than what we have seen before. Although that does not mean that one cannot draw land and there is also a chance of drawing only land.</p>
<p><strong>Calculating probability of different outcomes</strong></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="chapter-3-sampling-the-imaginary.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">8</span>,<span class="at">size =</span> <span class="dv">15</span>,<span class="at">prob =</span> <span class="fu">mean</span>(samples))</span></code></pre></div>
<pre><code>## [1] 0.1711683</code></pre>
<p>We see that this went from a bit above 20% to almost 17%</p>
<p>The following scenario increased.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="chapter-3-sampling-the-imaginary.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">6</span>,<span class="at">size =</span> <span class="dv">9</span>,<span class="at">prob =</span> <span class="fu">mean</span>(samples))</span></code></pre></div>
<pre><code>## [1] 0.2554195</code></pre>
<p>We see that it is higher now, we went from 0.19 to 0.25.</p>
<p>We see that the scenario of getting relatively more water is higher.</p>
</div>
<div id="h1" class="section level3" number="3.4.6">
<h3><span class="header-section-number">3.4.6</span> 3H1</h3>
<p>Using grid approximation, compute the posterior distribution for the probability of a birth being a boy. Assume a uniform prior probability. Which parameter value maximizes the posterior probability?</p>
<p>1 = Male, 0 = Female. Ande birth 1 and 2 are two different datasets.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="chapter-3-sampling-the-imaginary.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb48-2"><a href="chapter-3-sampling-the-imaginary.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(homeworkch3)</span>
<span id="cb48-3"><a href="chapter-3-sampling-the-imaginary.html#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="chapter-3-sampling-the-imaginary.html#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(birth1) <span class="sc">+</span> <span class="fu">sum</span>(birth2)</span></code></pre></div>
<pre><code>## [1] 111</code></pre>
<p>This means that there are 111 boys in the two datasets.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="chapter-3-sampling-the-imaginary.html#cb50-1" aria-hidden="true" tabindex="-1"></a>length <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb50-2"><a href="chapter-3-sampling-the-imaginary.html#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="chapter-3-sampling-the-imaginary.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># define grid</span></span>
<span id="cb50-4"><a href="chapter-3-sampling-the-imaginary.html#cb50-4" aria-hidden="true" tabindex="-1"></a>p_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from=</span><span class="dv">0</span> , <span class="at">to=</span><span class="dv">1</span> , <span class="at">length.out =</span> length )</span>
<span id="cb50-5"><a href="chapter-3-sampling-the-imaginary.html#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># define prior</span></span>
<span id="cb50-6"><a href="chapter-3-sampling-the-imaginary.html#cb50-6" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">rep</span>( <span class="dv">1</span> , length )</span>
<span id="cb50-7"><a href="chapter-3-sampling-the-imaginary.html#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># compute likelihood at each value in grid</span></span>
<span id="cb50-8"><a href="chapter-3-sampling-the-imaginary.html#cb50-8" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">111</span> ,<span class="at">size=</span><span class="dv">200</span> ,<span class="at">prob=</span>p_grid )</span>
<span id="cb50-9"><a href="chapter-3-sampling-the-imaginary.html#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co"># compute product of likelihood and prior</span></span>
<span id="cb50-10"><a href="chapter-3-sampling-the-imaginary.html#cb50-10" aria-hidden="true" tabindex="-1"></a>unstd.posterior <span class="ot">&lt;-</span> likelihood <span class="sc">*</span> prior</span>
<span id="cb50-11"><a href="chapter-3-sampling-the-imaginary.html#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="co"># standardize the posterior, so it sums to 1</span></span>
<span id="cb50-12"><a href="chapter-3-sampling-the-imaginary.html#cb50-12" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> unstd.posterior <span class="sc">/</span> <span class="fu">sum</span>(unstd.posterior)</span>
<span id="cb50-13"><a href="chapter-3-sampling-the-imaginary.html#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="chapter-3-sampling-the-imaginary.html#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting</span></span>
<span id="cb50-15"><a href="chapter-3-sampling-the-imaginary.html#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prior,<span class="at">type =</span> <span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-31-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="chapter-3-sampling-the-imaginary.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p_grid </span>
<span id="cb51-2"><a href="chapter-3-sampling-the-imaginary.html#cb51-2" aria-hidden="true" tabindex="-1"></a>     ,posterior </span>
<span id="cb51-3"><a href="chapter-3-sampling-the-imaginary.html#cb51-3" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">type=</span><span class="st">&quot;l&quot;</span></span>
<span id="cb51-4"><a href="chapter-3-sampling-the-imaginary.html#cb51-4" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">xlab=</span><span class="st">&quot;probability of a boy&quot;</span> </span>
<span id="cb51-5"><a href="chapter-3-sampling-the-imaginary.html#cb51-5" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">ylab=</span><span class="st">&quot;posterior probability&quot;</span> )</span>
<span id="cb51-6"><a href="chapter-3-sampling-the-imaginary.html#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="chapter-3-sampling-the-imaginary.html#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> p_grid[<span class="fu">which.max</span>(posterior)],<span class="at">col =</span> <span class="st">&#39;darkgreen&#39;</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-31-2.png" width="720" style="display: block; margin: auto;" /></p>
</div>
<div id="h2" class="section level3" number="3.4.7">
<h3><span class="header-section-number">3.4.7</span> 3H2</h3>
<p>Using the sample function, draw 10,000 random parameter values from the posterior distribution you calculated above. Use these samples to estimate the 50%, 89%, and 97% highest posterior density intervals.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="chapter-3-sampling-the-imaginary.html#cb52-1" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">sample</span>(p_grid,<span class="at">size=</span><span class="dv">10000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span>posterior)</span>
<span id="cb52-2"><a href="chapter-3-sampling-the-imaginary.html#cb52-2" aria-hidden="true" tabindex="-1"></a>hdpi <span class="ot">&lt;-</span> rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples,<span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb52-3"><a href="chapter-3-sampling-the-imaginary.html#cb52-3" aria-hidden="true" tabindex="-1"></a>hdpi</span></code></pre></div>
<pre><code>##      |0.5      0.5| 
## 0.5454545 0.5858586</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="chapter-3-sampling-the-imaginary.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#     |0.5      0.5| </span></span>
<span id="cb54-2"><a href="chapter-3-sampling-the-imaginary.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co">#0.5454545 0.5858586 </span></span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="chapter-3-sampling-the-imaginary.html#cb55-1" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples,<span class="at">prob =</span> <span class="fl">0.89</span>)</span></code></pre></div>
<pre><code>##     |0.89     0.89| 
## 0.5050505 0.6060606</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="chapter-3-sampling-the-imaginary.html#cb57-1" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples,<span class="at">prob =</span> <span class="fl">0.97</span>)</span></code></pre></div>
<pre><code>##     |0.97     0.97| 
## 0.4848485 0.6262626</code></pre>
</div>
<div id="h3" class="section level3" number="3.4.8">
<h3><span class="header-section-number">3.4.8</span> 3H3</h3>
<p>Use rbinom to simulate 10,000 replicates of 200 births. You should end up with 10,000 numbers, each one a count of boys out of 200 births. Compare the distribution of predicted numbers of boys to the actual count in the data (111 boys out of 200 births). There are many good ways to visualize the simulations, but the dens command (part of the rethinking package) is probably the easiest way in this case. Does it look like the model fits the data well? That is, does the distribution of predictions include the actual observation as a central, likely outcome?</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="chapter-3-sampling-the-imaginary.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb59-2"><a href="chapter-3-sampling-the-imaginary.html#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="chapter-3-sampling-the-imaginary.html#cb59-3" aria-hidden="true" tabindex="-1"></a>dummy_w <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">100000</span> <span class="co">#No of observations</span></span>
<span id="cb59-4"><a href="chapter-3-sampling-the-imaginary.html#cb59-4" aria-hidden="true" tabindex="-1"></a>                  ,<span class="at">size=</span><span class="dv">200</span>  <span class="co">#Size of each set</span></span>
<span id="cb59-5"><a href="chapter-3-sampling-the-imaginary.html#cb59-5" aria-hidden="true" tabindex="-1"></a>                  ,<span class="at">prob=</span>(<span class="dv">111</span><span class="sc">/</span><span class="dv">200</span>)) <span class="co">#55% boys</span></span>
<span id="cb59-6"><a href="chapter-3-sampling-the-imaginary.html#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(dummy_w</span>
<span id="cb59-7"><a href="chapter-3-sampling-the-imaginary.html#cb59-7" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">adj =</span> <span class="fl">0.7</span> <span class="co">#The higher the smoother, def = 0.5</span></span>
<span id="cb59-8"><a href="chapter-3-sampling-the-imaginary.html#cb59-8" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb59-9"><a href="chapter-3-sampling-the-imaginary.html#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dummy_w)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-35-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see from the plot that it is centered around 111. We can look at the mean and median in the following.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="chapter-3-sampling-the-imaginary.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dummy_w)</span>
<span id="cb60-2"><a href="chapter-3-sampling-the-imaginary.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(dummy_w)</span></code></pre></div>
<pre><code>## [1] 110.984
## [1] 111</code></pre>
<p>We see that it is very close to 111 and the median is 111.</p>
</div>
<div id="h4" class="section level3" number="3.4.9">
<h3><span class="header-section-number">3.4.9</span> 3H4</h3>
<p>Now compare 10,000 counts of boys from 100 simulated first borns only to the number of boys in the first births, birth1. How does the model look in this light?</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="chapter-3-sampling-the-imaginary.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(birth1)</span></code></pre></div>
<pre><code>## [1] 51</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="chapter-3-sampling-the-imaginary.html#cb64-1" aria-hidden="true" tabindex="-1"></a>dummy_w <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">100000</span> <span class="co">#No of observations</span></span>
<span id="cb64-2"><a href="chapter-3-sampling-the-imaginary.html#cb64-2" aria-hidden="true" tabindex="-1"></a>                  ,<span class="at">size=</span><span class="dv">100</span>  <span class="co">#Size of each set</span></span>
<span id="cb64-3"><a href="chapter-3-sampling-the-imaginary.html#cb64-3" aria-hidden="true" tabindex="-1"></a>                  ,<span class="at">prob=</span>(<span class="dv">111</span><span class="sc">/</span><span class="dv">200</span>)) <span class="co">#55% boys</span></span>
<span id="cb64-4"><a href="chapter-3-sampling-the-imaginary.html#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(dummy_w,<span class="at">adj =</span> <span class="fl">0.7</span>)</span>
<span id="cb64-5"><a href="chapter-3-sampling-the-imaginary.html#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">sum</span>(birth1),<span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-38-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="chapter-3-sampling-the-imaginary.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dummy_w)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-38-2.png" width="720" style="display: block; margin: auto;" /></p>
<p>Now we see that the the densest part of the density plot is left skewed compared to the first born boys.</p>
</div>
<div id="h5" class="section level3" number="3.4.10">
<h3><span class="header-section-number">3.4.10</span> 3H5</h3>
<p>The model assumes that sex of first and second births are independent. To check this assumption, focus now on second births that followed female first borns.</p>
<p>Compare 10,000 simulated counts of boys to only those second births that followed girls.</p>
<p>To do this correctly, you need to count the number of first borns who were girls and simulate that many births, 10,000 times.</p>
<p>Compare the counts of boys in your simulations to the actual observed count of boys following girls. How does the model look in this light? Any guesses what is going on in these data?</p>
<ol style="list-style-type: decimal">
<li>We know that it is a girl if the first born = 0. Thus we want to subset on these</li>
</ol>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="chapter-3-sampling-the-imaginary.html#cb66-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> birth2[birth1 <span class="sc">==</span> <span class="dv">0</span>] <span class="co">#Boys following girls</span></span></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="chapter-3-sampling-the-imaginary.html#cb67-1" aria-hidden="true" tabindex="-1"></a>dummy_w <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">100000</span> <span class="co">#No of observations</span></span>
<span id="cb67-2"><a href="chapter-3-sampling-the-imaginary.html#cb67-2" aria-hidden="true" tabindex="-1"></a>                  ,<span class="at">size =</span> <span class="fu">length</span>(birth1)<span class="sc">-</span><span class="fu">sum</span>(birth1)  <span class="co">#Size of each set</span></span>
<span id="cb67-3"><a href="chapter-3-sampling-the-imaginary.html#cb67-3" aria-hidden="true" tabindex="-1"></a>                  ,<span class="at">prob =</span> (<span class="dv">111</span><span class="sc">/</span><span class="dv">200</span>)) <span class="co">#55% boys</span></span>
<span id="cb67-4"><a href="chapter-3-sampling-the-imaginary.html#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="chapter-3-sampling-the-imaginary.html#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(dummy_w,<span class="at">adj =</span> <span class="fl">0.7</span>)</span>
<span id="cb67-6"><a href="chapter-3-sampling-the-imaginary.html#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">sum</span>(df) <span class="co">#no. of boys following girls</span></span>
<span id="cb67-7"><a href="chapter-3-sampling-the-imaginary.html#cb67-7" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-40-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="chapter-3-sampling-the-imaginary.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dummy_w)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-40-2.png" width="720" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-2-small-worlds-and-large-worlds.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="geocentric-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
