<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Geocentric Models | Bayesian Data Analysis Notes</title>
  <meta name="description" content="4 Geocentric Models | Bayesian Data Analysis Notes" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Geocentric Models | Bayesian Data Analysis Notes" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Geocentric Models | Bayesian Data Analysis Notes" />
  
  
  

<meta name="author" content="Jonas Ringive Korsholm" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-3-sampling-the-imaginary.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="chapter-1-golems-of-prague.html"><a href="chapter-1-golems-of-prague.html"><i class="fa fa-check"></i><b>1</b> Chapter 1 - Golems of Prague</a></li>
<li class="chapter" data-level="2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html"><i class="fa fa-check"></i><b>2</b> Chapter 2 - Small worlds and Large Worlds</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#models-and-estimation"><i class="fa fa-check"></i><b>2.1</b> Models and Estimation</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#engines-motors-to-estimate-the-models"><i class="fa fa-check"></i><b>2.1.1</b> Engines / Motors to estimate the models</a>
<ul>
<li class="chapter" data-level="2.1.1.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#grid-approximation"><i class="fa fa-check"></i><b>2.1.1.1</b> Grid approximation</a></li>
<li class="chapter" data-level="2.1.1.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#quadratic-approximation"><i class="fa fa-check"></i><b>2.1.1.2</b> Quadratic approximation</a></li>
<li class="chapter" data-level="2.1.1.3" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#markov-chain-monte-carlo"><i class="fa fa-check"></i><b>2.1.1.3</b> Markov Chain Monte Carlo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#exercises"><i class="fa fa-check"></i><b>2.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#m1"><i class="fa fa-check"></i><b>2.2.1</b> 2M1</a></li>
<li class="chapter" data-level="2.2.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#m2"><i class="fa fa-check"></i><b>2.2.2</b> 2M2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html"><i class="fa fa-check"></i><b>3</b> Chapter 3 - Sampling the Imaginary</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-from-a-grid-approximate-posterior"><i class="fa fa-check"></i><b>3.1</b> Sampling from a grid-approximate posterior</a></li>
<li class="chapter" data-level="3.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-to-summarize"><i class="fa fa-check"></i><b>3.2</b> Sampling to summarize</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#defined-boundaries"><i class="fa fa-check"></i><b>3.2.1</b> Defined Boundaries</a></li>
<li class="chapter" data-level="3.2.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#defined-probability-mass"><i class="fa fa-check"></i><b>3.2.2</b> Defined Probability Mass</a></li>
<li class="chapter" data-level="3.2.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#point-estimates"><i class="fa fa-check"></i><b>3.2.3</b> Point Estimates</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-to-simulate-prediction"><i class="fa fa-check"></i><b>3.3</b> Sampling to simulate prediction</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#dummy-data"><i class="fa fa-check"></i><b>3.3.1</b> Dummy Data</a></li>
<li class="chapter" data-level="3.3.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#model-checking"><i class="fa fa-check"></i><b>3.3.2</b> Model Checking</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#exercises-1"><i class="fa fa-check"></i><b>3.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m1-1"><i class="fa fa-check"></i><b>3.4.1</b> 3M1</a></li>
<li class="chapter" data-level="3.4.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m2-1"><i class="fa fa-check"></i><b>3.4.2</b> 3M2</a></li>
<li class="chapter" data-level="3.4.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m3"><i class="fa fa-check"></i><b>3.4.3</b> 3M3</a></li>
<li class="chapter" data-level="3.4.4" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m4"><i class="fa fa-check"></i><b>3.4.4</b> 3M4</a></li>
<li class="chapter" data-level="3.4.5" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m5"><i class="fa fa-check"></i><b>3.4.5</b> 3M5</a></li>
<li class="chapter" data-level="3.4.6" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h1"><i class="fa fa-check"></i><b>3.4.6</b> 3H1</a></li>
<li class="chapter" data-level="3.4.7" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h2"><i class="fa fa-check"></i><b>3.4.7</b> 3H2</a></li>
<li class="chapter" data-level="3.4.8" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h3"><i class="fa fa-check"></i><b>3.4.8</b> 3H3</a></li>
<li class="chapter" data-level="3.4.9" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h4"><i class="fa fa-check"></i><b>3.4.9</b> 3H4</a></li>
<li class="chapter" data-level="3.4.10" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h5"><i class="fa fa-check"></i><b>3.4.10</b> 3H5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geocentric-models.html"><a href="geocentric-models.html"><i class="fa fa-check"></i><b>4</b> Geocentric Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="geocentric-models.html"><a href="geocentric-models.html#why-normal-distributions-are-normal"><i class="fa fa-check"></i><b>4.1</b> Why Normal distributions are normal</a></li>
<li class="chapter" data-level="4.2" data-path="geocentric-models.html"><a href="geocentric-models.html#a-language-for-describing-models"><i class="fa fa-check"></i><b>4.2</b> A language for describing models</a></li>
<li class="chapter" data-level="4.3" data-path="geocentric-models.html"><a href="geocentric-models.html#gaussian-model-of-height"><i class="fa fa-check"></i><b>4.3</b> Gaussian model of height</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="geocentric-models.html"><a href="geocentric-models.html#the-model"><i class="fa fa-check"></i><b>4.3.1</b> The model</a></li>
<li class="chapter" data-level="4.3.2" data-path="geocentric-models.html"><a href="geocentric-models.html#grid-approximation-of-the-posterior-distribution"><i class="fa fa-check"></i><b>4.3.2</b> Grid approximation of the posterior distribution</a></li>
<li class="chapter" data-level="4.3.3" data-path="geocentric-models.html"><a href="geocentric-models.html#sampling-from-the-posterior"><i class="fa fa-check"></i><b>4.3.3</b> Sampling from the posterior</a></li>
<li class="chapter" data-level="4.3.4" data-path="geocentric-models.html"><a href="geocentric-models.html#finding-the-posterior-distribution-with-quap"><i class="fa fa-check"></i><b>4.3.4</b> Finding the posterior distribution with quap</a></li>
<li class="chapter" data-level="4.3.5" data-path="geocentric-models.html"><a href="geocentric-models.html#sampling-from-a-quap"><i class="fa fa-check"></i><b>4.3.5</b> Sampling from a quap</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="geocentric-models.html"><a href="geocentric-models.html#linear-prediction"><i class="fa fa-check"></i><b>4.4</b> Linear prediction</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="geocentric-models.html"><a href="geocentric-models.html#the-lienar-mdoel-strategy"><i class="fa fa-check"></i><b>4.4.1</b> The lienar mdoel strategy</a></li>
<li class="chapter" data-level="4.4.2" data-path="geocentric-models.html"><a href="geocentric-models.html#finding-the-posterior-distribution"><i class="fa fa-check"></i><b>4.4.2</b> Finding the posterior distribution</a></li>
<li class="chapter" data-level="4.4.3" data-path="geocentric-models.html"><a href="geocentric-models.html#interpreting-the-posterior-distribution"><i class="fa fa-check"></i><b>4.4.3</b> Interpreting the posterior distribution</a>
<ul>
<li class="chapter" data-level="4.4.3.1" data-path="geocentric-models.html"><a href="geocentric-models.html#tables-fo-marginal-distributions"><i class="fa fa-check"></i><b>4.4.3.1</b> Tables fo marginal distributions</a></li>
<li class="chapter" data-level="4.4.3.2" data-path="geocentric-models.html"><a href="geocentric-models.html#plotting-posterir-inference-against-the-data"><i class="fa fa-check"></i><b>4.4.3.2</b> Plotting posterir inference against the data</a></li>
<li class="chapter" data-level="4.4.3.3" data-path="geocentric-models.html"><a href="geocentric-models.html#adding-uncertainty-around-the-mean"><i class="fa fa-check"></i><b>4.4.3.3</b> Adding uncertainty around the mean</a></li>
<li class="chapter" data-level="4.4.3.4" data-path="geocentric-models.html"><a href="geocentric-models.html#plotting-regression-intervlas-and-contours"><i class="fa fa-check"></i><b>4.4.3.4</b> Plotting regression intervlas and contours</a></li>
<li class="chapter" data-level="4.4.3.5" data-path="geocentric-models.html"><a href="geocentric-models.html#prediction-intevals"><i class="fa fa-check"></i><b>4.4.3.5</b> Prediction intevals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="geocentric-models.html"><a href="geocentric-models.html#curves-form-lines"><i class="fa fa-check"></i><b>4.5</b> Curves form lines</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="geocentric-models.html"><a href="geocentric-models.html#polynomial-regression"><i class="fa fa-check"></i><b>4.5.1</b> Polynomial regression</a></li>
<li class="chapter" data-level="4.5.2" data-path="geocentric-models.html"><a href="geocentric-models.html#splines"><i class="fa fa-check"></i><b>4.5.2</b> Splines</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="geocentric-models.html"><a href="geocentric-models.html#exercises-2"><i class="fa fa-check"></i><b>4.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="geocentric-models.html"><a href="geocentric-models.html#m1-2"><i class="fa fa-check"></i><b>4.6.1</b> 4M1</a></li>
<li class="chapter" data-level="4.6.2" data-path="geocentric-models.html"><a href="geocentric-models.html#m8"><i class="fa fa-check"></i><b>4.6.2</b> 4M8</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Data Analysis Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="geocentric-models" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Geocentric Models</h1>
<p><em>This chapter introduce lienar regression as a Bayesian procedure</em>. Thus we will apply probability measures for intepretation, as that is what Bayesian is.</p>
<div id="why-normal-distributions-are-normal" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Why Normal distributions are normal</h2>
<p>This section examplifies why normal distributions are normal and how it is often seen in nature. Jesper shows an example where binomial random draws will tend to be centered around 0 as there are the most paths leading towards the middle. That is why we often find the normal distribution in real life.</p>
<p>It express that normal distributions come from addition of random events, e.g., the result of consecutive coin tosses. Also the product of small numbers approximate addition, hence the result of such outcomes is similar to the added scenario.</p>
<p>Although with large numbers we will tend not to get a normal distribution by finding the product hereof.</p>
<p>The book aim to teaach a strategy to model data and not a single model just for the toolbox.</p>
</div>
<div id="a-language-for-describing-models" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> A language for describing models</h2>
<p>This chapter summarize how models are defined and defines mathematical terminalogy.</p>
<p><strong>Recipe of defining models</strong></p>
<ol style="list-style-type: decimal">
<li><p>Recognize the variables that you want to understand. Observable variables = data. While unobservable things = parameters, e.g., averages and rates, e.g., you dont observe GDP growth rates, but it can be deducted from assessing varaibles (observed data).</p></li>
<li><p>Each variable can be defined in terms of other variables or in terms of a probability distribution. This enables one to learn about associations between variables.</p></li>
<li><p>The combination of variables and their probability distributions defines a joint generative model. This can be used to simulate hypothetical observations as well as analyze real ones.</p></li>
</ol>
<p><strong>Mathematical terminology:</strong></p>
<p>We see that <span class="math inline">\(W \sim Binomial(N,p)\)</span> means that W (water) variable is binomial, it has two outcomes, yes or no. and then we have <span class="math inline">\(p ~ Uniform(0,1)\)</span>, means that p (proportion of water on the globe) is between 0 and 1.</p>
<p>Notice that the wavy symbol <code>~</code> means that the models are <strong><em>stochastic</em></strong>, i.e., there are no instances on the left that are known with certainty. I.e., W is distributed as binomial</p>
<p><strong>Regarding priors:</strong></p>
<p>The priors must be set before you see the data, as if you did not do that, then it is no more a prior.</p>
<p>If you have no idea what to set as a prior, then you set it to some random value, e.g., making it uniform to be within a specific range.</p>
</div>
<div id="gaussian-model-of-height" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Gaussian model of height</h2>
<p>The following is an example to understand normal distributions of normal distributions.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="geocentric-models.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb59-2"><a href="geocentric-models.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Howell1)</span>
<span id="cb59-3"><a href="geocentric-models.html#cb59-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> Howell1 <span class="co">#d for data frame</span></span>
<span id="cb59-4"><a href="geocentric-models.html#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(d)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    544 obs. of  4 variables:
##  $ height: num  152 140 137 157 145 ...
##  $ weight: num  47.8 36.5 31.9 53 41.3 ...
##  $ age   : num  63 63 65 41 51 35 32 27 19 54 ...
##  $ male  : int  1 0 0 1 0 1 0 1 0 1 ...</code></pre>
<p>We see that we have height, wiehgt, age and male.</p>
<p>This can also be summarized with mean, sd, percentiles and histograms.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="geocentric-models.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(d)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">138.2635963</td>
</tr>
<tr class="even">
<td align="right">35.6106176</td>
</tr>
<tr class="odd">
<td align="right">29.3443934</td>
</tr>
<tr class="even">
<td align="right">0.4724265</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">27.6024476</td>
</tr>
<tr class="even">
<td align="right">14.7191782</td>
</tr>
<tr class="odd">
<td align="right">20.7468882</td>
</tr>
<tr class="even">
<td align="right">0.4996986</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">81.108550</td>
</tr>
<tr class="even">
<td align="right">9.360721</td>
</tr>
<tr class="odd">
<td align="right">1.000000</td>
</tr>
<tr class="even">
<td align="right">0.000000</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">165.73500</td>
</tr>
<tr class="even">
<td align="right">54.50289</td>
</tr>
<tr class="odd">
<td align="right">66.13500</td>
</tr>
<tr class="even">
<td align="right">1.00000</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="left">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">▁▁▁▁▁▁▁▂▁▇▇▅▁</td>
</tr>
<tr class="even">
<td align="left">▁▂▃▂▂▂▂▅▇▇▃▂▁</td>
</tr>
<tr class="odd">
<td align="left">▇▅▅▃▅▂▂▁▁</td>
</tr>
<tr class="even">
<td align="left">▇▁▁▁▁▁▁▁▁▇</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>And thus we see the distributions. We are only going to be working with people above or equal to 18 years of age.</p>
<p>Notice that we cannot use the histograms to suggest a distribution, that is because we need to select the priors on berforehand.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="geocentric-models.html#cb62-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> d[d<span class="sc">$</span>age <span class="sc">&gt;=</span> <span class="dv">18</span>,]</span></code></pre></div>
<div id="the-model" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> The model</h3>
<p>Now we can define the model with with the following terms:</p>
<p><span class="math display">\[h_i \sim Normal(\mu,\sigma)\]</span></p>
<p><span class="math inline">\(h_i \sim \mathcal{N}\)</span>, this is exactly the same, just shortened.</p>
<p>Meaning that height is stochastic, given the wavy character <code>~</code>, it is normal with mu and sigma mean and standard deviation. The <code>i</code> means each element in vector <code>h</code>.</p>
<p>Now we can specify the priors. <em>this is done independently for each parameter (unobserved)</em>. It looks the following:</p>
<p><img src="Images/paste-A88626AF.png" /></p>
<p>We see that we have the likelihood that consist of the priors, which are specified afterwards. This can be plotted with.</p>
<p>It means that the mean is centered in 178 and 20 standard deviation, thus two standard deviations (95% being 40), we will have 95% of the people within 178 +- 40.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="geocentric-models.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x,<span class="dv">178</span>,<span class="dv">20</span>),<span class="at">from =</span> <span class="dv">100</span>,<span class="at">to =</span> <span class="dv">250</span>,<span class="at">main =</span> <span class="st">&#39;Mean prior&#39;</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/4.12-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="geocentric-models.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dunif</span>(x,<span class="dv">0</span>,<span class="dv">50</span>),<span class="at">from =</span> <span class="sc">-</span><span class="dv">10</span>,<span class="at">to =</span> <span class="dv">60</span>,<span class="at">main =</span> <span class="st">&quot;Sigma prior&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/4.12-2.png" width="720" style="display: block; margin: auto;" /></p>
<p>Now one can sample heights based on the two priors.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="geocentric-models.html#cb65-1" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb65-2"><a href="geocentric-models.html#cb65-2" aria-hidden="true" tabindex="-1"></a>sample_mu <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(samples,<span class="dv">178</span>,<span class="dv">20</span>) <span class="co">#notice we cannot take the mean of the data, as it is a prior!!!</span></span>
<span id="cb65-3"><a href="geocentric-models.html#cb65-3" aria-hidden="true" tabindex="-1"></a>sample_sigma <span class="ot">&lt;-</span> <span class="fu">runif</span>(samples,<span class="dv">0</span>,<span class="dv">50</span>)</span>
<span id="cb65-4"><a href="geocentric-models.html#cb65-4" aria-hidden="true" tabindex="-1"></a>prior_h <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(samples,sample_mu,sample_sigma)</span>
<span id="cb65-5"><a href="geocentric-models.html#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(prior_h)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/4.14-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>One see that the mean is around the 178. The more samples we draw, the more normal will it look.</p>
<p>Now this makes sense since the mean standard deviation is rather low, lets look at an example with a large standard deviation to the mean.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="geocentric-models.html#cb66-1" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb66-2"><a href="geocentric-models.html#cb66-2" aria-hidden="true" tabindex="-1"></a>sample_mu <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(samples,<span class="dv">178</span>,<span class="dv">100</span>) <span class="co">#notice we cannot take the mean of the data, as it is a prior!!!</span></span>
<span id="cb66-3"><a href="geocentric-models.html#cb66-3" aria-hidden="true" tabindex="-1"></a>prior_h <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(samples,sample_mu,sample_sigma)</span>
<span id="cb66-4"><a href="geocentric-models.html#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(prior_h)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/4.15-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Now we see that the height can go all the way up to 600 and down to a negative number.</p>
<p>When you have a lot of data instances, then such a prior is not harmfull even though it clearly expects a lot of people being very tall and some even below 0. So having an unreasonable prior is not necessarily bad.</p>
</div>
<div id="grid-approximation-of-the-posterior-distribution" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Grid approximation of the posterior distribution</h3>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="geocentric-models.html#cb67-1" aria-hidden="true" tabindex="-1"></a>mu.list <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">150</span>, <span class="at">to=</span><span class="dv">160</span>, <span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb67-2"><a href="geocentric-models.html#cb67-2" aria-hidden="true" tabindex="-1"></a>sigma.list <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">7</span>, <span class="at">to=</span><span class="dv">9</span>, <span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb67-3"><a href="geocentric-models.html#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="geocentric-models.html#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Expand list, mu and sigma, </span></span>
<span id="cb67-5"><a href="geocentric-models.html#cb67-5" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">mu =</span> mu.list, <span class="at">sigma =</span> sigma.list)</span>
<span id="cb67-6"><a href="geocentric-models.html#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="geocentric-models.html#cb67-7" aria-hidden="true" tabindex="-1"></a>post<span class="sc">$</span>LL <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(post), <span class="cf">function</span>(i) <span class="fu">sum</span>(</span>
<span id="cb67-8"><a href="geocentric-models.html#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dnorm</span>(<span class="at">x =</span> d2<span class="sc">$</span>height</span>
<span id="cb67-9"><a href="geocentric-models.html#cb67-9" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">mean =</span> post<span class="sc">$</span>mu[i]</span>
<span id="cb67-10"><a href="geocentric-models.html#cb67-10" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">sd =</span> post<span class="sc">$</span>sigma[i]</span>
<span id="cb67-11"><a href="geocentric-models.html#cb67-11" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb67-12"><a href="geocentric-models.html#cb67-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb67-13"><a href="geocentric-models.html#cb67-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb67-14"><a href="geocentric-models.html#cb67-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-15"><a href="geocentric-models.html#cb67-15" aria-hidden="true" tabindex="-1"></a>post<span class="sc">$</span>prod <span class="ot">&lt;-</span> post<span class="sc">$</span>LL <span class="sc">+</span> <span class="fu">dnorm</span>( post<span class="sc">$</span>mu , <span class="dv">178</span> , <span class="dv">20</span> , <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-16"><a href="geocentric-models.html#cb67-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dunif</span>(post<span class="sc">$</span>sigma,<span class="dv">0</span>, <span class="dv">50</span>, <span class="cn">TRUE</span>)</span>
<span id="cb67-17"><a href="geocentric-models.html#cb67-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-18"><a href="geocentric-models.html#cb67-18" aria-hidden="true" tabindex="-1"></a>post<span class="sc">$</span>prob <span class="ot">&lt;-</span> <span class="fu">exp</span>(post<span class="sc">$</span>prod <span class="sc">-</span> <span class="fu">max</span>(post<span class="sc">$</span>prod))</span></code></pre></div>
<p>Now, lets inspect the posterior distribution</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="geocentric-models.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb68-2"><a href="geocentric-models.html#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co">#A contour plot</span></span>
<span id="cb68-3"><a href="geocentric-models.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contour_xyz</span>(post<span class="sc">$</span>mu, post<span class="sc">$</span>sigma, post<span class="sc">$</span>prob)</span>
<span id="cb68-4"><a href="geocentric-models.html#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="geocentric-models.html#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co">#A heatmap</span></span>
<span id="cb68-6"><a href="geocentric-models.html#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="fu">image_xyz</span>(<span class="at">x =</span> post<span class="sc">$</span>mu,<span class="at">y =</span>  post<span class="sc">$</span>sigma,<span class="at">z =</span>  post<span class="sc">$</span>prob)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/4.17-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>What we get from this, is the most probable combinations of the mu and sigma. Hence we see that very often the mean will be between 154 and 155 while the standard deviation is between 7.5 and 8.</p>
</div>
<div id="sampling-from-the-posterior" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Sampling from the posterior</h3>
<p>Now we are going to sample from the posterior, just as in the globe tossing problem. Here we are just also to sample from the mean and standard deviation. This is done by first making a set of samples, where each row number is listed, basically just an index.</p>
<p>Then we use the index to return the given mean and standard deviation.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="geocentric-models.html#cb69-1" aria-hidden="true" tabindex="-1"></a>sample.rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(post),<span class="at">size =</span> <span class="dv">10000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>) <span class="co">#We can draw the same instance twice</span></span>
<span id="cb69-2"><a href="geocentric-models.html#cb69-2" aria-hidden="true" tabindex="-1"></a>sample.mu <span class="ot">&lt;-</span> post<span class="sc">$</span>mu[sample.rows]</span>
<span id="cb69-3"><a href="geocentric-models.html#cb69-3" aria-hidden="true" tabindex="-1"></a>sample.sigma <span class="ot">&lt;-</span> post<span class="sc">$</span>sigma[sample.rows]</span></code></pre></div>
<p>We see that <code>post$mu</code> and <code>sigma</code> is a grid ranging from respectively 150 to 160 and 7 to 9. e.g.,</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="geocentric-models.html#cb70-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(post<span class="sc">$</span>mu,<span class="at">nrow =</span> <span class="dv">100</span>,<span class="at">ncol =</span> <span class="dv">100</span>)</span>
<span id="cb70-2"><a href="geocentric-models.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(m[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],<span class="at">n =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##           [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]
##  [1,] 150.0000 150.0000 150.0000 150.0000 150.0000 150.0000 150.0000 150.0000
##  [2,] 150.1010 150.1010 150.1010 150.1010 150.1010 150.1010 150.1010 150.1010
##  [3,] 150.2020 150.2020 150.2020 150.2020 150.2020 150.2020 150.2020 150.2020
##  [4,] 150.3030 150.3030 150.3030 150.3030 150.3030 150.3030 150.3030 150.3030
##  [5,] 150.4040 150.4040 150.4040 150.4040 150.4040 150.4040 150.4040 150.4040
##  [6,] 150.5051 150.5051 150.5051 150.5051 150.5051 150.5051 150.5051 150.5051
##  [7,] 150.6061 150.6061 150.6061 150.6061 150.6061 150.6061 150.6061 150.6061
##  [8,] 150.7071 150.7071 150.7071 150.7071 150.7071 150.7071 150.7071 150.7071
##  [9,] 150.8081 150.8081 150.8081 150.8081 150.8081 150.8081 150.8081 150.8081
## [10,] 150.9091 150.9091 150.9091 150.9091 150.9091 150.9091 150.9091 150.9091
##           [,9]    [,10]
##  [1,] 150.0000 150.0000
##  [2,] 150.1010 150.1010
##  [3,] 150.2020 150.2020
##  [4,] 150.3030 150.3030
##  [5,] 150.4040 150.4040
##  [6,] 150.5051 150.5051
##  [7,] 150.6061 150.6061
##  [8,] 150.7071 150.7071
##  [9,] 150.8081 150.8081
## [10,] 150.9091 150.9091</code></pre>
<p>Now lets plot the samples.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="geocentric-models.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb72-2"><a href="geocentric-models.html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sample.mu,sample.sigma</span>
<span id="cb72-3"><a href="geocentric-models.html#cb72-3" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">cex =</span> <span class="fl">0.5</span>,<span class="at">pch =</span> <span class="dv">16</span> <span class="co">#Dot sizes and shape</span></span>
<span id="cb72-4"><a href="geocentric-models.html#cb72-4" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">col =</span> <span class="fu">col.alpha</span>(rangi2,<span class="fl">0.1</span>) <span class="co">#make transparant colors</span></span>
<span id="cb72-5"><a href="geocentric-models.html#cb72-5" aria-hidden="true" tabindex="-1"></a>     )</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/4.20-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Now we can inspect the priors.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="geocentric-models.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb73-2"><a href="geocentric-models.html#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(sample.mu)</span>
<span id="cb73-3"><a href="geocentric-models.html#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(sample.sigma)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/4.21-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>These should have been more or less normally distributed according to the book, but for some reason they are not.</p>
</div>
<div id="finding-the-posterior-distribution-with-quap" class="section level3" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Finding the posterior distribution with quap</h3>
<p>This is using quadratic approximation.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="geocentric-models.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Howell1&quot;</span>)</span>
<span id="cb74-2"><a href="geocentric-models.html#cb74-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> Howell1</span>
<span id="cb74-3"><a href="geocentric-models.html#cb74-3" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> d[d<span class="sc">$</span>age <span class="sc">&gt;=</span> <span class="dv">18</span>,]</span></code></pre></div>
<p>We can spcify the model with the following:</p>
<p><span class="math display">\[h_i \sim Normal(\mu,\sigma)\]</span> <span class="math display">\[\mu \sim Normal(178,20)\]</span> <span class="math display">\[\sigma \sim Uniform(0,150)\]</span></p>
<p>While the equivilent in code is:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="geocentric-models.html#cb75-1" aria-hidden="true" tabindex="-1"></a>height <span class="sc">~</span> <span class="fu">dnorm</span>(mu,sigma)</span>
<span id="cb75-2"><a href="geocentric-models.html#cb75-2" aria-hidden="true" tabindex="-1"></a>mu <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">178</span>,<span class="dv">10</span>)</span>
<span id="cb75-3"><a href="geocentric-models.html#cb75-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>,<span class="dv">50</span>)</span></code></pre></div>
<p>This can be placed in a list:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="geocentric-models.html#cb76-1" aria-hidden="true" tabindex="-1"></a>flist <span class="ot">&lt;-</span>  <span class="fu">alist</span>(</span>
<span id="cb76-2"><a href="geocentric-models.html#cb76-2" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> <span class="fu">dnorm</span>(mu,sigma)</span>
<span id="cb76-3"><a href="geocentric-models.html#cb76-3" aria-hidden="true" tabindex="-1"></a>  ,mu <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">178</span>,<span class="dv">10</span>)</span>
<span id="cb76-4"><a href="geocentric-models.html#cb76-4" aria-hidden="true" tabindex="-1"></a>  ,sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>,<span class="dv">50</span>)</span>
<span id="cb76-5"><a href="geocentric-models.html#cb76-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Now we can fit the model to the data:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="geocentric-models.html#cb77-1" aria-hidden="true" tabindex="-1"></a>m4<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(flist,<span class="at">data =</span> d2)</span>
<span id="cb77-2"><a href="geocentric-models.html#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m4<span class="fl">.1</span>)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">154.636775</td>
</tr>
<tr class="even">
<td align="right">7.731408</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.4117468</td>
</tr>
<tr class="even">
<td align="right">0.2913949</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">153.978724</td>
</tr>
<tr class="even">
<td align="right">7.265703</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">155.294826</td>
</tr>
<tr class="even">
<td align="right">8.197114</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="sampling-from-a-quap" class="section level3" number="4.3.5">
<h3><span class="header-section-number">4.3.5</span> Sampling from a quap</h3>
<p>Now we are going to sample from the quadratic approximation.</p>
<p>Covariances is key to quadratic approximation. This can be found with:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="geocentric-models.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(m4<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##                 mu        sigma
## mu    0.1695354471 0.0008701619
## sigma 0.0008701619 0.0849109920</code></pre>
<p>This tells us how each parameter (unobserved) relates to every other parameter in the posterior distribution. In this scenario covariance does not matter a lot, but when we have a predictor variable, it will be key.</p>
<p>This can be extended to 2 elements:</p>
<ol style="list-style-type: decimal">
<li>A vector of variances for the parameters</li>
<li>A correlation matrix that tells us how changes in any parameter lead to correlated changes in others.</li>
</ol>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="geocentric-models.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(<span class="fu">vcov</span>(m4<span class="fl">.1</span>))</span>
<span id="cb80-2"><a href="geocentric-models.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov2cor</span>(<span class="fu">vcov</span>(m4<span class="fl">.1</span>))</span></code></pre></div>
<pre><code>##         mu      sigma 
## 0.16953545 0.08491099 
##                mu       sigma
## mu    1.000000000 0.007252502
## sigma 0.007252502 1.000000000</code></pre>
<p>We see that a change of 1 in mu will lead to a change of 1 in mu, and it will lead to a change of 0.0018 in sigma. This is very small, hence we can see that there is no correlation between the two of these. <em>Thus, learning the mean will not tell anything about the standard deviation.</em></p>
<p><strong>Getting samples</strong></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="geocentric-models.html#cb82-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m4<span class="fl">.1</span>,<span class="at">n =</span> <span class="dv">10000</span>)</span>
<span id="cb82-2"><a href="geocentric-models.html#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(post)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">mu</th>
<th align="right">sigma</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">154.2506</td>
<td align="right">7.260139</td>
</tr>
<tr class="even">
<td align="right">155.2653</td>
<td align="right">7.831658</td>
</tr>
<tr class="odd">
<td align="right">155.2295</td>
<td align="right">8.015096</td>
</tr>
<tr class="even">
<td align="right">155.4242</td>
<td align="right">7.819525</td>
</tr>
<tr class="odd">
<td align="right">154.6868</td>
<td align="right">8.088762</td>
</tr>
<tr class="even">
<td align="right">154.5212</td>
<td align="right">8.095557</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="geocentric-models.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(post)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">154.633205</td>
</tr>
<tr class="even">
<td align="right">7.736503</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.4122893</td>
</tr>
<tr class="even">
<td align="right">0.2928388</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">153.971768</td>
</tr>
<tr class="even">
<td align="right">7.265452</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">155.291918</td>
</tr>
<tr class="even">
<td align="right">8.206378</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="left">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">▁▁▅▇▂▁▁▁</td>
</tr>
<tr class="even">
<td align="left">▁▁▁▂▅▇▇▃▁▁▁</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>We can see that distributions look more or less normal.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="geocentric-models.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(post,<span class="at">pch =</span> <span class="dv">20</span></span>
<span id="cb84-2"><a href="geocentric-models.html#cb84-2" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">col =</span> <span class="fu">col.alpha</span>(rangi2,<span class="fl">0.1</span>))</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-43-1.png" width="720" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="linear-prediction" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Linear prediction</h2>
<hr />
<p><em>The procedure that we end up going through:</em></p>
<p><em>1. Use <code>link</code> to generate distributions of posterior value for mu.</em></p>
<p><em>2. Use summary functions like <code>mean</code> or <code>PI</code> to find averages and lower and upper bounds of mu, for each value of the predictor variable.</em></p>
<p><em>3. Finally, use plotting functions like <code>lines</code> and <code>shade</code> to draw the lines and intervels. Or you might plot the distributions of the predictions, or do even something else.</em></p>
<hr />
<p>Now we are going to regress one variable on another, hence we have a predictor and an outcome variable. The following example is predicting height given the weight.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="geocentric-models.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d2<span class="sc">$</span>height <span class="sc">~</span> d2<span class="sc">$</span>weight)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-44-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>There is clearly a relationship.</p>
<div id="the-lienar-mdoel-strategy" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> The lienar mdoel strategy</h3>
<p>To specify this model we will say:</p>
<p><em>let x = weight, thus</em> <span class="math inline">\(\bar{x}\)</span> is the average weight parameter of the observed variable.</p>
<p><img src="Images/paste-604F2802.png" /></p>
<p>Now we see that heights are stochastic and normally distributed and is described by the mean and standard deviation. To predict height, we need the mean of the weight variable. This one is deterministic hence the <code>=</code> and not the <code>~</code> sign. It consists of the priors (assumptions), where we express <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\sigma\)</span>. These are all stochastic, where <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are normally distributed while <span class="math inline">\(\sigma\)</span> is uniform.</p>
<p>Now one can simulate the priors.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="geocentric-models.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2971</span>)</span>
<span id="cb86-2"><a href="geocentric-models.html#cb86-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb86-3"><a href="geocentric-models.html#cb86-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">178</span>,<span class="dv">20</span>) <span class="co">#notice we cannot take the mean of the data, as it is a prior!!!</span></span>
<span id="cb86-4"><a href="geocentric-models.html#cb86-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">10</span>)</span></code></pre></div>
<p>This returns 100 pairs of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. This can be plotted with:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="geocentric-models.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NULL</span> </span>
<span id="cb87-2"><a href="geocentric-models.html#cb87-2" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">xlim=</span><span class="fu">range</span>(d2<span class="sc">$</span>weight), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>,<span class="dv">400</span>)</span>
<span id="cb87-3"><a href="geocentric-models.html#cb87-3" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">xlab=</span><span class="st">&quot;weight&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;height&quot;</span> )</span>
<span id="cb87-4"><a href="geocentric-models.html#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="geocentric-models.html#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb87-6"><a href="geocentric-models.html#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">272</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb87-7"><a href="geocentric-models.html#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;b ~ dnorm(0,10)&quot;</span>)</span>
<span id="cb87-8"><a href="geocentric-models.html#cb87-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-9"><a href="geocentric-models.html#cb87-9" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(d2<span class="sc">$</span>weight)</span>
<span id="cb87-10"><a href="geocentric-models.html#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N ) <span class="fu">curve</span>(a[i] <span class="sc">+</span> b[i]<span class="sc">*</span>(x <span class="sc">-</span> xbar)</span>
<span id="cb87-11"><a href="geocentric-models.html#cb87-11" aria-hidden="true" tabindex="-1"></a>                      ,<span class="at">from=</span><span class="fu">min</span>(d2<span class="sc">$</span>weight), <span class="at">to=</span><span class="fu">max</span>(d2<span class="sc">$</span>weight)</span>
<span id="cb87-12"><a href="geocentric-models.html#cb87-12" aria-hidden="true" tabindex="-1"></a>                      ,<span class="at">add=</span><span class="cn">TRUE</span></span>
<span id="cb87-13"><a href="geocentric-models.html#cb87-13" aria-hidden="true" tabindex="-1"></a>                      ,<span class="at">col=</span><span class="fu">col.alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.2</span>))</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/4.39-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that that we get many predictions where we expect a person to be higher than the worlds largest and smaller than the worlds smallest. We can address with by taking the logarithm, which is done in the following:</p>
<p><img src="Images/paste-6503E9ED.png" /></p>
<p>Hence we see that log is added to the equation.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="geocentric-models.html#cb88-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="dv">10000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb88-2"><a href="geocentric-models.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(b,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>),<span class="at">adj=</span><span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/4.40-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Doing the prior predictive simulation again, to compare with the logarithm of beta.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="geocentric-models.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb89-2"><a href="geocentric-models.html#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="geocentric-models.html#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2971</span>)</span>
<span id="cb89-4"><a href="geocentric-models.html#cb89-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb89-5"><a href="geocentric-models.html#cb89-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">178</span>,<span class="dv">20</span>)</span>
<span id="cb89-6"><a href="geocentric-models.html#cb89-6" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb89-7"><a href="geocentric-models.html#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NULL</span>,<span class="at">xlim=</span><span class="fu">range</span>(d2<span class="sc">$</span>weight), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>,<span class="dv">400</span>),<span class="at">xlab=</span><span class="st">&quot;weight&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;height&quot;</span> )</span>
<span id="cb89-8"><a href="geocentric-models.html#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb89-9"><a href="geocentric-models.html#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">272</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb89-10"><a href="geocentric-models.html#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;b ~ dnorm(0,10)&quot;</span>)</span>
<span id="cb89-11"><a href="geocentric-models.html#cb89-11" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(d2<span class="sc">$</span>weight)</span>
<span id="cb89-12"><a href="geocentric-models.html#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N ) <span class="fu">curve</span>(a[i] <span class="sc">+</span> b[i]<span class="sc">*</span>(x <span class="sc">-</span> xbar),<span class="at">from=</span><span class="fu">min</span>(d2<span class="sc">$</span>weight), <span class="at">to=</span><span class="fu">max</span>(d2<span class="sc">$</span>weight),<span class="at">add=</span><span class="cn">TRUE</span>,<span class="at">col=</span><span class="fu">col.alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.2</span>))</span>
<span id="cb89-13"><a href="geocentric-models.html#cb89-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-14"><a href="geocentric-models.html#cb89-14" aria-hidden="true" tabindex="-1"></a><span class="co">#With beta logarithm</span></span>
<span id="cb89-15"><a href="geocentric-models.html#cb89-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2971</span>)</span>
<span id="cb89-16"><a href="geocentric-models.html#cb89-16" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># 100 lines</span></span>
<span id="cb89-17"><a href="geocentric-models.html#cb89-17" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="dv">178</span>, <span class="dv">20</span>)</span>
<span id="cb89-18"><a href="geocentric-models.html#cb89-18" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(N, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co">#RLNORM for logarithm</span></span>
<span id="cb89-19"><a href="geocentric-models.html#cb89-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NULL</span> ,<span class="at">xlim=</span><span class="fu">range</span>(d2<span class="sc">$</span>weight), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>,<span class="dv">400</span>),<span class="at">xlab=</span><span class="st">&quot;weight&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;height&quot;</span>)</span>
<span id="cb89-20"><a href="geocentric-models.html#cb89-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb89-21"><a href="geocentric-models.html#cb89-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">272</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb89-22"><a href="geocentric-models.html#cb89-22" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;b ~ dnorm(0,10)&quot;</span>)</span>
<span id="cb89-23"><a href="geocentric-models.html#cb89-23" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(d2<span class="sc">$</span>weight)</span>
<span id="cb89-24"><a href="geocentric-models.html#cb89-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N ) <span class="fu">curve</span>(a[i] <span class="sc">+</span> b[i]<span class="sc">*</span>(x <span class="sc">-</span> xbar),<span class="at">from=</span><span class="fu">min</span>(d2<span class="sc">$</span>weight), <span class="at">to=</span><span class="fu">max</span>(d2<span class="sc">$</span>weight),<span class="at">add=</span><span class="cn">TRUE</span>,<span class="at">col=</span><span class="fu">col.alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.2</span>))</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="Bayesian-Data-Analysis-Notes_files/figure-html/4.41-1.png" alt="Left = Initial model, Right = logarithm of beta" width="720" />
<p class="caption">
(#fig:4.41)Left = Initial model, Right = logarithm of beta
</p>
</div>
<p>Now we see that the joint prior for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are realistict.</p>
<p><em>Joint prior = The predicted height given the wiehgt, which rely on alpha and beta priors that we have made.</em></p>
<p><strong>Then, what is the correct prior?</strong> It is a fallacy that there is one unique value that is optimal for the prior. Thus one must reason for the selection of the prior and perhaps try different priors to see what it suggest. Essentially the prior is just information that you give the model and can e.g., work as a constrain, as we see in the example above where the priors initially returned extreme values, which we need to tamper down.</p>
<p>Then one could say that we should compare the predictions with the actual sample and then optimize against this. Although one must be weary, as this will just yield to fitting against the sample, and is likely not to be the correct model. Although it boiles down to the purpose of the model.</p>
</div>
<div id="finding-the-posterior-distribution" class="section level3" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Finding the posterior distribution</h3>
<p>We see that we have the following model specification:</p>
<p><img src="Images/paste-82599F2B.png" /></p>
<p><em>Notice that <code>=</code> is exchanged with <code>&lt;-</code>, that is by convention and must be used when specifying the model in R.</em></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="geocentric-models.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Howell1&quot;</span>)</span>
<span id="cb90-2"><a href="geocentric-models.html#cb90-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> Howell1</span>
<span id="cb90-3"><a href="geocentric-models.html#cb90-3" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> d[d<span class="sc">$</span>age <span class="sc">&gt;=</span> <span class="dv">18</span>,]</span>
<span id="cb90-4"><a href="geocentric-models.html#cb90-4" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(d2<span class="sc">$</span>weight)</span>
<span id="cb90-5"><a href="geocentric-models.html#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="geocentric-models.html#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Fit the model</span></span>
<span id="cb90-7"><a href="geocentric-models.html#cb90-7" aria-hidden="true" tabindex="-1"></a>m4<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb90-8"><a href="geocentric-models.html#cb90-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb90-9"><a href="geocentric-models.html#cb90-9" aria-hidden="true" tabindex="-1"></a>    height <span class="sc">~</span> <span class="fu">dnorm</span>(mu,sigma)</span>
<span id="cb90-10"><a href="geocentric-models.html#cb90-10" aria-hidden="true" tabindex="-1"></a>    ,mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b <span class="sc">*</span> (weight <span class="sc">-</span> xbar) <span class="co">#Notice each weight is subtracted by the mean, the closer to the mean the smaller effect of b</span></span>
<span id="cb90-11"><a href="geocentric-models.html#cb90-11" aria-hidden="true" tabindex="-1"></a>    ,a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">178</span>,<span class="dv">20</span>)</span>
<span id="cb90-12"><a href="geocentric-models.html#cb90-12" aria-hidden="true" tabindex="-1"></a>    ,b <span class="sc">~</span> <span class="fu">dlnorm</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb90-13"><a href="geocentric-models.html#cb90-13" aria-hidden="true" tabindex="-1"></a>    ,sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>,<span class="dv">50</span>)</span>
<span id="cb90-14"><a href="geocentric-models.html#cb90-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb90-15"><a href="geocentric-models.html#cb90-15" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data =</span> d2</span>
<span id="cb90-16"><a href="geocentric-models.html#cb90-16" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="interpreting-the-posterior-distribution" class="section level3" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> Interpreting the posterior distribution</h3>
<p>One can interpret the posterior distribution in two ways:</p>
<ol style="list-style-type: decimal">
<li>By assessing tables of information</li>
<li>Plotting the posterior distributions</li>
</ol>
<p>It is often easiest to deduct conclusions based on the plots. The following make examples of both the tables and the plots.</p>
<div id="tables-fo-marginal-distributions" class="section level4" number="4.4.3.1">
<h4><span class="header-section-number">4.4.3.1</span> Tables fo marginal distributions</h4>
<p>Marginal posterior distribution of the parameters:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="geocentric-models.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m4<span class="fl">.3</span></span>
<span id="cb91-2"><a href="geocentric-models.html#cb91-2" aria-hidden="true" tabindex="-1"></a>       ,<span class="at">prob =</span> <span class="fl">0.89</span> <span class="co">#PI for 89% percent, also default</span></span>
<span id="cb91-3"><a href="geocentric-models.html#cb91-3" aria-hidden="true" tabindex="-1"></a>       )</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">154.6013671</td>
</tr>
<tr class="even">
<td align="right">0.9032807</td>
</tr>
<tr class="odd">
<td align="right">5.0718809</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.2703077</td>
</tr>
<tr class="even">
<td align="right">0.0419236</td>
</tr>
<tr class="odd">
<td align="right">0.1911548</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">154.1693633</td>
</tr>
<tr class="even">
<td align="right">0.8362787</td>
</tr>
<tr class="odd">
<td align="right">4.7663786</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">155.0333710</td>
</tr>
<tr class="even">
<td align="right">0.9702828</td>
</tr>
<tr class="odd">
<td align="right">5.3773831</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>For example we see that the mean height increase by a factor of 0.9 if one person is 1 kg heavier, hence the heavier, the taller.</p>
<p>The 5.5% and 94.5% indicate that 89% percent of the time one gets between 84cm and 97 cm taller if one is 1kg heavier.</p>
<p>One can also assess the covariances:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="geocentric-models.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">vcov</span>(m4<span class="fl">.3</span>),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##           a     b sigma
## a     0.073 0.000 0.000
## b     0.000 0.002 0.000
## sigma 0.000 0.000 0.037</code></pre>
<p>And we see that there is very little covariance among the parameters.</p>
<p>This is a visual representation of the same.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="geocentric-models.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(m4<span class="fl">.3</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-47-1.png" width="720" style="display: block; margin: auto;" /></p>
</div>
<div id="plotting-posterir-inference-against-the-data" class="section level4" number="4.4.3.2">
<h4><span class="header-section-number">4.4.3.2</span> Plotting posterir inference against the data</h4>
<p>First the raw data is plotted:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="geocentric-models.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb95-2"><a href="geocentric-models.html#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(height <span class="sc">~</span> weight,<span class="at">data =</span> d2,<span class="at">col =</span> rangi2)</span>
<span id="cb95-3"><a href="geocentric-models.html#cb95-3" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m4<span class="fl">.3</span>)</span>
<span id="cb95-4"><a href="geocentric-models.html#cb95-4" aria-hidden="true" tabindex="-1"></a>a_map <span class="ot">&lt;-</span> <span class="fu">mean</span>(post<span class="sc">$</span>a)</span>
<span id="cb95-5"><a href="geocentric-models.html#cb95-5" aria-hidden="true" tabindex="-1"></a>b_map <span class="ot">&lt;-</span> <span class="fu">mean</span>(post<span class="sc">$</span>b)</span>
<span id="cb95-6"><a href="geocentric-models.html#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="at">expr =</span> a_map <span class="sc">+</span> b_map <span class="sc">*</span> (x <span class="sc">-</span> xbar),<span class="at">add =</span> <span class="cn">TRUE</span>) <span class="co">#Ability to plot a function</span></span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/4.46-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that the function we defined based on the posterior seem reasonable, although there are many plausible lines.</p>
<p>Hence we are going to look into dealing with uncertainty.</p>
</div>
<div id="adding-uncertainty-around-the-mean" class="section level4" number="4.4.3.3">
<h4><span class="header-section-number">4.4.3.3</span> Adding uncertainty around the mean</h4>
<p>We are going to make many of the lines to interprete where they end up, hence also reflecting uncertainty.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="geocentric-models.html#cb96-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m4<span class="fl">.3</span>) <span class="co">#Default = 10.000</span></span>
<span id="cb96-2"><a href="geocentric-models.html#cb96-2" aria-hidden="true" tabindex="-1"></a>post[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">a</th>
<th align="right">b</th>
<th align="right">sigma</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">154.5789</td>
<td align="right">0.9376825</td>
<td align="right">5.220756</td>
</tr>
<tr class="even">
<td align="right">154.4067</td>
<td align="right">0.8937310</td>
<td align="right">4.752735</td>
</tr>
<tr class="odd">
<td align="right">154.4622</td>
<td align="right">0.9150822</td>
<td align="right">5.341227</td>
</tr>
<tr class="even">
<td align="right">154.2649</td>
<td align="right">0.9236067</td>
<td align="right">5.160423</td>
</tr>
<tr class="odd">
<td align="right">155.1258</td>
<td align="right">0.9495934</td>
<td align="right">5.108891</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="geocentric-models.html#cb97-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">150</span> <span class="co">#No. of samples</span></span>
<span id="cb97-2"><a href="geocentric-models.html#cb97-2" aria-hidden="true" tabindex="-1"></a>dN <span class="ot">&lt;-</span> d2[<span class="dv">1</span><span class="sc">:</span>N,] <span class="co">#subsetting</span></span>
<span id="cb97-3"><a href="geocentric-models.html#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Approximating the the </span></span>
<span id="cb97-4"><a href="geocentric-models.html#cb97-4" aria-hidden="true" tabindex="-1"></a>mN <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb97-5"><a href="geocentric-models.html#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb97-6"><a href="geocentric-models.html#cb97-6" aria-hidden="true" tabindex="-1"></a>    height <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma )</span>
<span id="cb97-7"><a href="geocentric-models.html#cb97-7" aria-hidden="true" tabindex="-1"></a>    ,mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b<span class="sc">*</span>( weight <span class="sc">-</span> <span class="fu">mean</span>(weight) )</span>
<span id="cb97-8"><a href="geocentric-models.html#cb97-8" aria-hidden="true" tabindex="-1"></a>    ,a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">178</span> , <span class="dv">20</span> )</span>
<span id="cb97-9"><a href="geocentric-models.html#cb97-9" aria-hidden="true" tabindex="-1"></a>    ,b <span class="sc">~</span> <span class="fu">dlnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> )</span>
<span id="cb97-10"><a href="geocentric-models.html#cb97-10" aria-hidden="true" tabindex="-1"></a>    ,sigma <span class="sc">~</span> <span class="fu">dunif</span>( <span class="dv">0</span> , <span class="dv">50</span> )</span>
<span id="cb97-11"><a href="geocentric-models.html#cb97-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb97-12"><a href="geocentric-models.html#cb97-12" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data=</span>dN</span>
<span id="cb97-13"><a href="geocentric-models.html#cb97-13" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>The following will show one example where we loop of the data data fit the line.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="geocentric-models.html#cb98-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="co">#No of loops</span></span>
<span id="cb98-2"><a href="geocentric-models.html#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="geocentric-models.html#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract n samples from the posterior distribution</span></span>
<span id="cb98-4"><a href="geocentric-models.html#cb98-4" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(mN ,<span class="at">n=</span>n)</span>
<span id="cb98-5"><a href="geocentric-models.html#cb98-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-6"><a href="geocentric-models.html#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="co"># display raw data and sample size</span></span>
<span id="cb98-7"><a href="geocentric-models.html#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> dN<span class="sc">$</span>weight</span>
<span id="cb98-8"><a href="geocentric-models.html#cb98-8" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">y =</span> dN<span class="sc">$</span>height</span>
<span id="cb98-9"><a href="geocentric-models.html#cb98-9" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">xlim=</span><span class="fu">range</span>(d2<span class="sc">$</span>weight),<span class="at">ylim=</span><span class="fu">range</span>(d2<span class="sc">$</span>height) </span>
<span id="cb98-10"><a href="geocentric-models.html#cb98-10" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">col=</span>rangi2</span>
<span id="cb98-11"><a href="geocentric-models.html#cb98-11" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">xlab=</span><span class="st">&quot;weight&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;height&quot;</span>)</span>
<span id="cb98-12"><a href="geocentric-models.html#cb98-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-13"><a href="geocentric-models.html#cb98-13" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">concat</span>(<span class="st">&quot;N = &quot;</span>,N,<span class="st">&quot;, Iterations = &quot;</span>,n))</span>
<span id="cb98-14"><a href="geocentric-models.html#cb98-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-15"><a href="geocentric-models.html#cb98-15" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the lines, with transparency</span></span>
<span id="cb98-16"><a href="geocentric-models.html#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb98-17"><a href="geocentric-models.html#cb98-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Draw a and b values from the subset of the data</span></span>
<span id="cb98-18"><a href="geocentric-models.html#cb98-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(post<span class="sc">$</span>a[i] <span class="sc">+</span> post<span class="sc">$</span>b[i]<span class="sc">*</span>(x<span class="sc">-</span><span class="fu">mean</span>(dN<span class="sc">$</span>weight)) </span>
<span id="cb98-19"><a href="geocentric-models.html#cb98-19" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">col=</span><span class="fu">col.alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.3</span>)</span>
<span id="cb98-20"><a href="geocentric-models.html#cb98-20" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">add=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/4.49-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>One will see that the more observations we include, the more certain will the model become. One will often experience that we are more confident around the mean and less in the ends of the x-range.</p>
</div>
<div id="plotting-regression-intervlas-and-contours" class="section level4" number="4.4.3.4">
<h4><span class="header-section-number">4.4.3.4</span> Plotting regression intervlas and contours</h4>
<p>Now lets start an example where the weight is fixed to 50 kg. We will see that a person with 50kg is not fixed to one height, but some will have greater certainty.</p>
<p>We see that we get 10.000 samples, thus 10.000 priors for both a and b and thus we can simulate the expected height for such a given person.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="geocentric-models.html#cb99-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m4<span class="fl">.3</span>,<span class="at">n =</span> <span class="dv">10000</span>)</span>
<span id="cb99-2"><a href="geocentric-models.html#cb99-2" aria-hidden="true" tabindex="-1"></a>mu_at_50 <span class="ot">&lt;-</span> post<span class="sc">$</span>a <span class="sc">+</span> post<span class="sc">$</span>b <span class="sc">*</span> (<span class="dv">50</span><span class="sc">-</span>xbar)</span>
<span id="cb99-3"><a href="geocentric-models.html#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(<span class="at">x =</span> mu_at_50,<span class="at">col =</span> rangi2,<span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">xlab =</span> <span class="st">&quot;mu|weight=50&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/4.52-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Now what we want to do is the same, but for <em>all weights</em>. For this one can use the <code>link</code> function.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="geocentric-models.html#cb100-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">link</span>(m4<span class="fl">.3</span>,<span class="at">n =</span> <span class="dv">1000</span>) <span class="co">#1000 is also default</span></span>
<span id="cb100-2"><a href="geocentric-models.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mu)</span></code></pre></div>
<pre><code>##  num [1:1000, 1:352] 158 157 157 157 157 ...</code></pre>
<p>We see that 352 roes in the data hence we get a matrix 352 columns (one for each individual) with 1.000 rows.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="geocentric-models.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define sequence of weights to compute predictions for these values will be on the horizontal axis</span></span>
<span id="cb102-2"><a href="geocentric-models.html#cb102-2" aria-hidden="true" tabindex="-1"></a>weight.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">25</span>, <span class="at">to=</span><span class="dv">70</span>, <span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb102-3"><a href="geocentric-models.html#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="geocentric-models.html#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use link to compute mu for each sample from posterior and for each weight in weight.seq</span></span>
<span id="cb102-5"><a href="geocentric-models.html#cb102-5" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">link</span>( m4<span class="fl">.3</span> , <span class="at">data=</span><span class="fu">data.frame</span>(<span class="at">weight=</span>weight.seq) )</span>
<span id="cb102-6"><a href="geocentric-models.html#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mu)</span></code></pre></div>
<pre><code>##  num [1:1000, 1:46] 136 136 136 137 137 ...</code></pre>
<p>Now we see that since we fed 46 values for the weight, we get 46 columns instead of one pr invidual.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="geocentric-models.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(height <span class="sc">~</span> weight,<span class="at">data =</span> d2,<span class="at">type=</span><span class="st">&quot;n&quot;</span>) <span class="co">#use type=&quot;n&quot; to hide raw data </span></span>
<span id="cb104-2"><a href="geocentric-models.html#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="geocentric-models.html#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co"># loop over samples and plot each mu value</span></span>
<span id="cb104-4"><a href="geocentric-models.html#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb104-5"><a href="geocentric-models.html#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(weight.seq, mu[i,] ,<span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">col.alpha</span>(rangi2,<span class="fl">0.1</span>))</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/4.55-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Finally we will summarize the distribution for each weight value.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="geocentric-models.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize the distribution of mu</span></span>
<span id="cb105-2"><a href="geocentric-models.html#cb105-2" aria-hidden="true" tabindex="-1"></a>mu.mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(mu, <span class="dv">2</span>, mean) <span class="co">#46 values, one for each weight</span></span>
<span id="cb105-3"><a href="geocentric-models.html#cb105-3" aria-hidden="true" tabindex="-1"></a>mu.PI <span class="ot">&lt;-</span> <span class="fu">apply</span>(mu, <span class="dv">2</span>, PI, <span class="at">prob=</span><span class="fl">0.89</span>) <span class="co">#The 89% PI for each mean</span></span></code></pre></div>
<p><code>mu.mean</code> = the average height (mu) for each weight value. And the PI is just accompanied with this as well.</p>
<p>Now we plot the means and the PI ontop of the data.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="geocentric-models.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Raw data plot</span></span>
<span id="cb106-2"><a href="geocentric-models.html#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(height <span class="sc">~</span> weight, <span class="at">data =</span> d2, <span class="at">col =</span> <span class="fu">col.alpha</span>(rangi2,<span class="fl">0.5</span>))</span>
<span id="cb106-3"><a href="geocentric-models.html#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="geocentric-models.html#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Ploatting MAP line (mean mu for each weight)</span></span>
<span id="cb106-5"><a href="geocentric-models.html#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> weight.seq,<span class="at">y =</span> mu.mean)</span>
<span id="cb106-6"><a href="geocentric-models.html#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="geocentric-models.html#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting PI intervals for each weight</span></span>
<span id="cb106-8"><a href="geocentric-models.html#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="fu">shade</span>(mu.PI,weight.seq)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-50-1.png" width="720" style="display: block; margin: auto;" /></p>
<p><strong><em>NOTICE THAT THIS IS PREDICTION OF AVERAGE HEIGHTS, IN THE FOLLOWING WE MAKE INTERVALS FOR ACTUAL HEIGHTS</em></strong></p>
</div>
<div id="prediction-intevals" class="section level4" number="4.4.3.5">
<h4><span class="header-section-number">4.4.3.5</span> Prediction intevals</h4>
<p>Now we are going to predict actual heights. The following is an example of actual predictions and generating a band of percentile interval.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="geocentric-models.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Simulate height (Simulates posterior observations for map and map2stan model fits.)</span></span>
<span id="cb107-2"><a href="geocentric-models.html#cb107-2" aria-hidden="true" tabindex="-1"></a>sim.height <span class="ot">&lt;-</span> <span class="fu">sim</span>(m4<span class="fl">.3</span>, <span class="at">data=</span><span class="fu">list</span>(<span class="at">weight=</span>weight.seq)) <span class="co">#n = 1000</span></span>
<span id="cb107-3"><a href="geocentric-models.html#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(sim.height)</span></code></pre></div>
<pre><code>##  num [1:1000, 1:46] 136 131 140 139 136 ...</code></pre>
<p>This contains simulated heights and not distributions as we saw previously.</p>
<p>Now we can generate the PI that we are going to plot.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="geocentric-models.html#cb109-1" aria-hidden="true" tabindex="-1"></a>height.PI <span class="ot">&lt;-</span> <span class="fu">apply</span>(sim.height,<span class="dv">2</span>,PI,<span class="at">prob =</span> <span class="fl">0.89</span>)</span>
<span id="cb109-2"><a href="geocentric-models.html#cb109-2" aria-hidden="true" tabindex="-1"></a>height.HPDI67 <span class="ot">&lt;-</span> <span class="fu">apply</span>(sim.height,<span class="dv">2</span>,HPDI,<span class="at">prob =</span> <span class="fl">0.67</span>)</span>
<span id="cb109-3"><a href="geocentric-models.html#cb109-3" aria-hidden="true" tabindex="-1"></a>height.HPDI89 <span class="ot">&lt;-</span> <span class="fu">apply</span>(sim.height,<span class="dv">2</span>,HPDI,<span class="at">prob =</span> <span class="fl">0.89</span>)</span>
<span id="cb109-4"><a href="geocentric-models.html#cb109-4" aria-hidden="true" tabindex="-1"></a>height.HPDI97 <span class="ot">&lt;-</span> <span class="fu">apply</span>(sim.height,<span class="dv">2</span>,HPDI,<span class="at">prob =</span> <span class="fl">0.97</span>)</span></code></pre></div>
<p>Lastly we need to plot the predictions and the percentile interval.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="geocentric-models.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting the data points</span></span>
<span id="cb110-2"><a href="geocentric-models.html#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(height <span class="sc">~</span> weight,<span class="at">data =</span> d2,<span class="at">col =</span> <span class="fu">col.alpha</span>(rangi2,<span class="fl">0.5</span>))</span>
<span id="cb110-3"><a href="geocentric-models.html#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="geocentric-models.html#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Draw MAP line</span></span>
<span id="cb110-5"><a href="geocentric-models.html#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(weight.seq,<span class="at">y =</span> mu.mean)</span>
<span id="cb110-6"><a href="geocentric-models.html#cb110-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-7"><a href="geocentric-models.html#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Draw HPDI region for simulated heights, notice I added two additional regions</span></span>
<span id="cb110-8"><a href="geocentric-models.html#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="fu">shade</span>(height.HPDI67,weight.seq)</span>
<span id="cb110-9"><a href="geocentric-models.html#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="fu">shade</span>(height.HPDI89,weight.seq)</span>
<span id="cb110-10"><a href="geocentric-models.html#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="fu">shade</span>(height.HPDI97,weight.seq)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/4.61-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Now we see that the region is far wider.</p>
</div>
</div>
</div>
<div id="curves-form-lines" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Curves form lines</h2>
<p>This is technically the same, but we add complexity in the form of more predictors. We approach this with polynomial regression and splines.</p>
<div id="polynomial-regression" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Polynomial regression</h3>
<p>This is basically using the same variable, but transforming it into second or third order polynomials.</p>
<p>When doing polynomials you are at risk of generating very large numbers, hence one should standardize the variable to avoid this. This also means that interpreting the effects from each parameter is more difficult.</p>
<p>Now we can specify the model with the following:</p>
<p><img src="Images/paste-E98BCBE5.png" /></p>
<p><em>Notice that this is for a cubic polynomial regression. One can just disregard $/beta_3$ in a quadratic polynomial.</em></p>
<p>The following will plot the example of:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="geocentric-models.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Standardize weights</span></span>
<span id="cb111-2"><a href="geocentric-models.html#cb111-2" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>weight_s <span class="ot">&lt;-</span> ( d<span class="sc">$</span>weight <span class="sc">-</span> <span class="fu">mean</span>(d<span class="sc">$</span>weight) )<span class="sc">/</span><span class="fu">sd</span>(d<span class="sc">$</span>weight)</span>
<span id="cb111-3"><a href="geocentric-models.html#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="geocentric-models.html#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Add vector of squared values, for the polynomial variable</span></span>
<span id="cb111-5"><a href="geocentric-models.html#cb111-5" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>weight_s2 <span class="ot">&lt;-</span> d<span class="sc">$</span>weight_s<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb111-6"><a href="geocentric-models.html#cb111-6" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>weight_s3 <span class="ot">&lt;-</span> d<span class="sc">$</span>weight_s<span class="sc">^</span><span class="dv">3</span> <span class="co">#For the cubic model</span></span>
<span id="cb111-7"><a href="geocentric-models.html#cb111-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-8"><a href="geocentric-models.html#cb111-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Specfify models</span></span>
<span id="cb111-9"><a href="geocentric-models.html#cb111-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-10"><a href="geocentric-models.html#cb111-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Linear model</span></span>
<span id="cb111-11"><a href="geocentric-models.html#cb111-11" aria-hidden="true" tabindex="-1"></a>  m4<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb111-12"><a href="geocentric-models.html#cb111-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">alist</span>(</span>
<span id="cb111-13"><a href="geocentric-models.html#cb111-13" aria-hidden="true" tabindex="-1"></a>        height <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) ,</span>
<span id="cb111-14"><a href="geocentric-models.html#cb111-14" aria-hidden="true" tabindex="-1"></a>        mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b1<span class="sc">*</span>weight_s ,</span>
<span id="cb111-15"><a href="geocentric-models.html#cb111-15" aria-hidden="true" tabindex="-1"></a>        a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">178</span> , <span class="dv">20</span> ) ,</span>
<span id="cb111-16"><a href="geocentric-models.html#cb111-16" aria-hidden="true" tabindex="-1"></a>        b1 <span class="sc">~</span> <span class="fu">dlnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) ,</span>
<span id="cb111-17"><a href="geocentric-models.html#cb111-17" aria-hidden="true" tabindex="-1"></a>        sigma <span class="sc">~</span> <span class="fu">dunif</span>( <span class="dv">0</span> , <span class="dv">50</span> )</span>
<span id="cb111-18"><a href="geocentric-models.html#cb111-18" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb111-19"><a href="geocentric-models.html#cb111-19" aria-hidden="true" tabindex="-1"></a>      ,<span class="at">data =</span> d</span>
<span id="cb111-20"><a href="geocentric-models.html#cb111-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb111-21"><a href="geocentric-models.html#cb111-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-22"><a href="geocentric-models.html#cb111-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Quadratic model (4.65)</span></span>
<span id="cb111-23"><a href="geocentric-models.html#cb111-23" aria-hidden="true" tabindex="-1"></a>  m4<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb111-24"><a href="geocentric-models.html#cb111-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb111-25"><a href="geocentric-models.html#cb111-25" aria-hidden="true" tabindex="-1"></a>      height <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) ,</span>
<span id="cb111-26"><a href="geocentric-models.html#cb111-26" aria-hidden="true" tabindex="-1"></a>      mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b1<span class="sc">*</span>weight_s <span class="sc">+</span> b2<span class="sc">*</span>weight_s2 ,</span>
<span id="cb111-27"><a href="geocentric-models.html#cb111-27" aria-hidden="true" tabindex="-1"></a>      a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">178</span> , <span class="dv">20</span> ) ,</span>
<span id="cb111-28"><a href="geocentric-models.html#cb111-28" aria-hidden="true" tabindex="-1"></a>      b1 <span class="sc">~</span> <span class="fu">dlnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) ,</span>
<span id="cb111-29"><a href="geocentric-models.html#cb111-29" aria-hidden="true" tabindex="-1"></a>      b2 <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) ,</span>
<span id="cb111-30"><a href="geocentric-models.html#cb111-30" aria-hidden="true" tabindex="-1"></a>      sigma <span class="sc">~</span> <span class="fu">dunif</span>( <span class="dv">0</span> , <span class="dv">50</span> )</span>
<span id="cb111-31"><a href="geocentric-models.html#cb111-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb111-32"><a href="geocentric-models.html#cb111-32" aria-hidden="true" tabindex="-1"></a>    ,<span class="at">data =</span> d</span>
<span id="cb111-33"><a href="geocentric-models.html#cb111-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb111-34"><a href="geocentric-models.html#cb111-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-35"><a href="geocentric-models.html#cb111-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Cubic model (4.69)</span></span>
<span id="cb111-36"><a href="geocentric-models.html#cb111-36" aria-hidden="true" tabindex="-1"></a>  d<span class="sc">$</span>weight_s3 <span class="ot">&lt;-</span> d<span class="sc">$</span>weight_s<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb111-37"><a href="geocentric-models.html#cb111-37" aria-hidden="true" tabindex="-1"></a>  m4<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb111-38"><a href="geocentric-models.html#cb111-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb111-39"><a href="geocentric-models.html#cb111-39" aria-hidden="true" tabindex="-1"></a>      height <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) ,</span>
<span id="cb111-40"><a href="geocentric-models.html#cb111-40" aria-hidden="true" tabindex="-1"></a>      mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b1<span class="sc">*</span>weight_s <span class="sc">+</span> b2<span class="sc">*</span>weight_s2 <span class="sc">+</span> b3<span class="sc">*</span>weight_s3 ,</span>
<span id="cb111-41"><a href="geocentric-models.html#cb111-41" aria-hidden="true" tabindex="-1"></a>      a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">178</span> , <span class="dv">20</span> ) ,</span>
<span id="cb111-42"><a href="geocentric-models.html#cb111-42" aria-hidden="true" tabindex="-1"></a>      b1 <span class="sc">~</span> <span class="fu">dlnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) ,</span>
<span id="cb111-43"><a href="geocentric-models.html#cb111-43" aria-hidden="true" tabindex="-1"></a>      b2 <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="dv">10</span> ) ,</span>
<span id="cb111-44"><a href="geocentric-models.html#cb111-44" aria-hidden="true" tabindex="-1"></a>      b3 <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="dv">10</span> ) ,</span>
<span id="cb111-45"><a href="geocentric-models.html#cb111-45" aria-hidden="true" tabindex="-1"></a>      sigma <span class="sc">~</span> <span class="fu">dunif</span>( <span class="dv">0</span> , <span class="dv">50</span> )</span>
<span id="cb111-46"><a href="geocentric-models.html#cb111-46" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb111-47"><a href="geocentric-models.html#cb111-47" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data=</span>d</span>
<span id="cb111-48"><a href="geocentric-models.html#cb111-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb111-49"><a href="geocentric-models.html#cb111-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-50"><a href="geocentric-models.html#cb111-50" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting</span></span>
<span id="cb111-51"><a href="geocentric-models.html#cb111-51" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb111-52"><a href="geocentric-models.html#cb111-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-53"><a href="geocentric-models.html#cb111-53" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Linear</span></span>
<span id="cb111-54"><a href="geocentric-models.html#cb111-54" aria-hidden="true" tabindex="-1"></a>  weight.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from=</span><span class="sc">-</span><span class="fl">2.2</span> , <span class="at">to=</span><span class="dv">2</span> , <span class="at">length.out=</span><span class="dv">30</span> )</span>
<span id="cb111-55"><a href="geocentric-models.html#cb111-55" aria-hidden="true" tabindex="-1"></a>  pred_dat <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">weight_s=</span>weight.seq ) <span class="co">#adds degree of poly</span></span>
<span id="cb111-56"><a href="geocentric-models.html#cb111-56" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="fu">link</span>( m4<span class="fl">.4</span> , <span class="at">data=</span>pred_dat ) <span class="co">#need to change model</span></span>
<span id="cb111-57"><a href="geocentric-models.html#cb111-57" aria-hidden="true" tabindex="-1"></a>  mu.mean <span class="ot">&lt;-</span> <span class="fu">apply</span>( mu , <span class="dv">2</span> , mean )</span>
<span id="cb111-58"><a href="geocentric-models.html#cb111-58" aria-hidden="true" tabindex="-1"></a>  mu.PI <span class="ot">&lt;-</span> <span class="fu">apply</span>( mu , <span class="dv">2</span> , PI , <span class="at">prob=</span><span class="fl">0.89</span> )</span>
<span id="cb111-59"><a href="geocentric-models.html#cb111-59" aria-hidden="true" tabindex="-1"></a>  sim.height <span class="ot">&lt;-</span> <span class="fu">sim</span>( m4<span class="fl">.4</span> , <span class="at">data=</span>pred_dat ) <span class="co">#need to change model</span></span>
<span id="cb111-60"><a href="geocentric-models.html#cb111-60" aria-hidden="true" tabindex="-1"></a>  height.PI <span class="ot">&lt;-</span> <span class="fu">apply</span>( sim.height , <span class="dv">2</span> , PI , <span class="at">prob=</span><span class="fl">0.89</span> )</span>
<span id="cb111-61"><a href="geocentric-models.html#cb111-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-62"><a href="geocentric-models.html#cb111-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>( height <span class="sc">~</span> weight_s , d , <span class="at">col=</span><span class="fu">col.alpha</span>(rangi2,<span class="fl">0.5</span>),<span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb111-63"><a href="geocentric-models.html#cb111-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>( weight.seq , mu.mean )</span>
<span id="cb111-64"><a href="geocentric-models.html#cb111-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade</span>( mu.PI , weight.seq )</span>
<span id="cb111-65"><a href="geocentric-models.html#cb111-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade</span>( height.PI , weight.seq )</span>
<span id="cb111-66"><a href="geocentric-models.html#cb111-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-67"><a href="geocentric-models.html#cb111-67" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Quadratic</span></span>
<span id="cb111-68"><a href="geocentric-models.html#cb111-68" aria-hidden="true" tabindex="-1"></a>  weight.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from=</span><span class="sc">-</span><span class="fl">2.2</span> , <span class="at">to=</span><span class="dv">2</span> , <span class="at">length.out=</span><span class="dv">30</span> )</span>
<span id="cb111-69"><a href="geocentric-models.html#cb111-69" aria-hidden="true" tabindex="-1"></a>  pred_dat <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">weight_s=</span>weight.seq , <span class="at">weight_s2=</span>weight.seq<span class="sc">^</span><span class="dv">2</span> ) <span class="co">#adds degree of poly</span></span>
<span id="cb111-70"><a href="geocentric-models.html#cb111-70" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="fu">link</span>( m4<span class="fl">.5</span> , <span class="at">data=</span>pred_dat ) <span class="co">#need to change model</span></span>
<span id="cb111-71"><a href="geocentric-models.html#cb111-71" aria-hidden="true" tabindex="-1"></a>  mu.mean <span class="ot">&lt;-</span> <span class="fu">apply</span>( mu , <span class="dv">2</span> , mean )</span>
<span id="cb111-72"><a href="geocentric-models.html#cb111-72" aria-hidden="true" tabindex="-1"></a>  mu.PI <span class="ot">&lt;-</span> <span class="fu">apply</span>( mu , <span class="dv">2</span> , PI , <span class="at">prob=</span><span class="fl">0.89</span> )</span>
<span id="cb111-73"><a href="geocentric-models.html#cb111-73" aria-hidden="true" tabindex="-1"></a>  sim.height <span class="ot">&lt;-</span> <span class="fu">sim</span>( m4<span class="fl">.5</span> , <span class="at">data=</span>pred_dat ) <span class="co">#need to change model</span></span>
<span id="cb111-74"><a href="geocentric-models.html#cb111-74" aria-hidden="true" tabindex="-1"></a>  height.PI <span class="ot">&lt;-</span> <span class="fu">apply</span>( sim.height , <span class="dv">2</span> , PI , <span class="at">prob=</span><span class="fl">0.89</span> )</span>
<span id="cb111-75"><a href="geocentric-models.html#cb111-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-76"><a href="geocentric-models.html#cb111-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>( height <span class="sc">~</span> weight_s , d , <span class="at">col=</span><span class="fu">col.alpha</span>(rangi2,<span class="fl">0.5</span>),<span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb111-77"><a href="geocentric-models.html#cb111-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>( weight.seq , mu.mean )</span>
<span id="cb111-78"><a href="geocentric-models.html#cb111-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade</span>( mu.PI , weight.seq )</span>
<span id="cb111-79"><a href="geocentric-models.html#cb111-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade</span>( height.PI , weight.seq )</span>
<span id="cb111-80"><a href="geocentric-models.html#cb111-80" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-81"><a href="geocentric-models.html#cb111-81" aria-hidden="true" tabindex="-1"></a>  <span class="co">#cubic</span></span>
<span id="cb111-82"><a href="geocentric-models.html#cb111-82" aria-hidden="true" tabindex="-1"></a>  weight.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from=</span><span class="sc">-</span><span class="fl">2.2</span> , <span class="at">to=</span><span class="dv">2</span> , <span class="at">length.out=</span><span class="dv">30</span> )</span>
<span id="cb111-83"><a href="geocentric-models.html#cb111-83" aria-hidden="true" tabindex="-1"></a>  pred_dat <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">weight_s=</span>weight.seq , <span class="at">weight_s2=</span>weight.seq<span class="sc">^</span><span class="dv">2</span>, <span class="at">weight_s3=</span>weight.seq<span class="sc">^</span><span class="dv">3</span> ) <span class="co">#adds degree of poly</span></span>
<span id="cb111-84"><a href="geocentric-models.html#cb111-84" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="fu">link</span>( m4<span class="fl">.6</span> , <span class="at">data=</span>pred_dat ) <span class="co">#need to change model</span></span>
<span id="cb111-85"><a href="geocentric-models.html#cb111-85" aria-hidden="true" tabindex="-1"></a>  mu.mean <span class="ot">&lt;-</span> <span class="fu">apply</span>( mu , <span class="dv">2</span> , mean )</span>
<span id="cb111-86"><a href="geocentric-models.html#cb111-86" aria-hidden="true" tabindex="-1"></a>  mu.PI <span class="ot">&lt;-</span> <span class="fu">apply</span>( mu , <span class="dv">2</span> , PI , <span class="at">prob=</span><span class="fl">0.89</span> )</span>
<span id="cb111-87"><a href="geocentric-models.html#cb111-87" aria-hidden="true" tabindex="-1"></a>  sim.height <span class="ot">&lt;-</span> <span class="fu">sim</span>( m4<span class="fl">.6</span> , <span class="at">data=</span>pred_dat ) <span class="co">#need to change model</span></span>
<span id="cb111-88"><a href="geocentric-models.html#cb111-88" aria-hidden="true" tabindex="-1"></a>  height.PI <span class="ot">&lt;-</span> <span class="fu">apply</span>( sim.height , <span class="dv">2</span> , PI , <span class="at">prob=</span><span class="fl">0.89</span> )</span>
<span id="cb111-89"><a href="geocentric-models.html#cb111-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-90"><a href="geocentric-models.html#cb111-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>( height <span class="sc">~</span> weight_s , d , <span class="at">col=</span><span class="fu">col.alpha</span>(rangi2,<span class="fl">0.5</span>),<span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb111-91"><a href="geocentric-models.html#cb111-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>( weight.seq , mu.mean )</span>
<span id="cb111-92"><a href="geocentric-models.html#cb111-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade</span>( mu.PI , weight.seq )</span>
<span id="cb111-93"><a href="geocentric-models.html#cb111-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade</span>( height.PI , weight.seq )</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-51"></span>
<img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-51-1.png" alt="Comparison between a linear, quadratic and cubic model. Notice that the same variable is used, just with different degree of polynomials." width="720" />
<p class="caption">
Figure 4.1: Comparison between a linear, quadratic and cubic model. Notice that the same variable is used, just with different degree of polynomials.
</p>
</div>
<p><strong>Table output for the polynomial</strong></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="geocentric-models.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m4<span class="fl">.5</span>)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">146.057160</td>
</tr>
<tr class="even">
<td align="right">21.733407</td>
</tr>
<tr class="odd">
<td align="right">-7.803209</td>
</tr>
<tr class="even">
<td align="right">5.774538</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3689809</td>
</tr>
<tr class="even">
<td align="right">0.2888934</td>
</tr>
<tr class="odd">
<td align="right">0.2741871</td>
</tr>
<tr class="even">
<td align="right">0.1764700</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">145.467457</td>
</tr>
<tr class="even">
<td align="right">21.271700</td>
</tr>
<tr class="odd">
<td align="right">-8.241412</td>
</tr>
<tr class="even">
<td align="right">5.492504</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">146.646862</td>
</tr>
<tr class="even">
<td align="right">22.195114</td>
</tr>
<tr class="odd">
<td align="right">-7.365005</td>
</tr>
<tr class="even">
<td align="right">6.056571</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>Now we see that b2 for instance is more complicated, as it is squared values that the parameter is multiplied with. Notice that a is still the intercept with y.</p>
</div>
<div id="splines" class="section level3" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Splines</h3>
<p>This is an alternative way of adding curvature. We are going to use basis splines, i.e., B-splines.</p>
<p>The code is not exemplified yet. Do this. For now, see <a href="#4m"><strong>??</strong></a></p>
<p>It is basically just splines as we have seen earlier in ML.</p>
</div>
</div>
<div id="exercises-2" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Exercises</h2>
<div id="m1-2" class="section level3" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> 4M1</h3>
<p><em>For the model definition below, simulate observed y values from the prior (not the posterior).</em></p>
<p><img src="Images/paste-25130FE4.png" /></p>
</div>
<div id="m8" class="section level3" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> 4M8</h3>
<p><em>In the chapter, we used 15 knots with the cherry blossom spline. Increase the number of knots and observe what happens to the resulting spline. Then adjust also the width of the prior on the weights—change the standard deviation of the prior and watch what happens. What do you think the combination of knot number and the prior on the weights controls?</em></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-3-sampling-the-imaginary.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
