<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11 Chapter 11 - God Spiked the Integers | Bayesian Data Analysis Notes</title>
  <meta name="description" content="11 Chapter 11 - God Spiked the Integers | Bayesian Data Analysis Notes" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="11 Chapter 11 - God Spiked the Integers | Bayesian Data Analysis Notes" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 Chapter 11 - God Spiked the Integers | Bayesian Data Analysis Notes" />
  
  
  

<meta name="author" content="Jonas Ringive Korsholm" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-10-big-entropy-and-the-generalized-linear-model.html"/>
<link rel="next" href="ch-13-models-with-memory.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="chapter-1-golems-of-prague.html"><a href="chapter-1-golems-of-prague.html"><i class="fa fa-check"></i><b>1</b> Chapter 1 - Golems of Prague</a></li>
<li class="chapter" data-level="2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html"><i class="fa fa-check"></i><b>2</b> Chapter 2 - Small worlds and Large Worlds</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#models-and-estimation"><i class="fa fa-check"></i><b>2.1</b> Models and Estimation</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#making-a-model-go"><i class="fa fa-check"></i><b>2.1.1</b> Making a model go!</a></li>
<li class="chapter" data-level="2.1.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#engines-motors-to-estimate-the-models"><i class="fa fa-check"></i><b>2.1.2</b> Engines / Motors to estimate the models</a>
<ul>
<li class="chapter" data-level="2.1.2.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#grid-approximation"><i class="fa fa-check"></i><b>2.1.2.1</b> Grid approximation</a></li>
<li class="chapter" data-level="2.1.2.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#quadratic-approximation"><i class="fa fa-check"></i><b>2.1.2.2</b> Quadratic approximation</a></li>
<li class="chapter" data-level="2.1.2.3" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#markov-chain-monte-carlo"><i class="fa fa-check"></i><b>2.1.2.3</b> Markov Chain Monte Carlo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#exercises"><i class="fa fa-check"></i><b>2.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#m1"><i class="fa fa-check"></i><b>2.2.1</b> 2M1</a></li>
<li class="chapter" data-level="2.2.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#m2"><i class="fa fa-check"></i><b>2.2.2</b> 2M2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html"><i class="fa fa-check"></i><b>3</b> Chapter 3 - Sampling the Imaginary</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-from-a-grid-approximate-posterior"><i class="fa fa-check"></i><b>3.1</b> Sampling from a grid-approximate posterior</a></li>
<li class="chapter" data-level="3.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-to-summarize"><i class="fa fa-check"></i><b>3.2</b> Sampling to summarize</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#defined-boundaries"><i class="fa fa-check"></i><b>3.2.1</b> Defined Boundaries</a></li>
<li class="chapter" data-level="3.2.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#defined-probability-mass"><i class="fa fa-check"></i><b>3.2.2</b> Defined Probability Mass</a></li>
<li class="chapter" data-level="3.2.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#point-estimates"><i class="fa fa-check"></i><b>3.2.3</b> Point Estimates</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-to-simulate-prediction"><i class="fa fa-check"></i><b>3.3</b> Sampling to simulate prediction</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#dummy-data"><i class="fa fa-check"></i><b>3.3.1</b> Dummy Data</a></li>
<li class="chapter" data-level="3.3.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#model-checking"><i class="fa fa-check"></i><b>3.3.2</b> Model Checking</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#exercises-1"><i class="fa fa-check"></i><b>3.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m1-1"><i class="fa fa-check"></i><b>3.4.1</b> 3M1</a></li>
<li class="chapter" data-level="3.4.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m2-1"><i class="fa fa-check"></i><b>3.4.2</b> 3M2</a></li>
<li class="chapter" data-level="3.4.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m3"><i class="fa fa-check"></i><b>3.4.3</b> 3M3</a></li>
<li class="chapter" data-level="3.4.4" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m4"><i class="fa fa-check"></i><b>3.4.4</b> 3M4</a></li>
<li class="chapter" data-level="3.4.5" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m5"><i class="fa fa-check"></i><b>3.4.5</b> 3M5</a></li>
<li class="chapter" data-level="3.4.6" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h1"><i class="fa fa-check"></i><b>3.4.6</b> 3H1</a></li>
<li class="chapter" data-level="3.4.7" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h2"><i class="fa fa-check"></i><b>3.4.7</b> 3H2</a></li>
<li class="chapter" data-level="3.4.8" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h3"><i class="fa fa-check"></i><b>3.4.8</b> 3H3</a></li>
<li class="chapter" data-level="3.4.9" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h4"><i class="fa fa-check"></i><b>3.4.9</b> 3H4</a></li>
<li class="chapter" data-level="3.4.10" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h5"><i class="fa fa-check"></i><b>3.4.10</b> 3H5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html"><i class="fa fa-check"></i><b>4</b> Chapter 4 - Geocentric Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#why-normal-distributions-are-normal"><i class="fa fa-check"></i><b>4.1</b> Why Normal distributions are normal</a></li>
<li class="chapter" data-level="4.2" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#a-language-for-describing-models"><i class="fa fa-check"></i><b>4.2</b> A language for describing models</a></li>
<li class="chapter" data-level="4.3" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#gaussian-model-of-height"><i class="fa fa-check"></i><b>4.3</b> Gaussian model of height</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#the-model"><i class="fa fa-check"></i><b>4.3.1</b> The model</a></li>
<li class="chapter" data-level="4.3.2" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#grid-approximation-of-the-posterior-distribution"><i class="fa fa-check"></i><b>4.3.2</b> Grid approximation of the posterior distribution</a></li>
<li class="chapter" data-level="4.3.3" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#sampling-from-the-posterior"><i class="fa fa-check"></i><b>4.3.3</b> Sampling from the posterior</a></li>
<li class="chapter" data-level="4.3.4" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#finding-the-posterior-distribution-with-quap"><i class="fa fa-check"></i><b>4.3.4</b> Finding the posterior distribution with quap</a></li>
<li class="chapter" data-level="4.3.5" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#sampling-from-a-quap"><i class="fa fa-check"></i><b>4.3.5</b> Sampling from a quap</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#linear-prediction"><i class="fa fa-check"></i><b>4.4</b> Linear prediction</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#the-linear-model-strategy"><i class="fa fa-check"></i><b>4.4.1</b> The linear model strategy</a></li>
<li class="chapter" data-level="4.4.2" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#finding-the-posterior-distribution"><i class="fa fa-check"></i><b>4.4.2</b> Finding the posterior distribution</a></li>
<li class="chapter" data-level="4.4.3" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#interpreting-the-posterior-distribution"><i class="fa fa-check"></i><b>4.4.3</b> Interpreting the posterior distribution</a>
<ul>
<li class="chapter" data-level="4.4.3.1" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#tables-of-marginal-distributions"><i class="fa fa-check"></i><b>4.4.3.1</b> Tables of marginal distributions</a></li>
<li class="chapter" data-level="4.4.3.2" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#plotting-posterior-inference-against-the-data"><i class="fa fa-check"></i><b>4.4.3.2</b> Plotting posterior inference against the data</a></li>
<li class="chapter" data-level="4.4.3.3" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#adding-uncertainty-around-the-mean"><i class="fa fa-check"></i><b>4.4.3.3</b> Adding uncertainty around the mean</a></li>
<li class="chapter" data-level="4.4.3.4" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#plotting-regression-intervlas-and-contours"><i class="fa fa-check"></i><b>4.4.3.4</b> Plotting regression intervlas and contours</a></li>
<li class="chapter" data-level="4.4.3.5" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#prediction-intevals"><i class="fa fa-check"></i><b>4.4.3.5</b> Prediction intevals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#curves-form-lines"><i class="fa fa-check"></i><b>4.5</b> Curves form lines</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#polynomial-regression"><i class="fa fa-check"></i><b>4.5.1</b> Polynomial regression</a></li>
<li class="chapter" data-level="4.5.2" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#splines"><i class="fa fa-check"></i><b>4.5.2</b> Splines</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#exercises-2"><i class="fa fa-check"></i><b>4.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#m1-2"><i class="fa fa-check"></i><b>4.6.1</b> 4M1</a></li>
<li class="chapter" data-level="4.6.2" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#m8"><i class="fa fa-check"></i><b>4.6.2</b> 4M8</a></li>
<li class="chapter" data-level="4.6.3" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#h1-1"><i class="fa fa-check"></i><b>4.6.3</b> 4H1</a></li>
<li class="chapter" data-level="4.6.4" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#h2-1"><i class="fa fa-check"></i><b>4.6.4</b> 4H2</a></li>
<li class="chapter" data-level="4.6.5" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#h3-1"><i class="fa fa-check"></i><b>4.6.5</b> 4H3</a>
<ul>
<li class="chapter" data-level="4.6.5.1" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#the-same-but-using-log-of-weight"><i class="fa fa-check"></i><b>4.6.5.1</b> The same but using log of weight</a></li>
</ul></li>
<li class="chapter" data-level="4.6.6" data-path="chapter-4-geocentric-models.html"><a href="chapter-4-geocentric-models.html#h6"><i class="fa fa-check"></i><b>4.6.6</b> 4H6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html"><i class="fa fa-check"></i><b>5</b> Chapter 5 - The Many Variables &amp; The Spurious Waffles</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#spurious-associations"><i class="fa fa-check"></i><b>5.1</b> Spurious Associations</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#testable-implications"><i class="fa fa-check"></i><b>5.1.1</b> Testable implications</a></li>
<li class="chapter" data-level="5.1.2" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#defining-a-multiple-regression"><i class="fa fa-check"></i><b>5.1.2</b> Defining a multiple regression</a></li>
<li class="chapter" data-level="5.1.3" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#approximating-the-posterior"><i class="fa fa-check"></i><b>5.1.3</b> Approximating the posterior</a></li>
<li class="chapter" data-level="5.1.4" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#the-flow"><i class="fa fa-check"></i><b>5.1.4</b> The flow</a>
<ul>
<li class="chapter" data-level="5.1.4.1" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#posterior-prediction-plots"><i class="fa fa-check"></i><b>5.1.4.1</b> Posterior Prediction Plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#masked-relationship"><i class="fa fa-check"></i><b>5.2</b> Masked Relationship</a></li>
<li class="chapter" data-level="5.3" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#categorical-variables"><i class="fa fa-check"></i><b>5.3</b> Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html"><i class="fa fa-check"></i><b>6</b> Chapter 6 - The Haunted DAG &amp; The Causal Terror</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#multicollinearity"><i class="fa fa-check"></i><b>6.1</b> Multicollinearity</a></li>
<li class="chapter" data-level="6.2" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#post-treatment-bias"><i class="fa fa-check"></i><b>6.2</b> Post Treatment Bias</a></li>
<li class="chapter" data-level="6.3" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#collider-bias"><i class="fa fa-check"></i><b>6.3</b> Collider Bias</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#collider-of-false-sorrow"><i class="fa fa-check"></i><b>6.3.1</b> Collider of false sorrow</a></li>
<li class="chapter" data-level="6.3.2" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#the-haunted-dag"><i class="fa fa-check"></i><b>6.3.2</b> The haunted DAG</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#confronting-confounding"><i class="fa fa-check"></i><b>6.4</b> Confronting Confounding</a></li>
<li class="chapter" data-level="6.5" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#exercises-3"><i class="fa fa-check"></i><b>6.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#m1-3"><i class="fa fa-check"></i><b>6.5.1</b> 6M1</a></li>
<li class="chapter" data-level="6.5.2" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#m3-1"><i class="fa fa-check"></i><b>6.5.2</b> 6M3</a></li>
<li class="chapter" data-level="6.5.3" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h"><i class="fa fa-check"></i><b>6.5.3</b> 6H</a></li>
<li class="chapter" data-level="6.5.4" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h3-2"><i class="fa fa-check"></i><b>6.5.4</b> 6H3</a></li>
<li class="chapter" data-level="6.5.5" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h4-1"><i class="fa fa-check"></i><b>6.5.5</b> 6H4</a></li>
<li class="chapter" data-level="6.5.6" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h5-1"><i class="fa fa-check"></i><b>6.5.6</b> 6H5</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#lecture-notes---not-integrated-in-the-text"><i class="fa fa-check"></i><b>6.6</b> Lecture notes - not integrated in the text</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html"><i class="fa fa-check"></i><b>7</b> Chapter 7 - Ulysses’ Compass</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#the-problem-with-parameters"><i class="fa fa-check"></i><b>7.1</b> The problem with parameters</a></li>
<li class="chapter" data-level="7.2" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#entropy-and-accuracy"><i class="fa fa-check"></i><b>7.2</b> Entropy and Accuracy</a></li>
<li class="chapter" data-level="7.3" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#golem-taming-regularization"><i class="fa fa-check"></i><b>7.3</b> Golem Taming: Regularization</a></li>
<li class="chapter" data-level="7.4" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#predicting-predictive-accuracy"><i class="fa fa-check"></i><b>7.4</b> Predicting predictive accuracy</a></li>
<li class="chapter" data-level="7.5" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#model-comparison"><i class="fa fa-check"></i><b>7.5</b> Model Comparison</a></li>
<li class="chapter" data-level="7.6" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#exercies"><i class="fa fa-check"></i><b>7.6</b> Exercies</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#m3-2"><i class="fa fa-check"></i><b>7.6.1</b> 7M3</a></li>
<li class="chapter" data-level="7.6.2" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#m4-1"><i class="fa fa-check"></i><b>7.6.2</b> 7M4</a></li>
<li class="chapter" data-level="7.6.3" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#m5-1"><i class="fa fa-check"></i><b>7.6.3</b> 7M5</a></li>
<li class="chapter" data-level="7.6.4" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#m6"><i class="fa fa-check"></i><b>7.6.4</b> 7M6</a></li>
<li class="chapter" data-level="7.6.5" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#h1-2"><i class="fa fa-check"></i><b>7.6.5</b> 7H1</a></li>
<li class="chapter" data-level="7.6.6" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#h2-2"><i class="fa fa-check"></i><b>7.6.6</b> 7H2</a>
<ul>
<li class="chapter" data-level="7.6.6.1" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#identify-the-outlier"><i class="fa fa-check"></i><b>7.6.6.1</b> (1) Identify the outlier</a></li>
<li class="chapter" data-level="7.6.6.2" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#inspect-model-predictions"><i class="fa fa-check"></i><b>7.6.6.2</b> (2) Inspect model predictions</a></li>
<li class="chapter" data-level="7.6.6.3" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#using-students-t-distribution"><i class="fa fa-check"></i><b>7.6.6.3</b> (3) Using students t distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.6.7" data-path="chapter-7-ulysses-compass.html"><a href="chapter-7-ulysses-compass.html#h5-2"><i class="fa fa-check"></i><b>7.6.7</b> 7H5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html"><i class="fa fa-check"></i><b>8</b> Chapter 8 - Conditional Manatees</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#building-an-interaction"><i class="fa fa-check"></i><b>8.1</b> Building an interaction</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#adding-an-indicator-variable-isnt-enough."><i class="fa fa-check"></i><b>8.1.1</b> Adding an indicator variable isn’t enough.</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#symmetry-of-interactions"><i class="fa fa-check"></i><b>8.2</b> Symmetry of interactions</a></li>
<li class="chapter" data-level="8.3" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#continuous-interactions"><i class="fa fa-check"></i><b>8.3</b> Continuous interactions</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#a-winter-flower"><i class="fa fa-check"></i><b>8.3.1</b> A Winter Flower</a></li>
<li class="chapter" data-level="8.3.2" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#the-models"><i class="fa fa-check"></i><b>8.3.2</b> The models</a></li>
<li class="chapter" data-level="8.3.3" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#plotting-posterior-predictions"><i class="fa fa-check"></i><b>8.3.3</b> Plotting posterior predictions</a></li>
<li class="chapter" data-level="8.3.4" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#plotting-prior-predictions"><i class="fa fa-check"></i><b>8.3.4</b> Plotting prior predictions</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#exercises-4"><i class="fa fa-check"></i><b>8.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#m4-2"><i class="fa fa-check"></i><b>8.4.1</b> 8M4</a>
<ul>
<li class="chapter" data-level="8.4.1.1" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#interaction-model"><i class="fa fa-check"></i><b>8.4.1.1</b> Interaction model</a></li>
<li class="chapter" data-level="8.4.1.2" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#conclusion"><i class="fa fa-check"></i><b>8.4.1.2</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="8.4.2" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#h3-3"><i class="fa fa-check"></i><b>8.4.2</b> 8H3</a>
<ul>
<li class="chapter" data-level="8.4.2.1" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#h3a"><i class="fa fa-check"></i><b>8.4.2.1</b> 8H3A</a></li>
<li class="chapter" data-level="8.4.2.2" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#h3b"><i class="fa fa-check"></i><b>8.4.2.2</b> 8H3B</a></li>
</ul></li>
<li class="chapter" data-level="8.4.3" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#h5-3"><i class="fa fa-check"></i><b>8.4.3</b> 8H5</a></li>
<li class="chapter" data-level="8.4.4" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#h6-1"><i class="fa fa-check"></i><b>8.4.4</b> 8H6</a></li>
<li class="chapter" data-level="8.4.5" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#h7"><i class="fa fa-check"></i><b>8.4.5</b> 8H7</a>
<ul>
<li class="chapter" data-level="8.4.5.1" data-path="chapter-8-conditional-manatees.html"><a href="chapter-8-conditional-manatees.html#predictions"><i class="fa fa-check"></i><b>8.4.5.1</b> Predictions</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>9</b> Chapter 9 - Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#good-king-markov-and-his-island-kingdom"><i class="fa fa-check"></i><b>9.1</b> Good King Markov and his island kingdom</a></li>
<li class="chapter" data-level="9.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#metropolis-algorithms"><i class="fa fa-check"></i><b>9.2</b> Metropolis algorithms</a></li>
<li class="chapter" data-level="9.3" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#hamiltonian-monte-carlo"><i class="fa fa-check"></i><b>9.3</b> Hamiltonian Monte Carlo</a></li>
<li class="chapter" data-level="9.4" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#easy-hmc-ulam"><i class="fa fa-check"></i><b>9.4</b> Easy HMC: ulam</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#fitting-using-quap"><i class="fa fa-check"></i><b>9.4.1</b> Fitting using quap</a></li>
<li class="chapter" data-level="9.4.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#fitting-using-hmc"><i class="fa fa-check"></i><b>9.4.2</b> Fitting using HMC</a>
<ul>
<li class="chapter" data-level="9.4.2.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#preparing-data"><i class="fa fa-check"></i><b>9.4.2.1</b> Preparing data</a></li>
<li class="chapter" data-level="9.4.2.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#sampling-from-the-posterior-1"><i class="fa fa-check"></i><b>9.4.2.2</b> Sampling from the posterior</a></li>
<li class="chapter" data-level="9.4.2.3" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#sampling-again-in-parallel"><i class="fa fa-check"></i><b>9.4.2.3</b> Sampling again, in parallel</a></li>
<li class="chapter" data-level="9.4.2.4" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#visualization"><i class="fa fa-check"></i><b>9.4.2.4</b> Visualization</a></li>
<li class="chapter" data-level="9.4.2.5" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#checking-the-chain"><i class="fa fa-check"></i><b>9.4.2.5</b> Checking the chain</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#care-and-feeding-of-your-markov-chain"><i class="fa fa-check"></i><b>9.5</b> Care and feeding of your Markov chain</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#how-many-samples-do-you-need"><i class="fa fa-check"></i><b>9.5.1</b> How many samples do you need?</a></li>
<li class="chapter" data-level="9.5.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#how-many-chains-do-you-need"><i class="fa fa-check"></i><b>9.5.2</b> How many chains do you need?</a></li>
<li class="chapter" data-level="9.5.3" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#taming-a-wild-chain"><i class="fa fa-check"></i><b>9.5.3</b> Taming a wild chain</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#exercises-5"><i class="fa fa-check"></i><b>9.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#e4"><i class="fa fa-check"></i><b>9.6.1</b> E4</a></li>
<li class="chapter" data-level="9.6.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#e5"><i class="fa fa-check"></i><b>9.6.2</b> E5</a></li>
<li class="chapter" data-level="9.6.3" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#e6"><i class="fa fa-check"></i><b>9.6.3</b> E6</a></li>
<li class="chapter" data-level="9.6.4" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#e7"><i class="fa fa-check"></i><b>9.6.4</b> E7</a></li>
<li class="chapter" data-level="9.6.5" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#m1-4"><i class="fa fa-check"></i><b>9.6.5</b> M1</a>
<ul>
<li class="chapter" data-level="9.6.5.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#comparing-to-posterior-distributions"><i class="fa fa-check"></i><b>9.6.5.1</b> Comparing to posterior distributions</a></li>
</ul></li>
<li class="chapter" data-level="9.6.6" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#h2-3"><i class="fa fa-check"></i><b>9.6.6</b> H2</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#lecture-notes"><i class="fa fa-check"></i><b>9.7</b> Lecture notes</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapter-10-big-entropy-and-the-generalized-linear-model.html"><a href="chapter-10-big-entropy-and-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>10</b> Chapter 10 - Big Entropy and the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chapter-10-big-entropy-and-the-generalized-linear-model.html"><a href="chapter-10-big-entropy-and-the-generalized-linear-model.html#maximum-entropy"><i class="fa fa-check"></i><b>10.1</b> Maximum Entropy</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="chapter-10-big-entropy-and-the-generalized-linear-model.html"><a href="chapter-10-big-entropy-and-the-generalized-linear-model.html#binomial"><i class="fa fa-check"></i><b>10.1.1</b> Binomial</a>
<ul>
<li class="chapter" data-level="10.1.1.1" data-path="chapter-10-big-entropy-and-the-generalized-linear-model.html"><a href="chapter-10-big-entropy-and-the-generalized-linear-model.html#example-from-the-lecture"><i class="fa fa-check"></i><b>10.1.1.1</b> Example from the lecture</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="chapter-10-big-entropy-and-the-generalized-linear-model.html"><a href="chapter-10-big-entropy-and-the-generalized-linear-model.html#generalized-linear-models"><i class="fa fa-check"></i><b>10.2</b> Generalized linear models</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="chapter-10-big-entropy-and-the-generalized-linear-model.html"><a href="chapter-10-big-entropy-and-the-generalized-linear-model.html#meet-the-family"><i class="fa fa-check"></i><b>10.2.1</b> Meet the family</a></li>
<li class="chapter" data-level="10.2.2" data-path="chapter-10-big-entropy-and-the-generalized-linear-model.html"><a href="chapter-10-big-entropy-and-the-generalized-linear-model.html#linking-linear-models-to-distributions"><i class="fa fa-check"></i><b>10.2.2</b> Linking linear models to distributions</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="chapter-10-big-entropy-and-the-generalized-linear-model.html"><a href="chapter-10-big-entropy-and-the-generalized-linear-model.html#maximum-entropy-priors"><i class="fa fa-check"></i><b>10.3</b> Maximum entropy priors</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html"><i class="fa fa-check"></i><b>11</b> Chapter 11 - God Spiked the Integers</a>
<ul>
<li class="chapter" data-level="11.1" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#binomial-regression"><i class="fa fa-check"></i><b>11.1</b> Binomial Regression</a>
<ul>
<li class="chapter" data-level="11.1.0.1" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#logistic-regression-prosocial-chimpanzees"><i class="fa fa-check"></i><b>11.1.0.1</b> Logistic regression: Prosocial chimpanzees:</a></li>
<li class="chapter" data-level="11.1.0.2" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#relative-shark-and-absolute-deer"><i class="fa fa-check"></i><b>11.1.0.2</b> Relative shark and absolute deer</a></li>
<li class="chapter" data-level="11.1.0.3" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#aggregated-binomial-chimpanzees-again-condensed."><i class="fa fa-check"></i><b>11.1.0.3</b> Aggregated binomial: Chimpanzees again, condensed.</a></li>
<li class="chapter" data-level="11.1.0.4" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#aggregated-binomial-graduate-school-admissions"><i class="fa fa-check"></i><b>11.1.0.4</b> Aggregated binomial: Graduate school admissions</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#poisson-regression"><i class="fa fa-check"></i><b>11.2</b> Poisson Regression</a>
<ul>
<li class="chapter" data-level="11.2.0.1" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#negative-binomial-gamma-poisson-models."><i class="fa fa-check"></i><b>11.2.0.1</b> Negative binomial (gamma-poisson) models.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#multinomial-regression"><i class="fa fa-check"></i><b>11.3</b> Multinomial Regression</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#example-from-the-lecture-1"><i class="fa fa-check"></i><b>11.3.1</b> Example from the lecture</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#exercies-1"><i class="fa fa-check"></i><b>11.4</b> Exercies</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#e1"><i class="fa fa-check"></i><b>11.4.1</b> E1</a></li>
<li class="chapter" data-level="11.4.2" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#e2"><i class="fa fa-check"></i><b>11.4.2</b> E2</a></li>
<li class="chapter" data-level="11.4.3" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#e3"><i class="fa fa-check"></i><b>11.4.3</b> E3</a></li>
<li class="chapter" data-level="11.4.4" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#m7"><i class="fa fa-check"></i><b>11.4.4</b> M7</a></li>
<li class="chapter" data-level="11.4.5" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#h1-3"><i class="fa fa-check"></i><b>11.4.5</b> H1</a></li>
<li class="chapter" data-level="11.4.6" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#h2-4"><i class="fa fa-check"></i><b>11.4.6</b> H2</a>
<ul>
<li class="chapter" data-level="11.4.6.1" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#a"><i class="fa fa-check"></i><b>11.4.6.1</b> A:</a></li>
<li class="chapter" data-level="11.4.6.2" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#b"><i class="fa fa-check"></i><b>11.4.6.2</b> B:</a></li>
<li class="chapter" data-level="11.4.6.3" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#c"><i class="fa fa-check"></i><b>11.4.6.3</b> C:</a></li>
</ul></li>
<li class="chapter" data-level="11.4.7" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#h3-4"><i class="fa fa-check"></i><b>11.4.7</b> H3</a>
<ul>
<li class="chapter" data-level="11.4.7.1" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#prior-predictive-simulation"><i class="fa fa-check"></i><b>11.4.7.1</b> Prior predictive simulation</a></li>
<li class="chapter" data-level="11.4.7.2" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#fitting-the-model"><i class="fa fa-check"></i><b>11.4.7.2</b> Fitting the model</a>
<ul>
<li class="chapter" data-level="11.4.7.2.1" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#using-poisson"><i class="fa fa-check"></i><b>11.4.7.2.1</b> Using poisson</a></li>
<li class="chapter" data-level="11.4.7.2.2" data-path="chapter-11-god-spiked-the-integers.html"><a href="chapter-11-god-spiked-the-integers.html#using-gamma-poisson"><i class="fa fa-check"></i><b>11.4.7.2.2</b> Using gamma poisson</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html"><i class="fa fa-check"></i><b>12</b> Ch 13 - Models with Memory</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#example-multilevel-tadpoles"><i class="fa fa-check"></i><b>12.1</b> Example: Multilevel tadpoles</a></li>
<li class="chapter" data-level="12.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#varying-effects-and-the-underfitting-overfitting-trade-off"><i class="fa fa-check"></i><b>12.2</b> Varying effects and the underfitting / overfitting trade-off</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#the-model-1"><i class="fa fa-check"></i><b>12.2.1</b> The model</a></li>
<li class="chapter" data-level="12.2.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#assign-values-to-the-parameters"><i class="fa fa-check"></i><b>12.2.2</b> Assign values to the parameters</a></li>
<li class="chapter" data-level="12.2.3" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#simulate-survivors"><i class="fa fa-check"></i><b>12.2.3</b> Simulate survivors</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#more-than-one-type-of-cluster"><i class="fa fa-check"></i><b>12.3</b> More than one type of cluster</a></li>
<li class="chapter" data-level="12.4" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#divergent-transitions-and-non-centered-priors"><i class="fa fa-check"></i><b>12.4</b> Divergent transitions and non-centered priors</a>
<ul>
<li class="chapter" data-level="12.4.0.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#the-devils-funnel-example"><i class="fa fa-check"></i><b>12.4.0.1</b> The Devil’s Funnel: (example)</a></li>
<li class="chapter" data-level="12.4.0.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#non-centered-chimpanzees-example"><i class="fa fa-check"></i><b>12.4.0.2</b> Non-centered chimpanzees (example)</a>
<ul>
<li class="chapter" data-level="12.4.0.2.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#solution-1-centered-parameterization-increasing-acceptance-rate"><i class="fa fa-check"></i><b>12.4.0.2.1</b> Solution 1: Centered parameterization (Increasing acceptance rate)</a></li>
<li class="chapter" data-level="12.4.0.2.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#solution-2-non-centered-version-reparameterize"><i class="fa fa-check"></i><b>12.4.0.2.2</b> Solution 2: Non-centered version (reparameterize)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#multilevel-posterior-predictions"><i class="fa fa-check"></i><b>12.5</b> Multilevel posterior predictions</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#posterior-prediction-for-same-clusters"><i class="fa fa-check"></i><b>12.5.1</b> Posterior prediction for same clusters</a></li>
<li class="chapter" data-level="12.5.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#posterior-prediction-for-new-clusters"><i class="fa fa-check"></i><b>12.5.2</b> Posterior prediction for new clusters</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#exercises-6"><i class="fa fa-check"></i><b>12.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#e1-1"><i class="fa fa-check"></i><b>12.6.1</b> E1</a></li>
<li class="chapter" data-level="12.6.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#e2-1"><i class="fa fa-check"></i><b>12.6.2</b> E2</a></li>
<li class="chapter" data-level="12.6.3" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#e3-1"><i class="fa fa-check"></i><b>12.6.3</b> E3</a></li>
<li class="chapter" data-level="12.6.4" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#e4-1"><i class="fa fa-check"></i><b>12.6.4</b> E4</a></li>
<li class="chapter" data-level="12.6.5" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#m1-5"><i class="fa fa-check"></i><b>12.6.5</b> M1</a></li>
<li class="chapter" data-level="12.6.6" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#h1-4"><i class="fa fa-check"></i><b>12.6.6</b> H1</a>
<ul>
<li class="chapter" data-level="12.6.6.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#fixed-effects-model"><i class="fa fa-check"></i><b>12.6.6.1</b> Fixed effects model:</a></li>
<li class="chapter" data-level="12.6.6.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#varying-intercepts-model"><i class="fa fa-check"></i><b>12.6.6.2</b> Varying intercepts model:</a></li>
<li class="chapter" data-level="12.6.6.3" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#extract-samples"><i class="fa fa-check"></i><b>12.6.6.3</b> Extract samples</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html"><i class="fa fa-check"></i><b>13</b> Ch 14 - Advuntetures in Coviaraince</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#varying-slopes-by-construction"><i class="fa fa-check"></i><b>13.1</b> Varying slopes by construction</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#simulate-the-population"><i class="fa fa-check"></i><b>13.1.1</b> Simulate the population</a></li>
<li class="chapter" data-level="13.1.2" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#simulate-observations"><i class="fa fa-check"></i><b>13.1.2</b> Simulate observations</a></li>
<li class="chapter" data-level="13.1.3" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#the-varying-slopes-model"><i class="fa fa-check"></i><b>13.1.3</b> The varying slopes model</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#advanced-varying-slopes"><i class="fa fa-check"></i><b>13.2</b> Advanced varying slopes</a>
<ul>
<li class="chapter" data-level="13.2.0.1" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#inference"><i class="fa fa-check"></i><b>13.2.0.1</b> Inference!</a></li>
<li class="chapter" data-level="13.2.0.2" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#conclusions---multilevel-horoscopes"><i class="fa fa-check"></i><b>13.2.0.2</b> Conclusions - multilevel horoscopes</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#exercises-7"><i class="fa fa-check"></i><b>13.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#e1-2"><i class="fa fa-check"></i><b>13.3.1</b> E1</a></li>
<li class="chapter" data-level="13.3.2" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#e3-2"><i class="fa fa-check"></i><b>13.3.2</b> E3</a></li>
<li class="chapter" data-level="13.3.3" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#h1-5"><i class="fa fa-check"></i><b>13.3.3</b> H1</a></li>
<li class="chapter" data-level="13.3.4" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#h2-5"><i class="fa fa-check"></i><b>13.3.4</b> H2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html"><i class="fa fa-check"></i><b>14</b> Ch 14 - Adventures in Covariance</a>
<ul>
<li class="chapter" data-level="14.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#ch-14.3---instruments-and-causal-designs"><i class="fa fa-check"></i><b>14.1</b> Ch 14.3 - Instruments and causal designs</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#instrumental-variables"><i class="fa fa-check"></i><b>14.1.1</b> Instrumental variables</a>
<ul>
<li class="chapter" data-level="14.1.1.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#only-including-e-we-add-confounding-effect-sideeffect-of-e"><i class="fa fa-check"></i><b>14.1.1.1</b> 1. Only including E (we add confounding effect sideeffect of E)</a></li>
<li class="chapter" data-level="14.1.1.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#adding-instrument-q-the-wrong-way"><i class="fa fa-check"></i><b>14.1.1.2</b> 2. Adding instrument Q (the wrong way)</a></li>
<li class="chapter" data-level="14.1.1.3" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#correct-use-of-the-instrument-variable"><i class="fa fa-check"></i><b>14.1.1.3</b> 3. Correct use of the instrument variable</a></li>
</ul></li>
<li class="chapter" data-level="14.1.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#other-designs"><i class="fa fa-check"></i><b>14.1.2</b> Other designs</a>
<ul>
<li class="chapter" data-level="14.1.2.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#front-door-criterion"><i class="fa fa-check"></i><b>14.1.2.1</b> Front-Door Criterion</a></li>
<li class="chapter" data-level="14.1.2.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#regression-discontinuity-rdd"><i class="fa fa-check"></i><b>14.1.2.2</b> Regression discontinuity (RDD)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#gaussian-processes-continuous-categories-and-the-gaussian-process"><i class="fa fa-check"></i><b>14.2</b> (Gaussian Processes) Continuous categories and the Gaussian process</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#example-spatial-autocorrelation-in-oceanic-tools"><i class="fa fa-check"></i><b>14.2.1</b> Example: Spatial autocorrelation in Oceanic tools</a>
<ul>
<li class="chapter" data-level="14.2.1.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#loading-data-defining-model"><i class="fa fa-check"></i><b>14.2.1.1</b> Loading data + defining model</a></li>
<li class="chapter" data-level="14.2.1.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#the-full-model"><i class="fa fa-check"></i><b>14.2.1.2</b> The full model</a></li>
<li class="chapter" data-level="14.2.1.3" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#gaussian-process-posterior"><i class="fa fa-check"></i><b>14.2.1.3</b> Gaussian Process Posterior</a></li>
</ul></li>
<li class="chapter" data-level="14.2.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#example-phylogenetic-distance-not-in-the-curriculum"><i class="fa fa-check"></i><b>14.2.2</b> Example: Phylogenetic distance (not in the curriculum)</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#exercises-8"><i class="fa fa-check"></i><b>14.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#m3-3"><i class="fa fa-check"></i><b>14.3.1</b> M3</a></li>
<li class="chapter" data-level="14.3.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#m4-3"><i class="fa fa-check"></i><b>14.3.2</b> M4</a></li>
<li class="chapter" data-level="14.3.3" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#h2-6"><i class="fa fa-check"></i><b>14.3.3</b> H2</a></li>
<li class="chapter" data-level="14.3.4" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#h4-varying-intercepts-varying-slopes"><i class="fa fa-check"></i><b>14.3.4</b> H4 Varying intercepts Varying slopes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Data Analysis Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter-11---god-spiked-the-integers" class="section level1" number="11">
<h1><span class="header-section-number">11</span> Chapter 11 - God Spiked the Integers</h1>
<p>The following sections makes examples using a binomial outcome and exponential outcome (poisson). Also the last section is about a multinomial problem, where there is more than two outcomes.</p>
<p>In general it is very good practice not to create proportions before running the model, as the counts indicate the magnitude of the model, while the proportions will not reflect such.</p>
<div id="binomial-regression" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Binomial Regression</h2>
<p>Binomial regression is when you have an outcome variable with two outcomes, e.g., yes/no, reject/accept etc. We see that it takes the following formula:</p>
<p><span class="math display">\[
y \sim Binomial(n,p)
\]</span></p>
<p>Where y is a count. P = a probability of a certain trial success and n is the number of trials.</p>
<div id="logistic-regression-prosocial-chimpanzees" class="section level4" number="11.1.0.1">
<h4><span class="header-section-number">11.1.0.1</span> Logistic regression: Prosocial chimpanzees:</h4>
<p>In the following an example with chimpanzees is presented. In real life they had a table with a chimpanzee in one end, and then some food on a table. This food could be delivered in each ends of the table, depending on what level a chimpanzee pulls. The trick is then for every second chimpanzee there will be another chimpanzee in the other end of the table. Hence they want to investigate if a chimpanzee is more likely to get food for both ends of the table, if there is another chimpanzee present.</p>
<p>Prosocial = is about caring, hence if there is a partnering chimp. A proscial option is when there is food on the other side of the table, that can be send to the other chimpanzee. (opposite of prosocail = asocial)</p>
<p>Notice that one should account for the handedness of a chimpanzee (left or right), as that may be a backdoor if we were to draw the DAG.</p>
<p><img src="Images/paste-F90E83ED.png" /></p>
<p>We will create a model with a binomial distribution explaining the outcome variable (if one or the other lever is pulled).</p>
<p>Then we will have a logit function (logistic) explaining the probably outcome (likelihood) and we will include two parameters, an intercept (<span class="math inline">\(\alpha\)</span>) and a coefficient (<span class="math inline">\(\beta\)</span>). There will be one (<span class="math inline">\(\alpha\)</span>) for each unique combination of outcomes.</p>
<p><em>Notice that we do not use dummy variables, but instead an index to model the interaction. For explanation of this, it is referred to CH5.</em></p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="chapter-11-god-spiked-the-integers.html#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Loading data 11.1</span></span>
<span id="cb281-2"><a href="chapter-11-god-spiked-the-integers.html#cb281-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb281-3"><a href="chapter-11-god-spiked-the-integers.html#cb281-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(chimpanzees)</span>
<span id="cb281-4"><a href="chapter-11-god-spiked-the-integers.html#cb281-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> chimpanzees</span>
<span id="cb281-5"><a href="chapter-11-god-spiked-the-integers.html#cb281-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-6"><a href="chapter-11-god-spiked-the-integers.html#cb281-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Create condition, treatment 1, 2, 3 and 4. see p. 326</span></span>
<span id="cb281-7"><a href="chapter-11-god-spiked-the-integers.html#cb281-7" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> d<span class="sc">$</span>prosoc_left <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>d<span class="sc">$</span>condition</span>
<span id="cb281-8"><a href="chapter-11-god-spiked-the-integers.html#cb281-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-9"><a href="chapter-11-god-spiked-the-integers.html#cb281-9" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>( <span class="sc">~</span> treatment <span class="sc">+</span> prosoc_left <span class="sc">+</span> condition , d ) <span class="co">#if condition = 1, then partner present</span></span></code></pre></div>
<pre><code>## , , condition = 0
## 
##          prosoc_left
## treatment   0   1
##         1 126   0
##         2   0 126
##         3   0   0
##         4   0   0
## 
## , , condition = 1
## 
##          prosoc_left
## treatment   0   1
##         1   0   0
##         2   0   0
##         3 126   0
##         4   0 126</code></pre>
<p>Now we see the different outcomes given the condition (if there is a partner present).</p>
<p><em>Notice that the</em> <span class="math inline">\(\alpha\)</span> prior is based on log-odds. We see that the log odds larger or smaller than 4 and -4 means great certainty on 0 or 1, see the picture of this in a earlier section. Hence in the following example, we see that the log-odds spans all the way up to &gt;15, hence it is simply just var too extreme, hence it says that pulling the left lever is either always or never happens. Hence when we transform to the probability scale, it will be either 0 or 1 (more or less). This is a horrible priors.</p>
<p>The following is just an example prior, which is almost flat, although the outcome leads to very non flat results, as we break the usual scale of the log-odds.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="chapter-11-god-spiked-the-integers.html#cb283-1" aria-hidden="true" tabindex="-1"></a>m11<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb283-2"><a href="chapter-11-god-spiked-the-integers.html#cb283-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb283-3"><a href="chapter-11-god-spiked-the-integers.html#cb283-3" aria-hidden="true" tabindex="-1"></a>    pulled_left <span class="sc">~</span> <span class="fu">dbinom</span>( <span class="dv">1</span> , p ) ,</span>
<span id="cb283-4"><a href="chapter-11-god-spiked-the-integers.html#cb283-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> a ,</span>
<span id="cb283-5"><a href="chapter-11-god-spiked-the-integers.html#cb283-5" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="dv">10</span> ) <span class="co">#Mean = 0, as log-odds is centered at 0. sd of 10 is very wide.</span></span>
<span id="cb283-6"><a href="chapter-11-god-spiked-the-integers.html#cb283-6" aria-hidden="true" tabindex="-1"></a>  ) , <span class="at">data=</span>d )</span>
<span id="cb283-7"><a href="chapter-11-god-spiked-the-integers.html#cb283-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-8"><a href="chapter-11-god-spiked-the-integers.html#cb283-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Sampling from the prior</span></span>
<span id="cb283-9"><a href="chapter-11-god-spiked-the-integers.html#cb283-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1999</span>)</span>
<span id="cb283-10"><a href="chapter-11-god-spiked-the-integers.html#cb283-10" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">extract.prior</span>(m11<span class="fl">.1</span>,<span class="at">n =</span> <span class="fl">1e4</span>)</span>
<span id="cb283-11"><a href="chapter-11-god-spiked-the-integers.html#cb283-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-12"><a href="chapter-11-god-spiked-the-integers.html#cb283-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Using inverse-link function to convert the parameter to the outcome scale</span></span>
<span id="cb283-13"><a href="chapter-11-god-spiked-the-integers.html#cb283-13" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(prior<span class="sc">$</span>a)</span>
<span id="cb283-14"><a href="chapter-11-god-spiked-the-integers.html#cb283-14" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(p,<span class="at">adj =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-166-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Se see that this prior will lead to great certainty in pulling the left or the right lever.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="chapter-11-god-spiked-the-integers.html#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Prior plot, plotting prior</span></span>
<span id="cb284-2"><a href="chapter-11-god-spiked-the-integers.html#cb284-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb284-3"><a href="chapter-11-god-spiked-the-integers.html#cb284-3" aria-hidden="true" tabindex="-1"></a>hx <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x,<span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb284-4"><a href="chapter-11-god-spiked-the-integers.html#cb284-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, hx, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">&quot;x value&quot;</span>,</span>
<span id="cb284-5"><a href="chapter-11-god-spiked-the-integers.html#cb284-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab=</span><span class="st">&quot;Density&quot;</span>, <span class="at">main=</span><span class="st">&quot;Comparison of prior Distributions&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-167-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that the prior is very wide and despite a bad prior, we get very certain outcomes of 0 or 1.</p>
<p>We will go for an sd of 1.5. We will also set the beta prior for dnorm of mean of 0 and standard deviation of 0.5. In the book they also examplifies with beta = dnorm(0,10), this is equally bad, hence it is regularized.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="chapter-11-god-spiked-the-integers.html#cb285-1" aria-hidden="true" tabindex="-1"></a>m11<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb285-2"><a href="chapter-11-god-spiked-the-integers.html#cb285-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb285-3"><a href="chapter-11-god-spiked-the-integers.html#cb285-3" aria-hidden="true" tabindex="-1"></a>    pulled_left <span class="sc">~</span> <span class="fu">dbinom</span>( <span class="dv">1</span> , p ) ,</span>
<span id="cb285-4"><a href="chapter-11-god-spiked-the-integers.html#cb285-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> a <span class="sc">+</span> b[treatment] ,</span>
<span id="cb285-5"><a href="chapter-11-god-spiked-the-integers.html#cb285-5" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">1.5</span> ),</span>
<span id="cb285-6"><a href="chapter-11-god-spiked-the-integers.html#cb285-6" aria-hidden="true" tabindex="-1"></a>    b[treatment] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> ) <span class="co">#the treatment paramtere</span></span>
<span id="cb285-7"><a href="chapter-11-god-spiked-the-integers.html#cb285-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb285-8"><a href="chapter-11-god-spiked-the-integers.html#cb285-8" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data=</span>d )</span>
<span id="cb285-9"><a href="chapter-11-god-spiked-the-integers.html#cb285-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-10"><a href="chapter-11-god-spiked-the-integers.html#cb285-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1999</span>)</span>
<span id="cb285-11"><a href="chapter-11-god-spiked-the-integers.html#cb285-11" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">extract.prior</span>( m11<span class="fl">.3</span> , <span class="at">n=</span><span class="fl">1e4</span> )</span>
<span id="cb285-12"><a href="chapter-11-god-spiked-the-integers.html#cb285-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-13"><a href="chapter-11-god-spiked-the-integers.html#cb285-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Get 4 vectors of samples based on the priors</span></span>
<span id="cb285-14"><a href="chapter-11-god-spiked-the-integers.html#cb285-14" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sapply</span>( <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> , <span class="cf">function</span>(k) <span class="fu">inv_logit</span>( prior<span class="sc">$</span>a <span class="sc">+</span> prior<span class="sc">$</span>b[,k] ) )</span>
<span id="cb285-15"><a href="chapter-11-god-spiked-the-integers.html#cb285-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-16"><a href="chapter-11-god-spiked-the-integers.html#cb285-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Compute the difference between two vectors</span></span>
<span id="cb285-17"><a href="chapter-11-god-spiked-the-integers.html#cb285-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>( <span class="fu">abs</span>( p[,<span class="dv">1</span>] <span class="sc">-</span> p[,<span class="dv">2</span>] ) )</span></code></pre></div>
<pre><code>## [1] 0.09838663</code></pre>
<p>Now we see that on average, there is 10% difference.</p>
<blockquote>
<p>From this we can tell that the samples deviate, but not very much. We want to limit the model from modeling unnatural outcomes, while actually being able to adapt. Hence we want the model to be skeptical of large differences.</p>
</blockquote>
<p>Now we can estimate the mode using <strong>Hamiltonian Monte Carlo</strong></p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="chapter-11-god-spiked-the-integers.html#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Estimating the posterior distribution using Hamiltonian Monte Carlo</span></span>
<span id="cb287-2"><a href="chapter-11-god-spiked-the-integers.html#cb287-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-3"><a href="chapter-11-god-spiked-the-integers.html#cb287-3" aria-hidden="true" tabindex="-1"></a><span class="co"># prior trimmed data list</span></span>
<span id="cb287-4"><a href="chapter-11-god-spiked-the-integers.html#cb287-4" aria-hidden="true" tabindex="-1"></a>dat_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb287-5"><a href="chapter-11-god-spiked-the-integers.html#cb287-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pulled_left =</span> d<span class="sc">$</span>pulled_left,</span>
<span id="cb287-6"><a href="chapter-11-god-spiked-the-integers.html#cb287-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">actor =</span> d<span class="sc">$</span>actor,</span>
<span id="cb287-7"><a href="chapter-11-god-spiked-the-integers.html#cb287-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">as.integer</span>(d<span class="sc">$</span>treatment) )</span>
<span id="cb287-8"><a href="chapter-11-god-spiked-the-integers.html#cb287-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-9"><a href="chapter-11-god-spiked-the-integers.html#cb287-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Constructing the model 11.11</span></span>
<span id="cb287-10"><a href="chapter-11-god-spiked-the-integers.html#cb287-10" aria-hidden="true" tabindex="-1"></a>m11<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb287-11"><a href="chapter-11-god-spiked-the-integers.html#cb287-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb287-12"><a href="chapter-11-god-spiked-the-integers.html#cb287-12" aria-hidden="true" tabindex="-1"></a>    pulled_left <span class="sc">~</span> <span class="fu">dbinom</span>( <span class="dv">1</span> , p ) ,</span>
<span id="cb287-13"><a href="chapter-11-god-spiked-the-integers.html#cb287-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> a[actor] <span class="sc">+</span> b[treatment] , <span class="co">#actor = chimp, treatment = the experiment setup</span></span>
<span id="cb287-14"><a href="chapter-11-god-spiked-the-integers.html#cb287-14" aria-hidden="true" tabindex="-1"></a>    a[actor] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">1.5</span> ),</span>
<span id="cb287-15"><a href="chapter-11-god-spiked-the-integers.html#cb287-15" aria-hidden="true" tabindex="-1"></a>    b[treatment] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> )</span>
<span id="cb287-16"><a href="chapter-11-god-spiked-the-integers.html#cb287-16" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb287-17"><a href="chapter-11-god-spiked-the-integers.html#cb287-17" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data=</span>dat_list , <span class="at">chains=</span><span class="dv">4</span> , <span class="at">log_lik=</span><span class="cn">TRUE</span> )</span></code></pre></div>
<pre><code>## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c
## clang -I&quot;/Library/Frameworks/R.framework/Resources/include&quot; -DNDEBUG   -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/Rcpp/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/unsupported&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/BH/include&quot; -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/src/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppParallel/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/rstan/include&quot; -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include &#39;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp&#39;  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:88:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name &#39;namespace&#39;
## namespace Eigen {
## ^
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected &#39;;&#39; after top level declarator
## namespace Eigen {
##                ^
##                ;
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:96:10: fatal error: &#39;complex&#39; file not found
## #include &lt;complex&gt;
##          ^~~~~~~~~
## 3 errors generated.
## make: *** [foo.o] Error 1
## 
## SAMPLING FOR MODEL &#39;82480dff1a626a42c2ca9de938d65b9d&#39; NOW (CHAIN 1).
## Chain 1: 
## Chain 1: Gradient evaluation took 0.000109 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.09 seconds.
## Chain 1: Adjust your expectations accordingly!
## Chain 1: 
## Chain 1: 
## Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 1: 
## Chain 1:  Elapsed Time: 0.341279 seconds (Warm-up)
## Chain 1:                0.306452 seconds (Sampling)
## Chain 1:                0.647731 seconds (Total)
## Chain 1: 
## 
## SAMPLING FOR MODEL &#39;82480dff1a626a42c2ca9de938d65b9d&#39; NOW (CHAIN 2).
## Chain 2: 
## Chain 2: Gradient evaluation took 5.3e-05 seconds
## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.53 seconds.
## Chain 2: Adjust your expectations accordingly!
## Chain 2: 
## Chain 2: 
## Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 2: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 2: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 2: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 2: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 2: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 2: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 2: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 2: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 2: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 2: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 2: 
## Chain 2:  Elapsed Time: 0.339352 seconds (Warm-up)
## Chain 2:                0.267315 seconds (Sampling)
## Chain 2:                0.606667 seconds (Total)
## Chain 2: 
## 
## SAMPLING FOR MODEL &#39;82480dff1a626a42c2ca9de938d65b9d&#39; NOW (CHAIN 3).
## Chain 3: 
## Chain 3: Gradient evaluation took 5.2e-05 seconds
## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.52 seconds.
## Chain 3: Adjust your expectations accordingly!
## Chain 3: 
## Chain 3: 
## Chain 3: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 3: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 3: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 3: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 3: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 3: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 3: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 3: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 3: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 3: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 3: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 3: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 3: 
## Chain 3:  Elapsed Time: 0.377494 seconds (Warm-up)
## Chain 3:                0.280099 seconds (Sampling)
## Chain 3:                0.657593 seconds (Total)
## Chain 3: 
## 
## SAMPLING FOR MODEL &#39;82480dff1a626a42c2ca9de938d65b9d&#39; NOW (CHAIN 4).
## Chain 4: 
## Chain 4: Gradient evaluation took 5.5e-05 seconds
## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.55 seconds.
## Chain 4: Adjust your expectations accordingly!
## Chain 4: 
## Chain 4: 
## Chain 4: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 4: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 4: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 4: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 4: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 4: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 4: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 4: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 4: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 4: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 4: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 4: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 4: 
## Chain 4:  Elapsed Time: 0.353908 seconds (Warm-up)
## Chain 4:                0.340683 seconds (Sampling)
## Chain 4:                0.694591 seconds (Total)
## Chain 4:</code></pre>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="chapter-11-god-spiked-the-integers.html#cb289-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-2"><a href="chapter-11-god-spiked-the-integers.html#cb289-2" aria-hidden="true" tabindex="-1"></a><span class="co"># OUTPUT = mean = log-odds of outcomes for each parameter.  </span></span>
<span id="cb289-3"><a href="chapter-11-god-spiked-the-integers.html#cb289-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-4"><a href="chapter-11-god-spiked-the-integers.html#cb289-4" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>( m11<span class="fl">.4</span> , <span class="at">depth=</span><span class="dv">2</span> )</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.4691437</td>
</tr>
<tr class="even">
<td align="right">3.8591587</td>
</tr>
<tr class="odd">
<td align="right">-0.7731752</td>
</tr>
<tr class="even">
<td align="right">-0.7801181</td>
</tr>
<tr class="odd">
<td align="right">-0.4733026</td>
</tr>
<tr class="even">
<td align="right">0.4574861</td>
</tr>
<tr class="odd">
<td align="right">1.9302531</td>
</tr>
<tr class="even">
<td align="right">-0.0126179</td>
</tr>
<tr class="odd">
<td align="right">0.4963272</td>
</tr>
<tr class="even">
<td align="right">-0.3631956</td>
</tr>
<tr class="odd">
<td align="right">0.3859976</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3355974</td>
</tr>
<tr class="even">
<td align="right">0.7245205</td>
</tr>
<tr class="odd">
<td align="right">0.3424777</td>
</tr>
<tr class="even">
<td align="right">0.3415426</td>
</tr>
<tr class="odd">
<td align="right">0.3374260</td>
</tr>
<tr class="even">
<td align="right">0.3361617</td>
</tr>
<tr class="odd">
<td align="right">0.4328352</td>
</tr>
<tr class="even">
<td align="right">0.2913041</td>
</tr>
<tr class="odd">
<td align="right">0.2919672</td>
</tr>
<tr class="even">
<td align="right">0.2958807</td>
</tr>
<tr class="odd">
<td align="right">0.2874828</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-1.0202393</td>
</tr>
<tr class="even">
<td align="right">2.7666512</td>
</tr>
<tr class="odd">
<td align="right">-1.3319969</td>
</tr>
<tr class="even">
<td align="right">-1.3300130</td>
</tr>
<tr class="odd">
<td align="right">-1.0240518</td>
</tr>
<tr class="even">
<td align="right">-0.0677018</td>
</tr>
<tr class="odd">
<td align="right">1.2805477</td>
</tr>
<tr class="even">
<td align="right">-0.4757591</td>
</tr>
<tr class="odd">
<td align="right">0.0392419</td>
</tr>
<tr class="even">
<td align="right">-0.8341717</td>
</tr>
<tr class="odd">
<td align="right">-0.0661710</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0720931</td>
</tr>
<tr class="even">
<td align="right">5.0802776</td>
</tr>
<tr class="odd">
<td align="right">-0.2386032</td>
</tr>
<tr class="even">
<td align="right">-0.2413658</td>
</tr>
<tr class="odd">
<td align="right">0.0680157</td>
</tr>
<tr class="even">
<td align="right">1.0099898</td>
</tr>
<tr class="odd">
<td align="right">2.6511620</td>
</tr>
<tr class="even">
<td align="right">0.4591869</td>
</tr>
<tr class="odd">
<td align="right">0.9630114</td>
</tr>
<tr class="even">
<td align="right">0.1006613</td>
</tr>
<tr class="odd">
<td align="right">0.8474066</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">705.8014</td>
</tr>
<tr class="even">
<td align="right">1253.8186</td>
</tr>
<tr class="odd">
<td align="right">678.3468</td>
</tr>
<tr class="even">
<td align="right">725.1492</td>
</tr>
<tr class="odd">
<td align="right">697.1381</td>
</tr>
<tr class="even">
<td align="right">694.0357</td>
</tr>
<tr class="odd">
<td align="right">823.7525</td>
</tr>
<tr class="even">
<td align="right">620.2070</td>
</tr>
<tr class="odd">
<td align="right">697.4281</td>
</tr>
<tr class="even">
<td align="right">594.8777</td>
</tr>
<tr class="odd">
<td align="right">653.0517</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1.005217</td>
</tr>
<tr class="even">
<td align="right">1.000421</td>
</tr>
<tr class="odd">
<td align="right">1.004455</td>
</tr>
<tr class="even">
<td align="right">1.003907</td>
</tr>
<tr class="odd">
<td align="right">1.002598</td>
</tr>
<tr class="even">
<td align="right">1.002623</td>
</tr>
<tr class="odd">
<td align="right">1.001609</td>
</tr>
<tr class="even">
<td align="right">1.002723</td>
</tr>
<tr class="odd">
<td align="right">1.002708</td>
</tr>
<tr class="even">
<td align="right">1.004414</td>
</tr>
<tr class="odd">
<td align="right">1.004958</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>Thus, we see a bunch of different alpha values and the four different beta values (one for each treatment). Interpretation:</p>
<ul>
<li><p>Alpha = for each chimp.</p></li>
<li><p>Alpha mean = the log-odds of pulling the left lever (success = left lever pull)</p>
<ul>
<li><p>When alpha &gt; 0 we know that the probability is &gt;50%, we have three chimps with positive numbers. where it is already clear that chimp 2 almost always pulled the left lever (i think it was a lefty chimp).</p></li>
<li><p>In general we see that there is a tendency for right handedness, as most chimps have a preference of the right lever (alpha mean (log odds) less than 50%)</p></li>
</ul></li>
<li><p>beta = for each type of treatment.</p></li>
<li><p>beta mean = the log-odds of pulling the left lever given the treatment. We see that it typically spans in the negative and positive region, hence an indication of the treatment not having a great effect. more about this in the following.</p></li>
</ul>
<p>Let us take a look of the tendency of pulling the LEFT lever. In general what we see is the preference for left and right handedness for each chimp. This is the reason for controlling for each actor (chimp)</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="chapter-11-god-spiked-the-integers.html#cb290-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m11<span class="fl">.4</span>)</span>
<span id="cb290-2"><a href="chapter-11-god-spiked-the-integers.html#cb290-2" aria-hidden="true" tabindex="-1"></a>p_left <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>( post<span class="sc">$</span>a )</span>
<span id="cb290-3"><a href="chapter-11-god-spiked-the-integers.html#cb290-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( <span class="fu">precis</span>( <span class="fu">as.data.frame</span>(p_left) ) , <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>) )</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/11.12-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that that chimpanzee 1, 3, 4, 5 have a preference to pull the right lever, that is because the probability of pulling the left lever is below 50%. Chimpanzee no. 6 is a bit on both sides, while chimpanzee 2 and 7 tends to pull the left lever.</p>
<p>Let us inspect the actual cases for chimpanzee no. 2.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="chapter-11-god-spiked-the-integers.html#cb291-1" aria-hidden="true" tabindex="-1"></a>d[d<span class="sc">$</span>actor <span class="sc">==</span> <span class="dv">2</span>,<span class="st">&quot;pulled_left&quot;</span>] <span class="sc">%&gt;%</span> <span class="fu">table</span>()</span></code></pre></div>
<pre><code>## .
##  1 
## 72</code></pre>
<p>We see that this guy in fact only pulled the left lever, hence the great certainty.</p>
<p>Now we want to measure the treatment effect. We can derive the effect from the <span class="math inline">\(\beta\)</span> coefficient.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="chapter-11-god-spiked-the-integers.html#cb293-1" aria-hidden="true" tabindex="-1"></a>labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;R/N&quot;</span>,<span class="st">&quot;L/N&quot;</span>,<span class="st">&quot;R/P&quot;</span>,<span class="st">&quot;L/P&quot;</span>) <span class="co">#R = right, L = Left, P = Partner, N = No partner</span></span>
<span id="cb293-2"><a href="chapter-11-god-spiked-the-integers.html#cb293-2" aria-hidden="true" tabindex="-1"></a>{<span class="fu">plot</span>( <span class="fu">precis</span>( m11<span class="fl">.4</span> , <span class="at">depth=</span><span class="dv">2</span> , <span class="at">pars=</span><span class="st">&quot;b&quot;</span> ) , <span class="at">labels=</span>labs)</span>
<span id="cb293-3"><a href="chapter-11-god-spiked-the-integers.html#cb293-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;R = Right, L = Left, N = no partner, P = Partner&quot;</span>)}</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/11.13-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>It already seems as if they are overlapping. But what is really interesting is the difference between the scenarios. This we inspect in the following:</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="chapter-11-god-spiked-the-integers.html#cb294-1" aria-hidden="true" tabindex="-1"></a>diffs <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb294-2"><a href="chapter-11-god-spiked-the-integers.html#cb294-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">db13 =</span> post<span class="sc">$</span>b[,<span class="dv">1</span>] <span class="sc">-</span> post<span class="sc">$</span>b[,<span class="dv">3</span>], <span class="co">#No partner / partner treatment</span></span>
<span id="cb294-3"><a href="chapter-11-god-spiked-the-integers.html#cb294-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">db24 =</span> post<span class="sc">$</span>b[,<span class="dv">2</span>] <span class="sc">-</span> post<span class="sc">$</span>b[,<span class="dv">4</span>] )</span>
<span id="cb294-4"><a href="chapter-11-god-spiked-the-integers.html#cb294-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( <span class="fu">precis</span>(diffs) )</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/11.14-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see some tendencies, although as both ranges on both sides of 0, there is no strong evidance of a pattern.</p>
<p>In the book they also compare the posterior predictions compared with the osberved events. This will not be shown.</p>
<p>Ultimately it also compares the model with a non interaction model (index for oth chimpanzee and treatment). So a modell looks the following:</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="chapter-11-god-spiked-the-integers.html#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating data for condition and pulled lever</span></span>
<span id="cb295-2"><a href="chapter-11-god-spiked-the-integers.html#cb295-2" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>side <span class="ot">&lt;-</span> d<span class="sc">$</span>prosoc_left <span class="sc">+</span> <span class="dv">1</span> <span class="co"># right 1, left 2</span></span>
<span id="cb295-3"><a href="chapter-11-god-spiked-the-integers.html#cb295-3" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>cond <span class="ot">&lt;-</span> d<span class="sc">$</span>condition <span class="sc">+</span> <span class="dv">1</span> <span class="co"># no partner 1, partner 2</span></span>
<span id="cb295-4"><a href="chapter-11-god-spiked-the-integers.html#cb295-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-5"><a href="chapter-11-god-spiked-the-integers.html#cb295-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Specify model</span></span>
<span id="cb295-6"><a href="chapter-11-god-spiked-the-integers.html#cb295-6" aria-hidden="true" tabindex="-1"></a>dat_list2 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb295-7"><a href="chapter-11-god-spiked-the-integers.html#cb295-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pulled_left =</span> d<span class="sc">$</span>pulled_left,</span>
<span id="cb295-8"><a href="chapter-11-god-spiked-the-integers.html#cb295-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">actor =</span> d<span class="sc">$</span>actor,</span>
<span id="cb295-9"><a href="chapter-11-god-spiked-the-integers.html#cb295-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">side =</span> d<span class="sc">$</span>side,</span>
<span id="cb295-10"><a href="chapter-11-god-spiked-the-integers.html#cb295-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cond =</span> d<span class="sc">$</span>cond</span>
<span id="cb295-11"><a href="chapter-11-god-spiked-the-integers.html#cb295-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb295-12"><a href="chapter-11-god-spiked-the-integers.html#cb295-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-13"><a href="chapter-11-god-spiked-the-integers.html#cb295-13" aria-hidden="true" tabindex="-1"></a>m11<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb295-14"><a href="chapter-11-god-spiked-the-integers.html#cb295-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb295-15"><a href="chapter-11-god-spiked-the-integers.html#cb295-15" aria-hidden="true" tabindex="-1"></a>    pulled_left <span class="sc">~</span> <span class="fu">dbinom</span>( <span class="dv">1</span> , p ) ,</span>
<span id="cb295-16"><a href="chapter-11-god-spiked-the-integers.html#cb295-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> a[actor] <span class="sc">+</span> bs[side] <span class="sc">+</span> bc[cond] ,</span>
<span id="cb295-17"><a href="chapter-11-god-spiked-the-integers.html#cb295-17" aria-hidden="true" tabindex="-1"></a>    a[actor] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">1.5</span> ),</span>
<span id="cb295-18"><a href="chapter-11-god-spiked-the-integers.html#cb295-18" aria-hidden="true" tabindex="-1"></a>    bs[side] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> ),</span>
<span id="cb295-19"><a href="chapter-11-god-spiked-the-integers.html#cb295-19" aria-hidden="true" tabindex="-1"></a>    bc[cond] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> )</span>
<span id="cb295-20"><a href="chapter-11-god-spiked-the-integers.html#cb295-20" aria-hidden="true" tabindex="-1"></a>  ) , <span class="at">data=</span>dat_list2 , <span class="at">chains=</span><span class="dv">4</span></span>
<span id="cb295-21"><a href="chapter-11-god-spiked-the-integers.html#cb295-21" aria-hidden="true" tabindex="-1"></a>  , <span class="at">log_lik=</span><span class="cn">TRUE</span> <span class="co">#Keep log_lik for comparabillity</span></span>
<span id="cb295-22"><a href="chapter-11-god-spiked-the-integers.html#cb295-22" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c
## clang -I&quot;/Library/Frameworks/R.framework/Resources/include&quot; -DNDEBUG   -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/Rcpp/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/unsupported&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/BH/include&quot; -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/src/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppParallel/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/rstan/include&quot; -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include &#39;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp&#39;  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:88:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name &#39;namespace&#39;
## namespace Eigen {
## ^
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected &#39;;&#39; after top level declarator
## namespace Eigen {
##                ^
##                ;
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:96:10: fatal error: &#39;complex&#39; file not found
## #include &lt;complex&gt;
##          ^~~~~~~~~
## 3 errors generated.
## make: *** [foo.o] Error 1
## 
## SAMPLING FOR MODEL &#39;8cec853a8473faa0bc2e49bbbdc68fa7&#39; NOW (CHAIN 1).
## Chain 1: 
## Chain 1: Gradient evaluation took 0.0001 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 1 seconds.
## Chain 1: Adjust your expectations accordingly!
## Chain 1: 
## Chain 1: 
## Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 1: 
## Chain 1:  Elapsed Time: 0.782901 seconds (Warm-up)
## Chain 1:                0.628488 seconds (Sampling)
## Chain 1:                1.41139 seconds (Total)
## Chain 1: 
## 
## SAMPLING FOR MODEL &#39;8cec853a8473faa0bc2e49bbbdc68fa7&#39; NOW (CHAIN 2).
## Chain 2: 
## Chain 2: Gradient evaluation took 6.3e-05 seconds
## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.63 seconds.
## Chain 2: Adjust your expectations accordingly!
## Chain 2: 
## Chain 2: 
## Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 2: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 2: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 2: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 2: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 2: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 2: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 2: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 2: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 2: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 2: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 2: 
## Chain 2:  Elapsed Time: 0.623772 seconds (Warm-up)
## Chain 2:                0.609987 seconds (Sampling)
## Chain 2:                1.23376 seconds (Total)
## Chain 2: 
## 
## SAMPLING FOR MODEL &#39;8cec853a8473faa0bc2e49bbbdc68fa7&#39; NOW (CHAIN 3).
## Chain 3: 
## Chain 3: Gradient evaluation took 6.6e-05 seconds
## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.66 seconds.
## Chain 3: Adjust your expectations accordingly!
## Chain 3: 
## Chain 3: 
## Chain 3: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 3: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 3: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 3: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 3: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 3: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 3: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 3: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 3: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 3: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 3: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 3: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 3: 
## Chain 3:  Elapsed Time: 0.683877 seconds (Warm-up)
## Chain 3:                0.595127 seconds (Sampling)
## Chain 3:                1.279 seconds (Total)
## Chain 3: 
## 
## SAMPLING FOR MODEL &#39;8cec853a8473faa0bc2e49bbbdc68fa7&#39; NOW (CHAIN 4).
## Chain 4: 
## Chain 4: Gradient evaluation took 6.6e-05 seconds
## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.66 seconds.
## Chain 4: Adjust your expectations accordingly!
## Chain 4: 
## Chain 4: 
## Chain 4: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 4: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 4: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 4: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 4: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 4: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 4: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 4: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 4: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 4: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 4: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 4: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 4: 
## Chain 4:  Elapsed Time: 0.709614 seconds (Warm-up)
## Chain 4:                0.573546 seconds (Sampling)
## Chain 4:                1.28316 seconds (Total)
## Chain 4:</code></pre>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="chapter-11-god-spiked-the-integers.html#cb297-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-2"><a href="chapter-11-god-spiked-the-integers.html#cb297-2" aria-hidden="true" tabindex="-1"></a><span class="co">#compare the model with the previous model:</span></span>
<span id="cb297-3"><a href="chapter-11-god-spiked-the-integers.html#cb297-3" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>( m11<span class="fl">.5</span> , m11<span class="fl">.4</span> , <span class="at">func=</span>PSIS )</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">530.6715</td>
</tr>
<tr class="even">
<td align="right">532.2422</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">19.18167</td>
</tr>
<tr class="even">
<td align="right">18.95302</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.000000</td>
</tr>
<tr class="even">
<td align="right">1.570755</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">1.406882</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">7.726863</td>
</tr>
<tr class="even">
<td align="right">8.460029</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.6868379</td>
</tr>
<tr class="even">
<td align="right">0.3131621</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>We see that the simpler model is working just as fine. That was expected as we did not discover any effects in the original model, hence there should not be one either in the simpler model.</p>
</div>
<div id="relative-shark-and-absolute-deer" class="section level4" number="11.1.0.2">
<h4><span class="header-section-number">11.1.0.2</span> Relative shark and absolute deer</h4>
<p>Notice that logistic regression should be seen as measuring <em>relative effects</em>, this is the relative change in odds of an outcome.</p>
<p>We can calculate the <em>proportional odds</em> by saying: case we switch from a scenario with no partner (2) and to a scenario where we have a partner (4).</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="chapter-11-god-spiked-the-integers.html#cb298-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m11<span class="fl">.4</span>)</span>
<span id="cb298-2"><a href="chapter-11-god-spiked-the-integers.html#cb298-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">exp</span>(post<span class="sc">$</span>b[,<span class="dv">4</span>] <span class="sc">-</span> post<span class="sc">$</span>b[,<span class="dv">2</span>]))</span></code></pre></div>
<pre><code>## [1] 0.9299786</code></pre>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="chapter-11-god-spiked-the-integers.html#cb300-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2 = two food items and no partner</span></span>
<span id="cb300-2"><a href="chapter-11-god-spiked-the-integers.html#cb300-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4 = two food items and a partner</span></span></code></pre></div>
<p>0.93 = 7% reduction of odds of the monkey pulling the left lever (0.93 % relative chance of success (pulling left lever)).</p>
<p>Thus notice that the realtive scale is perceptive, as change from one category to another, e.g., from the chimpanzee example from one treatment to another, may seem large on a relative scale, although in absolute number, you may be working on a very small magnitude.</p>
<p>Example: lung cancer is rare and we see that smoking increases your odds of getting lung cancer by three. lung cancer is still rare, although a third of lung cancer patients just smoked.</p>
<p>Another example from the lecture:</p>
<p><img src="Images/paste-68634DED.png" width="222" /></p>
</div>
<div id="aggregated-binomial-chimpanzees-again-condensed." class="section level4" number="11.1.0.3">
<h4><span class="header-section-number">11.1.0.3</span> Aggregated binomial: Chimpanzees again, condensed.</h4>
<p>This is the same example just as the model above, here the data is basically just aggregated, so we have one row for each chimpanzee and not one for each experiment.</p>
<p>Now the model is just specified with:</p>
<p><span class="math display">\[
leftpuls \sim Binomial(18,p)
\]</span></p>
<p>As <span class="math inline">\(Binomial(N,p)\)</span> and N = number of osbervations, as we have 18 experiments per chimpanzee, we will use N = 18. Notice that N can only be fixed, if there is an equal number of observations pr. row in the underlying data for the aggregated data (the following section deals with this).</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="chapter-11-god-spiked-the-integers.html#cb301-1" aria-hidden="true" tabindex="-1"></a>m11<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb301-2"><a href="chapter-11-god-spiked-the-integers.html#cb301-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb301-3"><a href="chapter-11-god-spiked-the-integers.html#cb301-3" aria-hidden="true" tabindex="-1"></a>    left_pulls <span class="sc">~</span> <span class="fu">dbinom</span>( <span class="dv">18</span> , p ) , <span class="co">#18 instead of 1</span></span>
<span id="cb301-4"><a href="chapter-11-god-spiked-the-integers.html#cb301-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> a[actor] <span class="sc">+</span> b[treatment] ,</span>
<span id="cb301-5"><a href="chapter-11-god-spiked-the-integers.html#cb301-5" aria-hidden="true" tabindex="-1"></a>    a[actor] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">1.5</span> ) ,</span>
<span id="cb301-6"><a href="chapter-11-god-spiked-the-integers.html#cb301-6" aria-hidden="true" tabindex="-1"></a>    b[treatment] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> )</span>
<span id="cb301-7"><a href="chapter-11-god-spiked-the-integers.html#cb301-7" aria-hidden="true" tabindex="-1"></a>  ) , <span class="at">data=</span>dat , <span class="at">chains=</span><span class="dv">4</span> , <span class="at">log_lik=</span><span class="cn">TRUE</span> )</span></code></pre></div>
<p>For the rest of the example, I refer to the book. the only difference we see, is that the PSIS is a bit different (due to a bit different parametization), although the model performs equally well.</p>
</div>
<div id="aggregated-binomial-graduate-school-admissions" class="section level4" number="11.1.0.4">
<h4><span class="header-section-number">11.1.0.4</span> Aggregated binomial: Graduate school admissions</h4>
<p>In this example we see that there is not an equal number of observations per aggregation category. The following example show two different models:</p>
<ol style="list-style-type: decimal">
<li>One without index variable for department</li>
<li>One with index variable for department, to adjust for the mediating effect the department has on the DAG</li>
</ol>
<div class="figure">
<img src="Images/paste-85D16C60.png" alt="" />
<p class="caption">G = Gender, D = Department, A = Acceptance</p>
</div>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="chapter-11-god-spiked-the-integers.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Loading the data</span></span>
<span id="cb302-2"><a href="chapter-11-god-spiked-the-integers.html#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb302-3"><a href="chapter-11-god-spiked-the-integers.html#cb302-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(UCBadmit)</span>
<span id="cb302-4"><a href="chapter-11-god-spiked-the-integers.html#cb302-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> UCBadmit</span>
<span id="cb302-5"><a href="chapter-11-god-spiked-the-integers.html#cb302-5" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">dept</th>
<th align="left">applicant.gender</th>
<th align="right">admit</th>
<th align="right">reject</th>
<th align="right">applications</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="left">male</td>
<td align="right">512</td>
<td align="right">313</td>
<td align="right">825</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="left">female</td>
<td align="right">89</td>
<td align="right">19</td>
<td align="right">108</td>
</tr>
<tr class="odd">
<td align="left">B</td>
<td align="left">male</td>
<td align="right">353</td>
<td align="right">207</td>
<td align="right">560</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="left">female</td>
<td align="right">17</td>
<td align="right">8</td>
<td align="right">25</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="left">male</td>
<td align="right">120</td>
<td align="right">205</td>
<td align="right">325</td>
</tr>
<tr class="even">
<td align="left">C</td>
<td align="left">female</td>
<td align="right">202</td>
<td align="right">391</td>
<td align="right">593</td>
</tr>
<tr class="odd">
<td align="left">D</td>
<td align="left">male</td>
<td align="right">138</td>
<td align="right">279</td>
<td align="right">417</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="left">female</td>
<td align="right">131</td>
<td align="right">244</td>
<td align="right">375</td>
</tr>
<tr class="odd">
<td align="left">E</td>
<td align="left">male</td>
<td align="right">53</td>
<td align="right">138</td>
<td align="right">191</td>
</tr>
<tr class="even">
<td align="left">E</td>
<td align="left">female</td>
<td align="right">94</td>
<td align="right">299</td>
<td align="right">393</td>
</tr>
<tr class="odd">
<td align="left">F</td>
<td align="left">male</td>
<td align="right">22</td>
<td align="right">351</td>
<td align="right">373</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left">female</td>
<td align="right">24</td>
<td align="right">317</td>
<td align="right">341</td>
</tr>
</tbody>
</table>
</div>
<p>We see that there is different number of applications for each department for both males and females. We deal with this, merely by inserting a variable in N’s place in the equation.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="chapter-11-god-spiked-the-integers.html#cb303-1" aria-hidden="true" tabindex="-1"></a>dat_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb303-2"><a href="chapter-11-god-spiked-the-integers.html#cb303-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">admit =</span> d<span class="sc">$</span>admit,</span>
<span id="cb303-3"><a href="chapter-11-god-spiked-the-integers.html#cb303-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">applications =</span> d<span class="sc">$</span>applications,</span>
<span id="cb303-4"><a href="chapter-11-god-spiked-the-integers.html#cb303-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">gid =</span> <span class="fu">ifelse</span>( d<span class="sc">$</span>applicant.gender<span class="sc">==</span><span class="st">&quot;male&quot;</span> , <span class="dv">1</span> , <span class="dv">2</span> )</span>
<span id="cb303-5"><a href="chapter-11-god-spiked-the-integers.html#cb303-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb303-6"><a href="chapter-11-god-spiked-the-integers.html#cb303-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-7"><a href="chapter-11-god-spiked-the-integers.html#cb303-7" aria-hidden="true" tabindex="-1"></a>m11<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb303-8"><a href="chapter-11-god-spiked-the-integers.html#cb303-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb303-9"><a href="chapter-11-god-spiked-the-integers.html#cb303-9" aria-hidden="true" tabindex="-1"></a>    admit <span class="sc">~</span> <span class="fu">dbinom</span>( applications , p ) ,</span>
<span id="cb303-10"><a href="chapter-11-god-spiked-the-integers.html#cb303-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> a[gid] , <span class="co">#index for gender</span></span>
<span id="cb303-11"><a href="chapter-11-god-spiked-the-integers.html#cb303-11" aria-hidden="true" tabindex="-1"></a>    a[gid] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">1.5</span> )</span>
<span id="cb303-12"><a href="chapter-11-god-spiked-the-integers.html#cb303-12" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb303-13"><a href="chapter-11-god-spiked-the-integers.html#cb303-13" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data=</span>dat_list , <span class="at">chains=</span><span class="dv">4</span> )</span></code></pre></div>
<pre><code>## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c
## clang -I&quot;/Library/Frameworks/R.framework/Resources/include&quot; -DNDEBUG   -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/Rcpp/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/unsupported&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/BH/include&quot; -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/src/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppParallel/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/rstan/include&quot; -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include &#39;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp&#39;  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:88:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name &#39;namespace&#39;
## namespace Eigen {
## ^
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected &#39;;&#39; after top level declarator
## namespace Eigen {
##                ^
##                ;
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:96:10: fatal error: &#39;complex&#39; file not found
## #include &lt;complex&gt;
##          ^~~~~~~~~
## 3 errors generated.
## make: *** [foo.o] Error 1
## 
## SAMPLING FOR MODEL &#39;92bf1800293ab05bf80648b931ab8346&#39; NOW (CHAIN 1).
## Chain 1: 
## Chain 1: Gradient evaluation took 2e-05 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.2 seconds.
## Chain 1: Adjust your expectations accordingly!
## Chain 1: 
## Chain 1: 
## Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 1: 
## Chain 1:  Elapsed Time: 0.010075 seconds (Warm-up)
## Chain 1:                0.008091 seconds (Sampling)
## Chain 1:                0.018166 seconds (Total)
## Chain 1: 
## 
## SAMPLING FOR MODEL &#39;92bf1800293ab05bf80648b931ab8346&#39; NOW (CHAIN 2).
## Chain 2: 
## Chain 2: Gradient evaluation took 7e-06 seconds
## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.07 seconds.
## Chain 2: Adjust your expectations accordingly!
## Chain 2: 
## Chain 2: 
## Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 2: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 2: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 2: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 2: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 2: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 2: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 2: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 2: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 2: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 2: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 2: 
## Chain 2:  Elapsed Time: 0.009735 seconds (Warm-up)
## Chain 2:                0.007687 seconds (Sampling)
## Chain 2:                0.017422 seconds (Total)
## Chain 2: 
## 
## SAMPLING FOR MODEL &#39;92bf1800293ab05bf80648b931ab8346&#39; NOW (CHAIN 3).
## Chain 3: 
## Chain 3: Gradient evaluation took 7e-06 seconds
## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.07 seconds.
## Chain 3: Adjust your expectations accordingly!
## Chain 3: 
## Chain 3: 
## Chain 3: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 3: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 3: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 3: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 3: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 3: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 3: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 3: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 3: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 3: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 3: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 3: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 3: 
## Chain 3:  Elapsed Time: 0.008559 seconds (Warm-up)
## Chain 3:                0.009595 seconds (Sampling)
## Chain 3:                0.018154 seconds (Total)
## Chain 3: 
## 
## SAMPLING FOR MODEL &#39;92bf1800293ab05bf80648b931ab8346&#39; NOW (CHAIN 4).
## Chain 4: 
## Chain 4: Gradient evaluation took 6e-06 seconds
## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.06 seconds.
## Chain 4: Adjust your expectations accordingly!
## Chain 4: 
## Chain 4: 
## Chain 4: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 4: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 4: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 4: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 4: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 4: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 4: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 4: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 4: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 4: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 4: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 4: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 4: 
## Chain 4:  Elapsed Time: 0.009241 seconds (Warm-up)
## Chain 4:                0.00917 seconds (Sampling)
## Chain 4:                0.018411 seconds (Total)
## Chain 4:</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="chapter-11-god-spiked-the-integers.html#cb305-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-2"><a href="chapter-11-god-spiked-the-integers.html#cb305-2" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>( m11<span class="fl">.7</span> , <span class="at">depth=</span><span class="dv">2</span> ) <span class="co">#Output mean ) log odds</span></span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.2202347</td>
</tr>
<tr class="even">
<td align="right">-0.8299381</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0392477</td>
</tr>
<tr class="even">
<td align="right">0.0507154</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.2803993</td>
</tr>
<tr class="even">
<td align="right">-0.9096241</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.1554518</td>
</tr>
<tr class="even">
<td align="right">-0.7485576</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1366.756</td>
</tr>
<tr class="even">
<td align="right">1533.751</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1.0001290</td>
</tr>
<tr class="even">
<td align="right">0.9983079</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>We see the log odds, recall that 0 = &lt;50% probability, females look to be more certainly not being admitted.</p>
<p>We see from the first example, that females (2) appear to be accepted less than males. Although how much higher? We can show the contrast on the aboslute and relative scale.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="chapter-11-god-spiked-the-integers.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Compute the difference in probability measures.</span></span>
<span id="cb306-2"><a href="chapter-11-god-spiked-the-integers.html#cb306-2" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m11<span class="fl">.7</span>)</span>
<span id="cb306-3"><a href="chapter-11-god-spiked-the-integers.html#cb306-3" aria-hidden="true" tabindex="-1"></a>diff_a <span class="ot">&lt;-</span> post<span class="sc">$</span>a[,<span class="dv">1</span>] <span class="sc">-</span> post<span class="sc">$</span>a[,<span class="dv">2</span>]</span>
<span id="cb306-4"><a href="chapter-11-god-spiked-the-integers.html#cb306-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-5"><a href="chapter-11-god-spiked-the-integers.html#cb306-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Going from log odds to probability</span></span>
<span id="cb306-6"><a href="chapter-11-god-spiked-the-integers.html#cb306-6" aria-hidden="true" tabindex="-1"></a>diff_p <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(post<span class="sc">$</span>a[,<span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">inv_logit</span>(post<span class="sc">$</span>a[,<span class="dv">2</span>])</span>
<span id="cb306-7"><a href="chapter-11-god-spiked-the-integers.html#cb306-7" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>( <span class="fu">list</span>( <span class="at">diff_a=</span>diff_a , <span class="at">diff_p=</span>diff_p ) )</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.6097035</td>
</tr>
<tr class="even">
<td align="right">0.1414188</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0652006</td>
</tr>
<tr class="even">
<td align="right">0.0147087</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.5065589</td>
</tr>
<tr class="even">
<td align="right">0.1180769</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.7157854</td>
</tr>
<tr class="even">
<td align="right">0.1649805</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="left">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">▁▁▁▃▇▇▅▂▁▁</td>
</tr>
<tr class="even">
<td align="left">▁▁▂▃▇▇▅▂▁▁▁</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>On a probability scale there is somewhere between 0.12 and 0.16 probability larger difference for males. Hence either there is huge discrimination going on or there is something lurking in the data.</p>
<p>We see that based on the difference of a, we see that there is certainly a somewhat difference. This we can also interpret visually.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="chapter-11-god-spiked-the-integers.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">postcheck</span>( m11<span class="fl">.7</span> )</span>
<span id="cb307-2"><a href="chapter-11-god-spiked-the-integers.html#cb307-2" aria-hidden="true" tabindex="-1"></a><span class="co"># draw lines connecting points from same dept</span></span>
<span id="cb307-3"><a href="chapter-11-god-spiked-the-integers.html#cb307-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span> ) {</span>
<span id="cb307-4"><a href="chapter-11-god-spiked-the-integers.html#cb307-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(i<span class="dv">-1</span>)</span>
<span id="cb307-5"><a href="chapter-11-god-spiked-the-integers.html#cb307-5" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> d<span class="sc">$</span>admit[x]<span class="sc">/</span>d<span class="sc">$</span>applications[x]</span>
<span id="cb307-6"><a href="chapter-11-god-spiked-the-integers.html#cb307-6" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> d<span class="sc">$</span>admit[x<span class="sc">+</span><span class="dv">1</span>]<span class="sc">/</span>d<span class="sc">$</span>applications[x<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb307-7"><a href="chapter-11-god-spiked-the-integers.html#cb307-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( <span class="fu">c</span>(x,x<span class="sc">+</span><span class="dv">1</span>) , <span class="fu">c</span>(y1,y2) , <span class="at">col=</span>rangi2 , <span class="at">lwd=</span><span class="dv">2</span> )</span>
<span id="cb307-8"><a href="chapter-11-god-spiked-the-integers.html#cb307-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>( x<span class="fl">+0.5</span> , (y1<span class="sc">+</span>y2)<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.05</span> , d<span class="sc">$</span>dept[x] , <span class="at">cex=</span><span class="fl">0.8</span> , <span class="at">col=</span>rangi2 )</span>
<span id="cb307-9"><a href="chapter-11-god-spiked-the-integers.html#cb307-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="Bayesian-Data-Analysis-Notes_files/figure-html/11.31-1.png" alt="Blue = obbserved proportions in raw data, and the black points are the expected difference. We are very much off here." width="720" />
<p class="caption">
(#fig:11.31)Blue = obbserved proportions in raw data, and the black points are the expected difference. We are very much off here.
</p>
</div>
<p>Notice that the first dot on the line is male, and the second dot is female. We see in the first case, there is a larger posterior prediction for males compared to females, although it is observed that in real life, the actual prob of admission is greater for females. We do in fact see that females are admitted more in all but 2 departments. Thus there is something totally off here. <strong>So what is happening? Lets look at the DAG.</strong></p>
<div class="figure">
<img src="Images/paste-10080A62.png" alt="" />
<p class="caption">On the right we have the suggested adjusted model, to include the departments, hence the effect within each department instead of across all departments.</p>
</div>
<p>We see that there is a backdoor to admission, hence we must include department in the model.</p>
<blockquote>
<p>But did the model do anything wrong? no, we just told it that it can calculate log-odds across departments, but now it is clear that we must direct the model elsewise.</p>
</blockquote>
<p>Now we see that we are very much off. Hence we can try to include the department into the model.</p>
<p><strong>Lets add an index variable for department</strong></p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="chapter-11-god-spiked-the-integers.html#cb308-1" aria-hidden="true" tabindex="-1"></a>dat_list<span class="sc">$</span>dept_id <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="at">each=</span><span class="dv">2</span>)</span>
<span id="cb308-2"><a href="chapter-11-god-spiked-the-integers.html#cb308-2" aria-hidden="true" tabindex="-1"></a>m11<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb308-3"><a href="chapter-11-god-spiked-the-integers.html#cb308-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb308-4"><a href="chapter-11-god-spiked-the-integers.html#cb308-4" aria-hidden="true" tabindex="-1"></a>    admit <span class="sc">~</span> <span class="fu">dbinom</span>( applications , p ) ,</span>
<span id="cb308-5"><a href="chapter-11-god-spiked-the-integers.html#cb308-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> a[gid] <span class="sc">+</span> delta[dept_id] , <span class="co">#Added index for department</span></span>
<span id="cb308-6"><a href="chapter-11-god-spiked-the-integers.html#cb308-6" aria-hidden="true" tabindex="-1"></a>    a[gid] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">1.5</span> ) ,</span>
<span id="cb308-7"><a href="chapter-11-god-spiked-the-integers.html#cb308-7" aria-hidden="true" tabindex="-1"></a>    delta[dept_id] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">1.5</span> )</span>
<span id="cb308-8"><a href="chapter-11-god-spiked-the-integers.html#cb308-8" aria-hidden="true" tabindex="-1"></a>  ) , <span class="at">data=</span>dat_list , <span class="at">chains=</span><span class="dv">4</span> , <span class="at">iter=</span><span class="dv">4000</span> )</span></code></pre></div>
<pre><code>## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c
## clang -I&quot;/Library/Frameworks/R.framework/Resources/include&quot; -DNDEBUG   -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/Rcpp/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/unsupported&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/BH/include&quot; -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/src/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppParallel/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/rstan/include&quot; -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include &#39;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp&#39;  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:88:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name &#39;namespace&#39;
## namespace Eigen {
## ^
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected &#39;;&#39; after top level declarator
## namespace Eigen {
##                ^
##                ;
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:96:10: fatal error: &#39;complex&#39; file not found
## #include &lt;complex&gt;
##          ^~~~~~~~~
## 3 errors generated.
## make: *** [foo.o] Error 1
## 
## SAMPLING FOR MODEL &#39;eefef2dd38cd530185967a7d0d74fe47&#39; NOW (CHAIN 1).
## Chain 1: 
## Chain 1: Gradient evaluation took 1.7e-05 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.17 seconds.
## Chain 1: Adjust your expectations accordingly!
## Chain 1: 
## Chain 1: 
## Chain 1: Iteration:    1 / 4000 [  0%]  (Warmup)
## Chain 1: Iteration:  400 / 4000 [ 10%]  (Warmup)
## Chain 1: Iteration:  800 / 4000 [ 20%]  (Warmup)
## Chain 1: Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Chain 1: Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Chain 1: Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Chain 1: Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Chain 1: Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Chain 1: Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Chain 1: Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Chain 1: Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Chain 1: Iteration: 4000 / 4000 [100%]  (Sampling)
## Chain 1: 
## Chain 1:  Elapsed Time: 0.21787 seconds (Warm-up)
## Chain 1:                0.205867 seconds (Sampling)
## Chain 1:                0.423737 seconds (Total)
## Chain 1: 
## 
## SAMPLING FOR MODEL &#39;eefef2dd38cd530185967a7d0d74fe47&#39; NOW (CHAIN 2).
## Chain 2: 
## Chain 2: Gradient evaluation took 8e-06 seconds
## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.08 seconds.
## Chain 2: Adjust your expectations accordingly!
## Chain 2: 
## Chain 2: 
## Chain 2: Iteration:    1 / 4000 [  0%]  (Warmup)
## Chain 2: Iteration:  400 / 4000 [ 10%]  (Warmup)
## Chain 2: Iteration:  800 / 4000 [ 20%]  (Warmup)
## Chain 2: Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Chain 2: Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Chain 2: Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Chain 2: Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Chain 2: Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Chain 2: Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Chain 2: Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Chain 2: Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Chain 2: Iteration: 4000 / 4000 [100%]  (Sampling)
## Chain 2: 
## Chain 2:  Elapsed Time: 0.220694 seconds (Warm-up)
## Chain 2:                0.212825 seconds (Sampling)
## Chain 2:                0.433519 seconds (Total)
## Chain 2: 
## 
## SAMPLING FOR MODEL &#39;eefef2dd38cd530185967a7d0d74fe47&#39; NOW (CHAIN 3).
## Chain 3: 
## Chain 3: Gradient evaluation took 8e-06 seconds
## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.08 seconds.
## Chain 3: Adjust your expectations accordingly!
## Chain 3: 
## Chain 3: 
## Chain 3: Iteration:    1 / 4000 [  0%]  (Warmup)
## Chain 3: Iteration:  400 / 4000 [ 10%]  (Warmup)
## Chain 3: Iteration:  800 / 4000 [ 20%]  (Warmup)
## Chain 3: Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Chain 3: Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Chain 3: Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Chain 3: Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Chain 3: Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Chain 3: Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Chain 3: Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Chain 3: Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Chain 3: Iteration: 4000 / 4000 [100%]  (Sampling)
## Chain 3: 
## Chain 3:  Elapsed Time: 0.21909 seconds (Warm-up)
## Chain 3:                0.202852 seconds (Sampling)
## Chain 3:                0.421942 seconds (Total)
## Chain 3: 
## 
## SAMPLING FOR MODEL &#39;eefef2dd38cd530185967a7d0d74fe47&#39; NOW (CHAIN 4).
## Chain 4: 
## Chain 4: Gradient evaluation took 7e-06 seconds
## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.07 seconds.
## Chain 4: Adjust your expectations accordingly!
## Chain 4: 
## Chain 4: 
## Chain 4: Iteration:    1 / 4000 [  0%]  (Warmup)
## Chain 4: Iteration:  400 / 4000 [ 10%]  (Warmup)
## Chain 4: Iteration:  800 / 4000 [ 20%]  (Warmup)
## Chain 4: Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Chain 4: Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Chain 4: Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Chain 4: Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Chain 4: Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Chain 4: Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Chain 4: Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Chain 4: Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Chain 4: Iteration: 4000 / 4000 [100%]  (Sampling)
## Chain 4: 
## Chain 4:  Elapsed Time: 0.23273 seconds (Warm-up)
## Chain 4:                0.202543 seconds (Sampling)
## Chain 4:                0.435273 seconds (Total)
## Chain 4:</code></pre>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="chapter-11-god-spiked-the-integers.html#cb310-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-2"><a href="chapter-11-god-spiked-the-integers.html#cb310-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Precis where we include department</span></span>
<span id="cb310-3"><a href="chapter-11-god-spiked-the-integers.html#cb310-3" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>( m11<span class="fl">.8</span> , <span class="at">depth=</span><span class="dv">2</span> )</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.5060728</td>
</tr>
<tr class="even">
<td align="right">-0.4090259</td>
</tr>
<tr class="odd">
<td align="right">1.0871730</td>
</tr>
<tr class="even">
<td align="right">1.0420536</td>
</tr>
<tr class="odd">
<td align="right">-0.1738616</td>
</tr>
<tr class="even">
<td align="right">-0.2056515</td>
</tr>
<tr class="odd">
<td align="right">-0.6477765</td>
</tr>
<tr class="even">
<td align="right">-2.2064013</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.5231841</td>
</tr>
<tr class="even">
<td align="right">0.5232166</td>
</tr>
<tr class="odd">
<td align="right">0.5252742</td>
</tr>
<tr class="even">
<td align="right">0.5288346</td>
</tr>
<tr class="odd">
<td align="right">0.5259279</td>
</tr>
<tr class="even">
<td align="right">0.5257558</td>
</tr>
<tr class="odd">
<td align="right">0.5272430</td>
</tr>
<tr class="even">
<td align="right">0.5367216</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-1.3076943</td>
</tr>
<tr class="even">
<td align="right">-1.2178163</td>
</tr>
<tr class="odd">
<td align="right">0.2083305</td>
</tr>
<tr class="even">
<td align="right">0.1580663</td>
</tr>
<tr class="odd">
<td align="right">-1.0557751</td>
</tr>
<tr class="even">
<td align="right">-1.0891502</td>
</tr>
<tr class="odd">
<td align="right">-1.5475111</td>
</tr>
<tr class="even">
<td align="right">-3.1120745</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3726761</td>
</tr>
<tr class="even">
<td align="right">0.4696824</td>
</tr>
<tr class="odd">
<td align="right">1.8919884</td>
</tr>
<tr class="even">
<td align="right">1.8625786</td>
</tr>
<tr class="odd">
<td align="right">0.6327715</td>
</tr>
<tr class="even">
<td align="right">0.6031325</td>
</tr>
<tr class="odd">
<td align="right">0.1757279</td>
</tr>
<tr class="even">
<td align="right">-1.3620805</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">568.2421</td>
</tr>
<tr class="even">
<td align="right">566.8179</td>
</tr>
<tr class="odd">
<td align="right">571.2311</td>
</tr>
<tr class="even">
<td align="right">581.8204</td>
</tr>
<tr class="odd">
<td align="right">568.1861</td>
</tr>
<tr class="even">
<td align="right">576.9245</td>
</tr>
<tr class="odd">
<td align="right">566.3875</td>
</tr>
<tr class="even">
<td align="right">584.7413</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1.014264</td>
</tr>
<tr class="even">
<td align="right">1.014132</td>
</tr>
<tr class="odd">
<td align="right">1.014131</td>
</tr>
<tr class="even">
<td align="right">1.014501</td>
</tr>
<tr class="odd">
<td align="right">1.014180</td>
</tr>
<tr class="even">
<td align="right">1.013421</td>
</tr>
<tr class="odd">
<td align="right">1.014135</td>
</tr>
<tr class="even">
<td align="right">1.014613</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>First of all we see that the means are very similar now (to each other, male is lower), where the model also accounts for each department. And we also see that each department is very different in the effect that it has on acceptance rate.</p>
<p>We also see that some department (most) tend to admit more females than males, by looking within each department.</p>
<p>Now we can estimate the differences as before:</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="chapter-11-god-spiked-the-integers.html#cb311-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m11<span class="fl">.8</span>)</span>
<span id="cb311-2"><a href="chapter-11-god-spiked-the-integers.html#cb311-2" aria-hidden="true" tabindex="-1"></a>diff_a <span class="ot">&lt;-</span> post<span class="sc">$</span>a[,<span class="dv">1</span>] <span class="sc">-</span> post<span class="sc">$</span>a[,<span class="dv">2</span>] <span class="co">#on the relative scale</span></span>
<span id="cb311-3"><a href="chapter-11-god-spiked-the-integers.html#cb311-3" aria-hidden="true" tabindex="-1"></a>diff_p <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(post<span class="sc">$</span>a[,<span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">inv_logit</span>(post<span class="sc">$</span>a[,<span class="dv">2</span>]) <span class="co">#on the absolute scale (probability scale)</span></span>
<span id="cb311-4"><a href="chapter-11-god-spiked-the-integers.html#cb311-4" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>( <span class="fu">list</span>( <span class="at">diff_a=</span>diff_a , <span class="at">diff_p=</span>diff_p ) )</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.0970469</td>
</tr>
<tr class="even">
<td align="right">-0.0217861</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0805260</td>
</tr>
<tr class="even">
<td align="right">0.0184385</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.2242904</td>
</tr>
<tr class="even">
<td align="right">-0.0516160</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0314741</td>
</tr>
<tr class="even">
<td align="right">0.0069762</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="left">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">▁▁▁▁▂▅▇▇▅▂▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">▁▁▂▇▇▂▁▁</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>We see that on average the difference is -0.1 and the intervals are mostly negative. On the probability scale, we see that there is a negative difference, hence a small disadvantage for males. Although we see that the probability difference is very close to zero, it is likely that the difference between males and females is very small.</p>
<p>We see that the difference is much smaller now where we account for the department which is a mediator effect that we see in the DAG in the beginning for the section.</p>
</div>
</div>
<div id="poisson-regression" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Poisson Regression</h2>
<p>Sometimes there will be an exponential effect in the data. This we will not be able to model using a binomial approach, hence we need the poisson distribution. It looks the following:</p>
<p><span class="math display">\[
y_i \sim Poisson(\lambda)
\]</span></p>
<p>Where lambda is the expected value of outomce y, i.e., expected variance of the counts y.</p>
<p>When going for poisson regression one will typically also go for the <strong>log link</strong> function, which is a new link function, it looks the following</p>
<p><span class="math display">\[
y_i \sim Poisson(\lambda_i)
\]</span></p>
<p><span class="math display">\[
log(\lambda_i)= \alpha + \beta(x_i-\bar{x})
\]</span></p>
<p>The log link ensures that <span class="math inline">\(\lambda_i\)</span> is always positive.</p>
<div id="negative-binomial-gamma-poisson-models." class="section level4" number="11.2.0.1">
<h4><span class="header-section-number">11.2.0.1</span> Negative binomial (gamma-poisson) models.</h4>
<p>It is common practice for some reason to swap the Poisson distribution with a negative binomial distribution, also sometimes called a gamma-poisson distribution. It is basically a mixture of different poisson distributions.</p>
</div>
</div>
<div id="multinomial-regression" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> Multinomial Regression</h2>
<p>In a binomial setting you will have two different outcomes, although that is not always the case, hence you must apply models that can take on multiple categories.</p>
<p>Such models are called multinomial regression. The output is a multinomial logit, i.e., the softmax.</p>
<p>They present some different approaches also in stan. I will not replicate the stan code.</p>
<p>The example is with admission rates for UC Berkely.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="chapter-11-god-spiked-the-integers.html#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="co"># binomial model of overall admission probability</span></span>
<span id="cb312-2"><a href="chapter-11-god-spiked-the-integers.html#cb312-2" aria-hidden="true" tabindex="-1"></a>m_binom <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb312-3"><a href="chapter-11-god-spiked-the-integers.html#cb312-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb312-4"><a href="chapter-11-god-spiked-the-integers.html#cb312-4" aria-hidden="true" tabindex="-1"></a>    admit <span class="sc">~</span> <span class="fu">dbinom</span>(applications,p),</span>
<span id="cb312-5"><a href="chapter-11-god-spiked-the-integers.html#cb312-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> a,</span>
<span id="cb312-6"><a href="chapter-11-god-spiked-the-integers.html#cb312-6" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">1.5</span> )</span>
<span id="cb312-7"><a href="chapter-11-god-spiked-the-integers.html#cb312-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb312-8"><a href="chapter-11-god-spiked-the-integers.html#cb312-8" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data=</span>d )</span>
<span id="cb312-9"><a href="chapter-11-god-spiked-the-integers.html#cb312-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-10"><a href="chapter-11-god-spiked-the-integers.html#cb312-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Poisson model of overall admission rate and rejection rate</span></span>
<span id="cb312-11"><a href="chapter-11-god-spiked-the-integers.html#cb312-11" aria-hidden="true" tabindex="-1"></a><span class="co"># &#39;reject&#39; is a reserved word in Stan, cannot use as variable name</span></span>
<span id="cb312-12"><a href="chapter-11-god-spiked-the-integers.html#cb312-12" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">admit=</span>d<span class="sc">$</span>admit , <span class="at">rej=</span>d<span class="sc">$</span>reject )</span>
<span id="cb312-13"><a href="chapter-11-god-spiked-the-integers.html#cb312-13" aria-hidden="true" tabindex="-1"></a>m_pois <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb312-14"><a href="chapter-11-god-spiked-the-integers.html#cb312-14" aria-hidden="true" tabindex="-1"></a><span class="fu">alist</span>(</span>
<span id="cb312-15"><a href="chapter-11-god-spiked-the-integers.html#cb312-15" aria-hidden="true" tabindex="-1"></a>    admit <span class="sc">~</span> <span class="fu">dpois</span>(lambda1),</span>
<span id="cb312-16"><a href="chapter-11-god-spiked-the-integers.html#cb312-16" aria-hidden="true" tabindex="-1"></a>    rej <span class="sc">~</span> <span class="fu">dpois</span>(lambda2),</span>
<span id="cb312-17"><a href="chapter-11-god-spiked-the-integers.html#cb312-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(lambda1) <span class="ot">&lt;-</span> a1,</span>
<span id="cb312-18"><a href="chapter-11-god-spiked-the-integers.html#cb312-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(lambda2) <span class="ot">&lt;-</span> a2,</span>
<span id="cb312-19"><a href="chapter-11-god-spiked-the-integers.html#cb312-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(a1,a2) <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">1.5</span>)</span>
<span id="cb312-20"><a href="chapter-11-god-spiked-the-integers.html#cb312-20" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">data=</span>dat , <span class="at">chains=</span><span class="dv">3</span> , <span class="at">cores=</span><span class="dv">3</span> )</span></code></pre></div>
<pre><code>## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c
## clang -I&quot;/Library/Frameworks/R.framework/Resources/include&quot; -DNDEBUG   -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/Rcpp/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/unsupported&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/BH/include&quot; -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/src/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppParallel/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/rstan/include&quot; -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include &#39;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp&#39;  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:88:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name &#39;namespace&#39;
## namespace Eigen {
## ^
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected &#39;;&#39; after top level declarator
## namespace Eigen {
##                ^
##                ;
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:96:10: fatal error: &#39;complex&#39; file not found
## #include &lt;complex&gt;
##          ^~~~~~~~~
## 3 errors generated.
## make: *** [foo.o] Error 1</code></pre>
<p>binomial probability of admission across the entire data set.</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="chapter-11-god-spiked-the-integers.html#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Binomial model inference</span></span>
<span id="cb314-2"><a href="chapter-11-god-spiked-the-integers.html#cb314-2" aria-hidden="true" tabindex="-1"></a><span class="fu">inv_logit</span>(<span class="fu">coef</span>(m_binom))</span></code></pre></div>
<pre><code>##         a 
## 0.3878044</code></pre>
<p>We see the probability of a female being accepted is 38%.</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="chapter-11-god-spiked-the-integers.html#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="co">#log odds for binomial model</span></span>
<span id="cb316-2"><a href="chapter-11-god-spiked-the-integers.html#cb316-2" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m_binom)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.4565506</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0305001</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.5052957</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.4078055</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>We can see the same for the poisson model:</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="chapter-11-god-spiked-the-integers.html#cb317-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">coef</span>(m_pois)</span>
<span id="cb317-2"><a href="chapter-11-god-spiked-the-integers.html#cb317-2" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> k[<span class="st">&#39;a1&#39;</span>]</span>
<span id="cb317-3"><a href="chapter-11-god-spiked-the-integers.html#cb317-3" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> k[<span class="st">&#39;a2&#39;</span>]</span>
<span id="cb317-4"><a href="chapter-11-god-spiked-the-integers.html#cb317-4" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(a1)<span class="sc">/</span>(<span class="fu">exp</span>(a1)<span class="sc">+</span><span class="fu">exp</span>(a2))</span></code></pre></div>
<pre><code>##        a1 
## 0.3873817</code></pre>
<p>We see that the result is very similar.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="chapter-11-god-spiked-the-integers.html#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="co">#log-rate for the poisson</span></span>
<span id="cb319-2"><a href="chapter-11-god-spiked-the-integers.html#cb319-2" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m_pois)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.440725</td>
</tr>
<tr class="even">
<td align="right">4.982394</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0190694</td>
</tr>
<tr class="even">
<td align="right">0.0238711</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.409933</td>
</tr>
<tr class="even">
<td align="right">4.945237</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.470396</td>
</tr>
<tr class="even">
<td align="right">5.020236</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1010.0855</td>
</tr>
<tr class="even">
<td align="right">876.8744</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.9996939</td>
</tr>
<tr class="even">
<td align="right">0.9985171</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<div id="example-from-the-lecture-1" class="section level3" number="11.3.1">
<h3><span class="header-section-number">11.3.1</span> Example from the lecture</h3>
<p>Relationship between tools, population and contact with the world.</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="chapter-11-god-spiked-the-integers.html#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb320-2"><a href="chapter-11-god-spiked-the-integers.html#cb320-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Kline)</span>
<span id="cb320-3"><a href="chapter-11-god-spiked-the-integers.html#cb320-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> Kline</span>
<span id="cb320-4"><a href="chapter-11-god-spiked-the-integers.html#cb320-4" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>P <span class="ot">&lt;-</span> <span class="fu">scale</span>( <span class="fu">log</span>(d<span class="sc">$</span>population) )</span>
<span id="cb320-5"><a href="chapter-11-god-spiked-the-integers.html#cb320-5" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>contact_id <span class="ot">&lt;-</span> <span class="fu">ifelse</span>( d<span class="sc">$</span>contact<span class="sc">==</span><span class="st">&quot;high&quot;</span> , <span class="dv">2</span> , <span class="dv">1</span> )</span></code></pre></div>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="chapter-11-god-spiked-the-integers.html#cb321-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb321-2"><a href="chapter-11-god-spiked-the-integers.html#cb321-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">T1 =</span> d<span class="sc">$</span>total_tools , <span class="co">#I named it T1, as T is reserved for TRUE</span></span>
<span id="cb321-3"><a href="chapter-11-god-spiked-the-integers.html#cb321-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">P =</span> d<span class="sc">$</span>P ,</span>
<span id="cb321-4"><a href="chapter-11-god-spiked-the-integers.html#cb321-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cid =</span> d<span class="sc">$</span>contact_id </span>
<span id="cb321-5"><a href="chapter-11-god-spiked-the-integers.html#cb321-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb321-6"><a href="chapter-11-god-spiked-the-integers.html#cb321-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-7"><a href="chapter-11-god-spiked-the-integers.html#cb321-7" aria-hidden="true" tabindex="-1"></a><span class="co"># intercept only</span></span>
<span id="cb321-8"><a href="chapter-11-god-spiked-the-integers.html#cb321-8" aria-hidden="true" tabindex="-1"></a>m11<span class="fl">.9</span> <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb321-9"><a href="chapter-11-god-spiked-the-integers.html#cb321-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb321-10"><a href="chapter-11-god-spiked-the-integers.html#cb321-10" aria-hidden="true" tabindex="-1"></a>    T1 <span class="sc">~</span> <span class="fu">dpois</span>( lambda ),</span>
<span id="cb321-11"><a href="chapter-11-god-spiked-the-integers.html#cb321-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(lambda) <span class="ot">&lt;-</span> a,</span>
<span id="cb321-12"><a href="chapter-11-god-spiked-the-integers.html#cb321-12" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">3</span>,<span class="fl">0.5</span>)</span>
<span id="cb321-13"><a href="chapter-11-god-spiked-the-integers.html#cb321-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb321-14"><a href="chapter-11-god-spiked-the-integers.html#cb321-14" aria-hidden="true" tabindex="-1"></a>  , <span class="at">data=</span>dat , <span class="at">chains=</span><span class="dv">4</span> , <span class="at">log_lik=</span><span class="cn">TRUE</span> ) <span class="co">#Log like to be able to compare</span></span></code></pre></div>
<pre><code>## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c
## clang -I&quot;/Library/Frameworks/R.framework/Resources/include&quot; -DNDEBUG   -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/Rcpp/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/unsupported&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/BH/include&quot; -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/src/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppParallel/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/rstan/include&quot; -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include &#39;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp&#39;  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:88:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name &#39;namespace&#39;
## namespace Eigen {
## ^
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected &#39;;&#39; after top level declarator
## namespace Eigen {
##                ^
##                ;
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:96:10: fatal error: &#39;complex&#39; file not found
## #include &lt;complex&gt;
##          ^~~~~~~~~
## 3 errors generated.
## make: *** [foo.o] Error 1
## 
## SAMPLING FOR MODEL &#39;2a800616debdca1af3c840a8294e1e8c&#39; NOW (CHAIN 1).
## Chain 1: 
## Chain 1: Gradient evaluation took 1.3e-05 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.13 seconds.
## Chain 1: Adjust your expectations accordingly!
## Chain 1: 
## Chain 1: 
## Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 1: 
## Chain 1:  Elapsed Time: 0.004454 seconds (Warm-up)
## Chain 1:                0.003966 seconds (Sampling)
## Chain 1:                0.00842 seconds (Total)
## Chain 1: 
## 
## SAMPLING FOR MODEL &#39;2a800616debdca1af3c840a8294e1e8c&#39; NOW (CHAIN 2).
## Chain 2: 
## Chain 2: Gradient evaluation took 3e-06 seconds
## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.03 seconds.
## Chain 2: Adjust your expectations accordingly!
## Chain 2: 
## Chain 2: 
## Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 2: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 2: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 2: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 2: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 2: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 2: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 2: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 2: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 2: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 2: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 2: 
## Chain 2:  Elapsed Time: 0.004398 seconds (Warm-up)
## Chain 2:                0.004419 seconds (Sampling)
## Chain 2:                0.008817 seconds (Total)
## Chain 2: 
## 
## SAMPLING FOR MODEL &#39;2a800616debdca1af3c840a8294e1e8c&#39; NOW (CHAIN 3).
## Chain 3: 
## Chain 3: Gradient evaluation took 5e-06 seconds
## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.05 seconds.
## Chain 3: Adjust your expectations accordingly!
## Chain 3: 
## Chain 3: 
## Chain 3: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 3: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 3: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 3: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 3: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 3: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 3: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 3: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 3: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 3: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 3: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 3: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 3: 
## Chain 3:  Elapsed Time: 0.00447 seconds (Warm-up)
## Chain 3:                0.004279 seconds (Sampling)
## Chain 3:                0.008749 seconds (Total)
## Chain 3: 
## 
## SAMPLING FOR MODEL &#39;2a800616debdca1af3c840a8294e1e8c&#39; NOW (CHAIN 4).
## Chain 4: 
## Chain 4: Gradient evaluation took 5e-06 seconds
## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.05 seconds.
## Chain 4: Adjust your expectations accordingly!
## Chain 4: 
## Chain 4: 
## Chain 4: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 4: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 4: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 4: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 4: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 4: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 4: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 4: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 4: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 4: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 4: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 4: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 4: 
## Chain 4:  Elapsed Time: 0.004612 seconds (Warm-up)
## Chain 4:                0.004322 seconds (Sampling)
## Chain 4:                0.008934 seconds (Total)
## Chain 4:</code></pre>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="chapter-11-god-spiked-the-integers.html#cb323-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-2"><a href="chapter-11-god-spiked-the-integers.html#cb323-2" aria-hidden="true" tabindex="-1"></a><span class="co"># interaction model</span></span>
<span id="cb323-3"><a href="chapter-11-god-spiked-the-integers.html#cb323-3" aria-hidden="true" tabindex="-1"></a>m11<span class="fl">.10</span> <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb323-4"><a href="chapter-11-god-spiked-the-integers.html#cb323-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb323-5"><a href="chapter-11-god-spiked-the-integers.html#cb323-5" aria-hidden="true" tabindex="-1"></a>    T1 <span class="sc">~</span> <span class="fu">dpois</span>( lambda ),</span>
<span id="cb323-6"><a href="chapter-11-god-spiked-the-integers.html#cb323-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(lambda) <span class="ot">&lt;-</span> a[cid] <span class="sc">+</span> b[cid]<span class="sc">*</span>P,</span>
<span id="cb323-7"><a href="chapter-11-god-spiked-the-integers.html#cb323-7" aria-hidden="true" tabindex="-1"></a>    a[cid] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">3</span> , <span class="fl">0.5</span> ),</span>
<span id="cb323-8"><a href="chapter-11-god-spiked-the-integers.html#cb323-8" aria-hidden="true" tabindex="-1"></a>    b[cid] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.2</span> )</span>
<span id="cb323-9"><a href="chapter-11-god-spiked-the-integers.html#cb323-9" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">data=</span>dat , <span class="at">chains=</span><span class="dv">4</span> , <span class="at">log_lik=</span><span class="cn">TRUE</span> ) <span class="co">#Log like to be able to compare</span></span></code></pre></div>
<pre><code>## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c
## clang -I&quot;/Library/Frameworks/R.framework/Resources/include&quot; -DNDEBUG   -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/Rcpp/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/unsupported&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/BH/include&quot; -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/src/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppParallel/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/rstan/include&quot; -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include &#39;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp&#39;  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:88:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name &#39;namespace&#39;
## namespace Eigen {
## ^
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected &#39;;&#39; after top level declarator
## namespace Eigen {
##                ^
##                ;
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:96:10: fatal error: &#39;complex&#39; file not found
## #include &lt;complex&gt;
##          ^~~~~~~~~
## 3 errors generated.
## make: *** [foo.o] Error 1
## 
## SAMPLING FOR MODEL &#39;5aa61820e8e2a3b5e20709d24f8ee9f2&#39; NOW (CHAIN 1).
## Chain 1: 
## Chain 1: Gradient evaluation took 1.8e-05 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.18 seconds.
## Chain 1: Adjust your expectations accordingly!
## Chain 1: 
## Chain 1: 
## Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 1: 
## Chain 1:  Elapsed Time: 0.013768 seconds (Warm-up)
## Chain 1:                0.012059 seconds (Sampling)
## Chain 1:                0.025827 seconds (Total)
## Chain 1: 
## 
## SAMPLING FOR MODEL &#39;5aa61820e8e2a3b5e20709d24f8ee9f2&#39; NOW (CHAIN 2).
## Chain 2: 
## Chain 2: Gradient evaluation took 5e-06 seconds
## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.05 seconds.
## Chain 2: Adjust your expectations accordingly!
## Chain 2: 
## Chain 2: 
## Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 2: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 2: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 2: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 2: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 2: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 2: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 2: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 2: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 2: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 2: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 2: 
## Chain 2:  Elapsed Time: 0.015038 seconds (Warm-up)
## Chain 2:                0.013223 seconds (Sampling)
## Chain 2:                0.028261 seconds (Total)
## Chain 2: 
## 
## SAMPLING FOR MODEL &#39;5aa61820e8e2a3b5e20709d24f8ee9f2&#39; NOW (CHAIN 3).
## Chain 3: 
## Chain 3: Gradient evaluation took 6e-06 seconds
## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.06 seconds.
## Chain 3: Adjust your expectations accordingly!
## Chain 3: 
## Chain 3: 
## Chain 3: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 3: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 3: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 3: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 3: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 3: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 3: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 3: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 3: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 3: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 3: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 3: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 3: 
## Chain 3:  Elapsed Time: 0.014641 seconds (Warm-up)
## Chain 3:                0.011745 seconds (Sampling)
## Chain 3:                0.026386 seconds (Total)
## Chain 3: 
## 
## SAMPLING FOR MODEL &#39;5aa61820e8e2a3b5e20709d24f8ee9f2&#39; NOW (CHAIN 4).
## Chain 4: 
## Chain 4: Gradient evaluation took 6e-06 seconds
## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.06 seconds.
## Chain 4: Adjust your expectations accordingly!
## Chain 4: 
## Chain 4: 
## Chain 4: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 4: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 4: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 4: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 4: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 4: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 4: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 4: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 4: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 4: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 4: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 4: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 4: 
## Chain 4:  Elapsed Time: 0.015284 seconds (Warm-up)
## Chain 4:                0.011617 seconds (Sampling)
## Chain 4:                0.026901 seconds (Total)
## Chain 4:</code></pre>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="chapter-11-god-spiked-the-integers.html#cb325-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-2"><a href="chapter-11-god-spiked-the-integers.html#cb325-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Lets compare these, pLOO = effective number of parameters</span></span>
<span id="cb325-3"><a href="chapter-11-god-spiked-the-integers.html#cb325-3" aria-hidden="true" tabindex="-1"></a><span class="co">#compare( m11.9 , m11.10 , func=PSIS )</span></span>
<span id="cb325-4"><a href="chapter-11-god-spiked-the-integers.html#cb325-4" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>( m11<span class="fl">.9</span> , m11<span class="fl">.10</span> , <span class="at">func=</span>LOO ) <span class="co">#Should return the pLOO</span></span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">85.20857</td>
</tr>
<tr class="even">
<td align="right">142.17720</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">13.20423</td>
</tr>
<tr class="even">
<td align="right">33.67112</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.00000</td>
</tr>
<tr class="even">
<td align="right">56.96863</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">33.50932</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">6.939991</td>
</tr>
<tr class="even">
<td align="right">8.802057</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">0</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>We see from this model, that the effective number of parameters (pLOO), hence the intuitively more complicated model is less prone to overfitting, due to the lower effective number of parameters.</p>
<p>The following plots represent the posterior predictions</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="chapter-11-god-spiked-the-integers.html#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb326-2"><a href="chapter-11-god-spiked-the-integers.html#cb326-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">PSIS</span>( m11<span class="fl">.10</span> , <span class="at">pointwise=</span><span class="cn">TRUE</span> )<span class="sc">$</span>k</span>
<span id="cb326-3"><a href="chapter-11-god-spiked-the-integers.html#cb326-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-4"><a href="chapter-11-god-spiked-the-integers.html#cb326-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( dat<span class="sc">$</span>P , dat<span class="sc">$</span>T , <span class="at">xlab=</span><span class="st">&quot;log population (std)&quot;</span> , <span class="at">ylab=</span><span class="st">&quot;total tools&quot;</span> ,</span>
<span id="cb326-5"><a href="chapter-11-god-spiked-the-integers.html#cb326-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">col=</span>rangi2 , <span class="at">pch=</span><span class="fu">ifelse</span>( dat<span class="sc">$</span>cid<span class="sc">==</span><span class="dv">1</span> , <span class="dv">1</span> , <span class="dv">16</span> ) , <span class="at">lwd=</span><span class="dv">2</span> ,</span>
<span id="cb326-6"><a href="chapter-11-god-spiked-the-integers.html#cb326-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">75</span>) , <span class="at">cex=</span><span class="dv">1</span><span class="sc">+</span><span class="fu">normalize</span>(k)</span>
<span id="cb326-7"><a href="chapter-11-god-spiked-the-integers.html#cb326-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb326-8"><a href="chapter-11-god-spiked-the-integers.html#cb326-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-9"><a href="chapter-11-god-spiked-the-integers.html#cb326-9" aria-hidden="true" tabindex="-1"></a><span class="co"># set up the horizontal axis values to compute predictions at</span></span>
<span id="cb326-10"><a href="chapter-11-god-spiked-the-integers.html#cb326-10" aria-hidden="true" tabindex="-1"></a>ns <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb326-11"><a href="chapter-11-god-spiked-the-integers.html#cb326-11" aria-hidden="true" tabindex="-1"></a>P_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from=</span><span class="sc">-</span><span class="fl">1.4</span> , <span class="at">to=</span><span class="dv">3</span> , <span class="at">length.out=</span>ns )</span>
<span id="cb326-12"><a href="chapter-11-god-spiked-the-integers.html#cb326-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-13"><a href="chapter-11-god-spiked-the-integers.html#cb326-13" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions for cid=1 (low contact)</span></span>
<span id="cb326-14"><a href="chapter-11-god-spiked-the-integers.html#cb326-14" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">link</span>( m11<span class="fl">.10</span> , <span class="at">data=</span><span class="fu">data.frame</span>( <span class="at">P=</span>P_seq , <span class="at">cid=</span><span class="dv">1</span> ) )</span>
<span id="cb326-15"><a href="chapter-11-god-spiked-the-integers.html#cb326-15" aria-hidden="true" tabindex="-1"></a>lmu <span class="ot">&lt;-</span> <span class="fu">apply</span>( lambda , <span class="dv">2</span> , mean )</span>
<span id="cb326-16"><a href="chapter-11-god-spiked-the-integers.html#cb326-16" aria-hidden="true" tabindex="-1"></a>lci <span class="ot">&lt;-</span> <span class="fu">apply</span>( lambda , <span class="dv">2</span> , PI )</span>
<span id="cb326-17"><a href="chapter-11-god-spiked-the-integers.html#cb326-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( P_seq , lmu , <span class="at">lty=</span><span class="dv">2</span> , <span class="at">lwd=</span><span class="fl">1.5</span> )</span>
<span id="cb326-18"><a href="chapter-11-god-spiked-the-integers.html#cb326-18" aria-hidden="true" tabindex="-1"></a><span class="fu">shade</span>( lci , P_seq , <span class="at">xpd=</span><span class="cn">TRUE</span> )</span>
<span id="cb326-19"><a href="chapter-11-god-spiked-the-integers.html#cb326-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-20"><a href="chapter-11-god-spiked-the-integers.html#cb326-20" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions for cid=2 (high contact)</span></span>
<span id="cb326-21"><a href="chapter-11-god-spiked-the-integers.html#cb326-21" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">link</span>( m11<span class="fl">.10</span> , <span class="at">data=</span><span class="fu">data.frame</span>( <span class="at">P=</span>P_seq , <span class="at">cid=</span><span class="dv">2</span> ) )</span>
<span id="cb326-22"><a href="chapter-11-god-spiked-the-integers.html#cb326-22" aria-hidden="true" tabindex="-1"></a>lmu <span class="ot">&lt;-</span> <span class="fu">apply</span>( lambda , <span class="dv">2</span> , mean )</span>
<span id="cb326-23"><a href="chapter-11-god-spiked-the-integers.html#cb326-23" aria-hidden="true" tabindex="-1"></a>lci <span class="ot">&lt;-</span> <span class="fu">apply</span>( lambda , <span class="dv">2</span> , PI )</span>
<span id="cb326-24"><a href="chapter-11-god-spiked-the-integers.html#cb326-24" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( P_seq , lmu , <span class="at">lty=</span><span class="dv">1</span> , <span class="at">lwd=</span><span class="fl">1.5</span> )</span>
<span id="cb326-25"><a href="chapter-11-god-spiked-the-integers.html#cb326-25" aria-hidden="true" tabindex="-1"></a><span class="fu">shade</span>( lci , P_seq , <span class="at">xpd=</span><span class="cn">TRUE</span> )</span>
<span id="cb326-26"><a href="chapter-11-god-spiked-the-integers.html#cb326-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-27"><a href="chapter-11-god-spiked-the-integers.html#cb326-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-28"><a href="chapter-11-god-spiked-the-integers.html#cb326-28" aria-hidden="true" tabindex="-1"></a><span class="co"># code chunk 11.48</span></span>
<span id="cb326-29"><a href="chapter-11-god-spiked-the-integers.html#cb326-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( d<span class="sc">$</span>population , d<span class="sc">$</span>total_tools , <span class="at">xlab=</span><span class="st">&quot;population&quot;</span> , <span class="at">ylab=</span><span class="st">&quot;total tools&quot;</span> ,</span>
<span id="cb326-30"><a href="chapter-11-god-spiked-the-integers.html#cb326-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">col=</span>rangi2 , <span class="at">pch=</span><span class="fu">ifelse</span>( dat<span class="sc">$</span>cid<span class="sc">==</span><span class="dv">1</span> , <span class="dv">1</span> , <span class="dv">16</span> ) , <span class="at">lwd=</span><span class="dv">2</span> ,</span>
<span id="cb326-31"><a href="chapter-11-god-spiked-the-integers.html#cb326-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">75</span>) , <span class="at">cex=</span><span class="dv">1</span><span class="sc">+</span><span class="fu">normalize</span>(k))</span>
<span id="cb326-32"><a href="chapter-11-god-spiked-the-integers.html#cb326-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-33"><a href="chapter-11-god-spiked-the-integers.html#cb326-33" aria-hidden="true" tabindex="-1"></a>ns <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb326-34"><a href="chapter-11-god-spiked-the-integers.html#cb326-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-35"><a href="chapter-11-god-spiked-the-integers.html#cb326-35" aria-hidden="true" tabindex="-1"></a>P_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from=</span><span class="sc">-</span><span class="dv">5</span> , <span class="at">to=</span><span class="dv">3</span> , <span class="at">length.out=</span>ns )</span>
<span id="cb326-36"><a href="chapter-11-god-spiked-the-integers.html#cb326-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.53 is sd of log(population)</span></span>
<span id="cb326-37"><a href="chapter-11-god-spiked-the-integers.html#cb326-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-38"><a href="chapter-11-god-spiked-the-integers.html#cb326-38" aria-hidden="true" tabindex="-1"></a><span class="co"># 9 is mean of log(population)</span></span>
<span id="cb326-39"><a href="chapter-11-god-spiked-the-integers.html#cb326-39" aria-hidden="true" tabindex="-1"></a>pop_seq <span class="ot">&lt;-</span> <span class="fu">exp</span>( P_seq<span class="sc">*</span><span class="fl">1.53</span> <span class="sc">+</span> <span class="dv">9</span> )</span>
<span id="cb326-40"><a href="chapter-11-god-spiked-the-integers.html#cb326-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-41"><a href="chapter-11-god-spiked-the-integers.html#cb326-41" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">link</span>( m11<span class="fl">.10</span> , <span class="at">data=</span><span class="fu">data.frame</span>( <span class="at">P=</span>P_seq , <span class="at">cid=</span><span class="dv">1</span> ) )</span>
<span id="cb326-42"><a href="chapter-11-god-spiked-the-integers.html#cb326-42" aria-hidden="true" tabindex="-1"></a>lmu <span class="ot">&lt;-</span> <span class="fu">apply</span>( lambda , <span class="dv">2</span> , mean )</span>
<span id="cb326-43"><a href="chapter-11-god-spiked-the-integers.html#cb326-43" aria-hidden="true" tabindex="-1"></a>lci <span class="ot">&lt;-</span> <span class="fu">apply</span>( lambda , <span class="dv">2</span> , PI )</span>
<span id="cb326-44"><a href="chapter-11-god-spiked-the-integers.html#cb326-44" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( pop_seq , lmu , <span class="at">lty=</span><span class="dv">2</span> , <span class="at">lwd=</span><span class="fl">1.5</span> )</span>
<span id="cb326-45"><a href="chapter-11-god-spiked-the-integers.html#cb326-45" aria-hidden="true" tabindex="-1"></a><span class="fu">shade</span>( lci , pop_seq , <span class="at">xpd=</span><span class="cn">TRUE</span> )</span>
<span id="cb326-46"><a href="chapter-11-god-spiked-the-integers.html#cb326-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-47"><a href="chapter-11-god-spiked-the-integers.html#cb326-47" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">link</span>( m11<span class="fl">.10</span> , <span class="at">data=</span><span class="fu">data.frame</span>( <span class="at">P=</span>P_seq , <span class="at">cid=</span><span class="dv">2</span> ) )</span>
<span id="cb326-48"><a href="chapter-11-god-spiked-the-integers.html#cb326-48" aria-hidden="true" tabindex="-1"></a>lmu <span class="ot">&lt;-</span> <span class="fu">apply</span>( lambda , <span class="dv">2</span> , mean )</span>
<span id="cb326-49"><a href="chapter-11-god-spiked-the-integers.html#cb326-49" aria-hidden="true" tabindex="-1"></a>lci <span class="ot">&lt;-</span> <span class="fu">apply</span>( lambda , <span class="dv">2</span> , PI )</span>
<span id="cb326-50"><a href="chapter-11-god-spiked-the-integers.html#cb326-50" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( pop_seq , lmu , <span class="at">lty=</span><span class="dv">1</span> , <span class="at">lwd=</span><span class="fl">1.5</span> )</span>
<span id="cb326-51"><a href="chapter-11-god-spiked-the-integers.html#cb326-51" aria-hidden="true" tabindex="-1"></a><span class="fu">shade</span>( lci , pop_seq , <span class="at">xpd=</span><span class="cn">TRUE</span> )</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="Bayesian-Data-Analysis-Notes_files/figure-html/11.47_48-1.png" alt="Dashed = low contact and solid line = high contact" width="720" />
<p class="caption">
(#fig:11.47_48)Dashed = low contact and solid line = high contact
</p>
</div>
</div>
</div>
<div id="exercies-1" class="section level2" number="11.4">
<h2><span class="header-section-number">11.4</span> Exercies</h2>
<div id="e1" class="section level3" number="11.4.1">
<h3><span class="header-section-number">11.4.1</span> E1</h3>
<p>If an event has probability of 0.35, what are the log-odds of this event?</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="chapter-11-god-spiked-the-integers.html#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="co">#find log odds (logit) based on the probability</span></span>
<span id="cb327-2"><a href="chapter-11-god-spiked-the-integers.html#cb327-2" aria-hidden="true" tabindex="-1"></a><span class="fu">logit</span>(<span class="at">x =</span> <span class="fl">0.35</span>) <span class="co"># - 0.61</span></span></code></pre></div>
<pre><code>## [1] -0.6190392</code></pre>
<p>We know that when odds = 0, then we have 50/50 probability, and odds higher / lower than 3/-3 equals very certain outcomes (5% / 95%).</p>
<p>This can also be calculated with:</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="chapter-11-god-spiked-the-integers.html#cb329-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fl">0.35</span> <span class="co">#recal that p = exp(alpha + beta * xi)/(exp(alpha + beta * xi)), where xi is one observation</span></span>
<span id="cb329-2"><a href="chapter-11-god-spiked-the-integers.html#cb329-2" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(p<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>p))</span></code></pre></div>
<pre><code>## [1] -0.6190392</code></pre>
</div>
<div id="e2" class="section level3" number="11.4.2">
<h3><span class="header-section-number">11.4.2</span> E2</h3>
<p>If an event has log-odds 3.2, what is the probability of this event?</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="chapter-11-god-spiked-the-integers.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co">#transform log-odds to a probability</span></span>
<span id="cb331-2"><a href="chapter-11-god-spiked-the-integers.html#cb331-2" aria-hidden="true" tabindex="-1"></a><span class="fu">logistic</span>(<span class="at">x =</span> <span class="fl">3.2</span>)</span></code></pre></div>
<pre><code>## [1] 0.9608343</code></pre>
<p>log-odds = logits</p>
<p>we can find the odds, by taking the exponential of the log-odds.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="chapter-11-god-spiked-the-integers.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fl">3.2</span>) <span class="co"># = 23.5</span></span></code></pre></div>
<pre><code>## [1] 24.53253</code></pre>
</div>
<div id="e3" class="section level3" number="11.4.3">
<h3><span class="header-section-number">11.4.3</span> E3</h3>
<p>Suppose that a coefficient in a logistic regression has value 1.7. What does that imply about the proportional change in odds of the outcome?</p>
<p>That means that by one unit change in x, the log-odds will increase by 1.7, thus if we are working with standardized x values, then one standard deviation of change in x, leads to 1.7 higher log-odds,</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="chapter-11-god-spiked-the-integers.html#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logistic</span>(<span class="fl">1.7</span>)</span></code></pre></div>
<pre><code>## [1] 0.8455347</code></pre>
<p>We see that 1.7 log odds is corresponding with:</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="chapter-11-god-spiked-the-integers.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fl">1.7</span>) <span class="co">#5.5</span></span></code></pre></div>
<pre><code>## [1] 5.473947</code></pre>
<p>That implies that there is a 5.5 greater chance of something happening, given a one unit change in x.</p>
</div>
<div id="m7" class="section level3" number="11.4.4">
<h3><span class="header-section-number">11.4.4</span> M7</h3>
<p>Use quap to construct a quadratic approximate posterior distribution for the chimpanzee model that includes a unique intercept for each actor, m11.4 (p. 330). Compare the quadratic approximation to the posterior distribution produced instead from MCMC. Can you explain both the differences and the similarities between the quadratic approximate and the MCMC distributions?</p>
<p>Relax the prior on the actor intercepts to normal(0,10). Re-estimate the posterior using both ulam and quap. Do the differences increase or decrease?</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="chapter-11-god-spiked-the-integers.html#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;chimpanzees&quot;</span>)</span>
<span id="cb339-2"><a href="chapter-11-god-spiked-the-integers.html#cb339-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> chimpanzees</span>
<span id="cb339-3"><a href="chapter-11-god-spiked-the-integers.html#cb339-3" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> d<span class="sc">$</span>prosoc_left <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>d<span class="sc">$</span>condition</span>
<span id="cb339-4"><a href="chapter-11-god-spiked-the-integers.html#cb339-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-5"><a href="chapter-11-god-spiked-the-integers.html#cb339-5" aria-hidden="true" tabindex="-1"></a><span class="co"># prior trimmed data list</span></span>
<span id="cb339-6"><a href="chapter-11-god-spiked-the-integers.html#cb339-6" aria-hidden="true" tabindex="-1"></a>dat_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb339-7"><a href="chapter-11-god-spiked-the-integers.html#cb339-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pulled_left =</span> d<span class="sc">$</span>pulled_left,</span>
<span id="cb339-8"><a href="chapter-11-god-spiked-the-integers.html#cb339-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">actor =</span> d<span class="sc">$</span>actor,</span>
<span id="cb339-9"><a href="chapter-11-god-spiked-the-integers.html#cb339-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">as.integer</span>(d<span class="sc">$</span>treatment) )</span>
<span id="cb339-10"><a href="chapter-11-god-spiked-the-integers.html#cb339-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-11"><a href="chapter-11-god-spiked-the-integers.html#cb339-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Constructing the model</span></span>
<span id="cb339-12"><a href="chapter-11-god-spiked-the-integers.html#cb339-12" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">alist</span>(</span>
<span id="cb339-13"><a href="chapter-11-god-spiked-the-integers.html#cb339-13" aria-hidden="true" tabindex="-1"></a>    pulled_left <span class="sc">~</span> <span class="fu">dbinom</span>( <span class="dv">1</span> , p ) , <span class="co"># = Logistic regression</span></span>
<span id="cb339-14"><a href="chapter-11-god-spiked-the-integers.html#cb339-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> a[actor] <span class="sc">+</span> b[treatment] , <span class="co">#actor = chimp, treatment = the experiment setup</span></span>
<span id="cb339-15"><a href="chapter-11-god-spiked-the-integers.html#cb339-15" aria-hidden="true" tabindex="-1"></a>    a[actor] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">1.5</span> ),</span>
<span id="cb339-16"><a href="chapter-11-god-spiked-the-integers.html#cb339-16" aria-hidden="true" tabindex="-1"></a>    b[treatment] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> )</span>
<span id="cb339-17"><a href="chapter-11-god-spiked-the-integers.html#cb339-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb339-18"><a href="chapter-11-god-spiked-the-integers.html#cb339-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-19"><a href="chapter-11-god-spiked-the-integers.html#cb339-19" aria-hidden="true" tabindex="-1"></a>m11<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">ulam</span>( <span class="co">#Estimating the posterior distribution using Hamiltonian Monte Carlo</span></span>
<span id="cb339-20"><a href="chapter-11-god-spiked-the-integers.html#cb339-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> model</span>
<span id="cb339-21"><a href="chapter-11-god-spiked-the-integers.html#cb339-21" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data=</span>dat_list , <span class="at">chains=</span><span class="dv">4</span> , <span class="at">log_lik=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c
## clang -I&quot;/Library/Frameworks/R.framework/Resources/include&quot; -DNDEBUG   -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/Rcpp/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/unsupported&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/BH/include&quot; -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/src/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppParallel/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/rstan/include&quot; -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include &#39;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp&#39;  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:88:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name &#39;namespace&#39;
## namespace Eigen {
## ^
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected &#39;;&#39; after top level declarator
## namespace Eigen {
##                ^
##                ;
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:96:10: fatal error: &#39;complex&#39; file not found
## #include &lt;complex&gt;
##          ^~~~~~~~~
## 3 errors generated.
## make: *** [foo.o] Error 1
## 
## SAMPLING FOR MODEL &#39;82480dff1a626a42c2ca9de938d65b9d&#39; NOW (CHAIN 1).
## Chain 1: 
## Chain 1: Gradient evaluation took 8.1e-05 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.81 seconds.
## Chain 1: Adjust your expectations accordingly!
## Chain 1: 
## Chain 1: 
## Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 1: 
## Chain 1:  Elapsed Time: 0.351952 seconds (Warm-up)
## Chain 1:                0.355928 seconds (Sampling)
## Chain 1:                0.70788 seconds (Total)
## Chain 1: 
## 
## SAMPLING FOR MODEL &#39;82480dff1a626a42c2ca9de938d65b9d&#39; NOW (CHAIN 2).
## Chain 2: 
## Chain 2: Gradient evaluation took 5.3e-05 seconds
## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.53 seconds.
## Chain 2: Adjust your expectations accordingly!
## Chain 2: 
## Chain 2: 
## Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 2: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 2: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 2: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 2: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 2: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 2: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 2: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 2: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 2: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 2: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 2: 
## Chain 2:  Elapsed Time: 0.324579 seconds (Warm-up)
## Chain 2:                0.275657 seconds (Sampling)
## Chain 2:                0.600236 seconds (Total)
## Chain 2: 
## 
## SAMPLING FOR MODEL &#39;82480dff1a626a42c2ca9de938d65b9d&#39; NOW (CHAIN 3).
## Chain 3: 
## Chain 3: Gradient evaluation took 5.1e-05 seconds
## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.51 seconds.
## Chain 3: Adjust your expectations accordingly!
## Chain 3: 
## Chain 3: 
## Chain 3: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 3: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 3: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 3: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 3: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 3: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 3: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 3: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 3: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 3: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 3: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 3: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 3: 
## Chain 3:  Elapsed Time: 0.359744 seconds (Warm-up)
## Chain 3:                0.335316 seconds (Sampling)
## Chain 3:                0.69506 seconds (Total)
## Chain 3: 
## 
## SAMPLING FOR MODEL &#39;82480dff1a626a42c2ca9de938d65b9d&#39; NOW (CHAIN 4).
## Chain 4: 
## Chain 4: Gradient evaluation took 5.1e-05 seconds
## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.51 seconds.
## Chain 4: Adjust your expectations accordingly!
## Chain 4: 
## Chain 4: 
## Chain 4: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 4: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 4: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 4: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 4: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 4: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 4: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 4: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 4: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 4: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 4: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 4: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 4: 
## Chain 4:  Elapsed Time: 0.36314 seconds (Warm-up)
## Chain 4:                0.324514 seconds (Sampling)
## Chain 4:                0.687654 seconds (Total)
## Chain 4:</code></pre>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="chapter-11-god-spiked-the-integers.html#cb341-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-2"><a href="chapter-11-god-spiked-the-integers.html#cb341-2" aria-hidden="true" tabindex="-1"></a>m11<span class="fl">.4</span>_quap <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb341-3"><a href="chapter-11-god-spiked-the-integers.html#cb341-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">flist =</span> model</span>
<span id="cb341-4"><a href="chapter-11-god-spiked-the-integers.html#cb341-4" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data =</span> dat_list</span>
<span id="cb341-5"><a href="chapter-11-god-spiked-the-integers.html#cb341-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Now we can compare the outputs of these models, both in a table, but also the in a scatterplot.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="chapter-11-god-spiked-the-integers.html#cb342-1" aria-hidden="true" tabindex="-1"></a>prec_ulam <span class="ot">&lt;-</span> <span class="fu">precis</span>(m11<span class="fl">.4</span>,<span class="at">depth =</span> <span class="dv">2</span>)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>] <span class="co">#Remove n_eff and rhat</span></span>
<span id="cb342-2"><a href="chapter-11-god-spiked-the-integers.html#cb342-2" aria-hidden="true" tabindex="-1"></a>prec_quap <span class="ot">&lt;-</span> <span class="fu">precis</span>(m11<span class="fl">.4</span>_quap,<span class="at">depth =</span> <span class="dv">2</span>)</span>
<span id="cb342-3"><a href="chapter-11-god-spiked-the-integers.html#cb342-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(prec_ulam,prec_quap),<span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">5.5%</th>
<th align="right">94.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">a[1]</td>
<td align="right">-0.45</td>
<td align="right">0.33</td>
<td align="right">-0.98</td>
<td align="right">0.07</td>
<td align="right">-0.44</td>
<td align="right">0.33</td>
<td align="right">-0.96</td>
<td align="right">0.08</td>
</tr>
<tr class="even">
<td align="left">a[2]</td>
<td align="right">3.88</td>
<td align="right">0.73</td>
<td align="right">2.78</td>
<td align="right">5.09</td>
<td align="right">3.71</td>
<td align="right">0.72</td>
<td align="right">2.55</td>
<td align="right">4.86</td>
</tr>
<tr class="odd">
<td align="left">a[3]</td>
<td align="right">-0.74</td>
<td align="right">0.34</td>
<td align="right">-1.28</td>
<td align="right">-0.21</td>
<td align="right">-0.73</td>
<td align="right">0.33</td>
<td align="right">-1.26</td>
<td align="right">-0.20</td>
</tr>
<tr class="even">
<td align="left">a[4]</td>
<td align="right">-0.75</td>
<td align="right">0.34</td>
<td align="right">-1.30</td>
<td align="right">-0.20</td>
<td align="right">-0.73</td>
<td align="right">0.33</td>
<td align="right">-1.26</td>
<td align="right">-0.20</td>
</tr>
<tr class="odd">
<td align="left">a[5]</td>
<td align="right">-0.44</td>
<td align="right">0.33</td>
<td align="right">-0.98</td>
<td align="right">0.10</td>
<td align="right">-0.44</td>
<td align="right">0.33</td>
<td align="right">-0.96</td>
<td align="right">0.08</td>
</tr>
<tr class="even">
<td align="left">a[6]</td>
<td align="right">0.48</td>
<td align="right">0.33</td>
<td align="right">-0.04</td>
<td align="right">1.02</td>
<td align="right">0.47</td>
<td align="right">0.33</td>
<td align="right">-0.06</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">a[7]</td>
<td align="right">1.95</td>
<td align="right">0.41</td>
<td align="right">1.29</td>
<td align="right">2.62</td>
<td align="right">1.91</td>
<td align="right">0.41</td>
<td align="right">1.24</td>
<td align="right">2.57</td>
</tr>
<tr class="even">
<td align="left">b[1]</td>
<td align="right">-0.04</td>
<td align="right">0.29</td>
<td align="right">-0.50</td>
<td align="right">0.43</td>
<td align="right">-0.04</td>
<td align="right">0.28</td>
<td align="right">-0.49</td>
<td align="right">0.41</td>
</tr>
<tr class="odd">
<td align="left">b[2]</td>
<td align="right">0.48</td>
<td align="right">0.29</td>
<td align="right">0.03</td>
<td align="right">0.95</td>
<td align="right">0.47</td>
<td align="right">0.28</td>
<td align="right">0.02</td>
<td align="right">0.93</td>
</tr>
<tr class="even">
<td align="left">b[3]</td>
<td align="right">-0.39</td>
<td align="right">0.28</td>
<td align="right">-0.84</td>
<td align="right">0.06</td>
<td align="right">-0.38</td>
<td align="right">0.29</td>
<td align="right">-0.83</td>
<td align="right">0.08</td>
</tr>
<tr class="odd">
<td align="left">b[4]</td>
<td align="right">0.36</td>
<td align="right">0.29</td>
<td align="right">-0.09</td>
<td align="right">0.83</td>
<td align="right">0.36</td>
<td align="right">0.28</td>
<td align="right">-0.09</td>
<td align="right">0.82</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="chapter-11-god-spiked-the-integers.html#cb343-1" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#7fc97f&quot;</span>,<span class="st">&quot;#fdc086&quot;</span>)</span>
<span id="cb343-2"><a href="chapter-11-god-spiked-the-integers.html#cb343-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prec_ulam<span class="sc">$</span>mean,<span class="at">pch =</span> <span class="dv">20</span>,<span class="at">col =</span> colors[<span class="dv">1</span>],<span class="at">xlab =</span> <span class="st">&quot;Parameters&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;Parameter Coefficient&quot;</span></span>
<span id="cb343-3"><a href="chapter-11-god-spiked-the-integers.html#cb343-3" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">main =</span> <span class="st">&quot;Mean comparisons&quot;</span>,<span class="at">sub =</span> <span class="st">&quot;Comparison of mean values for the model parameters&quot;</span></span>
<span id="cb343-4"><a href="chapter-11-god-spiked-the-integers.html#cb343-4" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(prec_quap<span class="sc">$</span><span class="st">`</span><span class="at">5.5%</span><span class="st">`</span>),<span class="fu">max</span>(prec_quap<span class="sc">$</span><span class="st">`</span><span class="at">94.5%</span><span class="st">`</span>))</span>
<span id="cb343-5"><a href="chapter-11-god-spiked-the-integers.html#cb343-5" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">panel.first =</span> <span class="fu">list</span>(<span class="fu">grid</span>()))</span>
<span id="cb343-6"><a href="chapter-11-god-spiked-the-integers.html#cb343-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lines(x = c(prec_ulam$`5.5%`[1],prec_ulam$`94.5%`[1]))</span></span>
<span id="cb343-7"><a href="chapter-11-god-spiked-the-integers.html#cb343-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(prec_ulam<span class="sc">$</span>mean)) <span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(i,i),<span class="at">y =</span> <span class="fu">c</span>(prec_ulam<span class="sc">$</span><span class="st">`</span><span class="at">5.5%</span><span class="st">`</span>[i],prec_ulam<span class="sc">$</span><span class="st">`</span><span class="at">94.5%</span><span class="st">`</span>[i])</span>
<span id="cb343-8"><a href="chapter-11-god-spiked-the-integers.html#cb343-8" aria-hidden="true" tabindex="-1"></a>                                          ,<span class="at">col =</span> <span class="fu">alpha</span>(colors[<span class="dv">1</span>],<span class="at">alpha =</span> <span class="fl">0.7</span>),<span class="at">lwd =</span> <span class="fl">1.2</span>)</span>
<span id="cb343-9"><a href="chapter-11-god-spiked-the-integers.html#cb343-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(prec_quap<span class="sc">$</span>mean)) <span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(i,i),<span class="at">y =</span> <span class="fu">c</span>(prec_quap<span class="sc">$</span><span class="st">`</span><span class="at">5.5%</span><span class="st">`</span>[i],prec_quap<span class="sc">$</span><span class="st">`</span><span class="at">94.5%</span><span class="st">`</span>[i])</span>
<span id="cb343-10"><a href="chapter-11-god-spiked-the-integers.html#cb343-10" aria-hidden="true" tabindex="-1"></a>                                          ,<span class="at">col =</span> <span class="fu">alpha</span>(colors[<span class="dv">2</span>],<span class="at">alpha =</span> <span class="fl">0.7</span>),<span class="at">lwd =</span> <span class="fl">1.2</span>)</span>
<span id="cb343-11"><a href="chapter-11-god-spiked-the-integers.html#cb343-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(prec_quap<span class="sc">$</span>mean,<span class="at">pch =</span> <span class="dv">20</span>,<span class="at">col =</span> colors[<span class="dv">2</span>])</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-184-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Notice that we apply the inverse-link (inv_logit) to convert the parameter to the outcome scale, thus we will see the x-axis going from 0 to 1.</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="chapter-11-god-spiked-the-integers.html#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract samples for posterior distribution inference</span></span>
<span id="cb344-2"><a href="chapter-11-god-spiked-the-integers.html#cb344-2" aria-hidden="true" tabindex="-1"></a>post_ulam <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m11<span class="fl">.4</span>)</span>
<span id="cb344-3"><a href="chapter-11-god-spiked-the-integers.html#cb344-3" aria-hidden="true" tabindex="-1"></a>post_quap <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m11<span class="fl">.4</span>_quap)</span>
<span id="cb344-4"><a href="chapter-11-god-spiked-the-integers.html#cb344-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(post_ulam<span class="sc">$</span>a)</span></code></pre></div>
<pre><code>##             [,1]     [,2]       [,3]       [,4]       [,5]       [,6]     [,7]
## [1,] -0.50226915 3.051394 -0.7547121 -1.0646104 -0.8049986 0.57643054 1.722355
## [2,] -0.81374304 4.036825 -1.1748382 -0.7222603 -0.7821070 0.06835324 1.745042
## [3,] -0.35414769 4.055247 -0.9335821 -0.6488562 -0.4474682 0.66036615 1.914422
## [4,]  0.06205239 4.531490 -0.5354637 -0.2106793 -0.7401811 0.56604814 3.204656
## [5,] -0.53500106 4.560263 -0.5845058 -0.2805840 -0.3985944 0.76173343 2.276771
## [6,]  0.14469389 3.484830 -0.5010515 -0.7021487 -0.1237632 0.62771047 2.332214</code></pre>
<p>Notice that we get results for each chimp. We want to just compare one against another chimp. We select chimp no. 2.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="chapter-11-god-spiked-the-integers.html#cb346-1" aria-hidden="true" tabindex="-1"></a>chimpNo <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb346-2"><a href="chapter-11-god-spiked-the-integers.html#cb346-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-3"><a href="chapter-11-god-spiked-the-integers.html#cb346-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb346-4"><a href="chapter-11-god-spiked-the-integers.html#cb346-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(<span class="fu">inv_logit</span>(post_ulam<span class="sc">$</span>a[,chimpNo]))</span>
<span id="cb346-5"><a href="chapter-11-god-spiked-the-integers.html#cb346-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(<span class="fu">inv_logit</span>(post_quap<span class="sc">$</span>a[,chimpNo]),<span class="at">add =</span> T,<span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb346-6"><a href="chapter-11-god-spiked-the-integers.html#cb346-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;With inv_logit to transform x to the outcome scale (probability / logistic)&quot;</span>)</span>
<span id="cb346-7"><a href="chapter-11-god-spiked-the-integers.html#cb346-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;ulam&quot;</span>,<span class="st">&quot;quap&quot;</span>),<span class="at">lty =</span> <span class="dv">1</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;darkred&quot;</span>))</span>
<span id="cb346-8"><a href="chapter-11-god-spiked-the-integers.html#cb346-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-9"><a href="chapter-11-god-spiked-the-integers.html#cb346-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(post_ulam<span class="sc">$</span>a[,chimpNo])</span>
<span id="cb346-10"><a href="chapter-11-god-spiked-the-integers.html#cb346-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dens</span>(post_quap<span class="sc">$</span>a[,chimpNo],<span class="at">add =</span> T,<span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb346-11"><a href="chapter-11-god-spiked-the-integers.html#cb346-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Raw alpha outputs = log-odds scale&quot;</span>)</span>
<span id="cb346-12"><a href="chapter-11-god-spiked-the-integers.html#cb346-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;ulam&quot;</span>,<span class="st">&quot;quap&quot;</span>),<span class="at">lty =</span> <span class="dv">1</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;darkred&quot;</span>))</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-186-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that on an overall level, the distributions appear to be similar. And naturally they both confirm, that for chimp 2 (was that the leftie?) we see a very high expected probability or odds for selecting the left lever.</p>
<p>We can convert the log-odds to odds:</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="chapter-11-god-spiked-the-integers.html#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">mean</span>(post_ulam<span class="sc">$</span>a[,chimpNo])) <span class="co">#= 48.87329</span></span></code></pre></div>
<pre><code>## [1] 48.36527</code></pre>
<p>We see that on average, we expect to see that chimp selecting the left lever more than 48 times compared to the right lever. Thus if the chimp are to pull the right lever twice (two times), we expect him to also have pulled the left lever around 97 times (48.87329 * 2).</p>
<p>Thus the conclusion is that it almost always pulls the left lever.</p>
<p>Notice that on the log-odds scale we also see VERY high values, that is as the practical difference between log-odds of 5, 6 and 7 is practically the same, they all mean always (or almost always).</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="chapter-11-god-spiked-the-integers.html#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">inv_logit</span>(post_ulam<span class="sc">$</span>a[,chimpNo])) <span class="co">#= 0.9742542</span></span></code></pre></div>
<pre><code>## [1] 0.9745698</code></pre>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="chapter-11-god-spiked-the-integers.html#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<pre><code>## null device 
##           1</code></pre>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="chapter-11-god-spiked-the-integers.html#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="h1-3" class="section level3" number="11.4.5">
<h3><span class="header-section-number">11.4.5</span> H1</h3>
<p>Use WAIC or PSIS to compare the chimoanzee model that includes a unqie intercept for each actor, m11.4 (p. 330), to the simpler model fit in the same section. Interpret the results.</p>
<p>I choose to compare all four models:</p>
<ol style="list-style-type: decimal">
<li>Merely an intercept and a wide alpha prior</li>
<li>Adding a slope for treatment group, with a vaguely informative prior.</li>
<li>Regularizing the alpha prior, otherwise the same as model 2.</li>
<li>MCMC fitted model.</li>
</ol>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="chapter-11-god-spiked-the-integers.html#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;chimpanzees&quot;</span>)</span>
<span id="cb354-2"><a href="chapter-11-god-spiked-the-integers.html#cb354-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> chimpanzees</span>
<span id="cb354-3"><a href="chapter-11-god-spiked-the-integers.html#cb354-3" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> d<span class="sc">$</span>prosoc_left <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>d<span class="sc">$</span>condition</span>
<span id="cb354-4"><a href="chapter-11-god-spiked-the-integers.html#cb354-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-5"><a href="chapter-11-god-spiked-the-integers.html#cb354-5" aria-hidden="true" tabindex="-1"></a><span class="co"># prior trimmed data list</span></span>
<span id="cb354-6"><a href="chapter-11-god-spiked-the-integers.html#cb354-6" aria-hidden="true" tabindex="-1"></a>dat_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb354-7"><a href="chapter-11-god-spiked-the-integers.html#cb354-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pulled_left =</span> d<span class="sc">$</span>pulled_left,</span>
<span id="cb354-8"><a href="chapter-11-god-spiked-the-integers.html#cb354-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">actor =</span> d<span class="sc">$</span>actor,</span>
<span id="cb354-9"><a href="chapter-11-god-spiked-the-integers.html#cb354-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">as.integer</span>(d<span class="sc">$</span>treatment) )</span>
<span id="cb354-10"><a href="chapter-11-god-spiked-the-integers.html#cb354-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-11"><a href="chapter-11-god-spiked-the-integers.html#cb354-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Fitting different models with different levels of complexity</span></span>
<span id="cb354-12"><a href="chapter-11-god-spiked-the-integers.html#cb354-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-13"><a href="chapter-11-god-spiked-the-integers.html#cb354-13" aria-hidden="true" tabindex="-1"></a>m11<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb354-14"><a href="chapter-11-god-spiked-the-integers.html#cb354-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb354-15"><a href="chapter-11-god-spiked-the-integers.html#cb354-15" aria-hidden="true" tabindex="-1"></a>    pulled_left <span class="sc">~</span> <span class="fu">dbinom</span>( <span class="dv">1</span> , p ) ,</span>
<span id="cb354-16"><a href="chapter-11-god-spiked-the-integers.html#cb354-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> a ,</span>
<span id="cb354-17"><a href="chapter-11-god-spiked-the-integers.html#cb354-17" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="dv">10</span> ) <span class="co">#Mean = 0, as log-odds is centered at 0. sd of 10 is very wide.</span></span>
<span id="cb354-18"><a href="chapter-11-god-spiked-the-integers.html#cb354-18" aria-hidden="true" tabindex="-1"></a>  ) , <span class="at">data=</span>d,)</span>
<span id="cb354-19"><a href="chapter-11-god-spiked-the-integers.html#cb354-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-20"><a href="chapter-11-god-spiked-the-integers.html#cb354-20" aria-hidden="true" tabindex="-1"></a>m11<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb354-21"><a href="chapter-11-god-spiked-the-integers.html#cb354-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb354-22"><a href="chapter-11-god-spiked-the-integers.html#cb354-22" aria-hidden="true" tabindex="-1"></a>    pulled_left <span class="sc">~</span> <span class="fu">dbinom</span>( <span class="dv">1</span> , p ) ,</span>
<span id="cb354-23"><a href="chapter-11-god-spiked-the-integers.html#cb354-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> a <span class="sc">+</span> b[treatment],</span>
<span id="cb354-24"><a href="chapter-11-god-spiked-the-integers.html#cb354-24" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="dv">10</span> ), <span class="co">#Mean = 0, as log-odds is centered at 0. sd of 10 is very wide.</span></span>
<span id="cb354-25"><a href="chapter-11-god-spiked-the-integers.html#cb354-25" aria-hidden="true" tabindex="-1"></a>    b[treatment] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.5</span>)</span>
<span id="cb354-26"><a href="chapter-11-god-spiked-the-integers.html#cb354-26" aria-hidden="true" tabindex="-1"></a>  ) , <span class="at">data=</span>d)</span>
<span id="cb354-27"><a href="chapter-11-god-spiked-the-integers.html#cb354-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-28"><a href="chapter-11-god-spiked-the-integers.html#cb354-28" aria-hidden="true" tabindex="-1"></a>m11<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb354-29"><a href="chapter-11-god-spiked-the-integers.html#cb354-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb354-30"><a href="chapter-11-god-spiked-the-integers.html#cb354-30" aria-hidden="true" tabindex="-1"></a>    pulled_left <span class="sc">~</span> <span class="fu">dbinom</span>( <span class="dv">1</span> , p ) ,</span>
<span id="cb354-31"><a href="chapter-11-god-spiked-the-integers.html#cb354-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> a <span class="sc">+</span> b[treatment] ,</span>
<span id="cb354-32"><a href="chapter-11-god-spiked-the-integers.html#cb354-32" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">1.5</span> ),</span>
<span id="cb354-33"><a href="chapter-11-god-spiked-the-integers.html#cb354-33" aria-hidden="true" tabindex="-1"></a>    b[treatment] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> ) <span class="co">#the treatment paramtere</span></span>
<span id="cb354-34"><a href="chapter-11-god-spiked-the-integers.html#cb354-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb354-35"><a href="chapter-11-god-spiked-the-integers.html#cb354-35" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data=</span>d )</span>
<span id="cb354-36"><a href="chapter-11-god-spiked-the-integers.html#cb354-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-37"><a href="chapter-11-god-spiked-the-integers.html#cb354-37" aria-hidden="true" tabindex="-1"></a>m11<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">ulam</span>(</span>
<span id="cb354-38"><a href="chapter-11-god-spiked-the-integers.html#cb354-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb354-39"><a href="chapter-11-god-spiked-the-integers.html#cb354-39" aria-hidden="true" tabindex="-1"></a>    pulled_left <span class="sc">~</span> <span class="fu">dbinom</span>( <span class="dv">1</span> , p ) ,</span>
<span id="cb354-40"><a href="chapter-11-god-spiked-the-integers.html#cb354-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> a[actor] <span class="sc">+</span> b[treatment] , <span class="co">#actor = chimp, treatment = the experiment setup</span></span>
<span id="cb354-41"><a href="chapter-11-god-spiked-the-integers.html#cb354-41" aria-hidden="true" tabindex="-1"></a>    a[actor] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">1.5</span> ),</span>
<span id="cb354-42"><a href="chapter-11-god-spiked-the-integers.html#cb354-42" aria-hidden="true" tabindex="-1"></a>    b[treatment] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> )</span>
<span id="cb354-43"><a href="chapter-11-god-spiked-the-integers.html#cb354-43" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb354-44"><a href="chapter-11-god-spiked-the-integers.html#cb354-44" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data=</span>dat_list,<span class="at">chains=</span><span class="dv">4</span>,<span class="at">log_lik=</span><span class="cn">TRUE</span>,<span class="at">messages =</span> F)</span></code></pre></div>
<pre><code>## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c
## clang -I&quot;/Library/Frameworks/R.framework/Resources/include&quot; -DNDEBUG   -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/Rcpp/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/unsupported&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/BH/include&quot; -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/src/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppParallel/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/rstan/include&quot; -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include &#39;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp&#39;  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:88:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name &#39;namespace&#39;
## namespace Eigen {
## ^
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected &#39;;&#39; after top level declarator
## namespace Eigen {
##                ^
##                ;
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:96:10: fatal error: &#39;complex&#39; file not found
## #include &lt;complex&gt;
##          ^~~~~~~~~
## 3 errors generated.
## make: *** [foo.o] Error 1
## 
## SAMPLING FOR MODEL &#39;82480dff1a626a42c2ca9de938d65b9d&#39; NOW (CHAIN 1).
## Chain 1: 
## Chain 1: Gradient evaluation took 7.7e-05 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.77 seconds.
## Chain 1: Adjust your expectations accordingly!
## Chain 1: 
## Chain 1: 
## Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 1: 
## Chain 1:  Elapsed Time: 0.354294 seconds (Warm-up)
## Chain 1:                0.255752 seconds (Sampling)
## Chain 1:                0.610046 seconds (Total)
## Chain 1: 
## 
## SAMPLING FOR MODEL &#39;82480dff1a626a42c2ca9de938d65b9d&#39; NOW (CHAIN 2).
## Chain 2: 
## Chain 2: Gradient evaluation took 5.3e-05 seconds
## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.53 seconds.
## Chain 2: Adjust your expectations accordingly!
## Chain 2: 
## Chain 2: 
## Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 2: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 2: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 2: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 2: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 2: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 2: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 2: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 2: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 2: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 2: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 2: 
## Chain 2:  Elapsed Time: 0.353566 seconds (Warm-up)
## Chain 2:                0.264056 seconds (Sampling)
## Chain 2:                0.617622 seconds (Total)
## Chain 2: 
## 
## SAMPLING FOR MODEL &#39;82480dff1a626a42c2ca9de938d65b9d&#39; NOW (CHAIN 3).
## Chain 3: 
## Chain 3: Gradient evaluation took 5.1e-05 seconds
## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.51 seconds.
## Chain 3: Adjust your expectations accordingly!
## Chain 3: 
## Chain 3: 
## Chain 3: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 3: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 3: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 3: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 3: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 3: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 3: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 3: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 3: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 3: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 3: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 3: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 3: 
## Chain 3:  Elapsed Time: 0.358812 seconds (Warm-up)
## Chain 3:                0.259953 seconds (Sampling)
## Chain 3:                0.618765 seconds (Total)
## Chain 3: 
## 
## SAMPLING FOR MODEL &#39;82480dff1a626a42c2ca9de938d65b9d&#39; NOW (CHAIN 4).
## Chain 4: 
## Chain 4: Gradient evaluation took 5e-05 seconds
## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.5 seconds.
## Chain 4: Adjust your expectations accordingly!
## Chain 4: 
## Chain 4: 
## Chain 4: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 4: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 4: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 4: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 4: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 4: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 4: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 4: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 4: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 4: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 4: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 4: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 4: 
## Chain 4:  Elapsed Time: 0.347864 seconds (Warm-up)
## Chain 4:                0.334209 seconds (Sampling)
## Chain 4:                0.682073 seconds (Total)
## Chain 4:</code></pre>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="chapter-11-god-spiked-the-integers.html#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(m11<span class="fl">.1</span>,m11<span class="fl">.2</span>,m11<span class="fl">.3</span>,m11<span class="fl">.4</span>)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">531.7018</td>
</tr>
<tr class="even">
<td align="right">682.4764</td>
</tr>
<tr class="odd">
<td align="right">682.7261</td>
</tr>
<tr class="even">
<td align="right">687.8290</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">18.824979</td>
</tr>
<tr class="even">
<td align="right">9.110635</td>
</tr>
<tr class="odd">
<td align="right">9.151473</td>
</tr>
<tr class="even">
<td align="right">7.056233</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="right">150.7745</td>
</tr>
<tr class="odd">
<td align="right">151.0243</td>
</tr>
<tr class="even">
<td align="right">156.1271</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">18.30941</td>
</tr>
<tr class="odd">
<td align="right">18.32737</td>
</tr>
<tr class="even">
<td align="right">18.84802</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">8.1770292</td>
</tr>
<tr class="even">
<td align="right">3.6259284</td>
</tr>
<tr class="odd">
<td align="right">3.7567175</td>
</tr>
<tr class="even">
<td align="right">0.9438886</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>Notice that we get an warning, as different fitting techniques are used, that being quap and ulam.</p>
<p>We see that the multiple slopes and multiple intercepts model is the better model, at least on a WAIC level. Notice that we have more than twice as many effective parameters as in the simpler models.</p>
<p>When we look at the simpler models, it does appear as if the only intercept model (the average) is suffice.</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="chapter-11-god-spiked-the-integers.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">compare</span>(m11<span class="fl">.1</span>,m11<span class="fl">.2</span>,m11<span class="fl">.3</span>,m11<span class="fl">.4</span>))</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-192-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>lets just take a quick look at the precis tables for the most complex and simple models.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="chapter-11-god-spiked-the-integers.html#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m11<span class="fl">.4</span>,<span class="at">depth =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.4435775</td>
</tr>
<tr class="even">
<td align="right">3.8901085</td>
</tr>
<tr class="odd">
<td align="right">-0.7414336</td>
</tr>
<tr class="even">
<td align="right">-0.7397777</td>
</tr>
<tr class="odd">
<td align="right">-0.4430549</td>
</tr>
<tr class="even">
<td align="right">0.4775556</td>
</tr>
<tr class="odd">
<td align="right">1.9503312</td>
</tr>
<tr class="even">
<td align="right">-0.0465911</td>
</tr>
<tr class="odd">
<td align="right">0.4746179</td>
</tr>
<tr class="even">
<td align="right">-0.3831221</td>
</tr>
<tr class="odd">
<td align="right">0.3617923</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3317787</td>
</tr>
<tr class="even">
<td align="right">0.7503880</td>
</tr>
<tr class="odd">
<td align="right">0.3366571</td>
</tr>
<tr class="even">
<td align="right">0.3305844</td>
</tr>
<tr class="odd">
<td align="right">0.3268284</td>
</tr>
<tr class="even">
<td align="right">0.3362400</td>
</tr>
<tr class="odd">
<td align="right">0.4102926</td>
</tr>
<tr class="even">
<td align="right">0.2821930</td>
</tr>
<tr class="odd">
<td align="right">0.2867526</td>
</tr>
<tr class="even">
<td align="right">0.2822717</td>
</tr>
<tr class="odd">
<td align="right">0.2851691</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.9920154</td>
</tr>
<tr class="even">
<td align="right">2.7464950</td>
</tr>
<tr class="odd">
<td align="right">-1.2587440</td>
</tr>
<tr class="even">
<td align="right">-1.2698848</td>
</tr>
<tr class="odd">
<td align="right">-0.9790120</td>
</tr>
<tr class="even">
<td align="right">-0.0434111</td>
</tr>
<tr class="odd">
<td align="right">1.3071752</td>
</tr>
<tr class="even">
<td align="right">-0.5064946</td>
</tr>
<tr class="odd">
<td align="right">0.0107296</td>
</tr>
<tr class="even">
<td align="right">-0.8235016</td>
</tr>
<tr class="odd">
<td align="right">-0.1012881</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0881515</td>
</tr>
<tr class="even">
<td align="right">5.1623509</td>
</tr>
<tr class="odd">
<td align="right">-0.1917230</td>
</tr>
<tr class="even">
<td align="right">-0.2224388</td>
</tr>
<tr class="odd">
<td align="right">0.0829083</td>
</tr>
<tr class="even">
<td align="right">1.0216735</td>
</tr>
<tr class="odd">
<td align="right">2.5944937</td>
</tr>
<tr class="even">
<td align="right">0.3804621</td>
</tr>
<tr class="odd">
<td align="right">0.9294940</td>
</tr>
<tr class="even">
<td align="right">0.0619090</td>
</tr>
<tr class="odd">
<td align="right">0.7981877</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">710.8329</td>
</tr>
<tr class="even">
<td align="right">1300.4618</td>
</tr>
<tr class="odd">
<td align="right">692.2417</td>
</tr>
<tr class="even">
<td align="right">613.2645</td>
</tr>
<tr class="odd">
<td align="right">736.3469</td>
</tr>
<tr class="even">
<td align="right">687.2429</td>
</tr>
<tr class="odd">
<td align="right">819.0778</td>
</tr>
<tr class="even">
<td align="right">586.6369</td>
</tr>
<tr class="odd">
<td align="right">581.9288</td>
</tr>
<tr class="even">
<td align="right">623.0519</td>
</tr>
<tr class="odd">
<td align="right">625.1247</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1.0010058</td>
</tr>
<tr class="even">
<td align="right">1.0004089</td>
</tr>
<tr class="odd">
<td align="right">1.0010750</td>
</tr>
<tr class="even">
<td align="right">0.9996676</td>
</tr>
<tr class="odd">
<td align="right">1.0010363</td>
</tr>
<tr class="even">
<td align="right">1.0030824</td>
</tr>
<tr class="odd">
<td align="right">1.0062344</td>
</tr>
<tr class="even">
<td align="right">1.0020596</td>
</tr>
<tr class="odd">
<td align="right">1.0007630</td>
</tr>
<tr class="even">
<td align="right">1.0021203</td>
</tr>
<tr class="odd">
<td align="right">1.0008004</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="chapter-11-god-spiked-the-integers.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m11<span class="fl">.1</span>)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3201416</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0902272</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1759412</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.4643421</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>Notice that the multiple intercepts model is able to capture the left handed chimp, that the single intercept model is simply not able to do.</p>
</div>
<div id="h2-4" class="section level3" number="11.4.6">
<h3><span class="header-section-number">11.4.6</span> H2</h3>
<p>The data contained in library(mass);data(eagles) are records of salmon pirating attempts by Bald Eagles in Washing State. While one eagle feeds, sometimes another will swoop in and try to steal the salmon from it. Call the feeding eagle the victim and the thief the “pirate.” Use the available data to build a binomial GLM of successful pirating attempts.</p>
<ol style="list-style-type: lower-alpha">
<li>Consider the following model</li>
</ol>
<p><span class="math display">\[
y_i \sim Binomial(n_i,p_i) \\
logit(p_i) = \alpha + \beta_PP_i + \beta_VV_i + \beta_AA_i \\
\alpha \sim Normal(0,1.5) \\
\beta_P,\beta_V,\beta_A \sim Normal(0,0.5)
\]</span></p>
<p>Where:</p>
<ul>
<li>y is the number of successful attempts,</li>
<li>n is the total number of attempts.</li>
<li>P is a dummy variable indicating whether or not the pirate had large body size,</li>
<li>V is a dummy variable indicating whether or not the victim had large body size, and finally</li>
<li>A is a dummy variable indicating whether or not the pirate was an adult.</li>
</ul>
<p>Fit the model above to the eagels data, using both quap and ulam. Is the quadratic approximation okay?</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Now interpret the estimates. If the quadratic approximation turned out okay, then its okay to use the quap estimates. Otherwise stick to ulam estimates. Then plot the posterior predictions.</li>
</ol>
<p>Compute and display both:</p>
<ol style="list-style-type: decimal">
<li><p>The predicted probability of success and its 89% interval for each row (i) on the data, as well as,</p></li>
<li><p>The predicted success count and its 89% interval. What different information does each type fo posterior prediction provide?</p></li>
</ol>
<ol start="3" style="list-style-type: lower-alpha">
<li>Now try to improve the model. Consider an interaction between the pirates size and age (immature or adult). Compare this model to the previous one, using WAIC. Interpret.</li>
</ol>
<div id="a" class="section level4" number="11.4.6.1">
<h4><span class="header-section-number">11.4.6.1</span> A:</h4>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="chapter-11-god-spiked-the-integers.html#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb360-2"><a href="chapter-11-god-spiked-the-integers.html#cb360-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(eagles)</span>
<span id="cb360-3"><a href="chapter-11-god-spiked-the-integers.html#cb360-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> eagles</span>
<span id="cb360-4"><a href="chapter-11-god-spiked-the-integers.html#cb360-4" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>P <span class="ot">&lt;-</span> <span class="fu">ifelse</span>( d<span class="sc">$</span>P<span class="sc">==</span><span class="st">&quot;L&quot;</span> , <span class="dv">1</span> , <span class="dv">0</span> ) <span class="co">#P = Pirate, L = large, S = Small</span></span>
<span id="cb360-5"><a href="chapter-11-god-spiked-the-integers.html#cb360-5" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>V <span class="ot">&lt;-</span> <span class="fu">ifelse</span>( d<span class="sc">$</span>V<span class="sc">==</span><span class="st">&quot;L&quot;</span> , <span class="dv">1</span> , <span class="dv">0</span> ) <span class="co">#V = Victim, L = large, S = Small</span></span>
<span id="cb360-6"><a href="chapter-11-god-spiked-the-integers.html#cb360-6" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>A <span class="ot">&lt;-</span> <span class="fu">ifelse</span>( d<span class="sc">$</span>A<span class="sc">==</span><span class="st">&quot;A&quot;</span> , <span class="dv">1</span> , <span class="dv">0</span> ) <span class="co">#A = Adult, 1 = yes, 0 = no.</span></span>
<span id="cb360-7"><a href="chapter-11-god-spiked-the-integers.html#cb360-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">y</th>
<th align="right">n</th>
<th align="right">P</th>
<th align="right">A</th>
<th align="right">V</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">17</td>
<td align="right">24</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">29</td>
<td align="right">29</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">27</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">20</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">12</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">16</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<p>The following error is probably due to some missspecified names, hence some of the parameters cannot be mapped to data.</p>
<p><em>Error in quap(alist(y ~ dbinom(n, p), logit(p) &lt;- a + bP * P + bV * V + :</em>
<em>initial value in ‘vmmin’ is not finite</em>
<em>The start values for the parameters were invalid. This could be caused by missing values (NA) in the data or by start values outside the parameter constraints. If there are no NA values in the data, try using explicit start values.</em></p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="chapter-11-god-spiked-the-integers.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The model</span></span>
<span id="cb361-2"><a href="chapter-11-god-spiked-the-integers.html#cb361-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">alist</span>(</span>
<span id="cb361-3"><a href="chapter-11-god-spiked-the-integers.html#cb361-3" aria-hidden="true" tabindex="-1"></a>    y <span class="sc">~</span> <span class="fu">dbinom</span>(n,p),</span>
<span id="cb361-4"><a href="chapter-11-god-spiked-the-integers.html#cb361-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> a <span class="sc">+</span> bP<span class="sc">*</span>P <span class="sc">+</span> bV<span class="sc">*</span>V <span class="sc">+</span> bA<span class="sc">*</span>A, <span class="co">#returns log odds</span></span>
<span id="cb361-5"><a href="chapter-11-god-spiked-the-integers.html#cb361-5" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">1.5</span>),</span>
<span id="cb361-6"><a href="chapter-11-god-spiked-the-integers.html#cb361-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(bP,bV,bA) <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.5</span>)</span>
<span id="cb361-7"><a href="chapter-11-god-spiked-the-integers.html#cb361-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb361-8"><a href="chapter-11-god-spiked-the-integers.html#cb361-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-9"><a href="chapter-11-god-spiked-the-integers.html#cb361-9" aria-hidden="true" tabindex="-1"></a>m_q <span class="ot">&lt;-</span> <span class="fu">quap</span>(<span class="at">flist =</span> model,<span class="at">data =</span> d) <span class="co">#The quadratic approximation</span></span>
<span id="cb361-10"><a href="chapter-11-god-spiked-the-integers.html#cb361-10" aria-hidden="true" tabindex="-1"></a>m_u <span class="ot">&lt;-</span> <span class="fu">ulam</span>(<span class="at">flist =</span> model,<span class="at">data =</span> d,<span class="at">chains =</span> <span class="dv">4</span>,<span class="at">cores =</span> <span class="dv">4</span>,<span class="at">log_lik =</span> T,<span class="at">messages =</span> F)</span></code></pre></div>
<pre><code>## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c
## clang -I&quot;/Library/Frameworks/R.framework/Resources/include&quot; -DNDEBUG   -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/Rcpp/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/unsupported&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/BH/include&quot; -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/src/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppParallel/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/rstan/include&quot; -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include &#39;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp&#39;  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:88:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name &#39;namespace&#39;
## namespace Eigen {
## ^
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected &#39;;&#39; after top level declarator
## namespace Eigen {
##                ^
##                ;
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:96:10: fatal error: &#39;complex&#39; file not found
## #include &lt;complex&gt;
##          ^~~~~~~~~
## 3 errors generated.
## make: *** [foo.o] Error 1</code></pre>
<p>Now we can call <code>precis</code> to inspect how similar the estimates are.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="chapter-11-god-spiked-the-integers.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m_q)</span>
<span id="cb363-2"><a href="chapter-11-god-spiked-the-integers.html#cb363-2" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m_u)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.2936208</td>
</tr>
<tr class="even">
<td align="right">1.6211816</td>
</tr>
<tr class="odd">
<td align="right">-1.6729682</td>
</tr>
<tr class="even">
<td align="right">0.6515824</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3681345</td>
</tr>
<tr class="even">
<td align="right">0.3063627</td>
</tr>
<tr class="odd">
<td align="right">0.3191345</td>
</tr>
<tr class="even">
<td align="right">0.3054232</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.2947292</td>
</tr>
<tr class="even">
<td align="right">1.1315548</td>
</tr>
<tr class="odd">
<td align="right">-2.1830068</td>
</tr>
<tr class="even">
<td align="right">0.1634571</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.8819707</td>
</tr>
<tr class="even">
<td align="right">2.1108084</td>
</tr>
<tr class="odd">
<td align="right">-1.1629297</td>
</tr>
<tr class="even">
<td align="right">1.1397077</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3084117</td>
</tr>
<tr class="even">
<td align="right">0.6745819</td>
</tr>
<tr class="odd">
<td align="right">-1.7090153</td>
</tr>
<tr class="even">
<td align="right">1.6342664</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3729282</td>
</tr>
<tr class="even">
<td align="right">0.3141565</td>
</tr>
<tr class="odd">
<td align="right">0.3195422</td>
</tr>
<tr class="even">
<td align="right">0.3142915</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.2934971</td>
</tr>
<tr class="even">
<td align="right">0.1841710</td>
</tr>
<tr class="odd">
<td align="right">-2.2033099</td>
</tr>
<tr class="even">
<td align="right">1.1388909</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.9005712</td>
</tr>
<tr class="even">
<td align="right">1.2037533</td>
</tr>
<tr class="odd">
<td align="right">-1.2003659</td>
</tr>
<tr class="even">
<td align="right">2.1326898</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1052.184</td>
</tr>
<tr class="even">
<td align="right">1454.764</td>
</tr>
<tr class="odd">
<td align="right">1287.957</td>
</tr>
<tr class="even">
<td align="right">1480.225</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1.0026219</td>
</tr>
<tr class="even">
<td align="right">1.0019732</td>
</tr>
<tr class="odd">
<td align="right">0.9996437</td>
</tr>
<tr class="even">
<td align="right">1.0030633</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>We see that most estimates are similar although the coefficient for adult is very different. We know that quap is not always an effective fitting technique. We see that the effective sample looks good in the MCMC model, and we also see that trank plot shows healthy chains. Thus we go forward with the MCMC model.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="chapter-11-god-spiked-the-integers.html#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="fu">trankplot</span>(m_u)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-198-1.png" width="720" style="display: block; margin: auto;" /></p>
</div>
<div id="b" class="section level4" number="11.4.6.2">
<h4><span class="header-section-number">11.4.6.2</span> B:</h4>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="chapter-11-god-spiked-the-integers.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="co">#lets extract the coefficients first:</span></span>
<span id="cb365-2"><a href="chapter-11-god-spiked-the-integers.html#cb365-2" aria-hidden="true" tabindex="-1"></a>prec <span class="ot">&lt;-</span> <span class="fu">precis</span>(m_u)</span>
<span id="cb365-3"><a href="chapter-11-god-spiked-the-integers.html#cb365-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> prec[<span class="st">&quot;a&quot;</span>,<span class="st">&quot;mean&quot;</span>]</span>
<span id="cb365-4"><a href="chapter-11-god-spiked-the-integers.html#cb365-4" aria-hidden="true" tabindex="-1"></a>bA <span class="ot">&lt;-</span> prec[<span class="st">&quot;bA&quot;</span>,<span class="st">&quot;mean&quot;</span>]</span>
<span id="cb365-5"><a href="chapter-11-god-spiked-the-integers.html#cb365-5" aria-hidden="true" tabindex="-1"></a>bV <span class="ot">&lt;-</span> prec[<span class="st">&quot;bV&quot;</span>,<span class="st">&quot;mean&quot;</span>]</span>
<span id="cb365-6"><a href="chapter-11-god-spiked-the-integers.html#cb365-6" aria-hidden="true" tabindex="-1"></a>bP <span class="ot">&lt;-</span> prec[<span class="st">&quot;bP&quot;</span>,<span class="st">&quot;mean&quot;</span>]</span>
<span id="cb365-7"><a href="chapter-11-god-spiked-the-integers.html#cb365-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-8"><a href="chapter-11-god-spiked-the-integers.html#cb365-8" aria-hidden="true" tabindex="-1"></a>pe <span class="ot">&lt;-</span> <span class="fu">c</span>() <span class="co">#for point estimate</span></span>
<span id="cb365-9"><a href="chapter-11-god-spiked-the-integers.html#cb365-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(d)){ </span>
<span id="cb365-10"><a href="chapter-11-god-spiked-the-integers.html#cb365-10" aria-hidden="true" tabindex="-1"></a>  pe[i] <span class="ot">&lt;-</span> a <span class="sc">+</span> bP<span class="sc">*</span>d<span class="sc">$</span>P[i] <span class="sc">+</span> bV<span class="sc">*</span>d<span class="sc">$</span>V[i] <span class="sc">+</span> bA<span class="sc">*</span>d<span class="sc">$</span>A[i]</span>
<span id="cb365-11"><a href="chapter-11-god-spiked-the-integers.html#cb365-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb365-12"><a href="chapter-11-god-spiked-the-integers.html#cb365-12" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>PE_logodds <span class="ot">&lt;-</span> pe</span>
<span id="cb365-13"><a href="chapter-11-god-spiked-the-integers.html#cb365-13" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>PE_p <span class="ot">&lt;-</span> <span class="fu">logistic</span>(<span class="at">x =</span> pe) <span class="co">#transform from log odds to logistic</span></span></code></pre></div>
<p>Already from the point estimates we are able to see that the greatest probability of success is when the pirate is large and an adult and while the victim is not large.</p>
<p>On the other hand we see that the smallest chance of success is when we have a small and non adult pirate and while victim is an adult.</p>
<p>To do some inference on the model and the compatibility intervals, lets extract some samples.</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="chapter-11-god-spiked-the-integers.html#cb366-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m_u)</span>
<span id="cb366-2"><a href="chapter-11-god-spiked-the-integers.html#cb366-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(<span class="fu">logistic</span>(post<span class="sc">$</span>a),<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.055</span>,<span class="fl">0.5</span>,<span class="fl">0.945</span>)) <span class="co">#This is for the null model, where all variables = 0</span></span></code></pre></div>
<pre><code>##      5.5%       50%     94.5% 
## 0.4271480 0.5790018 0.7110669</code></pre>
<p>Then one could do the same for each combination</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="chapter-11-god-spiked-the-integers.html#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(<span class="fu">logistic</span>(post<span class="sc">$</span>a <span class="sc">+</span> post<span class="sc">$</span>bA),<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.055</span>,<span class="fl">0.5</span>,<span class="fl">0.945</span>)) <span class="co">#a small adult pirate and small victim</span></span>
<span id="cb368-2"><a href="chapter-11-god-spiked-the-integers.html#cb368-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(<span class="fu">logistic</span>(post<span class="sc">$</span>a <span class="sc">+</span> post<span class="sc">$</span>bV),<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.055</span>,<span class="fl">0.5</span>,<span class="fl">0.945</span>)) <span class="co">#a small non adult pirate and large victim</span></span>
<span id="cb368-3"><a href="chapter-11-god-spiked-the-integers.html#cb368-3" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(<span class="fu">logistic</span>(post<span class="sc">$</span>a <span class="sc">+</span> post<span class="sc">$</span>bP),<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.055</span>,<span class="fl">0.5</span>,<span class="fl">0.945</span>)) <span class="co">#a large non adult pirate and small victim</span></span>
<span id="cb368-4"><a href="chapter-11-god-spiked-the-integers.html#cb368-4" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(<span class="fu">logistic</span>(post<span class="sc">$</span>a <span class="sc">+</span> post<span class="sc">$</span>bA <span class="sc">+</span> post<span class="sc">$</span>bV),<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.055</span>,<span class="fl">0.5</span>,<span class="fl">0.945</span>)) <span class="co">#an adult small pirate and large victim</span></span>
<span id="cb368-5"><a href="chapter-11-god-spiked-the-integers.html#cb368-5" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(<span class="fu">logistic</span>(post<span class="sc">$</span>a <span class="sc">+</span> post<span class="sc">$</span>bA <span class="sc">+</span> post<span class="sc">$</span>bV <span class="sc">+</span> post<span class="sc">$</span>bP),<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.055</span>,<span class="fl">0.5</span>,<span class="fl">0.945</span>))</span>
<span id="cb368-6"><a href="chapter-11-god-spiked-the-integers.html#cb368-6" aria-hidden="true" tabindex="-1"></a><span class="co">#This could be done for combinations</span></span></code></pre></div>
<pre><code>##      5.5%       50%     94.5% 
## 0.5990238 0.7261539 0.8265728 
##      5.5%       50%     94.5% 
## 0.1289846 0.1991154 0.2905680 
##      5.5%       50%     94.5% 
## 0.7988038 0.8724992 0.9260033 
##      5.5%       50%     94.5% 
## 0.2172980 0.3275955 0.4547045 
##      5.5%       50%     94.5% 
## 0.5998496 0.7120795 0.8053506</code></pre>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="chapter-11-god-spiked-the-integers.html#cb370-1" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>psuccess <span class="ot">&lt;-</span> d<span class="sc">$</span>y <span class="sc">/</span> d<span class="sc">$</span>n</span>
<span id="cb370-2"><a href="chapter-11-god-spiked-the-integers.html#cb370-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-3"><a href="chapter-11-god-spiked-the-integers.html#cb370-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">link</span>(<span class="at">fit =</span> m_u) <span class="co">#simulate posterior probabilities (for the probability model)</span></span>
<span id="cb370-4"><a href="chapter-11-god-spiked-the-integers.html#cb370-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sim</span>(<span class="at">fit =</span> m_u) <span class="co">#simulate posterior observations (for the absolute counts model)</span></span>
<span id="cb370-5"><a href="chapter-11-god-spiked-the-integers.html#cb370-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-6"><a href="chapter-11-god-spiked-the-integers.html#cb370-6" aria-hidden="true" tabindex="-1"></a>p.mean <span class="ot">&lt;-</span> <span class="fu">apply</span>( p , <span class="dv">2</span> , mean )</span>
<span id="cb370-7"><a href="chapter-11-god-spiked-the-integers.html#cb370-7" aria-hidden="true" tabindex="-1"></a>p.PI <span class="ot">&lt;-</span> <span class="fu">apply</span>( p , <span class="dv">2</span> , PI )</span>
<span id="cb370-8"><a href="chapter-11-god-spiked-the-integers.html#cb370-8" aria-hidden="true" tabindex="-1"></a>y.mean <span class="ot">&lt;-</span> <span class="fu">apply</span>( y , <span class="dv">2</span> , mean )</span>
<span id="cb370-9"><a href="chapter-11-god-spiked-the-integers.html#cb370-9" aria-hidden="true" tabindex="-1"></a>y.PI <span class="ot">&lt;-</span> <span class="fu">apply</span>( y , <span class="dv">2</span> , PI )</span>
<span id="cb370-10"><a href="chapter-11-god-spiked-the-integers.html#cb370-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-11"><a href="chapter-11-god-spiked-the-integers.html#cb370-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="fl">0.2</span>))</span>
<span id="cb370-12"><a href="chapter-11-god-spiked-the-integers.html#cb370-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-13"><a href="chapter-11-god-spiked-the-integers.html#cb370-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Predicted relative successes</span></span>
<span id="cb370-14"><a href="chapter-11-god-spiked-the-integers.html#cb370-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-15"><a href="chapter-11-god-spiked-the-integers.html#cb370-15" aria-hidden="true" tabindex="-1"></a><span class="co"># plot raw proportions success for each case</span></span>
<span id="cb370-16"><a href="chapter-11-god-spiked-the-integers.html#cb370-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( d<span class="sc">$</span>psuccess , <span class="at">col=</span>rangi2 ,</span>
<span id="cb370-17"><a href="chapter-11-god-spiked-the-integers.html#cb370-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">&quot;successful proportion&quot;</span> , <span class="at">xlab=</span><span class="st">&quot;case&quot;</span> , <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span> ,</span>
<span id="cb370-18"><a href="chapter-11-god-spiked-the-integers.html#cb370-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.75</span>,<span class="fl">8.25</span>) , <span class="at">pch=</span><span class="dv">16</span>,<span class="at">main =</span> <span class="st">&quot;Predicted relative successes&quot;</span></span>
<span id="cb370-19"><a href="chapter-11-god-spiked-the-integers.html#cb370-19" aria-hidden="true" tabindex="-1"></a>    ,<span class="at">panel.first =</span> <span class="fu">list</span>(<span class="fu">grid</span>()))</span>
<span id="cb370-20"><a href="chapter-11-god-spiked-the-integers.html#cb370-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-21"><a href="chapter-11-god-spiked-the-integers.html#cb370-21" aria-hidden="true" tabindex="-1"></a><span class="co"># label cases on horizontal axis</span></span>
<span id="cb370-22"><a href="chapter-11-god-spiked-the-integers.html#cb370-22" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>( <span class="dv">1</span> , <span class="at">at=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">8</span> ,</span>
<span id="cb370-23"><a href="chapter-11-god-spiked-the-integers.html#cb370-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span><span class="fu">c</span>( <span class="st">&quot;LAL&quot;</span>,<span class="st">&quot;LAS&quot;</span>,<span class="st">&quot;LIL&quot;</span>,<span class="st">&quot;LIS&quot;</span>,<span class="st">&quot;SAL&quot;</span>,<span class="st">&quot;SAS&quot;</span>,<span class="st">&quot;SIL&quot;</span>,<span class="st">&quot;SIS&quot;</span> ) )</span>
<span id="cb370-24"><a href="chapter-11-god-spiked-the-integers.html#cb370-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-25"><a href="chapter-11-god-spiked-the-integers.html#cb370-25" aria-hidden="true" tabindex="-1"></a><span class="co"># display posterior predicted proportions successful</span></span>
<span id="cb370-26"><a href="chapter-11-god-spiked-the-integers.html#cb370-26" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>( <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span> , p.mean )</span>
<span id="cb370-27"><a href="chapter-11-god-spiked-the-integers.html#cb370-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span> ) <span class="fu">lines</span>( <span class="fu">c</span>(i,i) , p.PI[,i] )</span>
<span id="cb370-28"><a href="chapter-11-god-spiked-the-integers.html#cb370-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-29"><a href="chapter-11-god-spiked-the-integers.html#cb370-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Predicted absolute successes</span></span>
<span id="cb370-30"><a href="chapter-11-god-spiked-the-integers.html#cb370-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-31"><a href="chapter-11-god-spiked-the-integers.html#cb370-31" aria-hidden="true" tabindex="-1"></a><span class="co"># plot raw counts success for each case</span></span>
<span id="cb370-32"><a href="chapter-11-god-spiked-the-integers.html#cb370-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( d<span class="sc">$</span>y , <span class="at">col=</span>rangi2 ,</span>
<span id="cb370-33"><a href="chapter-11-god-spiked-the-integers.html#cb370-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">&quot;successful attempts&quot;</span> , <span class="at">xlab=</span><span class="st">&quot;case&quot;</span> , <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span> ,</span>
<span id="cb370-34"><a href="chapter-11-god-spiked-the-integers.html#cb370-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.75</span>,<span class="fl">8.25</span>) , <span class="at">pch=</span><span class="dv">16</span>,<span class="at">main =</span> <span class="st">&quot;Predicted absolute successes&quot;</span></span>
<span id="cb370-35"><a href="chapter-11-god-spiked-the-integers.html#cb370-35" aria-hidden="true" tabindex="-1"></a>    ,<span class="at">panel.first =</span> <span class="fu">list</span>(<span class="fu">grid</span>()))</span>
<span id="cb370-36"><a href="chapter-11-god-spiked-the-integers.html#cb370-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-37"><a href="chapter-11-god-spiked-the-integers.html#cb370-37" aria-hidden="true" tabindex="-1"></a><span class="co"># label cases on horizontal axis</span></span>
<span id="cb370-38"><a href="chapter-11-god-spiked-the-integers.html#cb370-38" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>( <span class="dv">1</span> , <span class="at">at=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">8</span> ,</span>
<span id="cb370-39"><a href="chapter-11-god-spiked-the-integers.html#cb370-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span><span class="fu">c</span>( <span class="st">&quot;LAL&quot;</span>,<span class="st">&quot;LAS&quot;</span>,<span class="st">&quot;LIL&quot;</span>,<span class="st">&quot;LIS&quot;</span>,<span class="st">&quot;SAL&quot;</span>,<span class="st">&quot;SAS&quot;</span>,<span class="st">&quot;SIL&quot;</span>,<span class="st">&quot;SIS&quot;</span> ) )</span>
<span id="cb370-40"><a href="chapter-11-god-spiked-the-integers.html#cb370-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-41"><a href="chapter-11-god-spiked-the-integers.html#cb370-41" aria-hidden="true" tabindex="-1"></a><span class="co"># display posterior predicted successes</span></span>
<span id="cb370-42"><a href="chapter-11-god-spiked-the-integers.html#cb370-42" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>( <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span> , y.mean )</span>
<span id="cb370-43"><a href="chapter-11-god-spiked-the-integers.html#cb370-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span> ) <span class="fu">lines</span>( <span class="fu">c</span>(i,i) , y.PI[,i] )</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-202-1.png" width="720" style="display: block; margin: auto;" /></p>
</div>
<div id="c" class="section level4" number="11.4.6.3">
<h4><span class="header-section-number">11.4.6.3</span> C:</h4>
<p>Now try to improve the model. Consider an interaction between the pirates size and age (immature or adult). Compare this model to the previous one, using WAIC. Interpret.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="chapter-11-god-spiked-the-integers.html#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The model</span></span>
<span id="cb371-2"><a href="chapter-11-god-spiked-the-integers.html#cb371-2" aria-hidden="true" tabindex="-1"></a>model_int <span class="ot">&lt;-</span> <span class="fu">alist</span>(</span>
<span id="cb371-3"><a href="chapter-11-god-spiked-the-integers.html#cb371-3" aria-hidden="true" tabindex="-1"></a>    y <span class="sc">~</span> <span class="fu">dbinom</span>(n,p),</span>
<span id="cb371-4"><a href="chapter-11-god-spiked-the-integers.html#cb371-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> a <span class="sc">+</span> bP<span class="sc">*</span>P <span class="sc">+</span> bV<span class="sc">*</span>V <span class="sc">+</span> bA<span class="sc">*</span>A <span class="sc">+</span> bPA<span class="sc">*</span>P<span class="sc">*</span>A, <span class="co">#returns log odds</span></span>
<span id="cb371-5"><a href="chapter-11-god-spiked-the-integers.html#cb371-5" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">1.5</span>),</span>
<span id="cb371-6"><a href="chapter-11-god-spiked-the-integers.html#cb371-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(bP,bV,bA,bPA) <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.5</span>)</span>
<span id="cb371-7"><a href="chapter-11-god-spiked-the-integers.html#cb371-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb371-8"><a href="chapter-11-god-spiked-the-integers.html#cb371-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-9"><a href="chapter-11-god-spiked-the-integers.html#cb371-9" aria-hidden="true" tabindex="-1"></a>m2_u <span class="ot">&lt;-</span> <span class="fu">ulam</span>(<span class="at">flist =</span> model_int,<span class="at">data =</span> d,<span class="at">chains =</span> <span class="dv">4</span>,<span class="at">cores =</span> <span class="dv">4</span>,<span class="at">log_lik =</span> T,<span class="at">messages =</span> F)</span></code></pre></div>
<pre><code>## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c
## clang -I&quot;/Library/Frameworks/R.framework/Resources/include&quot; -DNDEBUG   -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/Rcpp/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/unsupported&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/BH/include&quot; -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/src/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppParallel/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/rstan/include&quot; -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include &#39;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp&#39;  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:88:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name &#39;namespace&#39;
## namespace Eigen {
## ^
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected &#39;;&#39; after top level declarator
## namespace Eigen {
##                ^
##                ;
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:96:10: fatal error: &#39;complex&#39; file not found
## #include &lt;complex&gt;
##          ^~~~~~~~~
## 3 errors generated.
## make: *** [foo.o] Error 1</code></pre>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="chapter-11-god-spiked-the-integers.html#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m2_u)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3423553</td>
</tr>
<tr class="even">
<td align="right">0.3074073</td>
</tr>
<tr class="odd">
<td align="right">0.5612080</td>
</tr>
<tr class="even">
<td align="right">-1.7150889</td>
</tr>
<tr class="odd">
<td align="right">1.5491790</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3636305</td>
</tr>
<tr class="even">
<td align="right">0.3845050</td>
</tr>
<tr class="odd">
<td align="right">0.3353116</td>
</tr>
<tr class="even">
<td align="right">0.3170750</td>
</tr>
<tr class="odd">
<td align="right">0.3314927</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.2241962</td>
</tr>
<tr class="even">
<td align="right">-0.3026831</td>
</tr>
<tr class="odd">
<td align="right">0.0232411</td>
</tr>
<tr class="even">
<td align="right">-2.2306435</td>
</tr>
<tr class="odd">
<td align="right">1.0395786</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.9207647</td>
</tr>
<tr class="even">
<td align="right">0.9358865</td>
</tr>
<tr class="odd">
<td align="right">1.0836450</td>
</tr>
<tr class="even">
<td align="right">-1.2198789</td>
</tr>
<tr class="odd">
<td align="right">2.0861344</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1040.528</td>
</tr>
<tr class="even">
<td align="right">1402.117</td>
</tr>
<tr class="odd">
<td align="right">1228.345</td>
</tr>
<tr class="even">
<td align="right">1320.456</td>
</tr>
<tr class="odd">
<td align="right">1238.091</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.9999437</td>
</tr>
<tr class="even">
<td align="right">1.0031158</td>
</tr>
<tr class="odd">
<td align="right">1.0006277</td>
</tr>
<tr class="even">
<td align="right">0.9994063</td>
</tr>
<tr class="odd">
<td align="right">1.0006411</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>Now we see that we have a parameter for the interaction, although we should notice that the 89% CI goes on both sides of 0. Hence indicating that it does not add a lot of information to the model. Lets compare the two</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="chapter-11-god-spiked-the-integers.html#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(m_u,m2_u)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">58.64102</td>
</tr>
<tr class="even">
<td align="right">59.99726</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">11.32478</td>
</tr>
<tr class="even">
<td align="right">11.58924</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.000000</td>
</tr>
<tr class="even">
<td align="right">1.356238</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">1.415029</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">8.248921</td>
</tr>
<tr class="even">
<td align="right">8.686291</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.6633188</td>
</tr>
<tr class="even">
<td align="right">0.3366812</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>Now we see that the more complex model has less predictive power than the interaction model.</p>
</div>
</div>
<div id="h3-4" class="section level3" number="11.4.7">
<h3><span class="header-section-number">11.4.7</span> H3</h3>
<p>The data contained in data(salamanders) are counts of salamanders from 47 different 49-m2 plots in northern california. THe column SALAMAN is the count in each plot, and the columns PCTCOVER and FORESTAGE are percent of ground cover and age of trees in the plot, respectively. You will model SALAMAN as a Poisson variable.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Model the relationship between density and percent over, using a log-link (same as the examepl in the book and lecture). Use weakly informative priors of your choosing. Check the quadratic approximation again, by comparing quap to ulam. Then plot the expected counts and their 89% interval against percent cover. In which ways dows the model do a good hjob? bad job?</p></li>
<li><p>Can you improve the model by using the other predictor, FORESTAGE? Try any models you think useful. Can you explain why FORESTAGE helps or does not help with prediction?</p></li>
</ol>
<p>The answer follows the guiding solutions:</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="chapter-11-god-spiked-the-integers.html#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(salamanders)</span>
<span id="cb375-2"><a href="chapter-11-god-spiked-the-integers.html#cb375-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> salamanders</span>
<span id="cb375-3"><a href="chapter-11-god-spiked-the-integers.html#cb375-3" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>C <span class="ot">&lt;-</span> <span class="fu">standardize</span>(d<span class="sc">$</span>PCTCOVER)</span>
<span id="cb375-4"><a href="chapter-11-god-spiked-the-integers.html#cb375-4" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>A <span class="ot">&lt;-</span> <span class="fu">standardize</span>(d<span class="sc">$</span>FORESTAGE)</span></code></pre></div>
<div id="prior-predictive-simulation" class="section level4" number="11.4.7.1">
<h4><span class="header-section-number">11.4.7.1</span> Prior predictive simulation</h4>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="chapter-11-god-spiked-the-integers.html#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<pre><code>## null device 
##           1</code></pre>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="chapter-11-god-spiked-the-integers.html#cb378-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co"># 50 samples from prior</span></span>
<span id="cb378-2"><a href="chapter-11-god-spiked-the-integers.html#cb378-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>( N , <span class="dv">0</span> , <span class="dv">1</span> )</span>
<span id="cb378-3"><a href="chapter-11-god-spiked-the-integers.html#cb378-3" aria-hidden="true" tabindex="-1"></a>bC <span class="ot">&lt;-</span> <span class="fu">rnorm</span>( N , <span class="dv">0</span> , <span class="dv">1</span> )</span>
<span id="cb378-4"><a href="chapter-11-god-spiked-the-integers.html#cb378-4" aria-hidden="true" tabindex="-1"></a>C_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from=</span><span class="sc">-</span><span class="dv">2</span> , <span class="at">to=</span><span class="dv">2</span> , <span class="at">length.out=</span><span class="dv">30</span> )</span>
<span id="cb378-5"><a href="chapter-11-god-spiked-the-integers.html#cb378-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( <span class="cn">NULL</span> , <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>) , <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>) ,</span>
<span id="cb378-6"><a href="chapter-11-god-spiked-the-integers.html#cb378-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;cover (standardized)&quot;</span> , <span class="at">ylab=</span><span class="st">&quot;salamanders&quot;</span> )</span>
<span id="cb378-7"><a href="chapter-11-god-spiked-the-integers.html#cb378-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N )</span>
<span id="cb378-8"><a href="chapter-11-god-spiked-the-integers.html#cb378-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>( C_seq , <span class="fu">exp</span>( a[i] <span class="sc">+</span> bC[i]<span class="sc">*</span>C_seq ) , <span class="at">col=</span><span class="fu">grau</span>() , <span class="at">lwd=</span><span class="fl">1.5</span> )</span></code></pre></div>
<p>Now lets try a more regularized prior:</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="chapter-11-god-spiked-the-integers.html#cb379-1" aria-hidden="true" tabindex="-1"></a>bC <span class="ot">&lt;-</span> <span class="fu">rnorm</span>( N , <span class="dv">0</span> , <span class="fl">0.5</span> )</span>
<span id="cb379-2"><a href="chapter-11-god-spiked-the-integers.html#cb379-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( <span class="cn">NULL</span> , <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>) , <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>) ,</span>
<span id="cb379-3"><a href="chapter-11-god-spiked-the-integers.html#cb379-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;cover (standardized)&quot;</span> , <span class="at">ylab=</span><span class="st">&quot;salamanders&quot;</span> )</span>
<span id="cb379-4"><a href="chapter-11-god-spiked-the-integers.html#cb379-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N )</span>
<span id="cb379-5"><a href="chapter-11-god-spiked-the-integers.html#cb379-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>( C_seq , <span class="fu">exp</span>( a[i] <span class="sc">+</span> bC[i]<span class="sc">*</span>C_seq ) , <span class="at">col=</span><span class="fu">grau</span>() , <span class="at">lwd=</span><span class="fl">1.5</span> )</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-207-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>we see that this can still model extreme examples, but we assume less salamanders in general per plot.</p>
</div>
<div id="fitting-the-model" class="section level4" number="11.4.7.2">
<h4><span class="header-section-number">11.4.7.2</span> Fitting the model</h4>
<div id="using-poisson" class="section level5" number="11.4.7.2.1">
<h5><span class="header-section-number">11.4.7.2.1</span> Using poisson</h5>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="chapter-11-god-spiked-the-integers.html#cb380-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">alist</span>(</span>
<span id="cb380-2"><a href="chapter-11-god-spiked-the-integers.html#cb380-2" aria-hidden="true" tabindex="-1"></a>    SALAMAN <span class="sc">~</span> <span class="fu">dpois</span>( lambda ), <span class="co">#Notice that we use poisson</span></span>
<span id="cb380-3"><a href="chapter-11-god-spiked-the-integers.html#cb380-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(lambda) <span class="ot">&lt;-</span> a <span class="sc">+</span> bC<span class="sc">*</span>C,</span>
<span id="cb380-4"><a href="chapter-11-god-spiked-the-integers.html#cb380-4" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb380-5"><a href="chapter-11-god-spiked-the-integers.html#cb380-5" aria-hidden="true" tabindex="-1"></a>    bC <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.5</span>) )</span>
<span id="cb380-6"><a href="chapter-11-god-spiked-the-integers.html#cb380-6" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">ulam</span>( f , <span class="at">data=</span>d , <span class="at">chains=</span><span class="dv">4</span> )</span></code></pre></div>
<pre><code>## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c
## clang -I&quot;/Library/Frameworks/R.framework/Resources/include&quot; -DNDEBUG   -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/Rcpp/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/unsupported&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/BH/include&quot; -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/src/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppParallel/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/rstan/include&quot; -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include &#39;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp&#39;  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:88:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name &#39;namespace&#39;
## namespace Eigen {
## ^
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected &#39;;&#39; after top level declarator
## namespace Eigen {
##                ^
##                ;
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:96:10: fatal error: &#39;complex&#39; file not found
## #include &lt;complex&gt;
##          ^~~~~~~~~
## 3 errors generated.
## make: *** [foo.o] Error 1
## 
## SAMPLING FOR MODEL &#39;4eb2a85f2a9d56bd07c53a5b30da3756&#39; NOW (CHAIN 1).
## Chain 1: 
## Chain 1: Gradient evaluation took 2.3e-05 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.23 seconds.
## Chain 1: Adjust your expectations accordingly!
## Chain 1: 
## Chain 1: 
## Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 1: 
## Chain 1:  Elapsed Time: 0.02104 seconds (Warm-up)
## Chain 1:                0.018719 seconds (Sampling)
## Chain 1:                0.039759 seconds (Total)
## Chain 1: 
## 
## SAMPLING FOR MODEL &#39;4eb2a85f2a9d56bd07c53a5b30da3756&#39; NOW (CHAIN 2).
## Chain 2: 
## Chain 2: Gradient evaluation took 7e-06 seconds
## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.07 seconds.
## Chain 2: Adjust your expectations accordingly!
## Chain 2: 
## Chain 2: 
## Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 2: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 2: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 2: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 2: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 2: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 2: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 2: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 2: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 2: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 2: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 2: 
## Chain 2:  Elapsed Time: 0.020563 seconds (Warm-up)
## Chain 2:                0.019523 seconds (Sampling)
## Chain 2:                0.040086 seconds (Total)
## Chain 2: 
## 
## SAMPLING FOR MODEL &#39;4eb2a85f2a9d56bd07c53a5b30da3756&#39; NOW (CHAIN 3).
## Chain 3: 
## Chain 3: Gradient evaluation took 8e-06 seconds
## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.08 seconds.
## Chain 3: Adjust your expectations accordingly!
## Chain 3: 
## Chain 3: 
## Chain 3: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 3: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 3: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 3: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 3: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 3: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 3: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 3: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 3: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 3: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 3: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 3: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 3: 
## Chain 3:  Elapsed Time: 0.019808 seconds (Warm-up)
## Chain 3:                0.018258 seconds (Sampling)
## Chain 3:                0.038066 seconds (Total)
## Chain 3: 
## 
## SAMPLING FOR MODEL &#39;4eb2a85f2a9d56bd07c53a5b30da3756&#39; NOW (CHAIN 4).
## Chain 4: 
## Chain 4: Gradient evaluation took 8e-06 seconds
## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.08 seconds.
## Chain 4: Adjust your expectations accordingly!
## Chain 4: 
## Chain 4: 
## Chain 4: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 4: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 4: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 4: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 4: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 4: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 4: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 4: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 4: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 4: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 4: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 4: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 4: 
## Chain 4:  Elapsed Time: 0.021344 seconds (Warm-up)
## Chain 4:                0.021364 seconds (Sampling)
## Chain 4:                0.042708 seconds (Total)
## Chain 4:</code></pre>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="chapter-11-god-spiked-the-integers.html#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m1)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.4828922</td>
</tr>
<tr class="even">
<td align="right">1.0551750</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1419569</td>
</tr>
<tr class="even">
<td align="right">0.1646161</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.2439024</td>
</tr>
<tr class="even">
<td align="right">0.7994123</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.6943425</td>
</tr>
<tr class="even">
<td align="right">1.3210153</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">478.6646</td>
</tr>
<tr class="even">
<td align="right">460.2957</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1.011032</td>
</tr>
<tr class="even">
<td align="right">1.010398</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>We see some correlation between the count of salamanders and the percent of ground cover. Lets plot this relationship</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="chapter-11-god-spiked-the-integers.html#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( d<span class="sc">$</span>C , d<span class="sc">$</span>SALAMAN , <span class="at">col=</span>rangi2 , <span class="at">lwd=</span><span class="dv">2</span> ,</span>
<span id="cb383-2"><a href="chapter-11-god-spiked-the-integers.html#cb383-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;cover (standardized)&quot;</span> , <span class="at">ylab=</span><span class="st">&quot;salamanders observed&quot;</span> )</span>
<span id="cb383-3"><a href="chapter-11-god-spiked-the-integers.html#cb383-3" aria-hidden="true" tabindex="-1"></a>C_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from=</span><span class="sc">-</span><span class="dv">2</span> , <span class="at">to=</span><span class="dv">2</span> , <span class="at">length.out=</span><span class="dv">30</span> )</span>
<span id="cb383-4"><a href="chapter-11-god-spiked-the-integers.html#cb383-4" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">link</span>( m1 , <span class="at">data=</span><span class="fu">list</span>(<span class="at">C=</span>C_seq) ) <span class="co">#Make predictions</span></span>
<span id="cb383-5"><a href="chapter-11-god-spiked-the-integers.html#cb383-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( C_seq , <span class="fu">colMeans</span>( l ) )</span>
<span id="cb383-6"><a href="chapter-11-god-spiked-the-integers.html#cb383-6" aria-hidden="true" tabindex="-1"></a><span class="fu">shade</span>( <span class="fu">apply</span>( l , <span class="dv">2</span> , PI ) , C_seq ) <span class="co">#add the CI</span></span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-210-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that the higher the ground cover is, the larger is the predicted number of salamanders.</p>
</div>
<div id="using-gamma-poisson" class="section level5" number="11.4.7.2.2">
<h5><span class="header-section-number">11.4.7.2.2</span> Using gamma poisson</h5>
<p>For comparison, we can try out a gamma-Poisson (aka negative binomial) model. You can read about the model in chapter 12.1.2 in the book. The gamma-Poisson introduces a new parameter, <span class="math inline">\(\phi\)</span>, which controls the dispersion (scale) of the rates across cases. <span class="math inline">\(\phi\)</span> must be positive and controls the variance. That variance of the gamma-Poisson is <span class="math inline">\(\lambda + \lambda / \phi\)</span>ϕ. This means that the larger the <span class="math inline">\(\phi\)</span> values, the more similar the distribution will be to a pure Poisson process. Let’s try one out for size and compare:</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="chapter-11-god-spiked-the-integers.html#cb384-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">alist</span>(</span>
<span id="cb384-2"><a href="chapter-11-god-spiked-the-integers.html#cb384-2" aria-hidden="true" tabindex="-1"></a>  SALAMAN <span class="sc">~</span> <span class="fu">dgampois</span>( lambda, phi ),</span>
<span id="cb384-3"><a href="chapter-11-god-spiked-the-integers.html#cb384-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(lambda) <span class="ot">&lt;-</span> a <span class="sc">+</span> bC<span class="sc">*</span>C,</span>
<span id="cb384-4"><a href="chapter-11-god-spiked-the-integers.html#cb384-4" aria-hidden="true" tabindex="-1"></a>  a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb384-5"><a href="chapter-11-god-spiked-the-integers.html#cb384-5" aria-hidden="true" tabindex="-1"></a>  bC <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.5</span>),</span>
<span id="cb384-6"><a href="chapter-11-god-spiked-the-integers.html#cb384-6" aria-hidden="true" tabindex="-1"></a>  phi <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>))</span>
<span id="cb384-7"><a href="chapter-11-god-spiked-the-integers.html#cb384-7" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">ulam</span>( f , <span class="at">data=</span>d , <span class="at">chains=</span><span class="dv">4</span>,<span class="at">messages =</span> F)</span>
<span id="cb384-8"><a href="chapter-11-god-spiked-the-integers.html#cb384-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-9"><a href="chapter-11-god-spiked-the-integers.html#cb384-9" aria-hidden="true" tabindex="-1"></a><span class="co">#The plot</span></span>
<span id="cb384-10"><a href="chapter-11-god-spiked-the-integers.html#cb384-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( d<span class="sc">$</span>C , d<span class="sc">$</span>SALAMAN , <span class="at">col=</span>rangi2 , <span class="at">lwd=</span><span class="dv">2</span> ,</span>
<span id="cb384-11"><a href="chapter-11-god-spiked-the-integers.html#cb384-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab=</span><span class="st">&quot;cover (standardized)&quot;</span> , <span class="at">ylab=</span><span class="st">&quot;salamanders observed&quot;</span> )</span>
<span id="cb384-12"><a href="chapter-11-god-spiked-the-integers.html#cb384-12" aria-hidden="true" tabindex="-1"></a>C_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from=</span><span class="sc">-</span><span class="dv">2</span> , <span class="at">to=</span><span class="dv">2</span> , <span class="at">length.out=</span><span class="dv">30</span> )</span>
<span id="cb384-13"><a href="chapter-11-god-spiked-the-integers.html#cb384-13" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">link</span>( m1 , <span class="at">data=</span><span class="fu">list</span>(<span class="at">C=</span>C_seq) )</span>
<span id="cb384-14"><a href="chapter-11-god-spiked-the-integers.html#cb384-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( C_seq , <span class="fu">colMeans</span>( l ) )</span>
<span id="cb384-15"><a href="chapter-11-god-spiked-the-integers.html#cb384-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-16"><a href="chapter-11-god-spiked-the-integers.html#cb384-16" aria-hidden="true" tabindex="-1"></a><span class="fu">shade</span>( <span class="fu">apply</span>( l , <span class="dv">2</span> , PI ) , C_seq )</span>
<span id="cb384-17"><a href="chapter-11-god-spiked-the-integers.html#cb384-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-18"><a href="chapter-11-god-spiked-the-integers.html#cb384-18" aria-hidden="true" tabindex="-1"></a>l2 <span class="ot">&lt;-</span> <span class="fu">link</span>( m2 , <span class="at">data=</span><span class="fu">list</span>(<span class="at">C=</span>C_seq) )</span>
<span id="cb384-19"><a href="chapter-11-god-spiked-the-integers.html#cb384-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( C_seq , <span class="fu">colMeans</span>( l2 ), <span class="at">col =</span> <span class="st">&quot;red&quot;</span> )</span>
<span id="cb384-20"><a href="chapter-11-god-spiked-the-integers.html#cb384-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-21"><a href="chapter-11-god-spiked-the-integers.html#cb384-21" aria-hidden="true" tabindex="-1"></a><span class="fu">shade</span>( <span class="fu">apply</span>( l2 , <span class="dv">2</span> , PI ) , C_seq, <span class="at">col =</span> <span class="fu">col.alpha</span>(<span class="st">&quot;red&quot;</span>, <span class="fl">0.15</span>) )</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-211-1.png" width="720" style="display: block; margin: auto;" /></p>
<pre><code>## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c
## clang -I&quot;/Library/Frameworks/R.framework/Resources/include&quot; -DNDEBUG   -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/Rcpp/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/unsupported&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/BH/include&quot; -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/src/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppParallel/include/&quot;  -I&quot;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/rstan/include&quot; -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include &#39;/Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp&#39;  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:88:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name &#39;namespace&#39;
## namespace Eigen {
## ^
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected &#39;;&#39; after top level declarator
## namespace Eigen {
##                ^
##                ;
## In file included from &lt;built-in&gt;:1:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13:
## In file included from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Dense:1:
## /Library/Frameworks/R.framework/Versions/4.0/Resources/library/RcppEigen/include/Eigen/Core:96:10: fatal error: &#39;complex&#39; file not found
## #include &lt;complex&gt;
##          ^~~~~~~~~
## 3 errors generated.
## make: *** [foo.o] Error 1
## 
## SAMPLING FOR MODEL &#39;68c56bc01a5da07d0430660eb3eac144&#39; NOW (CHAIN 1).
## Chain 1: 
## Chain 1: Gradient evaluation took 3.4e-05 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.34 seconds.
## Chain 1: Adjust your expectations accordingly!
## Chain 1: 
## Chain 1: 
## Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 1: 
## Chain 1:  Elapsed Time: 0.036676 seconds (Warm-up)
## Chain 1:                0.031079 seconds (Sampling)
## Chain 1:                0.067755 seconds (Total)
## Chain 1: 
## 
## SAMPLING FOR MODEL &#39;68c56bc01a5da07d0430660eb3eac144&#39; NOW (CHAIN 2).
## Chain 2: 
## Chain 2: Gradient evaluation took 2.1e-05 seconds
## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.21 seconds.
## Chain 2: Adjust your expectations accordingly!
## Chain 2: 
## Chain 2: 
## Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 2: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 2: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 2: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 2: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 2: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 2: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 2: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 2: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 2: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 2: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 2: 
## Chain 2:  Elapsed Time: 0.038515 seconds (Warm-up)
## Chain 2:                0.029749 seconds (Sampling)
## Chain 2:                0.068264 seconds (Total)
## Chain 2: 
## 
## SAMPLING FOR MODEL &#39;68c56bc01a5da07d0430660eb3eac144&#39; NOW (CHAIN 3).
## Chain 3: 
## Chain 3: Gradient evaluation took 1.9e-05 seconds
## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.19 seconds.
## Chain 3: Adjust your expectations accordingly!
## Chain 3: 
## Chain 3: 
## Chain 3: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 3: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 3: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 3: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 3: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 3: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 3: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 3: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 3: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 3: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 3: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 3: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 3: 
## Chain 3:  Elapsed Time: 0.03717 seconds (Warm-up)
## Chain 3:                0.028926 seconds (Sampling)
## Chain 3:                0.066096 seconds (Total)
## Chain 3: 
## 
## SAMPLING FOR MODEL &#39;68c56bc01a5da07d0430660eb3eac144&#39; NOW (CHAIN 4).
## Chain 4: 
## Chain 4: Gradient evaluation took 1.3e-05 seconds
## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.13 seconds.
## Chain 4: Adjust your expectations accordingly!
## Chain 4: 
## Chain 4: 
## Chain 4: Iteration:   1 / 1000 [  0%]  (Warmup)
## Chain 4: Iteration: 100 / 1000 [ 10%]  (Warmup)
## Chain 4: Iteration: 200 / 1000 [ 20%]  (Warmup)
## Chain 4: Iteration: 300 / 1000 [ 30%]  (Warmup)
## Chain 4: Iteration: 400 / 1000 [ 40%]  (Warmup)
## Chain 4: Iteration: 500 / 1000 [ 50%]  (Warmup)
## Chain 4: Iteration: 501 / 1000 [ 50%]  (Sampling)
## Chain 4: Iteration: 600 / 1000 [ 60%]  (Sampling)
## Chain 4: Iteration: 700 / 1000 [ 70%]  (Sampling)
## Chain 4: Iteration: 800 / 1000 [ 80%]  (Sampling)
## Chain 4: Iteration: 900 / 1000 [ 90%]  (Sampling)
## Chain 4: Iteration: 1000 / 1000 [100%]  (Sampling)
## Chain 4: 
## Chain 4:  Elapsed Time: 0.033977 seconds (Warm-up)
## Chain 4:                0.031232 seconds (Sampling)
## Chain 4:                0.065209 seconds (Total)
## Chain 4:</code></pre>
<p>In general we see that this is not doing anything much better than just the poisson.</p>
<p>We will see in the following chapters how multilevel models are better at capturing trends in different clusters.</p>

</div>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-10-big-entropy-and-the-generalized-linear-model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch-13-models-with-memory.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
