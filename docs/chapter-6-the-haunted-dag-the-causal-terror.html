<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Chapter 6 - The Haunted DAG &amp; The Causal Terror | Bayesian Data Analysis Notes</title>
  <meta name="description" content="7 Chapter 6 - The Haunted DAG &amp; The Causal Terror | Bayesian Data Analysis Notes" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Chapter 6 - The Haunted DAG &amp; The Causal Terror | Bayesian Data Analysis Notes" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Chapter 6 - The Haunted DAG &amp; The Causal Terror | Bayesian Data Analysis Notes" />
  
  
  

<meta name="author" content="Jonas Ringive Korsholm" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-5-the-many-variables-the-spurious-waffles.html"/>
<link rel="next" href="chapter-7-model-comparison.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="chapter-1-golems-of-prague.html"><a href="chapter-1-golems-of-prague.html"><i class="fa fa-check"></i><b>1</b> Chapter 1 - Golems of Prague</a></li>
<li class="chapter" data-level="2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html"><i class="fa fa-check"></i><b>2</b> Chapter 2 - Small worlds and Large Worlds</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#models-and-estimation"><i class="fa fa-check"></i><b>2.1</b> Models and Estimation</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#engines-motors-to-estimate-the-models"><i class="fa fa-check"></i><b>2.1.1</b> Engines / Motors to estimate the models</a>
<ul>
<li class="chapter" data-level="2.1.1.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#grid-approximation"><i class="fa fa-check"></i><b>2.1.1.1</b> Grid approximation</a></li>
<li class="chapter" data-level="2.1.1.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#quadratic-approximation"><i class="fa fa-check"></i><b>2.1.1.2</b> Quadratic approximation</a></li>
<li class="chapter" data-level="2.1.1.3" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#markov-chain-monte-carlo"><i class="fa fa-check"></i><b>2.1.1.3</b> Markov Chain Monte Carlo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#exercises"><i class="fa fa-check"></i><b>2.2</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#m1"><i class="fa fa-check"></i><b>2.2.1</b> 2M1</a></li>
<li class="chapter" data-level="2.2.2" data-path="chapter-2-small-worlds-and-large-worlds.html"><a href="chapter-2-small-worlds-and-large-worlds.html#m2"><i class="fa fa-check"></i><b>2.2.2</b> 2M2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html"><i class="fa fa-check"></i><b>3</b> Chapter 3 - Sampling the Imaginary</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-from-a-grid-approximate-posterior"><i class="fa fa-check"></i><b>3.1</b> Sampling from a grid-approximate posterior</a></li>
<li class="chapter" data-level="3.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-to-summarize"><i class="fa fa-check"></i><b>3.2</b> Sampling to summarize</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#defined-boundaries"><i class="fa fa-check"></i><b>3.2.1</b> Defined Boundaries</a></li>
<li class="chapter" data-level="3.2.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#defined-probability-mass"><i class="fa fa-check"></i><b>3.2.2</b> Defined Probability Mass</a></li>
<li class="chapter" data-level="3.2.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#point-estimates"><i class="fa fa-check"></i><b>3.2.3</b> Point Estimates</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#sampling-to-simulate-prediction"><i class="fa fa-check"></i><b>3.3</b> Sampling to simulate prediction</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#dummy-data"><i class="fa fa-check"></i><b>3.3.1</b> Dummy Data</a></li>
<li class="chapter" data-level="3.3.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#model-checking"><i class="fa fa-check"></i><b>3.3.2</b> Model Checking</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#exercises-1"><i class="fa fa-check"></i><b>3.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m1-1"><i class="fa fa-check"></i><b>3.4.1</b> 3M1</a></li>
<li class="chapter" data-level="3.4.2" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m2-1"><i class="fa fa-check"></i><b>3.4.2</b> 3M2</a></li>
<li class="chapter" data-level="3.4.3" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m3"><i class="fa fa-check"></i><b>3.4.3</b> 3M3</a></li>
<li class="chapter" data-level="3.4.4" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m4"><i class="fa fa-check"></i><b>3.4.4</b> 3M4</a></li>
<li class="chapter" data-level="3.4.5" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#m5"><i class="fa fa-check"></i><b>3.4.5</b> 3M5</a></li>
<li class="chapter" data-level="3.4.6" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h1"><i class="fa fa-check"></i><b>3.4.6</b> 3H1</a></li>
<li class="chapter" data-level="3.4.7" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h2"><i class="fa fa-check"></i><b>3.4.7</b> 3H2</a></li>
<li class="chapter" data-level="3.4.8" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h3"><i class="fa fa-check"></i><b>3.4.8</b> 3H3</a></li>
<li class="chapter" data-level="3.4.9" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h4"><i class="fa fa-check"></i><b>3.4.9</b> 3H4</a></li>
<li class="chapter" data-level="3.4.10" data-path="chapter-3-sampling-the-imaginary.html"><a href="chapter-3-sampling-the-imaginary.html#h5"><i class="fa fa-check"></i><b>3.4.10</b> 3H5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geocentric-models.html"><a href="geocentric-models.html"><i class="fa fa-check"></i><b>4</b> Geocentric Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="geocentric-models.html"><a href="geocentric-models.html#why-normal-distributions-are-normal"><i class="fa fa-check"></i><b>4.1</b> Why Normal distributions are normal</a></li>
<li class="chapter" data-level="4.2" data-path="geocentric-models.html"><a href="geocentric-models.html#a-language-for-describing-models"><i class="fa fa-check"></i><b>4.2</b> A language for describing models</a></li>
<li class="chapter" data-level="4.3" data-path="geocentric-models.html"><a href="geocentric-models.html#gaussian-model-of-height"><i class="fa fa-check"></i><b>4.3</b> Gaussian model of height</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="geocentric-models.html"><a href="geocentric-models.html#the-model"><i class="fa fa-check"></i><b>4.3.1</b> The model</a></li>
<li class="chapter" data-level="4.3.2" data-path="geocentric-models.html"><a href="geocentric-models.html#grid-approximation-of-the-posterior-distribution"><i class="fa fa-check"></i><b>4.3.2</b> Grid approximation of the posterior distribution</a></li>
<li class="chapter" data-level="4.3.3" data-path="geocentric-models.html"><a href="geocentric-models.html#sampling-from-the-posterior"><i class="fa fa-check"></i><b>4.3.3</b> Sampling from the posterior</a></li>
<li class="chapter" data-level="4.3.4" data-path="geocentric-models.html"><a href="geocentric-models.html#finding-the-posterior-distribution-with-quap"><i class="fa fa-check"></i><b>4.3.4</b> Finding the posterior distribution with quap</a></li>
<li class="chapter" data-level="4.3.5" data-path="geocentric-models.html"><a href="geocentric-models.html#sampling-from-a-quap"><i class="fa fa-check"></i><b>4.3.5</b> Sampling from a quap</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="geocentric-models.html"><a href="geocentric-models.html#linear-prediction"><i class="fa fa-check"></i><b>4.4</b> Linear prediction</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="geocentric-models.html"><a href="geocentric-models.html#the-lienar-mdoel-strategy"><i class="fa fa-check"></i><b>4.4.1</b> The lienar mdoel strategy</a></li>
<li class="chapter" data-level="4.4.2" data-path="geocentric-models.html"><a href="geocentric-models.html#finding-the-posterior-distribution"><i class="fa fa-check"></i><b>4.4.2</b> Finding the posterior distribution</a></li>
<li class="chapter" data-level="4.4.3" data-path="geocentric-models.html"><a href="geocentric-models.html#interpreting-the-posterior-distribution"><i class="fa fa-check"></i><b>4.4.3</b> Interpreting the posterior distribution</a>
<ul>
<li class="chapter" data-level="4.4.3.1" data-path="geocentric-models.html"><a href="geocentric-models.html#tables-fo-marginal-distributions"><i class="fa fa-check"></i><b>4.4.3.1</b> Tables fo marginal distributions</a></li>
<li class="chapter" data-level="4.4.3.2" data-path="geocentric-models.html"><a href="geocentric-models.html#plotting-posterior-inference-against-the-data"><i class="fa fa-check"></i><b>4.4.3.2</b> Plotting posterior inference against the data</a></li>
<li class="chapter" data-level="4.4.3.3" data-path="geocentric-models.html"><a href="geocentric-models.html#adding-uncertainty-around-the-mean"><i class="fa fa-check"></i><b>4.4.3.3</b> Adding uncertainty around the mean</a></li>
<li class="chapter" data-level="4.4.3.4" data-path="geocentric-models.html"><a href="geocentric-models.html#plotting-regression-intervlas-and-contours"><i class="fa fa-check"></i><b>4.4.3.4</b> Plotting regression intervlas and contours</a></li>
<li class="chapter" data-level="4.4.3.5" data-path="geocentric-models.html"><a href="geocentric-models.html#prediction-intevals"><i class="fa fa-check"></i><b>4.4.3.5</b> Prediction intevals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="geocentric-models.html"><a href="geocentric-models.html#curves-form-lines"><i class="fa fa-check"></i><b>4.5</b> Curves form lines</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="geocentric-models.html"><a href="geocentric-models.html#polynomial-regression"><i class="fa fa-check"></i><b>4.5.1</b> Polynomial regression</a></li>
<li class="chapter" data-level="4.5.2" data-path="geocentric-models.html"><a href="geocentric-models.html#splines"><i class="fa fa-check"></i><b>4.5.2</b> Splines</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="geocentric-models.html"><a href="geocentric-models.html#exercises-2"><i class="fa fa-check"></i><b>4.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="geocentric-models.html"><a href="geocentric-models.html#m1-2"><i class="fa fa-check"></i><b>4.6.1</b> 4M1</a></li>
<li class="chapter" data-level="4.6.2" data-path="geocentric-models.html"><a href="geocentric-models.html#m8"><i class="fa fa-check"></i><b>4.6.2</b> 4M8</a></li>
<li class="chapter" data-level="4.6.3" data-path="geocentric-models.html"><a href="geocentric-models.html#h1-1"><i class="fa fa-check"></i><b>4.6.3</b> 4H1</a></li>
<li class="chapter" data-level="4.6.4" data-path="geocentric-models.html"><a href="geocentric-models.html#h2-1"><i class="fa fa-check"></i><b>4.6.4</b> 4H2</a></li>
<li class="chapter" data-level="4.6.5" data-path="geocentric-models.html"><a href="geocentric-models.html#h3-1"><i class="fa fa-check"></i><b>4.6.5</b> 4H3</a>
<ul>
<li class="chapter" data-level="4.6.5.1" data-path="geocentric-models.html"><a href="geocentric-models.html#the-same-but-using-log-of-weight"><i class="fa fa-check"></i><b>4.6.5.1</b> The same but using log of weight</a></li>
</ul></li>
<li class="chapter" data-level="4.6.6" data-path="geocentric-models.html"><a href="geocentric-models.html#h6"><i class="fa fa-check"></i><b>4.6.6</b> 4H6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lecture-notes-wrap-up-chapters-geocentric-models.html"><a href="lecture-notes-wrap-up-chapters-geocentric-models.html"><i class="fa fa-check"></i><b>5</b> Lecture notes - wrap up chapters geocentric models</a></li>
<li class="chapter" data-level="6" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html"><i class="fa fa-check"></i><b>6</b> Chapter 5 - The Many Variables &amp; The Spurious Waffles</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#spurious-associations"><i class="fa fa-check"></i><b>6.1</b> Spurious Associations</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#defining-a-multiple-regression"><i class="fa fa-check"></i><b>6.1.1</b> Defining a multiple regression</a></li>
<li class="chapter" data-level="6.1.2" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#approximating-the-posterior"><i class="fa fa-check"></i><b>6.1.2</b> Approximating the posterior</a></li>
<li class="chapter" data-level="6.1.3" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#the-flow"><i class="fa fa-check"></i><b>6.1.3</b> The flow</a>
<ul>
<li class="chapter" data-level="6.1.3.1" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#posterior-prediction-plots"><i class="fa fa-check"></i><b>6.1.3.1</b> Posterior Prediction Plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#masked-relationship"><i class="fa fa-check"></i><b>6.2</b> Masked Relationship</a></li>
<li class="chapter" data-level="6.3" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#categorical-variables"><i class="fa fa-check"></i><b>6.3</b> Categorical Variables</a></li>
<li class="chapter" data-level="6.4" data-path="chapter-5-the-many-variables-the-spurious-waffles.html"><a href="chapter-5-the-many-variables-the-spurious-waffles.html#lecture-notes---not-integrated-in-the-notes"><i class="fa fa-check"></i><b>6.4</b> Lecture notes - not integrated in the notes</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html"><i class="fa fa-check"></i><b>7</b> Chapter 6 - The Haunted DAG &amp; The Causal Terror</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#multicollinearity"><i class="fa fa-check"></i><b>7.1</b> Multicollinearity</a></li>
<li class="chapter" data-level="7.2" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#post-treatment-bias"><i class="fa fa-check"></i><b>7.2</b> Post Treatment Bias</a></li>
<li class="chapter" data-level="7.3" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#collider-bias"><i class="fa fa-check"></i><b>7.3</b> Collider Bias</a></li>
<li class="chapter" data-level="7.4" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#confronting-confounding"><i class="fa fa-check"></i><b>7.4</b> Confronting Confounding</a></li>
<li class="chapter" data-level="7.5" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#exercises-3"><i class="fa fa-check"></i><b>7.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#m1-3"><i class="fa fa-check"></i><b>7.5.1</b> 6M1</a></li>
<li class="chapter" data-level="7.5.2" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#m3-1"><i class="fa fa-check"></i><b>7.5.2</b> 6M3</a></li>
<li class="chapter" data-level="7.5.3" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h"><i class="fa fa-check"></i><b>7.5.3</b> 6H</a></li>
<li class="chapter" data-level="7.5.4" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h3-2"><i class="fa fa-check"></i><b>7.5.4</b> 6H3</a></li>
<li class="chapter" data-level="7.5.5" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h4-1"><i class="fa fa-check"></i><b>7.5.5</b> 6H4</a></li>
<li class="chapter" data-level="7.5.6" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#h5-1"><i class="fa fa-check"></i><b>7.5.6</b> 6H5</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="chapter-6-the-haunted-dag-the-causal-terror.html"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#lecture-notes---not-integrated-in-the-text"><i class="fa fa-check"></i><b>7.6</b> Lecture notes - not integrated in the text</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html"><i class="fa fa-check"></i><b>8</b> Chapter 7 - Model comparison</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#the-problem-with-parameters"><i class="fa fa-check"></i><b>8.1</b> The problem with parameters</a></li>
<li class="chapter" data-level="8.2" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#entropy-and-accuracy"><i class="fa fa-check"></i><b>8.2</b> Entropy and Accuracy</a></li>
<li class="chapter" data-level="8.3" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#golem-taming-regularization"><i class="fa fa-check"></i><b>8.3</b> Golem Taming: Regularization</a></li>
<li class="chapter" data-level="8.4" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#predicting-predictive-accuracy"><i class="fa fa-check"></i><b>8.4</b> Predicting predictive accuracy</a></li>
<li class="chapter" data-level="8.5" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#model-comparison"><i class="fa fa-check"></i><b>8.5</b> Model Comparison</a></li>
<li class="chapter" data-level="8.6" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#exercies"><i class="fa fa-check"></i><b>8.6</b> Exercies</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#m3-2"><i class="fa fa-check"></i><b>8.6.1</b> 7M3</a></li>
<li class="chapter" data-level="8.6.2" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#m4-1"><i class="fa fa-check"></i><b>8.6.2</b> 7M4</a></li>
<li class="chapter" data-level="8.6.3" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#m5-1"><i class="fa fa-check"></i><b>8.6.3</b> 7M5</a></li>
<li class="chapter" data-level="8.6.4" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#m6"><i class="fa fa-check"></i><b>8.6.4</b> 7M6</a></li>
<li class="chapter" data-level="8.6.5" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#h1-2"><i class="fa fa-check"></i><b>8.6.5</b> 7H1</a></li>
<li class="chapter" data-level="8.6.6" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#h2-2"><i class="fa fa-check"></i><b>8.6.6</b> 7H2</a>
<ul>
<li class="chapter" data-level="8.6.6.1" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#identify-the-outlier"><i class="fa fa-check"></i><b>8.6.6.1</b> (1) Identify the outlier</a></li>
<li class="chapter" data-level="8.6.6.2" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#inspect-model-predictions"><i class="fa fa-check"></i><b>8.6.6.2</b> (2) Inspect model predictions</a></li>
<li class="chapter" data-level="8.6.6.3" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#using-students-t-distribution"><i class="fa fa-check"></i><b>8.6.6.3</b> (3) Using students t distribution</a></li>
</ul></li>
<li class="chapter" data-level="8.6.7" data-path="chapter-7-model-comparison.html"><a href="chapter-7-model-comparison.html#h5-2"><i class="fa fa-check"></i><b>8.6.7</b> 7H5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html"><i class="fa fa-check"></i><b>9</b> Chapter 8 - Model comparison</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#building-an-interaction"><i class="fa fa-check"></i><b>9.1</b> Building an interaction</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#adding-an-indicator-variable-isnt-enough."><i class="fa fa-check"></i><b>9.1.1</b> Adding an indicator variable isn’t enough.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#symmetry-of-interactions"><i class="fa fa-check"></i><b>9.2</b> Symmetry of interactions</a></li>
<li class="chapter" data-level="9.3" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#continuous-interactions"><i class="fa fa-check"></i><b>9.3</b> Continuous interactions</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#a-winter-flower"><i class="fa fa-check"></i><b>9.3.1</b> A Winter Flower</a></li>
<li class="chapter" data-level="9.3.2" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#the-models"><i class="fa fa-check"></i><b>9.3.2</b> The models</a></li>
<li class="chapter" data-level="9.3.3" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#plotting-posterior-predictions"><i class="fa fa-check"></i><b>9.3.3</b> Plotting posterior predictions</a></li>
<li class="chapter" data-level="9.3.4" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#plotting-prior-predictions"><i class="fa fa-check"></i><b>9.3.4</b> Plotting prior predictions</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#exercises-4"><i class="fa fa-check"></i><b>9.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#m4-2"><i class="fa fa-check"></i><b>9.4.1</b> 8M4</a>
<ul>
<li class="chapter" data-level="9.4.1.1" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#interaction-model"><i class="fa fa-check"></i><b>9.4.1.1</b> Interaction model</a></li>
<li class="chapter" data-level="9.4.1.2" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#conclusion"><i class="fa fa-check"></i><b>9.4.1.2</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9.4.2" data-path="chapter-8-model-comparison.html"><a href="chapter-8-model-comparison.html#h3-3"><i class="fa fa-check"></i><b>9.4.2</b> 8H3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>10</b> Chapter 9 - Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#good-king-markov-and-his-island-kingdom"><i class="fa fa-check"></i><b>10.1</b> Good King Markov and his island kingdom</a></li>
<li class="chapter" data-level="10.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#metropolis-algorithms"><i class="fa fa-check"></i><b>10.2</b> Metropolis algorithms</a></li>
<li class="chapter" data-level="10.3" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#hamiltonian-monte-carlo"><i class="fa fa-check"></i><b>10.3</b> Hamiltonian Monte Carlo</a></li>
<li class="chapter" data-level="10.4" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#easy-hmc-ulam"><i class="fa fa-check"></i><b>10.4</b> Easy HMC: ulam</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#fitting-using-quap"><i class="fa fa-check"></i><b>10.4.1</b> Fitting using quap</a></li>
<li class="chapter" data-level="10.4.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#fitting-using-hmc"><i class="fa fa-check"></i><b>10.4.2</b> Fitting using HMC</a>
<ul>
<li class="chapter" data-level="10.4.2.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#preparing-data"><i class="fa fa-check"></i><b>10.4.2.1</b> Preparing data</a></li>
<li class="chapter" data-level="10.4.2.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#sampling-from-the-posterior-1"><i class="fa fa-check"></i><b>10.4.2.2</b> Sampling from the posterior</a></li>
<li class="chapter" data-level="10.4.2.3" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#sampling-again-in-parallel"><i class="fa fa-check"></i><b>10.4.2.3</b> Sampling again, in parallel</a></li>
<li class="chapter" data-level="10.4.2.4" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#visualization"><i class="fa fa-check"></i><b>10.4.2.4</b> Visualization</a></li>
<li class="chapter" data-level="10.4.2.5" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#checking-the-chain"><i class="fa fa-check"></i><b>10.4.2.5</b> Checking the chain</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#care-and-feeding-of-your-markov-chain"><i class="fa fa-check"></i><b>10.5</b> Care and feeding of your Markov chain</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#how-many-samples-do-you-need"><i class="fa fa-check"></i><b>10.5.1</b> How many samples do you need?</a></li>
<li class="chapter" data-level="10.5.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#how-many-chains-do-you-need"><i class="fa fa-check"></i><b>10.5.2</b> How many chains do you need?</a></li>
<li class="chapter" data-level="10.5.3" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#taming-a-wild-chain"><i class="fa fa-check"></i><b>10.5.3</b> Taming a wild chain</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#exercises-5"><i class="fa fa-check"></i><b>10.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#e4"><i class="fa fa-check"></i><b>10.6.1</b> E4</a></li>
<li class="chapter" data-level="10.6.2" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#e5"><i class="fa fa-check"></i><b>10.6.2</b> E5</a></li>
<li class="chapter" data-level="10.6.3" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#e6"><i class="fa fa-check"></i><b>10.6.3</b> E6</a></li>
<li class="chapter" data-level="10.6.4" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#e7"><i class="fa fa-check"></i><b>10.6.4</b> E7</a></li>
<li class="chapter" data-level="10.6.5" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#m1-4"><i class="fa fa-check"></i><b>10.6.5</b> M1</a></li>
<li class="chapter" data-level="10.6.6" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#h2-3"><i class="fa fa-check"></i><b>10.6.6</b> H2</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="chapter-9-markov-chain-monte-carlo.html"><a href="chapter-9-markov-chain-monte-carlo.html#lecture-notes"><i class="fa fa-check"></i><b>10.7</b> Lecture notes</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>11</b> Big Entropy and the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="11.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#maximum-entropy"><i class="fa fa-check"></i><b>11.1</b> Maximum Entropy</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#binomial"><i class="fa fa-check"></i><b>11.1.1</b> Binomial</a>
<ul>
<li class="chapter" data-level="11.1.1.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#example-from-the-lecture"><i class="fa fa-check"></i><b>11.1.1.1</b> Example from the lecture</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#generalized-linear-models"><i class="fa fa-check"></i><b>11.2</b> Generalized linear models</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#meet-the-family"><i class="fa fa-check"></i><b>11.2.1</b> Meet the family</a></li>
<li class="chapter" data-level="11.2.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#linking-linear-models-to-distributions"><i class="fa fa-check"></i><b>11.2.2</b> Linking linear models to distributions</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#maximum-entropy-priors"><i class="fa fa-check"></i><b>11.3</b> Maximum entropy priors</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html"><i class="fa fa-check"></i><b>12</b> God Spiked the Integers</a>
<ul>
<li class="chapter" data-level="12.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#binomial-regression"><i class="fa fa-check"></i><b>12.1</b> Binomial Regression</a>
<ul>
<li class="chapter" data-level="12.1.0.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#logistic-regression-prosocial-chimpanzees"><i class="fa fa-check"></i><b>12.1.0.1</b> Logistic regression: Prosocial chimpanzees:</a></li>
<li class="chapter" data-level="12.1.0.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#relative-shark-and-absolute-deer"><i class="fa fa-check"></i><b>12.1.0.2</b> Relative shark and absolute deer</a></li>
<li class="chapter" data-level="12.1.0.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#aggregated-binomial-chimpanzees-again-condensed."><i class="fa fa-check"></i><b>12.1.0.3</b> Aggregated binomial: Chimpanzees again, condensed.</a></li>
<li class="chapter" data-level="12.1.0.4" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#aggregated-binomial-graduate-school-admissions"><i class="fa fa-check"></i><b>12.1.0.4</b> Aggregated binomial: Graduate school admissions</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#poisson-regression"><i class="fa fa-check"></i><b>12.2</b> Poisson Regression</a>
<ul>
<li class="chapter" data-level="12.2.0.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#negative-binomial-gamma-poisson-models."><i class="fa fa-check"></i><b>12.2.0.1</b> Negative binomial (gamma-poisson) models.</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#multinomial-regression"><i class="fa fa-check"></i><b>12.3</b> Multinomial Regression</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#example-from-the-lecture-1"><i class="fa fa-check"></i><b>12.3.1</b> Example from the lecture</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#exercies-1"><i class="fa fa-check"></i><b>12.4</b> Exercies</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#e1"><i class="fa fa-check"></i><b>12.4.1</b> E1</a></li>
<li class="chapter" data-level="12.4.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#e2"><i class="fa fa-check"></i><b>12.4.2</b> E2</a></li>
<li class="chapter" data-level="12.4.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#e3"><i class="fa fa-check"></i><b>12.4.3</b> E3</a></li>
<li class="chapter" data-level="12.4.4" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#m7"><i class="fa fa-check"></i><b>12.4.4</b> M7</a></li>
<li class="chapter" data-level="12.4.5" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#h1-3"><i class="fa fa-check"></i><b>12.4.5</b> H1</a></li>
<li class="chapter" data-level="12.4.6" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#h2-4"><i class="fa fa-check"></i><b>12.4.6</b> H2</a></li>
<li class="chapter" data-level="12.4.7" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#h3-4"><i class="fa fa-check"></i><b>12.4.7</b> H3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html"><i class="fa fa-check"></i><b>13</b> Ch 13 - Models with Memory</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#example-multilevel-tadpoles"><i class="fa fa-check"></i><b>13.1</b> Example: Multilevel tadpoles</a></li>
<li class="chapter" data-level="13.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#varying-effects-and-the-underfitting-overfitting-trade-off"><i class="fa fa-check"></i><b>13.2</b> Varying effects and the underfitting / overfitting trade-off</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#the-model-1"><i class="fa fa-check"></i><b>13.2.1</b> The model</a></li>
<li class="chapter" data-level="13.2.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#assign-values-to-the-parameters"><i class="fa fa-check"></i><b>13.2.2</b> Assign values to the parameters</a></li>
<li class="chapter" data-level="13.2.3" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#simulate-survivors"><i class="fa fa-check"></i><b>13.2.3</b> Simulate survivors</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#more-than-one-type-of-cluster"><i class="fa fa-check"></i><b>13.3</b> More than one type of cluster</a></li>
<li class="chapter" data-level="13.4" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#divergent-transitions-and-non-centered-priors"><i class="fa fa-check"></i><b>13.4</b> Divergent transitions and non-centered priors</a>
<ul>
<li class="chapter" data-level="13.4.0.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#the-devils-funnel-example"><i class="fa fa-check"></i><b>13.4.0.1</b> The Devil’s Funnel: (example)</a></li>
<li class="chapter" data-level="13.4.0.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#non-centered-chimpanzees-example"><i class="fa fa-check"></i><b>13.4.0.2</b> Non-centered chimpanzees (example)</a>
<ul>
<li class="chapter" data-level="13.4.0.2.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#solution-1-centered-parameterization-increasing-acceptance-rate"><i class="fa fa-check"></i><b>13.4.0.2.1</b> Solution 1: Centered parameterization (Increasing acceptance rate)</a></li>
<li class="chapter" data-level="13.4.0.2.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#solution-2-non-centered-version-reparameterize"><i class="fa fa-check"></i><b>13.4.0.2.2</b> Solution 2: Non-centered version (reparameterize)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#multilevel-posterior-predictions"><i class="fa fa-check"></i><b>13.5</b> Multilevel posterior predictions</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#posterior-prediction-for-same-clusters"><i class="fa fa-check"></i><b>13.5.1</b> Posterior prediction for same clusters</a></li>
<li class="chapter" data-level="13.5.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#posterior-prediction-for-new-clusters"><i class="fa fa-check"></i><b>13.5.2</b> Posterior prediction for new clusters</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#exercises-6"><i class="fa fa-check"></i><b>13.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#e1-1"><i class="fa fa-check"></i><b>13.6.1</b> E1</a></li>
<li class="chapter" data-level="13.6.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#e2-1"><i class="fa fa-check"></i><b>13.6.2</b> E2</a></li>
<li class="chapter" data-level="13.6.3" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#e3-1"><i class="fa fa-check"></i><b>13.6.3</b> E3</a></li>
<li class="chapter" data-level="13.6.4" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#e4-1"><i class="fa fa-check"></i><b>13.6.4</b> E4</a></li>
<li class="chapter" data-level="13.6.5" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#m1-5"><i class="fa fa-check"></i><b>13.6.5</b> M1</a></li>
<li class="chapter" data-level="13.6.6" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#h1-4"><i class="fa fa-check"></i><b>13.6.6</b> H1</a>
<ul>
<li class="chapter" data-level="13.6.6.1" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#fixed-effects-model"><i class="fa fa-check"></i><b>13.6.6.1</b> Fixed effects model:</a></li>
<li class="chapter" data-level="13.6.6.2" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#varying-intercepts-model"><i class="fa fa-check"></i><b>13.6.6.2</b> Varying intercepts model:</a></li>
<li class="chapter" data-level="13.6.6.3" data-path="ch-13-models-with-memory.html"><a href="ch-13-models-with-memory.html#extract-samples"><i class="fa fa-check"></i><b>13.6.6.3</b> Extract samples</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html"><i class="fa fa-check"></i><b>14</b> Ch 14 - Advuntetures in Coviaraince</a>
<ul>
<li class="chapter" data-level="14.1" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#varying-slopes-by-construction"><i class="fa fa-check"></i><b>14.1</b> Varying slopes by construction</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#simulate-the-population"><i class="fa fa-check"></i><b>14.1.1</b> Simulate the population</a></li>
<li class="chapter" data-level="14.1.2" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#simulate-observations"><i class="fa fa-check"></i><b>14.1.2</b> Simulate observations</a></li>
<li class="chapter" data-level="14.1.3" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#the-varying-slopes-model"><i class="fa fa-check"></i><b>14.1.3</b> The varying slopes model</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#advanced-varying-slopes"><i class="fa fa-check"></i><b>14.2</b> Advanced varying slopes</a>
<ul>
<li class="chapter" data-level="14.2.0.1" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#inference"><i class="fa fa-check"></i><b>14.2.0.1</b> Inference!</a></li>
<li class="chapter" data-level="14.2.0.2" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#conclusions---multilevel-horoscopes"><i class="fa fa-check"></i><b>14.2.0.2</b> Conclusions - multilevel horoscopes</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#exercises-7"><i class="fa fa-check"></i><b>14.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#e1-2"><i class="fa fa-check"></i><b>14.3.1</b> E1</a></li>
<li class="chapter" data-level="14.3.2" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#e3-2"><i class="fa fa-check"></i><b>14.3.2</b> E3</a></li>
<li class="chapter" data-level="14.3.3" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#h1-5"><i class="fa fa-check"></i><b>14.3.3</b> H1</a></li>
<li class="chapter" data-level="14.3.4" data-path="ch-14-advuntetures-in-coviaraince.html"><a href="ch-14-advuntetures-in-coviaraince.html#h2-5"><i class="fa fa-check"></i><b>14.3.4</b> H2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html"><i class="fa fa-check"></i><b>15</b> Ch 14 - Adventures in Covariance</a>
<ul>
<li class="chapter" data-level="15.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#ch-14.3---instruments-and-causal-designs"><i class="fa fa-check"></i><b>15.1</b> Ch 14.3 - Instruments and causal designs</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#instrumental-variables"><i class="fa fa-check"></i><b>15.1.1</b> Instrumental variables</a>
<ul>
<li class="chapter" data-level="15.1.1.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#only-including-e-we-add-confounding-effect-sideeffect-of-e"><i class="fa fa-check"></i><b>15.1.1.1</b> 1. Only including E (we add confounding effect sideeffect of E)</a></li>
<li class="chapter" data-level="15.1.1.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#adding-instrument-q-the-wrong-way"><i class="fa fa-check"></i><b>15.1.1.2</b> 2. Adding instrument Q (the wrong way)</a></li>
<li class="chapter" data-level="15.1.1.3" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#correct-use-of-the-instrument-variable"><i class="fa fa-check"></i><b>15.1.1.3</b> 3. Correct use of the instrument variable</a></li>
</ul></li>
<li class="chapter" data-level="15.1.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#other-designs"><i class="fa fa-check"></i><b>15.1.2</b> Other designs</a>
<ul>
<li class="chapter" data-level="15.1.2.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#front-door-criterion"><i class="fa fa-check"></i><b>15.1.2.1</b> Front-Door Criterion</a></li>
<li class="chapter" data-level="15.1.2.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#regression-discontinuity-rdd"><i class="fa fa-check"></i><b>15.1.2.2</b> Regression discontinuity (RDD)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#gaussian-processes-continuous-categories-and-the-gaussian-process"><i class="fa fa-check"></i><b>15.2</b> (Gaussian Processes) Continuous categories and the Gaussian process</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#example-spatial-autocorrelation-in-oceanic-tools"><i class="fa fa-check"></i><b>15.2.1</b> Example: Spatial autocorrelation in Oceanic tools</a>
<ul>
<li class="chapter" data-level="15.2.1.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#loading-data-defining-model"><i class="fa fa-check"></i><b>15.2.1.1</b> Loading data + defining model</a></li>
<li class="chapter" data-level="15.2.1.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#the-full-model"><i class="fa fa-check"></i><b>15.2.1.2</b> The full model</a></li>
<li class="chapter" data-level="15.2.1.3" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#gaussian-process-posterior"><i class="fa fa-check"></i><b>15.2.1.3</b> Gaussian Process Posterior</a></li>
</ul></li>
<li class="chapter" data-level="15.2.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#example-phylogenetic-distance-not-in-the-curriculum"><i class="fa fa-check"></i><b>15.2.2</b> Example: Phylogenetic distance (not in the curriculum)</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#exercises-8"><i class="fa fa-check"></i><b>15.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#m3-3"><i class="fa fa-check"></i><b>15.3.1</b> M3</a></li>
<li class="chapter" data-level="15.3.2" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#m4-3"><i class="fa fa-check"></i><b>15.3.2</b> M4</a></li>
<li class="chapter" data-level="15.3.3" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#h2-6"><i class="fa fa-check"></i><b>15.3.3</b> H2</a></li>
<li class="chapter" data-level="15.3.4" data-path="ch-14-adventures-in-covariance.html"><a href="ch-14-adventures-in-covariance.html#h4-varying-intercepts-varying-slopes"><i class="fa fa-check"></i><b>15.3.4</b> H4 Varying intercepts Varying slopes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Data Analysis Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter-6---the-haunted-dag-the-causal-terror" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Chapter 6 - The Haunted DAG &amp; The Causal Terror</h1>
<p>It is called the haunting DAG, as we see that checking different variables, may create colliders, where doing inference, the actual state will be skewed, e.g., see lecture notes @ref(lecture-notes—not-integrated-in-the-text).</p>
<p>The following sections elaborates on three hazards:</p>
<ol style="list-style-type: decimal">
<li>Multicollinearity</li>
<li>Post Treatment Bias</li>
<li>Collider Bias</li>
</ol>
<div id="multicollinearity" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Multicollinearity</h2>
<p>Multicollinearity is in its core not a bad effect in your model, although you want to avoid it when doing inference. In the litterature, there is an example of predicting heights based on the length of each leg, we see that the sum of the coefficient will add to the mean of the leg length in general.</p>
<p>Hence overall the model will predict the right results although inference wise it is counter intuitive.</p>
<p>In another example we have two highly correlated predictor variables that goes the opposite way of each other. We know in this example that these are in fact explained by the same (unobserved) variable, hence when you know one, you will also know the other.</p>
<div class="figure">
<img src="Images/paste-57ED2122.png" alt="" />
<p class="caption">L = lactose, F = fat. D = density. When the density is low, it has high lactose and low fat and the opposite. Thus if we know F, then we know F and L and if we know D, we will know both L and F, hence we want to only include one of the observed variables into the model.</p>
</div>
<p>In this example we saw from <code>precis</code> that when each observed variable is regressed individually the mean and compatibility intervals are far on each side of 0, although when both are included it will for both variables be centered, more or less, at 0 and have CI on both sides of 0.</p>
<p><strong><em>Notice that just because two variable correlate, we do not by default want to remove them!</em></strong></p>
<p><strong>Conclusion:</strong> Just because you have many causal explanatory variables at hand, it does not mean that you should use all of them.</p>
</div>
<div id="post-treatment-bias" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Post Treatment Bias</h2>
<p>did not get this</p>
</div>
<div id="collider-bias" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Collider Bias</h2>
<p>For this I will refer to the examples in the book about the grandchildren and the parents influence on childrens education <span class="citation"><a href="references.html#ref-mcelreath2020" role="doc-biblioref">McElreath</a> (<a href="references.html#ref-mcelreath2020" role="doc-biblioref">2020</a>)</span> pp. 180 - 182.</p>
<p>In its basics, when we include one variable, it might also indirectly include information on an unobserverd variable that is explaning both the predictor and the target variable. Hence the effect in the predictor P will implicitly also be reflected in the model. I.e., the unobserved effect will be hidden / under the radar, thus we will not be able to distinguish this effect from the actual effect of P.</p>
</div>
<div id="confronting-confounding" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Confronting Confounding</h2>
<p>No matter the size of the DAG, the model will consist of the following types:</p>
<p><img src="Images/paste-0D2F0876.png" /></p>
<p>There are scenarios we want to avoid etc.</p>
<ul>
<li>That I could elaborate on in the notes</li>
</ul>
<p>The approach to analyzing the DAG:</p>
<ol style="list-style-type: decimal">
<li>List all paths (paths disregard directions) connecting X and Y</li>
<li>Classify each path by whether it is open or closed. A path is open unless it contains a collider</li>
<li>Classify each path by whether it is a backdoor path. A backdoor path has an arrow entering X.</li>
<li>If there are any open backdoor paths, decide which variable(s) to condition on o close it (if possible).</li>
</ol>
<p>Pages 186 - 187 has examples on scenarios to avoid and how to close backdoors.</p>
<p>We have the following example where we want to analyze relationship on W to D.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb163-2"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb163-2" aria-hidden="true" tabindex="-1"></a>dag_6<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">dagitty</span>( <span class="st">&quot;dag {</span></span>
<span id="cb163-3"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="st">  A -&gt; D</span></span>
<span id="cb163-4"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="st">  A -&gt; M -&gt; D</span></span>
<span id="cb163-5"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb163-5" aria-hidden="true" tabindex="-1"></a><span class="st">  A &lt;- S -&gt; M</span></span>
<span id="cb163-6"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb163-6" aria-hidden="true" tabindex="-1"></a><span class="st">  S -&gt; W -&gt; D</span></span>
<span id="cb163-7"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb163-7" aria-hidden="true" tabindex="-1"></a><span class="st">  }&quot;</span></span>
<span id="cb163-8"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb163-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb163-9"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb163-9" aria-hidden="true" tabindex="-1"></a><span class="co"># coordinates(dag_6.2) &lt;- list(x = c(S=3,W=3,M=2,A=0,D=0)</span></span>
<span id="cb163-10"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb163-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                              ,y = c(S=0,W=3,M=2,A=0,D=3))</span></span>
<span id="cb163-11"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb163-11" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>(dag_6<span class="fl">.2</span>)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-85-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>There are 3 open backdoors:</p>
<ol style="list-style-type: decimal">
<li>S -&gt; A</li>
<li>S -&gt; M</li>
<li>S -&gt; W</li>
</ol>
<p>These all flow from S and affects either W or D. <em>Solution:</em> is to control for S, which will</p>
<p>We can control for this with <code>adjustmentSets()</code>, which will show variables that we should make indepent given we control for a specific variable.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>( dag_6<span class="fl">.2</span> , <span class="at">exposure=</span><span class="st">&quot;W&quot;</span> , <span class="at">outcome=</span><span class="st">&quot;D&quot;</span> )</span></code></pre></div>
<pre><code>## { A, M }
## { S }</code></pre>
<p>We see that we can either control for A and M or S.</p>
<p>We can also let the model find the conditional independences by saying:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">impliedConditionalIndependencies</span>(dag_6<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## A _||_ W | S
## D _||_ S | A, M, W
## M _||_ W | S</code></pre>
<p>Thus we see that A and W are independent given we control for S.</p>
</div>
<div id="exercises-3" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Exercises</h2>
<div id="m1-3" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> 6M1</h3>
<p>Modify the DAG on page 186 to include the variable V, an unobserved cause of C and Y: C &lt;- V -&gt; Y. Reanalyze the DAG.How many paths connect X to Y? Which must be closed? Which variables should you condition on now?</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb168-2"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb168-3"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb168-3" aria-hidden="true" tabindex="-1"></a>dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>( <span class="st">&quot;dag {</span></span>
<span id="cb168-4"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="st">  U [unobserved]</span></span>
<span id="cb168-5"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="st">  V [unobserved]</span></span>
<span id="cb168-6"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb168-6" aria-hidden="true" tabindex="-1"></a><span class="st">  X [exposure]</span></span>
<span id="cb168-7"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="st">  Y [outcome]</span></span>
<span id="cb168-8"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb168-8" aria-hidden="true" tabindex="-1"></a><span class="st">  A -&gt; U</span></span>
<span id="cb168-9"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb168-9" aria-hidden="true" tabindex="-1"></a><span class="st">  A -&gt; C</span></span>
<span id="cb168-10"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb168-10" aria-hidden="true" tabindex="-1"></a><span class="st">  U -&gt; B</span></span>
<span id="cb168-11"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb168-11" aria-hidden="true" tabindex="-1"></a><span class="st">  U -&gt; X</span></span>
<span id="cb168-12"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb168-12" aria-hidden="true" tabindex="-1"></a><span class="st">  C -&gt; B</span></span>
<span id="cb168-13"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb168-13" aria-hidden="true" tabindex="-1"></a><span class="st">  C -&gt; Y</span></span>
<span id="cb168-14"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb168-14" aria-hidden="true" tabindex="-1"></a><span class="st">  X -&gt; Y</span></span>
<span id="cb168-15"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb168-15" aria-hidden="true" tabindex="-1"></a><span class="st">  C &lt;- V -&gt; Y</span></span>
<span id="cb168-16"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb168-16" aria-hidden="true" tabindex="-1"></a><span class="st">  }&quot;</span></span>
<span id="cb168-17"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb168-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb168-18"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb168-18" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>(dag)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-88-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Paths (undirected) from X to Y.</p>
<ol style="list-style-type: decimal">
<li><p>List all paths (paths disregard directions) connecting X and Y</p>
<ol style="list-style-type: decimal">
<li>X,Y</li>
<li>X,U,B,C,Y</li>
<li>X,U,A,C,Y</li>
<li>X,U,B,C,V,Y</li>
<li>X,U,A,C,V,Y</li>
</ol></li>
<li><p>Classify each path by whether it is open or closed. A path is open unless it contains a collider</p>
<ul>
<li>We see that B and C are colliders, hence we will not want to touch those, as it will open up the flows to the leading effects.</li>
</ul></li>
<li><p>Classify each path by whether it is a backdoor path. A backdoor path has an arrow entering X.</p>
<ul>
<li>We see that U affects X, hence there is a backdoor. hence we want to close this relationship</li>
</ul></li>
<li><p>If there are any open backdoor paths, decide which variable(s) to condition on o close it (if possible).</p>
<ul>
<li>We see that U is a backdoor path, although it is unobserved hence we cannot adjust the model for that. (But can we adjust for A?)</li>
</ul></li>
</ol>
</div>
<div id="m3-1" class="section level3" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> 6M3</h3>
<p>Learning to analyze DAGs requires practice. For each of the four DAGs below, state which variables, if any, you must adjust for (conditionon) to estimate the total causal influenceof X on Y.</p>
<p><img src="Images/paste-FC71DC06.png" /></p>
<ol style="list-style-type: decimal">
<li>We must condition on Z, as the pipe from A to Y is being closed by conditioning on Z. One could</li>
</ol>
<p><strong>Will this also terminate the flow directly from A to Y?</strong></p>
<ol start="2" style="list-style-type: decimal">
<li><p>(top right): Should not condition on anything. We see that X to Y is causal and open. We see that Z is a collider, hence we dont want that included.</p></li>
<li><p>(bottom left): We see that Z is a collider, we dont want to control for that, thus by default A and Y are independent. Hence we just include X in the model.</p></li>
<li><p>We include X and A.</p></li>
</ol>
<p>We see that in the 4th example that Z is not a collider, that is because if we list all the paths, there will not be any arrows pointing towards each other.</p>
<ol style="list-style-type: decimal">
<li>X -&gt; Y</li>
<li>X -&gt; Z -&gt; Y</li>
<li>X &lt;- A -&gt; Z -&gt; Y</li>
</ol>
<p>Where in the third example we had:</p>
<ol style="list-style-type: decimal">
<li>X -&gt; Z &lt;- Y (We have a collider)</li>
<li>X &lt;- A -&gt; Z &lt;- Y (We have a collider)</li>
<li>X -&gt; Y</li>
</ol>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb169-2"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb169-3"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-3" aria-hidden="true" tabindex="-1"></a>dag1 <span class="ot">&lt;-</span> <span class="fu">dagitty</span>( <span class="st">&quot;dag {</span></span>
<span id="cb169-4"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="st">  X [exposure]</span></span>
<span id="cb169-5"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="st">  Y [outcome]</span></span>
<span id="cb169-6"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-6" aria-hidden="true" tabindex="-1"></a><span class="st">  A -&gt; Z -&gt; X -&gt; Y</span></span>
<span id="cb169-7"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-7" aria-hidden="true" tabindex="-1"></a><span class="st">  Z -&gt; Y</span></span>
<span id="cb169-8"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-8" aria-hidden="true" tabindex="-1"></a><span class="st">  A -&gt; Y</span></span>
<span id="cb169-9"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-9" aria-hidden="true" tabindex="-1"></a><span class="st">  }&quot;</span></span>
<span id="cb169-10"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-11"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-12"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-12" aria-hidden="true" tabindex="-1"></a>dag2 <span class="ot">&lt;-</span> <span class="fu">dagitty</span>( <span class="st">&quot;dag {</span></span>
<span id="cb169-13"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-13" aria-hidden="true" tabindex="-1"></a><span class="st">  X [exposure]</span></span>
<span id="cb169-14"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-14" aria-hidden="true" tabindex="-1"></a><span class="st">  Y [outcome]</span></span>
<span id="cb169-15"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-15" aria-hidden="true" tabindex="-1"></a><span class="st">  A -&gt; Z -&gt; Y</span></span>
<span id="cb169-16"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-16" aria-hidden="true" tabindex="-1"></a><span class="st">  A -&gt; Y</span></span>
<span id="cb169-17"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-17" aria-hidden="true" tabindex="-1"></a><span class="st">  X -&gt; Z</span></span>
<span id="cb169-18"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-18" aria-hidden="true" tabindex="-1"></a><span class="st">  X -&gt; Y</span></span>
<span id="cb169-19"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-19" aria-hidden="true" tabindex="-1"></a><span class="st">  }&quot;</span></span>
<span id="cb169-20"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-21"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-22"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-22" aria-hidden="true" tabindex="-1"></a>dag3 <span class="ot">&lt;-</span> <span class="fu">dagitty</span>( <span class="st">&quot;dag {</span></span>
<span id="cb169-23"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-23" aria-hidden="true" tabindex="-1"></a><span class="st">  X [exposure]</span></span>
<span id="cb169-24"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-24" aria-hidden="true" tabindex="-1"></a><span class="st">  Y [outcome]</span></span>
<span id="cb169-25"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-25" aria-hidden="true" tabindex="-1"></a><span class="st">  A -&gt; X -&gt; Y</span></span>
<span id="cb169-26"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-26" aria-hidden="true" tabindex="-1"></a><span class="st">  A -&gt; Z</span></span>
<span id="cb169-27"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-27" aria-hidden="true" tabindex="-1"></a><span class="st">  X -&gt; Z</span></span>
<span id="cb169-28"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-28" aria-hidden="true" tabindex="-1"></a><span class="st">  Y -&gt; Z</span></span>
<span id="cb169-29"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-29" aria-hidden="true" tabindex="-1"></a><span class="st">  }&quot;</span></span>
<span id="cb169-30"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-31"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-32"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-32" aria-hidden="true" tabindex="-1"></a>dag4 <span class="ot">&lt;-</span> <span class="fu">dagitty</span>( <span class="st">&quot;dag {</span></span>
<span id="cb169-33"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-33" aria-hidden="true" tabindex="-1"></a><span class="st">  X [exposure]</span></span>
<span id="cb169-34"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-34" aria-hidden="true" tabindex="-1"></a><span class="st">  Y [outcome]</span></span>
<span id="cb169-35"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-35" aria-hidden="true" tabindex="-1"></a><span class="st">  A -&gt; Z -&gt; Y</span></span>
<span id="cb169-36"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-36" aria-hidden="true" tabindex="-1"></a><span class="st">  A -&gt; X</span></span>
<span id="cb169-37"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-37" aria-hidden="true" tabindex="-1"></a><span class="st">  X -&gt; Y</span></span>
<span id="cb169-38"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-38" aria-hidden="true" tabindex="-1"></a><span class="st">  X -&gt; Z</span></span>
<span id="cb169-39"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-39" aria-hidden="true" tabindex="-1"></a><span class="st">  }&quot;</span></span>
<span id="cb169-40"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-41"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb169-41" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>(<span class="at">x =</span> dag1,<span class="at">exposure =</span> <span class="st">&quot;X&quot;</span>,<span class="at">outcome =</span> <span class="st">&quot;Y&quot;</span>)</span></code></pre></div>
<pre><code>## { Z }</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>(<span class="at">x =</span> dag2,<span class="at">exposure =</span> <span class="st">&quot;X&quot;</span>,<span class="at">outcome =</span> <span class="st">&quot;Y&quot;</span>)</span></code></pre></div>
<pre><code>##  {}</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>(<span class="at">x =</span> dag3,<span class="at">exposure =</span> <span class="st">&quot;X&quot;</span>,<span class="at">outcome =</span> <span class="st">&quot;Y&quot;</span>)</span></code></pre></div>
<pre><code>##  {}</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>(<span class="at">x =</span> dag4,<span class="at">exposure =</span> <span class="st">&quot;X&quot;</span>,<span class="at">outcome =</span> <span class="st">&quot;Y&quot;</span>)</span></code></pre></div>
<pre><code>## { A }</code></pre>
</div>
<div id="h" class="section level3" number="7.5.3">
<h3><span class="header-section-number">7.5.3</span> 6H</h3>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb177-2"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb177-3"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(foxes)</span>
<span id="cb177-4"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb177-4" aria-hidden="true" tabindex="-1"></a>dfs <span class="ot">&lt;-</span> foxes</span>
<span id="cb177-5"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb177-5" aria-hidden="true" tabindex="-1"></a>dfs<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">scale</span>(dfs<span class="sc">$</span>group)</span>
<span id="cb177-6"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb177-6" aria-hidden="true" tabindex="-1"></a>dfs<span class="sc">$</span>avgfood <span class="ot">&lt;-</span> <span class="fu">scale</span>(dfs<span class="sc">$</span>avgfood)</span>
<span id="cb177-7"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb177-7" aria-hidden="true" tabindex="-1"></a>dfs<span class="sc">$</span>groupsize <span class="ot">&lt;-</span> <span class="fu">scale</span>(dfs<span class="sc">$</span>groupsize)</span>
<span id="cb177-8"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb177-8" aria-hidden="true" tabindex="-1"></a>dfs<span class="sc">$</span>area <span class="ot">&lt;-</span> <span class="fu">scale</span>(dfs<span class="sc">$</span>area)</span>
<span id="cb177-9"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb177-9" aria-hidden="true" tabindex="-1"></a>dfs<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">scale</span>(dfs<span class="sc">$</span>weight)</span>
<span id="cb177-10"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb177-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-11"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb177-11" aria-hidden="true" tabindex="-1"></a>dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>( <span class="st">&quot;dag {</span></span>
<span id="cb177-12"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb177-12" aria-hidden="true" tabindex="-1"></a><span class="st">  weigth [outcome]</span></span>
<span id="cb177-13"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb177-13" aria-hidden="true" tabindex="-1"></a><span class="st">  weigth &lt;- groupsize</span></span>
<span id="cb177-14"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb177-14" aria-hidden="true" tabindex="-1"></a><span class="st">  area -&gt; avgfood -&gt; groupsize</span></span>
<span id="cb177-15"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb177-15" aria-hidden="true" tabindex="-1"></a><span class="st">  avgfood -&gt; weigth</span></span>
<span id="cb177-16"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb177-16" aria-hidden="true" tabindex="-1"></a><span class="st">  }&quot;</span></span>
<span id="cb177-17"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb177-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb177-18"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb177-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-19"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb177-19" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>(dag)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-90-1.png" width="720" style="display: block; margin: auto;" /></p>
</div>
<div id="h3-2" class="section level3" number="7.5.4">
<h3><span class="header-section-number">7.5.4</span> 6H3</h3>
<p>Use a model to infer the total causal influence of area on weight. Would increasing the <strong>area</strong> available to each fox make it <strong>heavier</strong> (healthier)? You might want to standardize the variables. Regardless, use prior predictive simulation to show that your model’s prior predictions stay within the possible outcome range.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb178-2"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb178-3"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb178-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-4"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb178-4" aria-hidden="true" tabindex="-1"></a>dag3 <span class="ot">&lt;-</span> <span class="fu">dagitty</span>( <span class="st">&quot;dag {</span></span>
<span id="cb178-5"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb178-5" aria-hidden="true" tabindex="-1"></a><span class="st">  weigth [outcome]</span></span>
<span id="cb178-6"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="st">  area [exposure]</span></span>
<span id="cb178-7"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb178-7" aria-hidden="true" tabindex="-1"></a><span class="st">  weigth &lt;- groupsize</span></span>
<span id="cb178-8"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb178-8" aria-hidden="true" tabindex="-1"></a><span class="st">  area -&gt; avgfood -&gt; groupsize</span></span>
<span id="cb178-9"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb178-9" aria-hidden="true" tabindex="-1"></a><span class="st">  avgfood -&gt; weigth</span></span>
<span id="cb178-10"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb178-10" aria-hidden="true" tabindex="-1"></a><span class="st">  }&quot;</span></span>
<span id="cb178-11"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb178-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb178-12"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb178-12" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>(dag)</span></code></pre></div>
<p><img src="Bayesian-Data-Analysis-Notes_files/figure-html/unnamed-chunk-91-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Possible paths:</p>
<ol style="list-style-type: decimal">
<li>area &gt; avgfood &gt; weight</li>
<li>area &gt; avgfood &gt; groupsize &gt; weight</li>
</ol>
<p>We just need to include Area.</p>
<p>Now for the analysis.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb179-2"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(foxes)</span>
<span id="cb179-3"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb179-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> foxes</span>
<span id="cb179-4"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb179-4" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>W <span class="ot">&lt;-</span> <span class="fu">standardize</span>(d<span class="sc">$</span>weight)</span>
<span id="cb179-5"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb179-5" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>A <span class="ot">&lt;-</span> <span class="fu">standardize</span>(d<span class="sc">$</span>area)</span>
<span id="cb179-6"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb179-6" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb179-7"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb179-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb179-8"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb179-8" aria-hidden="true" tabindex="-1"></a>    W <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ), <span class="co">#Weight is a normal distribution</span></span>
<span id="cb179-9"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb179-9" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bA<span class="sc">*</span>A, <span class="co">#the mean weights are defined by an intercept and a slope for A (area)</span></span>
<span id="cb179-10"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb179-10" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="co">#The intercept prior</span></span>
<span id="cb179-11"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb179-11" aria-hidden="true" tabindex="-1"></a>    bA <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="co">#The slope prior</span></span>
<span id="cb179-12"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb179-12" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>) <span class="co">#The variance</span></span>
<span id="cb179-13"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb179-13" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">data=</span>d )</span>
<span id="cb179-14"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb179-14" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m1)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0000008</td>
</tr>
<tr class="even">
<td align="right">0.0188331</td>
</tr>
<tr class="odd">
<td align="right">0.9912657</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0836086</td>
</tr>
<tr class="even">
<td align="right">0.0908958</td>
</tr>
<tr class="odd">
<td align="right">0.0646664</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.1336220</td>
</tr>
<tr class="even">
<td align="right">-0.1264359</td>
</tr>
<tr class="odd">
<td align="right">0.8879162</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1336235</td>
</tr>
<tr class="even">
<td align="right">0.1641021</td>
</tr>
<tr class="odd">
<td align="right">1.0946151</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>We see that the intercept is 0 although with a standard deviation of 0.08. We then see for each unit of area the weight is increasing by 0.02, while the standard deviation is 0.09m thus the weight is expected to both go up and down.</p>
<p>Thus statistically we cannot infer anything about the relationship.</p>
</div>
<div id="h4-1" class="section level3" number="7.5.5">
<h3><span class="header-section-number">7.5.5</span> 6H4</h3>
<p>Now infer the causal impact of adding food to a territory. Would this make foxes heavier? Which covariates do you need to adjust for to estimate the total causal influence of food.</p>
<p>Now we want to see if food is increasing weight, thus X is avgfood and Y is Weight</p>
<p>We see that there is a pipe from avgfood through groupsize, that implies that there is a direct effect from avgfood to weight, but also an indirect effect through groupsize. The task just says to measure the overall effect of food. Hence we want to construct a model only with food. We can do that as there are no backdoors to our explanatory variable.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb180-2"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(foxes)</span>
<span id="cb180-3"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(foxes)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">group</th>
<th align="right">avgfood</th>
<th align="right">groupsize</th>
<th align="right">area</th>
<th align="right">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.37</td>
<td align="right">2</td>
<td align="right">1.09</td>
<td align="right">5.02</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0.37</td>
<td align="right">2</td>
<td align="right">1.09</td>
<td align="right">2.84</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">0.53</td>
<td align="right">2</td>
<td align="right">2.05</td>
<td align="right">5.33</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.53</td>
<td align="right">2</td>
<td align="right">2.05</td>
<td align="right">6.07</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.49</td>
<td align="right">2</td>
<td align="right">2.12</td>
<td align="right">5.85</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">0.49</td>
<td align="right">2</td>
<td align="right">2.12</td>
<td align="right">3.25</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb181-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> foxes</span>
<span id="cb181-2"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb181-2" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>W <span class="ot">&lt;-</span> <span class="fu">standardize</span>(d<span class="sc">$</span>weight)</span>
<span id="cb181-3"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb181-3" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>AF <span class="ot">&lt;-</span> <span class="fu">standardize</span>(d<span class="sc">$</span>avgfood)</span>
<span id="cb181-4"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb181-4" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb181-5"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb181-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb181-6"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb181-6" aria-hidden="true" tabindex="-1"></a>    W <span class="sc">~</span> <span class="fu">dnorm</span>(mu,sigma),</span>
<span id="cb181-7"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb181-7" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bAF<span class="sc">*</span>AF <span class="sc">+</span> sigma,</span>
<span id="cb181-8"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb181-8" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb181-9"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb181-9" aria-hidden="true" tabindex="-1"></a>    bAF <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.5</span>),</span>
<span id="cb181-10"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb181-10" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb181-11"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb181-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb181-12"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb181-12" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data =</span> d</span>
<span id="cb181-13"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb181-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb181-14"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb181-14" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m2)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.7849851</td>
</tr>
<tr class="even">
<td align="right">-0.0243044</td>
</tr>
<tr class="odd">
<td align="right">0.9319074</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0855213</td>
</tr>
<tr class="even">
<td align="right">0.0856174</td>
</tr>
<tr class="odd">
<td align="right">0.0550372</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.9216646</td>
</tr>
<tr class="even">
<td align="right">-0.1611374</td>
</tr>
<tr class="odd">
<td align="right">0.8439473</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.6483056</td>
</tr>
<tr class="even">
<td align="right">0.1125287</td>
</tr>
<tr class="odd">
<td align="right">1.0198675</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>We see that there is a great deal of uncertainty as the mean beta coefficient is -0.02, although the standard deviation suggests that it can both go up and down (the weight)</p>
<p>Also notice that we did find that area had no effect on weight, and it makes sense that there is cause from area to avgfood, and thus increasing avgfood is similar to increasing area, thus it is expected with no effect. Although it would also be an explanation that a larger area would enable them to roam more around, hence food density would probably have been a better variable or at least interesting.</p>
</div>
<div id="h5-1" class="section level3" number="7.5.6">
<h3><span class="header-section-number">7.5.6</span> 6H5</h3>
<p>Consider your own research questing. Draw a DAG to represent it. What is the testatable implications of your DAG. Are there any variables you could condition on to close all backdoor paths? Are there unobserved variables that yoy have omitted? Would a reasonable colleague imagine additional threats to causal inference that you have ignored?</p>
<p>Lets just take the same data as above and add groupsize instead.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb182-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> foxes</span>
<span id="cb182-2"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb182-2" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>W <span class="ot">&lt;-</span> <span class="fu">standardize</span>(d<span class="sc">$</span>weight)</span>
<span id="cb182-3"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb182-3" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>G <span class="ot">&lt;-</span> <span class="fu">standardize</span>(d<span class="sc">$</span>groupsize)</span>
<span id="cb182-4"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb182-4" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb182-5"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb182-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb182-6"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb182-6" aria-hidden="true" tabindex="-1"></a>    W <span class="sc">~</span> <span class="fu">dnorm</span>(mu,sigma),</span>
<span id="cb182-7"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb182-7" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bG<span class="sc">*</span>G <span class="sc">+</span> sigma,</span>
<span id="cb182-8"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb182-8" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb182-9"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb182-9" aria-hidden="true" tabindex="-1"></a>    bG <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb182-10"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb182-10" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb182-11"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb182-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb182-12"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb182-12" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data =</span> d</span>
<span id="cb182-13"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb182-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb182-14"><a href="chapter-6-the-haunted-dag-the-causal-terror.html#cb182-14" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m3)</span></code></pre></div>
<div class="kable-table">
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.7787903</td>
</tr>
<tr class="even">
<td align="right">-0.1359307</td>
</tr>
<tr class="odd">
<td align="right">0.9212543</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0848406</td>
</tr>
<tr class="even">
<td align="right">0.0789734</td>
</tr>
<tr class="odd">
<td align="right">0.0545018</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.9143819</td>
</tr>
<tr class="even">
<td align="right">-0.2621456</td>
</tr>
<tr class="odd">
<td align="right">0.8341500</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.6431987</td>
</tr>
<tr class="even">
<td align="right">-0.0097159</td>
</tr>
<tr class="odd">
<td align="right">1.0083587</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<p>We see that group size tend to have a negative effect on the weight, hence by one group size unit increase standard deviation we will expect to weigh less.</p>
</div>
</div>
<div id="lecture-notes---not-integrated-in-the-text" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Lecture notes - not integrated in the text</h2>
<p>There are the following types:</p>
<p><img src="Images/paste-AF9AF12A.png" /></p>
<p><strong>The fork:</strong> We see that Z is a commen cause, thus when we know the outcome of Z, there is no relationship between X and Y.</p>
<p><img src="Images/paste-6AF0B30B.png" /></p>
<p><strong>The pipe:</strong> We see that Z is a mediator. We see that if we know (Condition) on Z, we remove the relationship between X and Y.</p>
<p><img src="Images/paste-831AAB7D.png" /></p>
<p>We see that this is very similar to the fork.</p>
<p><img src="Images/paste-59DCC9B1.png" /></p>
<p><strong>The collider:</strong> We see that there is a relationship from X to Z and Y to Z. Although if we control for Z, there is no relationship between X and Z. Thus, if we make the model as a linear regression, we will form a spurious relationship between X and Y, that we want to avoid.</p>
<p>The following is an example.</p>
<p><img src="Images/paste-D2249587.png" width="454" /></p>
<p>They must both be on, for the light to be on, but if switch is on and electicity is off, then the light is also off, hence if we know one of the parents, then we know the state of the other.</p>
<p><strong>Collider confounding:</strong> That is to identify if there actually is a relationship between two variables that explain the target variable.</p>
<p>We see in the following example, we control for marriage, and the two subsets of data will make the age appear to have a negative effect on happiness, while we know that that is not true (the data was simulated.)</p>
<p><img src="Images/paste-37D535B5.png" /></p>
<p><strong>Summary:</strong></p>
<p><img src="Images/paste-9098F7FA.png" /></p>
<p>For the pipe we dont want to control for Z, as that will terminate the relationship from C to Y.</p>
<p>For the Collider we need to take care and not create a spurious relationship. We want to leave the collider alone, hence we do not touch it.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-5-the-many-variables-the-spurious-waffles.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter-7-model-comparison.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
